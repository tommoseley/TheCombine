(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();var ra=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lS={exports:{}},Vl={},cS={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $i=Symbol.for("react.element"),p4=Symbol.for("react.portal"),h4=Symbol.for("react.fragment"),m4=Symbol.for("react.strict_mode"),g4=Symbol.for("react.profiler"),v4=Symbol.for("react.provider"),x4=Symbol.for("react.context"),y4=Symbol.for("react.forward_ref"),b4=Symbol.for("react.suspense"),w4=Symbol.for("react.memo"),_4=Symbol.for("react.lazy"),Ax=Symbol.iterator;function S4(e){return e===null||typeof e!="object"?null:(e=Ax&&e[Ax]||e["@@iterator"],typeof e=="function"?e:null)}var uS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dS=Object.assign,fS={};function uo(e,t,r){this.props=e,this.context=t,this.refs=fS,this.updater=r||uS}uo.prototype.isReactComponent={};uo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};uo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function pS(){}pS.prototype=uo.prototype;function Ug(e,t,r){this.props=e,this.context=t,this.refs=fS,this.updater=r||uS}var Gg=Ug.prototype=new pS;Gg.constructor=Ug;dS(Gg,uo.prototype);Gg.isPureReactComponent=!0;var Px=Array.isArray,hS=Object.prototype.hasOwnProperty,Kg={current:null},mS={key:!0,ref:!0,__self:!0,__source:!0};function gS(e,t,r){var n,s={},o=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)hS.call(t,n)&&!mS.hasOwnProperty(n)&&(s[n]=t[n]);var a=arguments.length-2;if(a===1)s.children=r;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in a=e.defaultProps,a)s[n]===void 0&&(s[n]=a[n]);return{$$typeof:$i,type:e,key:o,ref:i,props:s,_owner:Kg.current}}function j4(e,t){return{$$typeof:$i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Yg(e){return typeof e=="object"&&e!==null&&e.$$typeof===$i}function k4(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Dx=/\/+/g;function Wc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?k4(""+e.key):t.toString(36)}function za(e,t,r,n,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case $i:case p4:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+Wc(i,0):n,Px(s)?(r="",e!=null&&(r=e.replace(Dx,"$&/")+"/"),za(s,t,r,"",function(u){return u})):s!=null&&(Yg(s)&&(s=j4(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Dx,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",Px(e))for(var a=0;a<e.length;a++){o=e[a];var c=n+Wc(o,a);i+=za(o,t,r,c,s)}else if(c=S4(e),typeof c=="function")for(e=c.call(e),a=0;!(o=e.next()).done;)o=o.value,c=n+Wc(o,a++),i+=za(o,t,r,c,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function na(e,t,r){if(e==null)return e;var n=[],s=0;return za(e,n,"","",function(o){return t.call(r,o,s++)}),n}function N4(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var yt={current:null},qa={transition:null},E4={ReactCurrentDispatcher:yt,ReactCurrentBatchConfig:qa,ReactCurrentOwner:Kg};function vS(){throw Error("act(...) is not supported in production builds of React.")}de.Children={map:na,forEach:function(e,t,r){na(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return na(e,function(){t++}),t},toArray:function(e){return na(e,function(t){return t})||[]},only:function(e){if(!Yg(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};de.Component=uo;de.Fragment=h4;de.Profiler=g4;de.PureComponent=Ug;de.StrictMode=m4;de.Suspense=b4;de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=E4;de.act=vS;de.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=dS({},e.props),s=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=Kg.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(c in t)hS.call(t,c)&&!mS.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&a!==void 0?a[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];n.children=a}return{$$typeof:$i,type:e.type,key:s,ref:o,props:n,_owner:i}};de.createContext=function(e){return e={$$typeof:x4,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:v4,_context:e},e.Consumer=e};de.createElement=gS;de.createFactory=function(e){var t=gS.bind(null,e);return t.type=e,t};de.createRef=function(){return{current:null}};de.forwardRef=function(e){return{$$typeof:y4,render:e}};de.isValidElement=Yg;de.lazy=function(e){return{$$typeof:_4,_payload:{_status:-1,_result:e},_init:N4}};de.memo=function(e,t){return{$$typeof:w4,type:e,compare:t===void 0?null:t}};de.startTransition=function(e){var t=qa.transition;qa.transition={};try{e()}finally{qa.transition=t}};de.unstable_act=vS;de.useCallback=function(e,t){return yt.current.useCallback(e,t)};de.useContext=function(e){return yt.current.useContext(e)};de.useDebugValue=function(){};de.useDeferredValue=function(e){return yt.current.useDeferredValue(e)};de.useEffect=function(e,t){return yt.current.useEffect(e,t)};de.useId=function(){return yt.current.useId()};de.useImperativeHandle=function(e,t,r){return yt.current.useImperativeHandle(e,t,r)};de.useInsertionEffect=function(e,t){return yt.current.useInsertionEffect(e,t)};de.useLayoutEffect=function(e,t){return yt.current.useLayoutEffect(e,t)};de.useMemo=function(e,t){return yt.current.useMemo(e,t)};de.useReducer=function(e,t,r){return yt.current.useReducer(e,t,r)};de.useRef=function(e){return yt.current.useRef(e)};de.useState=function(e){return yt.current.useState(e)};de.useSyncExternalStore=function(e,t,r){return yt.current.useSyncExternalStore(e,t,r)};de.useTransition=function(){return yt.current.useTransition()};de.version="18.3.1";cS.exports=de;var m=cS.exports;const W=Vg(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C4=m,R4=Symbol.for("react.element"),T4=Symbol.for("react.fragment"),I4=Object.prototype.hasOwnProperty,M4=C4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,A4={key:!0,ref:!0,__self:!0,__source:!0};function xS(e,t,r){var n,s={},o=null,i=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)I4.call(t,n)&&!A4.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:R4,type:e,key:o,ref:i,props:s,_owner:M4.current}}Vl.Fragment=T4;Vl.jsx=xS;Vl.jsxs=xS;lS.exports=Vl;var l=lS.exports,Cm={},yS={exports:{}},zt={},bS={exports:{}},wS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(A,I){var z=A.length;A.push(I);e:for(;0<z;){var M=z-1>>>1,q=A[M];if(0<s(q,I))A[M]=I,A[z]=q,z=M;else break e}}function r(A){return A.length===0?null:A[0]}function n(A){if(A.length===0)return null;var I=A[0],z=A.pop();if(z!==I){A[0]=z;e:for(var M=0,q=A.length,H=q>>>1;M<H;){var O=2*(M+1)-1,B=A[O],Y=O+1,te=A[Y];if(0>s(B,z))Y<q&&0>s(te,B)?(A[M]=te,A[Y]=z,M=Y):(A[M]=B,A[O]=z,M=O);else if(Y<q&&0>s(te,z))A[M]=te,A[Y]=z,M=Y;else break e}}return I}function s(A,I){var z=A.sortIndex-I.sortIndex;return z!==0?z:A.id-I.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();e.unstable_now=function(){return i.now()-a}}var c=[],u=[],d=1,f=null,p=3,h=!1,y=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(A){for(var I=r(u);I!==null;){if(I.callback===null)n(u);else if(I.startTime<=A)n(u),I.sortIndex=I.expirationTime,t(c,I);else break;I=r(u)}}function _(A){if(v=!1,b(A),!y)if(r(c)!==null)y=!0,D(S);else{var I=r(u);I!==null&&F(_,I.startTime-A)}}function S(A,I){y=!1,v&&(v=!1,g(j),j=-1),h=!0;var z=p;try{for(b(I),f=r(c);f!==null&&(!(f.expirationTime>I)||A&&!T());){var M=f.callback;if(typeof M=="function"){f.callback=null,p=f.priorityLevel;var q=M(f.expirationTime<=I);I=e.unstable_now(),typeof q=="function"?f.callback=q:f===r(c)&&n(c),b(I)}else n(c);f=r(c)}if(f!==null)var H=!0;else{var O=r(u);O!==null&&F(_,O.startTime-I),H=!1}return H}finally{f=null,p=z,h=!1}}var k=!1,N=null,j=-1,C=5,R=-1;function T(){return!(e.unstable_now()-R<C)}function L(){if(N!==null){var A=e.unstable_now();R=A;var I=!0;try{I=N(!0,A)}finally{I?$():(k=!1,N=null)}}else k=!1}var $;if(typeof x=="function")$=function(){x(L)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,P=E.port2;E.port1.onmessage=L,$=function(){P.postMessage(null)}}else $=function(){w(L,0)};function D(A){N=A,k||(k=!0,$())}function F(A,I){j=w(function(){A(e.unstable_now())},I)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(A){A.callback=null},e.unstable_continueExecution=function(){y||h||(y=!0,D(S))},e.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<A?Math.floor(1e3/A):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(A){switch(p){case 1:case 2:case 3:var I=3;break;default:I=p}var z=p;p=I;try{return A()}finally{p=z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(A,I){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var z=p;p=A;try{return I()}finally{p=z}},e.unstable_scheduleCallback=function(A,I,z){var M=e.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?M+z:M):z=M,A){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=z+q,A={id:d++,callback:I,priorityLevel:A,startTime:z,expirationTime:q,sortIndex:-1},z>M?(A.sortIndex=z,t(u,A),r(c)===null&&A===r(u)&&(v?(g(j),j=-1):v=!0,F(_,z-M))):(A.sortIndex=q,t(c,A),y||h||(y=!0,D(S))),A},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(A){var I=p;return function(){var z=p;p=I;try{return A.apply(this,arguments)}finally{p=z}}}})(wS);bS.exports=wS;var P4=bS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D4=m,Ot=P4;function G(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _S=new Set,fi={};function gs(e,t){Zs(e,t),Zs(e+"Capture",t)}function Zs(e,t){for(fi[e]=t,e=0;e<t.length;e++)_S.add(t[e])}var Kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rm=Object.prototype.hasOwnProperty,O4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ox={},Lx={};function L4(e){return Rm.call(Lx,e)?!0:Rm.call(Ox,e)?!1:O4.test(e)?Lx[e]=!0:(Ox[e]=!0,!1)}function z4(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function q4(e,t,r,n){if(t===null||typeof t>"u"||z4(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function bt(e,t,r,n,s,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var at={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){at[e]=new bt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];at[t]=new bt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){at[e]=new bt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){at[e]=new bt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){at[e]=new bt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){at[e]=new bt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){at[e]=new bt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){at[e]=new bt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){at[e]=new bt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Xg=/[\-:]([a-z])/g;function Qg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Xg,Qg);at[t]=new bt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Xg,Qg);at[t]=new bt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Xg,Qg);at[t]=new bt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){at[e]=new bt(e,1,!1,e.toLowerCase(),null,!1,!1)});at.xlinkHref=new bt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){at[e]=new bt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Zg(e,t,r,n){var s=at.hasOwnProperty(t)?at[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(q4(t,r,s,n)&&(r=null),n||s===null?L4(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var tn=D4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sa=Symbol.for("react.element"),Cs=Symbol.for("react.portal"),Rs=Symbol.for("react.fragment"),Jg=Symbol.for("react.strict_mode"),Tm=Symbol.for("react.profiler"),SS=Symbol.for("react.provider"),jS=Symbol.for("react.context"),ev=Symbol.for("react.forward_ref"),Im=Symbol.for("react.suspense"),Mm=Symbol.for("react.suspense_list"),tv=Symbol.for("react.memo"),fn=Symbol.for("react.lazy"),kS=Symbol.for("react.offscreen"),zx=Symbol.iterator;function No(e){return e===null||typeof e!="object"?null:(e=zx&&e[zx]||e["@@iterator"],typeof e=="function"?e:null)}var Oe=Object.assign,Vc;function Fo(e){if(Vc===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Vc=t&&t[1]||""}return`
`+Vc+e}var Uc=!1;function Gc(e,t){if(!e||Uc)return"";Uc=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=n.stack.split(`
`),i=s.length-1,a=o.length-1;1<=i&&0<=a&&s[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(s[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||s[i]!==o[a]){var c=`
`+s[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=a);break}}}finally{Uc=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Fo(e):""}function $4(e){switch(e.tag){case 5:return Fo(e.type);case 16:return Fo("Lazy");case 13:return Fo("Suspense");case 19:return Fo("SuspenseList");case 0:case 2:case 15:return e=Gc(e.type,!1),e;case 11:return e=Gc(e.type.render,!1),e;case 1:return e=Gc(e.type,!0),e;default:return""}}function Am(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Rs:return"Fragment";case Cs:return"Portal";case Tm:return"Profiler";case Jg:return"StrictMode";case Im:return"Suspense";case Mm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case jS:return(e.displayName||"Context")+".Consumer";case SS:return(e._context.displayName||"Context")+".Provider";case ev:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case tv:return t=e.displayName||null,t!==null?t:Am(e.type)||"Memo";case fn:t=e._payload,e=e._init;try{return Am(e(t))}catch{}}return null}function F4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Am(t);case 8:return t===Jg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Dn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function NS(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function B4(e){var t=NS(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,o.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function oa(e){e._valueTracker||(e._valueTracker=B4(e))}function ES(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=NS(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function tl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Pm(e,t){var r=t.checked;return Oe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function qx(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Dn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function CS(e,t){t=t.checked,t!=null&&Zg(e,"checked",t,!1)}function Dm(e,t){CS(e,t);var r=Dn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Om(e,t.type,r):t.hasOwnProperty("defaultValue")&&Om(e,t.type,Dn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function $x(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Om(e,t,r){(t!=="number"||tl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Bo=Array.isArray;function Bs(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Dn(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Lm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(G(91));return Oe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Fx(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(G(92));if(Bo(r)){if(1<r.length)throw Error(G(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Dn(r)}}function RS(e,t){var r=Dn(t.value),n=Dn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Bx(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function TS(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?TS(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ia,IS=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ia=ia||document.createElement("div"),ia.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ia.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function pi(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Jo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},H4=["Webkit","ms","Moz","O"];Object.keys(Jo).forEach(function(e){H4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Jo[t]=Jo[e]})});function MS(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Jo.hasOwnProperty(e)&&Jo[e]?(""+t).trim():t+"px"}function AS(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=MS(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var W4=Oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qm(e,t){if(t){if(W4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(G(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(G(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(G(61))}if(t.style!=null&&typeof t.style!="object")throw Error(G(62))}}function $m(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fm=null;function rv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Bm=null,Hs=null,Ws=null;function Hx(e){if(e=Hi(e)){if(typeof Bm!="function")throw Error(G(280));var t=e.stateNode;t&&(t=Xl(t),Bm(e.stateNode,e.type,t))}}function PS(e){Hs?Ws?Ws.push(e):Ws=[e]:Hs=e}function DS(){if(Hs){var e=Hs,t=Ws;if(Ws=Hs=null,Hx(e),t)for(e=0;e<t.length;e++)Hx(t[e])}}function OS(e,t){return e(t)}function LS(){}var Kc=!1;function zS(e,t,r){if(Kc)return e(t,r);Kc=!0;try{return OS(e,t,r)}finally{Kc=!1,(Hs!==null||Ws!==null)&&(LS(),DS())}}function hi(e,t){var r=e.stateNode;if(r===null)return null;var n=Xl(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(G(231,t,typeof r));return r}var Hm=!1;if(Kr)try{var Eo={};Object.defineProperty(Eo,"passive",{get:function(){Hm=!0}}),window.addEventListener("test",Eo,Eo),window.removeEventListener("test",Eo,Eo)}catch{Hm=!1}function V4(e,t,r,n,s,o,i,a,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var ei=!1,rl=null,nl=!1,Wm=null,U4={onError:function(e){ei=!0,rl=e}};function G4(e,t,r,n,s,o,i,a,c){ei=!1,rl=null,V4.apply(U4,arguments)}function K4(e,t,r,n,s,o,i,a,c){if(G4.apply(this,arguments),ei){if(ei){var u=rl;ei=!1,rl=null}else throw Error(G(198));nl||(nl=!0,Wm=u)}}function vs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function qS(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Wx(e){if(vs(e)!==e)throw Error(G(188))}function Y4(e){var t=e.alternate;if(!t){if(t=vs(e),t===null)throw Error(G(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var o=s.alternate;if(o===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===r)return Wx(s),e;if(o===n)return Wx(s),t;o=o.sibling}throw Error(G(188))}if(r.return!==n.return)r=s,n=o;else{for(var i=!1,a=s.child;a;){if(a===r){i=!0,r=s,n=o;break}if(a===n){i=!0,n=s,r=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===r){i=!0,r=o,n=s;break}if(a===n){i=!0,n=o,r=s;break}a=a.sibling}if(!i)throw Error(G(189))}}if(r.alternate!==n)throw Error(G(190))}if(r.tag!==3)throw Error(G(188));return r.stateNode.current===r?e:t}function $S(e){return e=Y4(e),e!==null?FS(e):null}function FS(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=FS(e);if(t!==null)return t;e=e.sibling}return null}var BS=Ot.unstable_scheduleCallback,Vx=Ot.unstable_cancelCallback,X4=Ot.unstable_shouldYield,Q4=Ot.unstable_requestPaint,$e=Ot.unstable_now,Z4=Ot.unstable_getCurrentPriorityLevel,nv=Ot.unstable_ImmediatePriority,HS=Ot.unstable_UserBlockingPriority,sl=Ot.unstable_NormalPriority,J4=Ot.unstable_LowPriority,WS=Ot.unstable_IdlePriority,Ul=null,Cr=null;function eR(e){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(Ul,e,void 0,(e.current.flags&128)===128)}catch{}}var fr=Math.clz32?Math.clz32:nR,tR=Math.log,rR=Math.LN2;function nR(e){return e>>>=0,e===0?32:31-(tR(e)/rR|0)|0}var aa=64,la=4194304;function Ho(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ol(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,o=e.pingedLanes,i=r&268435455;if(i!==0){var a=i&~s;a!==0?n=Ho(a):(o&=i,o!==0&&(n=Ho(o)))}else i=r&~s,i!==0?n=Ho(i):o!==0&&(n=Ho(o));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-fr(t),s=1<<r,n|=e[r],t&=~s;return n}function sR(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oR(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-fr(o),a=1<<i,c=s[i];c===-1?(!(a&r)||a&n)&&(s[i]=sR(a,t)):c<=t&&(e.expiredLanes|=a),o&=~a}}function Vm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function VS(){var e=aa;return aa<<=1,!(aa&4194240)&&(aa=64),e}function Yc(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Fi(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-fr(t),e[t]=r}function iR(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-fr(r),o=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~o}}function sv(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-fr(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var be=0;function US(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var GS,ov,KS,YS,XS,Um=!1,ca=[],jn=null,kn=null,Nn=null,mi=new Map,gi=new Map,vn=[],aR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ux(e,t){switch(e){case"focusin":case"focusout":jn=null;break;case"dragenter":case"dragleave":kn=null;break;case"mouseover":case"mouseout":Nn=null;break;case"pointerover":case"pointerout":mi.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gi.delete(t.pointerId)}}function Co(e,t,r,n,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[s]},t!==null&&(t=Hi(t),t!==null&&ov(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function lR(e,t,r,n,s){switch(t){case"focusin":return jn=Co(jn,e,t,r,n,s),!0;case"dragenter":return kn=Co(kn,e,t,r,n,s),!0;case"mouseover":return Nn=Co(Nn,e,t,r,n,s),!0;case"pointerover":var o=s.pointerId;return mi.set(o,Co(mi.get(o)||null,e,t,r,n,s)),!0;case"gotpointercapture":return o=s.pointerId,gi.set(o,Co(gi.get(o)||null,e,t,r,n,s)),!0}return!1}function QS(e){var t=Jn(e.target);if(t!==null){var r=vs(t);if(r!==null){if(t=r.tag,t===13){if(t=qS(r),t!==null){e.blockedOn=t,XS(e.priority,function(){KS(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function $a(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Gm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Fm=n,r.target.dispatchEvent(n),Fm=null}else return t=Hi(r),t!==null&&ov(t),e.blockedOn=r,!1;t.shift()}return!0}function Gx(e,t,r){$a(e)&&r.delete(t)}function cR(){Um=!1,jn!==null&&$a(jn)&&(jn=null),kn!==null&&$a(kn)&&(kn=null),Nn!==null&&$a(Nn)&&(Nn=null),mi.forEach(Gx),gi.forEach(Gx)}function Ro(e,t){e.blockedOn===t&&(e.blockedOn=null,Um||(Um=!0,Ot.unstable_scheduleCallback(Ot.unstable_NormalPriority,cR)))}function vi(e){function t(s){return Ro(s,e)}if(0<ca.length){Ro(ca[0],e);for(var r=1;r<ca.length;r++){var n=ca[r];n.blockedOn===e&&(n.blockedOn=null)}}for(jn!==null&&Ro(jn,e),kn!==null&&Ro(kn,e),Nn!==null&&Ro(Nn,e),mi.forEach(t),gi.forEach(t),r=0;r<vn.length;r++)n=vn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<vn.length&&(r=vn[0],r.blockedOn===null);)QS(r),r.blockedOn===null&&vn.shift()}var Vs=tn.ReactCurrentBatchConfig,il=!0;function uR(e,t,r,n){var s=be,o=Vs.transition;Vs.transition=null;try{be=1,iv(e,t,r,n)}finally{be=s,Vs.transition=o}}function dR(e,t,r,n){var s=be,o=Vs.transition;Vs.transition=null;try{be=4,iv(e,t,r,n)}finally{be=s,Vs.transition=o}}function iv(e,t,r,n){if(il){var s=Gm(e,t,r,n);if(s===null)ou(e,t,n,al,r),Ux(e,n);else if(lR(s,e,t,r,n))n.stopPropagation();else if(Ux(e,n),t&4&&-1<aR.indexOf(e)){for(;s!==null;){var o=Hi(s);if(o!==null&&GS(o),o=Gm(e,t,r,n),o===null&&ou(e,t,n,al,r),o===s)break;s=o}s!==null&&n.stopPropagation()}else ou(e,t,n,null,r)}}var al=null;function Gm(e,t,r,n){if(al=null,e=rv(n),e=Jn(e),e!==null)if(t=vs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=qS(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return al=e,null}function ZS(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Z4()){case nv:return 1;case HS:return 4;case sl:case J4:return 16;case WS:return 536870912;default:return 16}default:return 16}}var _n=null,av=null,Fa=null;function JS(){if(Fa)return Fa;var e,t=av,r=t.length,n,s="value"in _n?_n.value:_n.textContent,o=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[o-n];n++);return Fa=s.slice(e,1<n?1-n:void 0)}function Ba(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ua(){return!0}function Kx(){return!1}function qt(e){function t(r,n,s,o,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(r=e[a],this[a]=r?r(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?ua:Kx,this.isPropagationStopped=Kx,this}return Oe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ua)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ua)},persist:function(){},isPersistent:ua}),t}var fo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lv=qt(fo),Bi=Oe({},fo,{view:0,detail:0}),fR=qt(Bi),Xc,Qc,To,Gl=Oe({},Bi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==To&&(To&&e.type==="mousemove"?(Xc=e.screenX-To.screenX,Qc=e.screenY-To.screenY):Qc=Xc=0,To=e),Xc)},movementY:function(e){return"movementY"in e?e.movementY:Qc}}),Yx=qt(Gl),pR=Oe({},Gl,{dataTransfer:0}),hR=qt(pR),mR=Oe({},Bi,{relatedTarget:0}),Zc=qt(mR),gR=Oe({},fo,{animationName:0,elapsedTime:0,pseudoElement:0}),vR=qt(gR),xR=Oe({},fo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yR=qt(xR),bR=Oe({},fo,{data:0}),Xx=qt(bR),wR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_R={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},SR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jR(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=SR[e])?!!t[e]:!1}function cv(){return jR}var kR=Oe({},Bi,{key:function(e){if(e.key){var t=wR[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ba(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?_R[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cv,charCode:function(e){return e.type==="keypress"?Ba(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ba(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),NR=qt(kR),ER=Oe({},Gl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qx=qt(ER),CR=Oe({},Bi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cv}),RR=qt(CR),TR=Oe({},fo,{propertyName:0,elapsedTime:0,pseudoElement:0}),IR=qt(TR),MR=Oe({},Gl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),AR=qt(MR),PR=[9,13,27,32],uv=Kr&&"CompositionEvent"in window,ti=null;Kr&&"documentMode"in document&&(ti=document.documentMode);var DR=Kr&&"TextEvent"in window&&!ti,ej=Kr&&(!uv||ti&&8<ti&&11>=ti),Zx=" ",Jx=!1;function tj(e,t){switch(e){case"keyup":return PR.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rj(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ts=!1;function OR(e,t){switch(e){case"compositionend":return rj(t);case"keypress":return t.which!==32?null:(Jx=!0,Zx);case"textInput":return e=t.data,e===Zx&&Jx?null:e;default:return null}}function LR(e,t){if(Ts)return e==="compositionend"||!uv&&tj(e,t)?(e=JS(),Fa=av=_n=null,Ts=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ej&&t.locale!=="ko"?null:t.data;default:return null}}var zR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ey(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!zR[e.type]:t==="textarea"}function nj(e,t,r,n){PS(n),t=ll(t,"onChange"),0<t.length&&(r=new lv("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var ri=null,xi=null;function qR(e){hj(e,0)}function Kl(e){var t=As(e);if(ES(t))return e}function $R(e,t){if(e==="change")return t}var sj=!1;if(Kr){var Jc;if(Kr){var eu="oninput"in document;if(!eu){var ty=document.createElement("div");ty.setAttribute("oninput","return;"),eu=typeof ty.oninput=="function"}Jc=eu}else Jc=!1;sj=Jc&&(!document.documentMode||9<document.documentMode)}function ry(){ri&&(ri.detachEvent("onpropertychange",oj),xi=ri=null)}function oj(e){if(e.propertyName==="value"&&Kl(xi)){var t=[];nj(t,xi,e,rv(e)),zS(qR,t)}}function FR(e,t,r){e==="focusin"?(ry(),ri=t,xi=r,ri.attachEvent("onpropertychange",oj)):e==="focusout"&&ry()}function BR(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Kl(xi)}function HR(e,t){if(e==="click")return Kl(t)}function WR(e,t){if(e==="input"||e==="change")return Kl(t)}function VR(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var hr=typeof Object.is=="function"?Object.is:VR;function yi(e,t){if(hr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Rm.call(t,s)||!hr(e[s],t[s]))return!1}return!0}function ny(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function sy(e,t){var r=ny(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ny(r)}}function ij(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?ij(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function aj(){for(var e=window,t=tl();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=tl(e.document)}return t}function dv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function UR(e){var t=aj(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&ij(r.ownerDocument.documentElement,r)){if(n!==null&&dv(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,o=Math.min(n.start,s);n=n.end===void 0?o:Math.min(n.end,s),!e.extend&&o>n&&(s=n,n=o,o=s),s=sy(r,o);var i=sy(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var GR=Kr&&"documentMode"in document&&11>=document.documentMode,Is=null,Km=null,ni=null,Ym=!1;function oy(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ym||Is==null||Is!==tl(n)||(n=Is,"selectionStart"in n&&dv(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ni&&yi(ni,n)||(ni=n,n=ll(Km,"onSelect"),0<n.length&&(t=new lv("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Is)))}function da(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ms={animationend:da("Animation","AnimationEnd"),animationiteration:da("Animation","AnimationIteration"),animationstart:da("Animation","AnimationStart"),transitionend:da("Transition","TransitionEnd")},tu={},lj={};Kr&&(lj=document.createElement("div").style,"AnimationEvent"in window||(delete Ms.animationend.animation,delete Ms.animationiteration.animation,delete Ms.animationstart.animation),"TransitionEvent"in window||delete Ms.transitionend.transition);function Yl(e){if(tu[e])return tu[e];if(!Ms[e])return e;var t=Ms[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in lj)return tu[e]=t[r];return e}var cj=Yl("animationend"),uj=Yl("animationiteration"),dj=Yl("animationstart"),fj=Yl("transitionend"),pj=new Map,iy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zn(e,t){pj.set(e,t),gs(t,[e])}for(var ru=0;ru<iy.length;ru++){var nu=iy[ru],KR=nu.toLowerCase(),YR=nu[0].toUpperCase()+nu.slice(1);zn(KR,"on"+YR)}zn(cj,"onAnimationEnd");zn(uj,"onAnimationIteration");zn(dj,"onAnimationStart");zn("dblclick","onDoubleClick");zn("focusin","onFocus");zn("focusout","onBlur");zn(fj,"onTransitionEnd");Zs("onMouseEnter",["mouseout","mouseover"]);Zs("onMouseLeave",["mouseout","mouseover"]);Zs("onPointerEnter",["pointerout","pointerover"]);Zs("onPointerLeave",["pointerout","pointerover"]);gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gs("onBeforeInput",["compositionend","keypress","textInput","paste"]);gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wo));function ay(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,K4(n,t,void 0,e),e.currentTarget=null}function hj(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var i=n.length-1;0<=i;i--){var a=n[i],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==o&&s.isPropagationStopped())break e;ay(s,a,u),o=c}else for(i=0;i<n.length;i++){if(a=n[i],c=a.instance,u=a.currentTarget,a=a.listener,c!==o&&s.isPropagationStopped())break e;ay(s,a,u),o=c}}}if(nl)throw e=Wm,nl=!1,Wm=null,e}function Ee(e,t){var r=t[eg];r===void 0&&(r=t[eg]=new Set);var n=e+"__bubble";r.has(n)||(mj(t,e,2,!1),r.add(n))}function su(e,t,r){var n=0;t&&(n|=4),mj(r,e,n,t)}var fa="_reactListening"+Math.random().toString(36).slice(2);function bi(e){if(!e[fa]){e[fa]=!0,_S.forEach(function(r){r!=="selectionchange"&&(XR.has(r)||su(r,!1,e),su(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[fa]||(t[fa]=!0,su("selectionchange",!1,t))}}function mj(e,t,r,n){switch(ZS(t)){case 1:var s=uR;break;case 4:s=dR;break;default:s=iv}r=s.bind(null,t,r,e),s=void 0,!Hm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function ou(e,t,r,n,s){var o=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var a=n.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;a!==null;){if(i=Jn(a),i===null)return;if(c=i.tag,c===5||c===6){n=o=i;continue e}a=a.parentNode}}n=n.return}zS(function(){var u=o,d=rv(r),f=[];e:{var p=pj.get(e);if(p!==void 0){var h=lv,y=e;switch(e){case"keypress":if(Ba(r)===0)break e;case"keydown":case"keyup":h=NR;break;case"focusin":y="focus",h=Zc;break;case"focusout":y="blur",h=Zc;break;case"beforeblur":case"afterblur":h=Zc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Yx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=hR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=RR;break;case cj:case uj:case dj:h=vR;break;case fj:h=IR;break;case"scroll":h=fR;break;case"wheel":h=AR;break;case"copy":case"cut":case"paste":h=yR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Qx}var v=(t&4)!==0,w=!v&&e==="scroll",g=v?p!==null?p+"Capture":null:p;v=[];for(var x=u,b;x!==null;){b=x;var _=b.stateNode;if(b.tag===5&&_!==null&&(b=_,g!==null&&(_=hi(x,g),_!=null&&v.push(wi(x,_,b)))),w)break;x=x.return}0<v.length&&(p=new h(p,y,null,r,d),f.push({event:p,listeners:v}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==Fm&&(y=r.relatedTarget||r.fromElement)&&(Jn(y)||y[Yr]))break e;if((h||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,h?(y=r.relatedTarget||r.toElement,h=u,y=y?Jn(y):null,y!==null&&(w=vs(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(h=null,y=u),h!==y)){if(v=Yx,_="onMouseLeave",g="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(v=Qx,_="onPointerLeave",g="onPointerEnter",x="pointer"),w=h==null?p:As(h),b=y==null?p:As(y),p=new v(_,x+"leave",h,r,d),p.target=w,p.relatedTarget=b,_=null,Jn(d)===u&&(v=new v(g,x+"enter",y,r,d),v.target=b,v.relatedTarget=w,_=v),w=_,h&&y)t:{for(v=h,g=y,x=0,b=v;b;b=Ss(b))x++;for(b=0,_=g;_;_=Ss(_))b++;for(;0<x-b;)v=Ss(v),x--;for(;0<b-x;)g=Ss(g),b--;for(;x--;){if(v===g||g!==null&&v===g.alternate)break t;v=Ss(v),g=Ss(g)}v=null}else v=null;h!==null&&ly(f,p,h,v,!1),y!==null&&w!==null&&ly(f,w,y,v,!0)}}e:{if(p=u?As(u):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var S=$R;else if(ey(p))if(sj)S=WR;else{S=BR;var k=FR}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(S=HR);if(S&&(S=S(e,u))){nj(f,S,r,d);break e}k&&k(e,p,u),e==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&Om(p,"number",p.value)}switch(k=u?As(u):window,e){case"focusin":(ey(k)||k.contentEditable==="true")&&(Is=k,Km=u,ni=null);break;case"focusout":ni=Km=Is=null;break;case"mousedown":Ym=!0;break;case"contextmenu":case"mouseup":case"dragend":Ym=!1,oy(f,r,d);break;case"selectionchange":if(GR)break;case"keydown":case"keyup":oy(f,r,d)}var N;if(uv)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else Ts?tj(e,r)&&(j="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(j="onCompositionStart");j&&(ej&&r.locale!=="ko"&&(Ts||j!=="onCompositionStart"?j==="onCompositionEnd"&&Ts&&(N=JS()):(_n=d,av="value"in _n?_n.value:_n.textContent,Ts=!0)),k=ll(u,j),0<k.length&&(j=new Xx(j,e,null,r,d),f.push({event:j,listeners:k}),N?j.data=N:(N=rj(r),N!==null&&(j.data=N)))),(N=DR?OR(e,r):LR(e,r))&&(u=ll(u,"onBeforeInput"),0<u.length&&(d=new Xx("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=N))}hj(f,t)})}function wi(e,t,r){return{instance:e,listener:t,currentTarget:r}}function ll(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=hi(e,r),o!=null&&n.unshift(wi(e,o,s)),o=hi(e,t),o!=null&&n.push(wi(e,o,s))),e=e.return}return n}function Ss(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function ly(e,t,r,n,s){for(var o=t._reactName,i=[];r!==null&&r!==n;){var a=r,c=a.alternate,u=a.stateNode;if(c!==null&&c===n)break;a.tag===5&&u!==null&&(a=u,s?(c=hi(r,o),c!=null&&i.unshift(wi(r,c,a))):s||(c=hi(r,o),c!=null&&i.push(wi(r,c,a)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var QR=/\r\n?/g,ZR=/\u0000|\uFFFD/g;function cy(e){return(typeof e=="string"?e:""+e).replace(QR,`
`).replace(ZR,"")}function pa(e,t,r){if(t=cy(t),cy(e)!==t&&r)throw Error(G(425))}function cl(){}var Xm=null,Qm=null;function Zm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Jm=typeof setTimeout=="function"?setTimeout:void 0,JR=typeof clearTimeout=="function"?clearTimeout:void 0,uy=typeof Promise=="function"?Promise:void 0,e5=typeof queueMicrotask=="function"?queueMicrotask:typeof uy<"u"?function(e){return uy.resolve(null).then(e).catch(t5)}:Jm;function t5(e){setTimeout(function(){throw e})}function iu(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),vi(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);vi(t)}function En(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function dy(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var po=Math.random().toString(36).slice(2),Nr="__reactFiber$"+po,_i="__reactProps$"+po,Yr="__reactContainer$"+po,eg="__reactEvents$"+po,r5="__reactListeners$"+po,n5="__reactHandles$"+po;function Jn(e){var t=e[Nr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Yr]||r[Nr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=dy(e);e!==null;){if(r=e[Nr])return r;e=dy(e)}return t}e=r,r=e.parentNode}return null}function Hi(e){return e=e[Nr]||e[Yr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function As(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(G(33))}function Xl(e){return e[_i]||null}var tg=[],Ps=-1;function qn(e){return{current:e}}function Ce(e){0>Ps||(e.current=tg[Ps],tg[Ps]=null,Ps--)}function ke(e,t){Ps++,tg[Ps]=e.current,e.current=t}var On={},ft=qn(On),kt=qn(!1),cs=On;function Js(e,t){var r=e.type.contextTypes;if(!r)return On;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in r)s[o]=t[o];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Nt(e){return e=e.childContextTypes,e!=null}function ul(){Ce(kt),Ce(ft)}function fy(e,t,r){if(ft.current!==On)throw Error(G(168));ke(ft,t),ke(kt,r)}function gj(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(G(108,F4(e)||"Unknown",s));return Oe({},r,n)}function dl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||On,cs=ft.current,ke(ft,e),ke(kt,kt.current),!0}function py(e,t,r){var n=e.stateNode;if(!n)throw Error(G(169));r?(e=gj(e,t,cs),n.__reactInternalMemoizedMergedChildContext=e,Ce(kt),Ce(ft),ke(ft,e)):Ce(kt),ke(kt,r)}var $r=null,Ql=!1,au=!1;function vj(e){$r===null?$r=[e]:$r.push(e)}function s5(e){Ql=!0,vj(e)}function $n(){if(!au&&$r!==null){au=!0;var e=0,t=be;try{var r=$r;for(be=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}$r=null,Ql=!1}catch(s){throw $r!==null&&($r=$r.slice(e+1)),BS(nv,$n),s}finally{be=t,au=!1}}return null}var Ds=[],Os=0,fl=null,pl=0,Ut=[],Gt=0,us=null,Fr=1,Br="";function Yn(e,t){Ds[Os++]=pl,Ds[Os++]=fl,fl=e,pl=t}function xj(e,t,r){Ut[Gt++]=Fr,Ut[Gt++]=Br,Ut[Gt++]=us,us=e;var n=Fr;e=Br;var s=32-fr(n)-1;n&=~(1<<s),r+=1;var o=32-fr(t)+s;if(30<o){var i=s-s%5;o=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Fr=1<<32-fr(t)+s|r<<s|n,Br=o+e}else Fr=1<<o|r<<s|n,Br=e}function fv(e){e.return!==null&&(Yn(e,1),xj(e,1,0))}function pv(e){for(;e===fl;)fl=Ds[--Os],Ds[Os]=null,pl=Ds[--Os],Ds[Os]=null;for(;e===us;)us=Ut[--Gt],Ut[Gt]=null,Br=Ut[--Gt],Ut[Gt]=null,Fr=Ut[--Gt],Ut[Gt]=null}var Dt=null,Pt=null,Te=!1,ur=null;function yj(e,t){var r=Yt(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function hy(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Dt=e,Pt=En(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Dt=e,Pt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=us!==null?{id:Fr,overflow:Br}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Yt(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Dt=e,Pt=null,!0):!1;default:return!1}}function rg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ng(e){if(Te){var t=Pt;if(t){var r=t;if(!hy(e,t)){if(rg(e))throw Error(G(418));t=En(r.nextSibling);var n=Dt;t&&hy(e,t)?yj(n,r):(e.flags=e.flags&-4097|2,Te=!1,Dt=e)}}else{if(rg(e))throw Error(G(418));e.flags=e.flags&-4097|2,Te=!1,Dt=e}}}function my(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Dt=e}function ha(e){if(e!==Dt)return!1;if(!Te)return my(e),Te=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Zm(e.type,e.memoizedProps)),t&&(t=Pt)){if(rg(e))throw bj(),Error(G(418));for(;t;)yj(e,t),t=En(t.nextSibling)}if(my(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(G(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Pt=En(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Pt=null}}else Pt=Dt?En(e.stateNode.nextSibling):null;return!0}function bj(){for(var e=Pt;e;)e=En(e.nextSibling)}function eo(){Pt=Dt=null,Te=!1}function hv(e){ur===null?ur=[e]:ur.push(e)}var o5=tn.ReactCurrentBatchConfig;function Io(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(G(309));var n=r.stateNode}if(!n)throw Error(G(147,e));var s=n,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var a=s.refs;i===null?delete a[o]:a[o]=i},t._stringRef=o,t)}if(typeof e!="string")throw Error(G(284));if(!r._owner)throw Error(G(290,e))}return e}function ma(e,t){throw e=Object.prototype.toString.call(t),Error(G(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function gy(e){var t=e._init;return t(e._payload)}function wj(e){function t(g,x){if(e){var b=g.deletions;b===null?(g.deletions=[x],g.flags|=16):b.push(x)}}function r(g,x){if(!e)return null;for(;x!==null;)t(g,x),x=x.sibling;return null}function n(g,x){for(g=new Map;x!==null;)x.key!==null?g.set(x.key,x):g.set(x.index,x),x=x.sibling;return g}function s(g,x){return g=In(g,x),g.index=0,g.sibling=null,g}function o(g,x,b){return g.index=b,e?(b=g.alternate,b!==null?(b=b.index,b<x?(g.flags|=2,x):b):(g.flags|=2,x)):(g.flags|=1048576,x)}function i(g){return e&&g.alternate===null&&(g.flags|=2),g}function a(g,x,b,_){return x===null||x.tag!==6?(x=hu(b,g.mode,_),x.return=g,x):(x=s(x,b),x.return=g,x)}function c(g,x,b,_){var S=b.type;return S===Rs?d(g,x,b.props.children,_,b.key):x!==null&&(x.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===fn&&gy(S)===x.type)?(_=s(x,b.props),_.ref=Io(g,x,b),_.return=g,_):(_=Ya(b.type,b.key,b.props,null,g.mode,_),_.ref=Io(g,x,b),_.return=g,_)}function u(g,x,b,_){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=mu(b,g.mode,_),x.return=g,x):(x=s(x,b.children||[]),x.return=g,x)}function d(g,x,b,_,S){return x===null||x.tag!==7?(x=is(b,g.mode,_,S),x.return=g,x):(x=s(x,b),x.return=g,x)}function f(g,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=hu(""+x,g.mode,b),x.return=g,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case sa:return b=Ya(x.type,x.key,x.props,null,g.mode,b),b.ref=Io(g,null,x),b.return=g,b;case Cs:return x=mu(x,g.mode,b),x.return=g,x;case fn:var _=x._init;return f(g,_(x._payload),b)}if(Bo(x)||No(x))return x=is(x,g.mode,b,null),x.return=g,x;ma(g,x)}return null}function p(g,x,b,_){var S=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return S!==null?null:a(g,x,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case sa:return b.key===S?c(g,x,b,_):null;case Cs:return b.key===S?u(g,x,b,_):null;case fn:return S=b._init,p(g,x,S(b._payload),_)}if(Bo(b)||No(b))return S!==null?null:d(g,x,b,_,null);ma(g,b)}return null}function h(g,x,b,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return g=g.get(b)||null,a(x,g,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case sa:return g=g.get(_.key===null?b:_.key)||null,c(x,g,_,S);case Cs:return g=g.get(_.key===null?b:_.key)||null,u(x,g,_,S);case fn:var k=_._init;return h(g,x,b,k(_._payload),S)}if(Bo(_)||No(_))return g=g.get(b)||null,d(x,g,_,S,null);ma(x,_)}return null}function y(g,x,b,_){for(var S=null,k=null,N=x,j=x=0,C=null;N!==null&&j<b.length;j++){N.index>j?(C=N,N=null):C=N.sibling;var R=p(g,N,b[j],_);if(R===null){N===null&&(N=C);break}e&&N&&R.alternate===null&&t(g,N),x=o(R,x,j),k===null?S=R:k.sibling=R,k=R,N=C}if(j===b.length)return r(g,N),Te&&Yn(g,j),S;if(N===null){for(;j<b.length;j++)N=f(g,b[j],_),N!==null&&(x=o(N,x,j),k===null?S=N:k.sibling=N,k=N);return Te&&Yn(g,j),S}for(N=n(g,N);j<b.length;j++)C=h(N,g,j,b[j],_),C!==null&&(e&&C.alternate!==null&&N.delete(C.key===null?j:C.key),x=o(C,x,j),k===null?S=C:k.sibling=C,k=C);return e&&N.forEach(function(T){return t(g,T)}),Te&&Yn(g,j),S}function v(g,x,b,_){var S=No(b);if(typeof S!="function")throw Error(G(150));if(b=S.call(b),b==null)throw Error(G(151));for(var k=S=null,N=x,j=x=0,C=null,R=b.next();N!==null&&!R.done;j++,R=b.next()){N.index>j?(C=N,N=null):C=N.sibling;var T=p(g,N,R.value,_);if(T===null){N===null&&(N=C);break}e&&N&&T.alternate===null&&t(g,N),x=o(T,x,j),k===null?S=T:k.sibling=T,k=T,N=C}if(R.done)return r(g,N),Te&&Yn(g,j),S;if(N===null){for(;!R.done;j++,R=b.next())R=f(g,R.value,_),R!==null&&(x=o(R,x,j),k===null?S=R:k.sibling=R,k=R);return Te&&Yn(g,j),S}for(N=n(g,N);!R.done;j++,R=b.next())R=h(N,g,j,R.value,_),R!==null&&(e&&R.alternate!==null&&N.delete(R.key===null?j:R.key),x=o(R,x,j),k===null?S=R:k.sibling=R,k=R);return e&&N.forEach(function(L){return t(g,L)}),Te&&Yn(g,j),S}function w(g,x,b,_){if(typeof b=="object"&&b!==null&&b.type===Rs&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case sa:e:{for(var S=b.key,k=x;k!==null;){if(k.key===S){if(S=b.type,S===Rs){if(k.tag===7){r(g,k.sibling),x=s(k,b.props.children),x.return=g,g=x;break e}}else if(k.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===fn&&gy(S)===k.type){r(g,k.sibling),x=s(k,b.props),x.ref=Io(g,k,b),x.return=g,g=x;break e}r(g,k);break}else t(g,k);k=k.sibling}b.type===Rs?(x=is(b.props.children,g.mode,_,b.key),x.return=g,g=x):(_=Ya(b.type,b.key,b.props,null,g.mode,_),_.ref=Io(g,x,b),_.return=g,g=_)}return i(g);case Cs:e:{for(k=b.key;x!==null;){if(x.key===k)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){r(g,x.sibling),x=s(x,b.children||[]),x.return=g,g=x;break e}else{r(g,x);break}else t(g,x);x=x.sibling}x=mu(b,g.mode,_),x.return=g,g=x}return i(g);case fn:return k=b._init,w(g,x,k(b._payload),_)}if(Bo(b))return y(g,x,b,_);if(No(b))return v(g,x,b,_);ma(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(r(g,x.sibling),x=s(x,b),x.return=g,g=x):(r(g,x),x=hu(b,g.mode,_),x.return=g,g=x),i(g)):r(g,x)}return w}var to=wj(!0),_j=wj(!1),hl=qn(null),ml=null,Ls=null,mv=null;function gv(){mv=Ls=ml=null}function vv(e){var t=hl.current;Ce(hl),e._currentValue=t}function sg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Us(e,t){ml=e,mv=Ls=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(St=!0),e.firstContext=null)}function Zt(e){var t=e._currentValue;if(mv!==e)if(e={context:e,memoizedValue:t,next:null},Ls===null){if(ml===null)throw Error(G(308));Ls=e,ml.dependencies={lanes:0,firstContext:e}}else Ls=Ls.next=e;return t}var es=null;function xv(e){es===null?es=[e]:es.push(e)}function Sj(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,xv(t)):(r.next=s.next,s.next=r),t.interleaved=r,Xr(e,n)}function Xr(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var pn=!1;function yv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jj(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ur(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Cn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ge&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,Xr(e,r)}return s=n.interleaved,s===null?(t.next=t,xv(n)):(t.next=s.next,s.next=t),n.interleaved=t,Xr(e,r)}function Ha(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,sv(e,r)}}function vy(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?s=o=i:o=o.next=i,r=r.next}while(r!==null);o===null?s=o=t:o=o.next=t}else s=o=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function gl(e,t,r,n){var s=e.updateQueue;pn=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,u=c.next;c.next=null,i===null?o=u:i.next=u,i=c;var d=e.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==i&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=c))}if(o!==null){var f=s.baseState;i=0,d=u=c=null,a=o;do{var p=a.lane,h=a.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=e,v=a;switch(p=t,h=r,v.tag){case 1:if(y=v.payload,typeof y=="function"){f=y.call(h,f,p);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,p=typeof y=="function"?y.call(h,f,p):y,p==null)break e;f=Oe({},f,p);break e;case 2:pn=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[a]:p.push(a))}else h={eventTime:h,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=h,c=f):d=d.next=h,i|=p;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;p=a,a=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);fs|=i,e.lanes=i,e.memoizedState=f}}function xy(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(G(191,s));s.call(n)}}}var Wi={},Rr=qn(Wi),Si=qn(Wi),ji=qn(Wi);function ts(e){if(e===Wi)throw Error(G(174));return e}function bv(e,t){switch(ke(ji,t),ke(Si,e),ke(Rr,Wi),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:zm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=zm(t,e)}Ce(Rr),ke(Rr,t)}function ro(){Ce(Rr),Ce(Si),Ce(ji)}function kj(e){ts(ji.current);var t=ts(Rr.current),r=zm(t,e.type);t!==r&&(ke(Si,e),ke(Rr,r))}function wv(e){Si.current===e&&(Ce(Rr),Ce(Si))}var Pe=qn(0);function vl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var lu=[];function _v(){for(var e=0;e<lu.length;e++)lu[e]._workInProgressVersionPrimary=null;lu.length=0}var Wa=tn.ReactCurrentDispatcher,cu=tn.ReactCurrentBatchConfig,ds=0,De=null,Ge=null,Ze=null,xl=!1,si=!1,ki=0,i5=0;function ct(){throw Error(G(321))}function Sv(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!hr(e[r],t[r]))return!1;return!0}function jv(e,t,r,n,s,o){if(ds=o,De=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Wa.current=e===null||e.memoizedState===null?u5:d5,e=r(n,s),si){o=0;do{if(si=!1,ki=0,25<=o)throw Error(G(301));o+=1,Ze=Ge=null,t.updateQueue=null,Wa.current=f5,e=r(n,s)}while(si)}if(Wa.current=yl,t=Ge!==null&&Ge.next!==null,ds=0,Ze=Ge=De=null,xl=!1,t)throw Error(G(300));return e}function kv(){var e=ki!==0;return ki=0,e}function kr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ze===null?De.memoizedState=Ze=e:Ze=Ze.next=e,Ze}function Jt(){if(Ge===null){var e=De.alternate;e=e!==null?e.memoizedState:null}else e=Ge.next;var t=Ze===null?De.memoizedState:Ze.next;if(t!==null)Ze=t,Ge=e;else{if(e===null)throw Error(G(310));Ge=e,e={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},Ze===null?De.memoizedState=Ze=e:Ze=Ze.next=e}return Ze}function Ni(e,t){return typeof t=="function"?t(e):t}function uu(e){var t=Jt(),r=t.queue;if(r===null)throw Error(G(311));r.lastRenderedReducer=e;var n=Ge,s=n.baseQueue,o=r.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}n.baseQueue=s=o,r.pending=null}if(s!==null){o=s.next,n=n.baseState;var a=i=null,c=null,u=o;do{var d=u.lane;if((ds&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=f,i=n):c=c.next=f,De.lanes|=d,fs|=d}u=u.next}while(u!==null&&u!==o);c===null?i=n:c.next=a,hr(n,t.memoizedState)||(St=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do o=s.lane,De.lanes|=o,fs|=o,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function du(e){var t=Jt(),r=t.queue;if(r===null)throw Error(G(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,o=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do o=e(o,i.action),i=i.next;while(i!==s);hr(o,t.memoizedState)||(St=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function Nj(){}function Ej(e,t){var r=De,n=Jt(),s=t(),o=!hr(n.memoizedState,s);if(o&&(n.memoizedState=s,St=!0),n=n.queue,Nv(Tj.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||Ze!==null&&Ze.memoizedState.tag&1){if(r.flags|=2048,Ei(9,Rj.bind(null,r,n,s,t),void 0,null),et===null)throw Error(G(349));ds&30||Cj(r,t,s)}return s}function Cj(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=De.updateQueue,t===null?(t={lastEffect:null,stores:null},De.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Rj(e,t,r,n){t.value=r,t.getSnapshot=n,Ij(t)&&Mj(e)}function Tj(e,t,r){return r(function(){Ij(t)&&Mj(e)})}function Ij(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!hr(e,r)}catch{return!0}}function Mj(e){var t=Xr(e,1);t!==null&&pr(t,e,1,-1)}function yy(e){var t=kr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ni,lastRenderedState:e},t.queue=e,e=e.dispatch=c5.bind(null,De,e),[t.memoizedState,e]}function Ei(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=De.updateQueue,t===null?(t={lastEffect:null,stores:null},De.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Aj(){return Jt().memoizedState}function Va(e,t,r,n){var s=kr();De.flags|=e,s.memoizedState=Ei(1|t,r,void 0,n===void 0?null:n)}function Zl(e,t,r,n){var s=Jt();n=n===void 0?null:n;var o=void 0;if(Ge!==null){var i=Ge.memoizedState;if(o=i.destroy,n!==null&&Sv(n,i.deps)){s.memoizedState=Ei(t,r,o,n);return}}De.flags|=e,s.memoizedState=Ei(1|t,r,o,n)}function by(e,t){return Va(8390656,8,e,t)}function Nv(e,t){return Zl(2048,8,e,t)}function Pj(e,t){return Zl(4,2,e,t)}function Dj(e,t){return Zl(4,4,e,t)}function Oj(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Lj(e,t,r){return r=r!=null?r.concat([e]):null,Zl(4,4,Oj.bind(null,t,e),r)}function Ev(){}function zj(e,t){var r=Jt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Sv(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function qj(e,t){var r=Jt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Sv(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function $j(e,t,r){return ds&21?(hr(r,t)||(r=VS(),De.lanes|=r,fs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,St=!0),e.memoizedState=r)}function a5(e,t){var r=be;be=r!==0&&4>r?r:4,e(!0);var n=cu.transition;cu.transition={};try{e(!1),t()}finally{be=r,cu.transition=n}}function Fj(){return Jt().memoizedState}function l5(e,t,r){var n=Tn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Bj(e))Hj(t,r);else if(r=Sj(e,t,r,n),r!==null){var s=xt();pr(r,e,n,s),Wj(r,t,n)}}function c5(e,t,r){var n=Tn(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Bj(e))Hj(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,a=o(i,r);if(s.hasEagerState=!0,s.eagerState=a,hr(a,i)){var c=t.interleaved;c===null?(s.next=s,xv(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=Sj(e,t,s,n),r!==null&&(s=xt(),pr(r,e,n,s),Wj(r,t,n))}}function Bj(e){var t=e.alternate;return e===De||t!==null&&t===De}function Hj(e,t){si=xl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Wj(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,sv(e,r)}}var yl={readContext:Zt,useCallback:ct,useContext:ct,useEffect:ct,useImperativeHandle:ct,useInsertionEffect:ct,useLayoutEffect:ct,useMemo:ct,useReducer:ct,useRef:ct,useState:ct,useDebugValue:ct,useDeferredValue:ct,useTransition:ct,useMutableSource:ct,useSyncExternalStore:ct,useId:ct,unstable_isNewReconciler:!1},u5={readContext:Zt,useCallback:function(e,t){return kr().memoizedState=[e,t===void 0?null:t],e},useContext:Zt,useEffect:by,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Va(4194308,4,Oj.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Va(4194308,4,e,t)},useInsertionEffect:function(e,t){return Va(4,2,e,t)},useMemo:function(e,t){var r=kr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=kr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=l5.bind(null,De,e),[n.memoizedState,e]},useRef:function(e){var t=kr();return e={current:e},t.memoizedState=e},useState:yy,useDebugValue:Ev,useDeferredValue:function(e){return kr().memoizedState=e},useTransition:function(){var e=yy(!1),t=e[0];return e=a5.bind(null,e[1]),kr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=De,s=kr();if(Te){if(r===void 0)throw Error(G(407));r=r()}else{if(r=t(),et===null)throw Error(G(349));ds&30||Cj(n,t,r)}s.memoizedState=r;var o={value:r,getSnapshot:t};return s.queue=o,by(Tj.bind(null,n,o,e),[e]),n.flags|=2048,Ei(9,Rj.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=kr(),t=et.identifierPrefix;if(Te){var r=Br,n=Fr;r=(n&~(1<<32-fr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=ki++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=i5++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},d5={readContext:Zt,useCallback:zj,useContext:Zt,useEffect:Nv,useImperativeHandle:Lj,useInsertionEffect:Pj,useLayoutEffect:Dj,useMemo:qj,useReducer:uu,useRef:Aj,useState:function(){return uu(Ni)},useDebugValue:Ev,useDeferredValue:function(e){var t=Jt();return $j(t,Ge.memoizedState,e)},useTransition:function(){var e=uu(Ni)[0],t=Jt().memoizedState;return[e,t]},useMutableSource:Nj,useSyncExternalStore:Ej,useId:Fj,unstable_isNewReconciler:!1},f5={readContext:Zt,useCallback:zj,useContext:Zt,useEffect:Nv,useImperativeHandle:Lj,useInsertionEffect:Pj,useLayoutEffect:Dj,useMemo:qj,useReducer:du,useRef:Aj,useState:function(){return du(Ni)},useDebugValue:Ev,useDeferredValue:function(e){var t=Jt();return Ge===null?t.memoizedState=e:$j(t,Ge.memoizedState,e)},useTransition:function(){var e=du(Ni)[0],t=Jt().memoizedState;return[e,t]},useMutableSource:Nj,useSyncExternalStore:Ej,useId:Fj,unstable_isNewReconciler:!1};function ar(e,t){if(e&&e.defaultProps){t=Oe({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function og(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Oe({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Jl={isMounted:function(e){return(e=e._reactInternals)?vs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=xt(),s=Tn(e),o=Ur(n,s);o.payload=t,r!=null&&(o.callback=r),t=Cn(e,o,s),t!==null&&(pr(t,e,s,n),Ha(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=xt(),s=Tn(e),o=Ur(n,s);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=Cn(e,o,s),t!==null&&(pr(t,e,s,n),Ha(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=xt(),n=Tn(e),s=Ur(r,n);s.tag=2,t!=null&&(s.callback=t),t=Cn(e,s,n),t!==null&&(pr(t,e,n,r),Ha(t,e,n))}};function wy(e,t,r,n,s,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,i):t.prototype&&t.prototype.isPureReactComponent?!yi(r,n)||!yi(s,o):!0}function Vj(e,t,r){var n=!1,s=On,o=t.contextType;return typeof o=="object"&&o!==null?o=Zt(o):(s=Nt(t)?cs:ft.current,n=t.contextTypes,o=(n=n!=null)?Js(e,s):On),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Jl,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function _y(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Jl.enqueueReplaceState(t,t.state,null)}function ig(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},yv(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=Zt(o):(o=Nt(t)?cs:ft.current,s.context=Js(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(og(e,t,o,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Jl.enqueueReplaceState(s,s.state,null),gl(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function no(e,t){try{var r="",n=t;do r+=$4(n),n=n.return;while(n);var s=r}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function fu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function ag(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var p5=typeof WeakMap=="function"?WeakMap:Map;function Uj(e,t,r){r=Ur(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){wl||(wl=!0,vg=n),ag(e,t)},r}function Gj(e,t,r){r=Ur(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){ag(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){ag(e,t),typeof n!="function"&&(Rn===null?Rn=new Set([this]):Rn.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function Sy(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new p5;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=E5.bind(null,e,t,r),t.then(e,e))}function jy(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ky(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ur(-1,1),t.tag=2,Cn(r,t,1))),r.lanes|=1),e)}var h5=tn.ReactCurrentOwner,St=!1;function vt(e,t,r,n){t.child=e===null?_j(t,null,r,n):to(t,e.child,r,n)}function Ny(e,t,r,n,s){r=r.render;var o=t.ref;return Us(t,s),n=jv(e,t,r,n,o,s),r=kv(),e!==null&&!St?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Qr(e,t,s)):(Te&&r&&fv(t),t.flags|=1,vt(e,t,n,s),t.child)}function Ey(e,t,r,n,s){if(e===null){var o=r.type;return typeof o=="function"&&!Dv(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,Kj(e,t,o,n,s)):(e=Ya(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var i=o.memoizedProps;if(r=r.compare,r=r!==null?r:yi,r(i,n)&&e.ref===t.ref)return Qr(e,t,s)}return t.flags|=1,e=In(o,n),e.ref=t.ref,e.return=t,t.child=e}function Kj(e,t,r,n,s){if(e!==null){var o=e.memoizedProps;if(yi(o,n)&&e.ref===t.ref)if(St=!1,t.pendingProps=n=o,(e.lanes&s)!==0)e.flags&131072&&(St=!0);else return t.lanes=e.lanes,Qr(e,t,s)}return lg(e,t,r,n,s)}function Yj(e,t,r){var n=t.pendingProps,s=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ke(qs,Mt),Mt|=r;else{if(!(r&1073741824))return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ke(qs,Mt),Mt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,ke(qs,Mt),Mt|=n}else o!==null?(n=o.baseLanes|r,t.memoizedState=null):n=r,ke(qs,Mt),Mt|=n;return vt(e,t,s,r),t.child}function Xj(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function lg(e,t,r,n,s){var o=Nt(r)?cs:ft.current;return o=Js(t,o),Us(t,s),r=jv(e,t,r,n,o,s),n=kv(),e!==null&&!St?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Qr(e,t,s)):(Te&&n&&fv(t),t.flags|=1,vt(e,t,r,s),t.child)}function Cy(e,t,r,n,s){if(Nt(r)){var o=!0;dl(t)}else o=!1;if(Us(t,s),t.stateNode===null)Ua(e,t),Vj(t,r,n),ig(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,a=t.memoizedProps;i.props=a;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=Zt(u):(u=Nt(r)?cs:ft.current,u=Js(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==n||c!==u)&&_y(t,i,n,u),pn=!1;var p=t.memoizedState;i.state=p,gl(t,n,i,s),c=t.memoizedState,a!==n||p!==c||kt.current||pn?(typeof d=="function"&&(og(t,r,d,n),c=t.memoizedState),(a=pn||wy(t,r,a,n,p,c,u))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),i.props=n,i.state=c,i.context=u,n=a):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,jj(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:ar(t.type,a),i.props=u,f=t.pendingProps,p=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=Zt(c):(c=Nt(r)?cs:ft.current,c=Js(t,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==f||p!==c)&&_y(t,i,n,c),pn=!1,p=t.memoizedState,i.state=p,gl(t,n,i,s);var y=t.memoizedState;a!==f||p!==y||kt.current||pn?(typeof h=="function"&&(og(t,r,h,n),y=t.memoizedState),(u=pn||wy(t,r,u,n,p,y,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,y,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,y,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),i.props=n,i.state=y,i.context=c,n=u):(typeof i.componentDidUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return cg(e,t,r,n,o,s)}function cg(e,t,r,n,s,o){Xj(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&py(t,r,!1),Qr(e,t,o);n=t.stateNode,h5.current=t;var a=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=to(t,e.child,null,o),t.child=to(t,null,a,o)):vt(e,t,a,o),t.memoizedState=n.state,s&&py(t,r,!0),t.child}function Qj(e){var t=e.stateNode;t.pendingContext?fy(e,t.pendingContext,t.pendingContext!==t.context):t.context&&fy(e,t.context,!1),bv(e,t.containerInfo)}function Ry(e,t,r,n,s){return eo(),hv(s),t.flags|=256,vt(e,t,r,n),t.child}var ug={dehydrated:null,treeContext:null,retryLane:0};function dg(e){return{baseLanes:e,cachePool:null,transitions:null}}function Zj(e,t,r){var n=t.pendingProps,s=Pe.current,o=!1,i=(t.flags&128)!==0,a;if((a=i)||(a=e!==null&&e.memoizedState===null?!1:(s&2)!==0),a?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ke(Pe,s&1),e===null)return ng(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,o?(n=t.mode,o=t.child,i={mode:"hidden",children:i},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=rc(i,n,0,null),e=is(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=dg(r),t.memoizedState=ug,e):Cv(t,i));if(s=e.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return m5(e,t,i,n,a,s,r);if(o){o=n.fallback,i=t.mode,s=e.child,a=s.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=In(s,c),n.subtreeFlags=s.subtreeFlags&14680064),a!==null?o=In(a,o):(o=is(o,i,r,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,i=e.child.memoizedState,i=i===null?dg(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~r,t.memoizedState=ug,n}return o=e.child,e=o.sibling,n=In(o,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Cv(e,t){return t=rc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ga(e,t,r,n){return n!==null&&hv(n),to(t,e.child,null,r),e=Cv(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function m5(e,t,r,n,s,o,i){if(r)return t.flags&256?(t.flags&=-257,n=fu(Error(G(422))),ga(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=n.fallback,s=t.mode,n=rc({mode:"visible",children:n.children},s,0,null),o=is(o,s,i,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,t.mode&1&&to(t,e.child,null,i),t.child.memoizedState=dg(i),t.memoizedState=ug,o);if(!(t.mode&1))return ga(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var a=n.dgst;return n=a,o=Error(G(419)),n=fu(o,n,void 0),ga(e,t,i,n)}if(a=(i&e.childLanes)!==0,St||a){if(n=et,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Xr(e,s),pr(n,e,s,-1))}return Pv(),n=fu(Error(G(421))),ga(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=C5.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,Pt=En(s.nextSibling),Dt=t,Te=!0,ur=null,e!==null&&(Ut[Gt++]=Fr,Ut[Gt++]=Br,Ut[Gt++]=us,Fr=e.id,Br=e.overflow,us=t),t=Cv(t,n.children),t.flags|=4096,t)}function Ty(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),sg(e.return,t,r)}function pu(e,t,r,n,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=s)}function Jj(e,t,r){var n=t.pendingProps,s=n.revealOrder,o=n.tail;if(vt(e,t,n.children,r),n=Pe.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ty(e,r,t);else if(e.tag===19)Ty(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ke(Pe,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&vl(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),pu(t,!1,s,r,o);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&vl(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}pu(t,!0,r,null,o);break;case"together":pu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ua(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Qr(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),fs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(G(153));if(t.child!==null){for(e=t.child,r=In(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=In(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function g5(e,t,r){switch(t.tag){case 3:Qj(t),eo();break;case 5:kj(t);break;case 1:Nt(t.type)&&dl(t);break;case 4:bv(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;ke(hl,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ke(Pe,Pe.current&1),t.flags|=128,null):r&t.child.childLanes?Zj(e,t,r):(ke(Pe,Pe.current&1),e=Qr(e,t,r),e!==null?e.sibling:null);ke(Pe,Pe.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Jj(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ke(Pe,Pe.current),n)break;return null;case 22:case 23:return t.lanes=0,Yj(e,t,r)}return Qr(e,t,r)}var ek,fg,tk,rk;ek=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};fg=function(){};tk=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,ts(Rr.current);var o=null;switch(r){case"input":s=Pm(e,s),n=Pm(e,n),o=[];break;case"select":s=Oe({},s,{value:void 0}),n=Oe({},n,{value:void 0}),o=[];break;case"textarea":s=Lm(e,s),n=Lm(e,n),o=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=cl)}qm(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(i in a)a.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(fi.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in n){var c=n[u];if(a=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(i in a)!a.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&a[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(o||(o=[]),o.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(o=o||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(fi.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ee("scroll",e),o||a===c||(o=[])):(o=o||[]).push(u,c))}r&&(o=o||[]).push("style",r);var u=o;(t.updateQueue=u)&&(t.flags|=4)}};rk=function(e,t,r,n){r!==n&&(t.flags|=4)};function Mo(e,t){if(!Te)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ut(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function v5(e,t,r){var n=t.pendingProps;switch(pv(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ut(t),null;case 1:return Nt(t.type)&&ul(),ut(t),null;case 3:return n=t.stateNode,ro(),Ce(kt),Ce(ft),_v(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(ha(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ur!==null&&(bg(ur),ur=null))),fg(e,t),ut(t),null;case 5:wv(t);var s=ts(ji.current);if(r=t.type,e!==null&&t.stateNode!=null)tk(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(G(166));return ut(t),null}if(e=ts(Rr.current),ha(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[Nr]=t,n[_i]=o,e=(t.mode&1)!==0,r){case"dialog":Ee("cancel",n),Ee("close",n);break;case"iframe":case"object":case"embed":Ee("load",n);break;case"video":case"audio":for(s=0;s<Wo.length;s++)Ee(Wo[s],n);break;case"source":Ee("error",n);break;case"img":case"image":case"link":Ee("error",n),Ee("load",n);break;case"details":Ee("toggle",n);break;case"input":qx(n,o),Ee("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},Ee("invalid",n);break;case"textarea":Fx(n,o),Ee("invalid",n)}qm(r,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?n.textContent!==a&&(o.suppressHydrationWarning!==!0&&pa(n.textContent,a,e),s=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&pa(n.textContent,a,e),s=["children",""+a]):fi.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&Ee("scroll",n)}switch(r){case"input":oa(n),$x(n,o,!0);break;case"textarea":oa(n),Bx(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=cl)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=TS(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Nr]=t,e[_i]=n,ek(e,t,!1,!1),t.stateNode=e;e:{switch(i=$m(r,n),r){case"dialog":Ee("cancel",e),Ee("close",e),s=n;break;case"iframe":case"object":case"embed":Ee("load",e),s=n;break;case"video":case"audio":for(s=0;s<Wo.length;s++)Ee(Wo[s],e);s=n;break;case"source":Ee("error",e),s=n;break;case"img":case"image":case"link":Ee("error",e),Ee("load",e),s=n;break;case"details":Ee("toggle",e),s=n;break;case"input":qx(e,n),s=Pm(e,n),Ee("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Oe({},n,{value:void 0}),Ee("invalid",e);break;case"textarea":Fx(e,n),s=Lm(e,n),Ee("invalid",e);break;default:s=n}qm(r,s),a=s;for(o in a)if(a.hasOwnProperty(o)){var c=a[o];o==="style"?AS(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&IS(e,c)):o==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&pi(e,c):typeof c=="number"&&pi(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(fi.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Ee("scroll",e):c!=null&&Zg(e,o,c,i))}switch(r){case"input":oa(e),$x(e,n,!1);break;case"textarea":oa(e),Bx(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Dn(n.value));break;case"select":e.multiple=!!n.multiple,o=n.value,o!=null?Bs(e,!!n.multiple,o,!1):n.defaultValue!=null&&Bs(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=cl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ut(t),null;case 6:if(e&&t.stateNode!=null)rk(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(G(166));if(r=ts(ji.current),ts(Rr.current),ha(t)){if(n=t.stateNode,r=t.memoizedProps,n[Nr]=t,(o=n.nodeValue!==r)&&(e=Dt,e!==null))switch(e.tag){case 3:pa(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&pa(n.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Nr]=t,t.stateNode=n}return ut(t),null;case 13:if(Ce(Pe),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Te&&Pt!==null&&t.mode&1&&!(t.flags&128))bj(),eo(),t.flags|=98560,o=!1;else if(o=ha(t),n!==null&&n.dehydrated!==null){if(e===null){if(!o)throw Error(G(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(G(317));o[Nr]=t}else eo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ut(t),o=!1}else ur!==null&&(bg(ur),ur=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Pe.current&1?Ye===0&&(Ye=3):Pv())),t.updateQueue!==null&&(t.flags|=4),ut(t),null);case 4:return ro(),fg(e,t),e===null&&bi(t.stateNode.containerInfo),ut(t),null;case 10:return vv(t.type._context),ut(t),null;case 17:return Nt(t.type)&&ul(),ut(t),null;case 19:if(Ce(Pe),o=t.memoizedState,o===null)return ut(t),null;if(n=(t.flags&128)!==0,i=o.rendering,i===null)if(n)Mo(o,!1);else{if(Ye!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=vl(e),i!==null){for(t.flags|=128,Mo(o,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)o=r,e=n,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ke(Pe,Pe.current&1|2),t.child}e=e.sibling}o.tail!==null&&$e()>so&&(t.flags|=128,n=!0,Mo(o,!1),t.lanes=4194304)}else{if(!n)if(e=vl(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Mo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!Te)return ut(t),null}else 2*$e()-o.renderingStartTime>so&&r!==1073741824&&(t.flags|=128,n=!0,Mo(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(r=o.last,r!==null?r.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=$e(),t.sibling=null,r=Pe.current,ke(Pe,n?r&1|2:r&1),t):(ut(t),null);case 22:case 23:return Av(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Mt&1073741824&&(ut(t),t.subtreeFlags&6&&(t.flags|=8192)):ut(t),null;case 24:return null;case 25:return null}throw Error(G(156,t.tag))}function x5(e,t){switch(pv(t),t.tag){case 1:return Nt(t.type)&&ul(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ro(),Ce(kt),Ce(ft),_v(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return wv(t),null;case 13:if(Ce(Pe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(G(340));eo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ce(Pe),null;case 4:return ro(),null;case 10:return vv(t.type._context),null;case 22:case 23:return Av(),null;case 24:return null;default:return null}}var va=!1,dt=!1,y5=typeof WeakSet=="function"?WeakSet:Set,Z=null;function zs(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Le(e,t,n)}else r.current=null}function pg(e,t,r){try{r()}catch(n){Le(e,t,n)}}var Iy=!1;function b5(e,t){if(Xm=il,e=aj(),dv(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var i=0,a=-1,c=-1,u=0,d=0,f=e,p=null;t:for(;;){for(var h;f!==r||s!==0&&f.nodeType!==3||(a=i+s),f!==o||n!==0&&f.nodeType!==3||(c=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===r&&++u===s&&(a=i),p===o&&++d===n&&(c=i),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}r=a===-1||c===-1?null:{start:a,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Qm={focusedElem:e,selectionRange:r},il=!1,Z=t;Z!==null;)if(t=Z,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Z=e;else for(;Z!==null;){t=Z;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,w=y.memoizedState,g=t.stateNode,x=g.getSnapshotBeforeUpdate(t.elementType===t.type?v:ar(t.type,v),w);g.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(_){Le(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,Z=e;break}Z=t.return}return y=Iy,Iy=!1,y}function oi(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&pg(t,r,o)}s=s.next}while(s!==n)}}function ec(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function hg(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function nk(e){var t=e.alternate;t!==null&&(e.alternate=null,nk(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Nr],delete t[_i],delete t[eg],delete t[r5],delete t[n5])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sk(e){return e.tag===5||e.tag===3||e.tag===4}function My(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||sk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function mg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=cl));else if(n!==4&&(e=e.child,e!==null))for(mg(e,t,r),e=e.sibling;e!==null;)mg(e,t,r),e=e.sibling}function gg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(gg(e,t,r),e=e.sibling;e!==null;)gg(e,t,r),e=e.sibling}var ot=null,lr=!1;function an(e,t,r){for(r=r.child;r!==null;)ok(e,t,r),r=r.sibling}function ok(e,t,r){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(Ul,r)}catch{}switch(r.tag){case 5:dt||zs(r,t);case 6:var n=ot,s=lr;ot=null,an(e,t,r),ot=n,lr=s,ot!==null&&(lr?(e=ot,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ot.removeChild(r.stateNode));break;case 18:ot!==null&&(lr?(e=ot,r=r.stateNode,e.nodeType===8?iu(e.parentNode,r):e.nodeType===1&&iu(e,r),vi(e)):iu(ot,r.stateNode));break;case 4:n=ot,s=lr,ot=r.stateNode.containerInfo,lr=!0,an(e,t,r),ot=n,lr=s;break;case 0:case 11:case 14:case 15:if(!dt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&pg(r,t,i),s=s.next}while(s!==n)}an(e,t,r);break;case 1:if(!dt&&(zs(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Le(r,t,a)}an(e,t,r);break;case 21:an(e,t,r);break;case 22:r.mode&1?(dt=(n=dt)||r.memoizedState!==null,an(e,t,r),dt=n):an(e,t,r);break;default:an(e,t,r)}}function Ay(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new y5),t.forEach(function(n){var s=R5.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function or(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var o=e,i=t,a=i;e:for(;a!==null;){switch(a.tag){case 5:ot=a.stateNode,lr=!1;break e;case 3:ot=a.stateNode.containerInfo,lr=!0;break e;case 4:ot=a.stateNode.containerInfo,lr=!0;break e}a=a.return}if(ot===null)throw Error(G(160));ok(o,i,s),ot=null,lr=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Le(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ik(t,e),t=t.sibling}function ik(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(or(t,e),_r(e),n&4){try{oi(3,e,e.return),ec(3,e)}catch(v){Le(e,e.return,v)}try{oi(5,e,e.return)}catch(v){Le(e,e.return,v)}}break;case 1:or(t,e),_r(e),n&512&&r!==null&&zs(r,r.return);break;case 5:if(or(t,e),_r(e),n&512&&r!==null&&zs(r,r.return),e.flags&32){var s=e.stateNode;try{pi(s,"")}catch(v){Le(e,e.return,v)}}if(n&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,i=r!==null?r.memoizedProps:o,a=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&CS(s,o),$m(a,i);var u=$m(a,o);for(i=0;i<c.length;i+=2){var d=c[i],f=c[i+1];d==="style"?AS(s,f):d==="dangerouslySetInnerHTML"?IS(s,f):d==="children"?pi(s,f):Zg(s,d,f,u)}switch(a){case"input":Dm(s,o);break;case"textarea":RS(s,o);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?Bs(s,!!o.multiple,h,!1):p!==!!o.multiple&&(o.defaultValue!=null?Bs(s,!!o.multiple,o.defaultValue,!0):Bs(s,!!o.multiple,o.multiple?[]:"",!1))}s[_i]=o}catch(v){Le(e,e.return,v)}}break;case 6:if(or(t,e),_r(e),n&4){if(e.stateNode===null)throw Error(G(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(v){Le(e,e.return,v)}}break;case 3:if(or(t,e),_r(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{vi(t.containerInfo)}catch(v){Le(e,e.return,v)}break;case 4:or(t,e),_r(e);break;case 13:or(t,e),_r(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(Iv=$e())),n&4&&Ay(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(dt=(u=dt)||d,or(t,e),dt=u):or(t,e),_r(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Z=e,d=e.child;d!==null;){for(f=Z=d;Z!==null;){switch(p=Z,h=p.child,p.tag){case 0:case 11:case 14:case 15:oi(4,p,p.return);break;case 1:zs(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(v){Le(n,r,v)}}break;case 5:zs(p,p.return);break;case 22:if(p.memoizedState!==null){Dy(f);continue}}h!==null?(h.return=p,Z=h):Dy(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=MS("display",i))}catch(v){Le(e,e.return,v)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(v){Le(e,e.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:or(t,e),_r(e),n&4&&Ay(e);break;case 21:break;default:or(t,e),_r(e)}}function _r(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(sk(r)){var n=r;break e}r=r.return}throw Error(G(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(pi(s,""),n.flags&=-33);var o=My(e);gg(e,o,s);break;case 3:case 4:var i=n.stateNode.containerInfo,a=My(e);mg(e,a,i);break;default:throw Error(G(161))}}catch(c){Le(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function w5(e,t,r){Z=e,ak(e)}function ak(e,t,r){for(var n=(e.mode&1)!==0;Z!==null;){var s=Z,o=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||va;if(!i){var a=s.alternate,c=a!==null&&a.memoizedState!==null||dt;a=va;var u=dt;if(va=i,(dt=c)&&!u)for(Z=s;Z!==null;)i=Z,c=i.child,i.tag===22&&i.memoizedState!==null?Oy(s):c!==null?(c.return=i,Z=c):Oy(s);for(;o!==null;)Z=o,ak(o),o=o.sibling;Z=s,va=a,dt=u}Py(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,Z=o):Py(e)}}function Py(e){for(;Z!==null;){var t=Z;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:dt||ec(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!dt)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:ar(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&xy(t,o,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}xy(t,i,r)}break;case 5:var a=t.stateNode;if(r===null&&t.flags&4){r=a;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&vi(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}dt||t.flags&512&&hg(t)}catch(p){Le(t,t.return,p)}}if(t===e){Z=null;break}if(r=t.sibling,r!==null){r.return=t.return,Z=r;break}Z=t.return}}function Dy(e){for(;Z!==null;){var t=Z;if(t===e){Z=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Z=r;break}Z=t.return}}function Oy(e){for(;Z!==null;){var t=Z;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{ec(4,t)}catch(c){Le(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){Le(t,s,c)}}var o=t.return;try{hg(t)}catch(c){Le(t,o,c)}break;case 5:var i=t.return;try{hg(t)}catch(c){Le(t,i,c)}}}catch(c){Le(t,t.return,c)}if(t===e){Z=null;break}var a=t.sibling;if(a!==null){a.return=t.return,Z=a;break}Z=t.return}}var _5=Math.ceil,bl=tn.ReactCurrentDispatcher,Rv=tn.ReactCurrentOwner,Qt=tn.ReactCurrentBatchConfig,ge=0,et=null,Be=null,it=0,Mt=0,qs=qn(0),Ye=0,Ci=null,fs=0,tc=0,Tv=0,ii=null,_t=null,Iv=0,so=1/0,qr=null,wl=!1,vg=null,Rn=null,xa=!1,Sn=null,_l=0,ai=0,xg=null,Ga=-1,Ka=0;function xt(){return ge&6?$e():Ga!==-1?Ga:Ga=$e()}function Tn(e){return e.mode&1?ge&2&&it!==0?it&-it:o5.transition!==null?(Ka===0&&(Ka=VS()),Ka):(e=be,e!==0||(e=window.event,e=e===void 0?16:ZS(e.type)),e):1}function pr(e,t,r,n){if(50<ai)throw ai=0,xg=null,Error(G(185));Fi(e,r,n),(!(ge&2)||e!==et)&&(e===et&&(!(ge&2)&&(tc|=r),Ye===4&&xn(e,it)),Et(e,n),r===1&&ge===0&&!(t.mode&1)&&(so=$e()+500,Ql&&$n()))}function Et(e,t){var r=e.callbackNode;oR(e,t);var n=ol(e,e===et?it:0);if(n===0)r!==null&&Vx(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Vx(r),t===1)e.tag===0?s5(Ly.bind(null,e)):vj(Ly.bind(null,e)),e5(function(){!(ge&6)&&$n()}),r=null;else{switch(US(n)){case 1:r=nv;break;case 4:r=HS;break;case 16:r=sl;break;case 536870912:r=WS;break;default:r=sl}r=mk(r,lk.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function lk(e,t){if(Ga=-1,Ka=0,ge&6)throw Error(G(327));var r=e.callbackNode;if(Gs()&&e.callbackNode!==r)return null;var n=ol(e,e===et?it:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Sl(e,n);else{t=n;var s=ge;ge|=2;var o=uk();(et!==e||it!==t)&&(qr=null,so=$e()+500,os(e,t));do try{k5();break}catch(a){ck(e,a)}while(!0);gv(),bl.current=o,ge=s,Be!==null?t=0:(et=null,it=0,t=Ye)}if(t!==0){if(t===2&&(s=Vm(e),s!==0&&(n=s,t=yg(e,s))),t===1)throw r=Ci,os(e,0),xn(e,n),Et(e,$e()),r;if(t===6)xn(e,n);else{if(s=e.current.alternate,!(n&30)&&!S5(s)&&(t=Sl(e,n),t===2&&(o=Vm(e),o!==0&&(n=o,t=yg(e,o))),t===1))throw r=Ci,os(e,0),xn(e,n),Et(e,$e()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(G(345));case 2:Xn(e,_t,qr);break;case 3:if(xn(e,n),(n&130023424)===n&&(t=Iv+500-$e(),10<t)){if(ol(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){xt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Jm(Xn.bind(null,e,_t,qr),t);break}Xn(e,_t,qr);break;case 4:if(xn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-fr(n);o=1<<i,i=t[i],i>s&&(s=i),n&=~o}if(n=s,n=$e()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*_5(n/1960))-n,10<n){e.timeoutHandle=Jm(Xn.bind(null,e,_t,qr),n);break}Xn(e,_t,qr);break;case 5:Xn(e,_t,qr);break;default:throw Error(G(329))}}}return Et(e,$e()),e.callbackNode===r?lk.bind(null,e):null}function yg(e,t){var r=ii;return e.current.memoizedState.isDehydrated&&(os(e,t).flags|=256),e=Sl(e,t),e!==2&&(t=_t,_t=r,t!==null&&bg(t)),e}function bg(e){_t===null?_t=e:_t.push.apply(_t,e)}function S5(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],o=s.getSnapshot;s=s.value;try{if(!hr(o(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function xn(e,t){for(t&=~Tv,t&=~tc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-fr(t),n=1<<r;e[r]=-1,t&=~n}}function Ly(e){if(ge&6)throw Error(G(327));Gs();var t=ol(e,0);if(!(t&1))return Et(e,$e()),null;var r=Sl(e,t);if(e.tag!==0&&r===2){var n=Vm(e);n!==0&&(t=n,r=yg(e,n))}if(r===1)throw r=Ci,os(e,0),xn(e,t),Et(e,$e()),r;if(r===6)throw Error(G(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Xn(e,_t,qr),Et(e,$e()),null}function Mv(e,t){var r=ge;ge|=1;try{return e(t)}finally{ge=r,ge===0&&(so=$e()+500,Ql&&$n())}}function ps(e){Sn!==null&&Sn.tag===0&&!(ge&6)&&Gs();var t=ge;ge|=1;var r=Qt.transition,n=be;try{if(Qt.transition=null,be=1,e)return e()}finally{be=n,Qt.transition=r,ge=t,!(ge&6)&&$n()}}function Av(){Mt=qs.current,Ce(qs)}function os(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,JR(r)),Be!==null)for(r=Be.return;r!==null;){var n=r;switch(pv(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ul();break;case 3:ro(),Ce(kt),Ce(ft),_v();break;case 5:wv(n);break;case 4:ro();break;case 13:Ce(Pe);break;case 19:Ce(Pe);break;case 10:vv(n.type._context);break;case 22:case 23:Av()}r=r.return}if(et=e,Be=e=In(e.current,null),it=Mt=t,Ye=0,Ci=null,Tv=tc=fs=0,_t=ii=null,es!==null){for(t=0;t<es.length;t++)if(r=es[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,o=r.pending;if(o!==null){var i=o.next;o.next=s,n.next=i}r.pending=n}es=null}return e}function ck(e,t){do{var r=Be;try{if(gv(),Wa.current=yl,xl){for(var n=De.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}xl=!1}if(ds=0,Ze=Ge=De=null,si=!1,ki=0,Rv.current=null,r===null||r.return===null){Ye=1,Ci=t,Be=null;break}e:{var o=e,i=r.return,a=r,c=t;if(t=it,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=a,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=jy(i);if(h!==null){h.flags&=-257,ky(h,i,a,o,t),h.mode&1&&Sy(o,u,t),t=h,c=u;var y=t.updateQueue;if(y===null){var v=new Set;v.add(c),t.updateQueue=v}else y.add(c);break e}else{if(!(t&1)){Sy(o,u,t),Pv();break e}c=Error(G(426))}}else if(Te&&a.mode&1){var w=jy(i);if(w!==null){!(w.flags&65536)&&(w.flags|=256),ky(w,i,a,o,t),hv(no(c,a));break e}}o=c=no(c,a),Ye!==4&&(Ye=2),ii===null?ii=[o]:ii.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var g=Uj(o,c,t);vy(o,g);break e;case 1:a=c;var x=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Rn===null||!Rn.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t;var _=Gj(o,a,t);vy(o,_);break e}}o=o.return}while(o!==null)}fk(r)}catch(S){t=S,Be===r&&r!==null&&(Be=r=r.return);continue}break}while(!0)}function uk(){var e=bl.current;return bl.current=yl,e===null?yl:e}function Pv(){(Ye===0||Ye===3||Ye===2)&&(Ye=4),et===null||!(fs&268435455)&&!(tc&268435455)||xn(et,it)}function Sl(e,t){var r=ge;ge|=2;var n=uk();(et!==e||it!==t)&&(qr=null,os(e,t));do try{j5();break}catch(s){ck(e,s)}while(!0);if(gv(),ge=r,bl.current=n,Be!==null)throw Error(G(261));return et=null,it=0,Ye}function j5(){for(;Be!==null;)dk(Be)}function k5(){for(;Be!==null&&!X4();)dk(Be)}function dk(e){var t=hk(e.alternate,e,Mt);e.memoizedProps=e.pendingProps,t===null?fk(e):Be=t,Rv.current=null}function fk(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=x5(r,t),r!==null){r.flags&=32767,Be=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ye=6,Be=null;return}}else if(r=v5(r,t,Mt),r!==null){Be=r;return}if(t=t.sibling,t!==null){Be=t;return}Be=t=e}while(t!==null);Ye===0&&(Ye=5)}function Xn(e,t,r){var n=be,s=Qt.transition;try{Qt.transition=null,be=1,N5(e,t,r,n)}finally{Qt.transition=s,be=n}return null}function N5(e,t,r,n){do Gs();while(Sn!==null);if(ge&6)throw Error(G(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(G(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(iR(e,o),e===et&&(Be=et=null,it=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||xa||(xa=!0,mk(sl,function(){return Gs(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=Qt.transition,Qt.transition=null;var i=be;be=1;var a=ge;ge|=4,Rv.current=null,b5(e,r),ik(r,e),UR(Qm),il=!!Xm,Qm=Xm=null,e.current=r,w5(r),Q4(),ge=a,be=i,Qt.transition=o}else e.current=r;if(xa&&(xa=!1,Sn=e,_l=s),o=e.pendingLanes,o===0&&(Rn=null),eR(r.stateNode),Et(e,$e()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(wl)throw wl=!1,e=vg,vg=null,e;return _l&1&&e.tag!==0&&Gs(),o=e.pendingLanes,o&1?e===xg?ai++:(ai=0,xg=e):ai=0,$n(),null}function Gs(){if(Sn!==null){var e=US(_l),t=Qt.transition,r=be;try{if(Qt.transition=null,be=16>e?16:e,Sn===null)var n=!1;else{if(e=Sn,Sn=null,_l=0,ge&6)throw Error(G(331));var s=ge;for(ge|=4,Z=e.current;Z!==null;){var o=Z,i=o.child;if(Z.flags&16){var a=o.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(Z=u;Z!==null;){var d=Z;switch(d.tag){case 0:case 11:case 15:oi(8,d,o)}var f=d.child;if(f!==null)f.return=d,Z=f;else for(;Z!==null;){d=Z;var p=d.sibling,h=d.return;if(nk(d),d===u){Z=null;break}if(p!==null){p.return=h,Z=p;break}Z=h}}}var y=o.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var w=v.sibling;v.sibling=null,v=w}while(v!==null)}}Z=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,Z=i;else e:for(;Z!==null;){if(o=Z,o.flags&2048)switch(o.tag){case 0:case 11:case 15:oi(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,Z=g;break e}Z=o.return}}var x=e.current;for(Z=x;Z!==null;){i=Z;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,Z=b;else e:for(i=x;Z!==null;){if(a=Z,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ec(9,a)}}catch(S){Le(a,a.return,S)}if(a===i){Z=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,Z=_;break e}Z=a.return}}if(ge=s,$n(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(Ul,e)}catch{}n=!0}return n}finally{be=r,Qt.transition=t}}return!1}function zy(e,t,r){t=no(r,t),t=Uj(e,t,1),e=Cn(e,t,1),t=xt(),e!==null&&(Fi(e,1,t),Et(e,t))}function Le(e,t,r){if(e.tag===3)zy(e,e,r);else for(;t!==null;){if(t.tag===3){zy(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Rn===null||!Rn.has(n))){e=no(r,e),e=Gj(t,e,1),t=Cn(t,e,1),e=xt(),t!==null&&(Fi(t,1,e),Et(t,e));break}}t=t.return}}function E5(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=xt(),e.pingedLanes|=e.suspendedLanes&r,et===e&&(it&r)===r&&(Ye===4||Ye===3&&(it&130023424)===it&&500>$e()-Iv?os(e,0):Tv|=r),Et(e,t)}function pk(e,t){t===0&&(e.mode&1?(t=la,la<<=1,!(la&130023424)&&(la=4194304)):t=1);var r=xt();e=Xr(e,t),e!==null&&(Fi(e,t,r),Et(e,r))}function C5(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),pk(e,r)}function R5(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(G(314))}n!==null&&n.delete(t),pk(e,r)}var hk;hk=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||kt.current)St=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return St=!1,g5(e,t,r);St=!!(e.flags&131072)}else St=!1,Te&&t.flags&1048576&&xj(t,pl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ua(e,t),e=t.pendingProps;var s=Js(t,ft.current);Us(t,r),s=jv(null,t,n,e,s,r);var o=kv();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Nt(n)?(o=!0,dl(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,yv(t),s.updater=Jl,t.stateNode=s,s._reactInternals=t,ig(t,n,e,r),t=cg(null,t,n,!0,o,r)):(t.tag=0,Te&&o&&fv(t),vt(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ua(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=I5(n),e=ar(n,e),s){case 0:t=lg(null,t,n,e,r);break e;case 1:t=Cy(null,t,n,e,r);break e;case 11:t=Ny(null,t,n,e,r);break e;case 14:t=Ey(null,t,n,ar(n.type,e),r);break e}throw Error(G(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ar(n,s),lg(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ar(n,s),Cy(e,t,n,s,r);case 3:e:{if(Qj(t),e===null)throw Error(G(387));n=t.pendingProps,o=t.memoizedState,s=o.element,jj(e,t),gl(t,n,null,r);var i=t.memoizedState;if(n=i.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=no(Error(G(423)),t),t=Ry(e,t,n,r,s);break e}else if(n!==s){s=no(Error(G(424)),t),t=Ry(e,t,n,r,s);break e}else for(Pt=En(t.stateNode.containerInfo.firstChild),Dt=t,Te=!0,ur=null,r=_j(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(eo(),n===s){t=Qr(e,t,r);break e}vt(e,t,n,r)}t=t.child}return t;case 5:return kj(t),e===null&&ng(t),n=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,i=s.children,Zm(n,s)?i=null:o!==null&&Zm(n,o)&&(t.flags|=32),Xj(e,t),vt(e,t,i,r),t.child;case 6:return e===null&&ng(t),null;case 13:return Zj(e,t,r);case 4:return bv(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=to(t,null,n,r):vt(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ar(n,s),Ny(e,t,n,s,r);case 7:return vt(e,t,t.pendingProps,r),t.child;case 8:return vt(e,t,t.pendingProps.children,r),t.child;case 12:return vt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,o=t.memoizedProps,i=s.value,ke(hl,n._currentValue),n._currentValue=i,o!==null)if(hr(o.value,i)){if(o.children===s.children&&!kt.current){t=Qr(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var c=a.firstContext;c!==null;){if(c.context===n){if(o.tag===1){c=Ur(-1,r&-r),c.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),sg(o.return,r,t),a.lanes|=r;break}c=c.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(G(341));i.lanes|=r,a=i.alternate,a!==null&&(a.lanes|=r),sg(i,r,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}vt(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Us(t,r),s=Zt(s),n=n(s),t.flags|=1,vt(e,t,n,r),t.child;case 14:return n=t.type,s=ar(n,t.pendingProps),s=ar(n.type,s),Ey(e,t,n,s,r);case 15:return Kj(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:ar(n,s),Ua(e,t),t.tag=1,Nt(n)?(e=!0,dl(t)):e=!1,Us(t,r),Vj(t,n,s),ig(t,n,s,r),cg(null,t,n,!0,e,r);case 19:return Jj(e,t,r);case 22:return Yj(e,t,r)}throw Error(G(156,t.tag))};function mk(e,t){return BS(e,t)}function T5(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yt(e,t,r,n){return new T5(e,t,r,n)}function Dv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function I5(e){if(typeof e=="function")return Dv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ev)return 11;if(e===tv)return 14}return 2}function In(e,t){var r=e.alternate;return r===null?(r=Yt(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ya(e,t,r,n,s,o){var i=2;if(n=e,typeof e=="function")Dv(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Rs:return is(r.children,s,o,t);case Jg:i=8,s|=8;break;case Tm:return e=Yt(12,r,t,s|2),e.elementType=Tm,e.lanes=o,e;case Im:return e=Yt(13,r,t,s),e.elementType=Im,e.lanes=o,e;case Mm:return e=Yt(19,r,t,s),e.elementType=Mm,e.lanes=o,e;case kS:return rc(r,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case SS:i=10;break e;case jS:i=9;break e;case ev:i=11;break e;case tv:i=14;break e;case fn:i=16,n=null;break e}throw Error(G(130,e==null?e:typeof e,""))}return t=Yt(i,r,t,s),t.elementType=e,t.type=n,t.lanes=o,t}function is(e,t,r,n){return e=Yt(7,e,n,t),e.lanes=r,e}function rc(e,t,r,n){return e=Yt(22,e,n,t),e.elementType=kS,e.lanes=r,e.stateNode={isHidden:!1},e}function hu(e,t,r){return e=Yt(6,e,null,t),e.lanes=r,e}function mu(e,t,r){return t=Yt(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function M5(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yc(0),this.expirationTimes=Yc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yc(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ov(e,t,r,n,s,o,i,a,c){return e=new M5(e,t,r,a,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=Yt(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},yv(o),e}function A5(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Cs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function gk(e){if(!e)return On;e=e._reactInternals;e:{if(vs(e)!==e||e.tag!==1)throw Error(G(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Nt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(G(171))}if(e.tag===1){var r=e.type;if(Nt(r))return gj(e,r,t)}return t}function vk(e,t,r,n,s,o,i,a,c){return e=Ov(r,n,!0,e,s,o,i,a,c),e.context=gk(null),r=e.current,n=xt(),s=Tn(r),o=Ur(n,s),o.callback=t??null,Cn(r,o,s),e.current.lanes=s,Fi(e,s,n),Et(e,n),e}function nc(e,t,r,n){var s=t.current,o=xt(),i=Tn(s);return r=gk(r),t.context===null?t.context=r:t.pendingContext=r,t=Ur(o,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Cn(s,t,i),e!==null&&(pr(e,s,i,o),Ha(e,s,i)),i}function jl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function qy(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Lv(e,t){qy(e,t),(e=e.alternate)&&qy(e,t)}function P5(){return null}var xk=typeof reportError=="function"?reportError:function(e){console.error(e)};function zv(e){this._internalRoot=e}sc.prototype.render=zv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(G(409));nc(e,t,null,null)};sc.prototype.unmount=zv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ps(function(){nc(null,e,null,null)}),t[Yr]=null}};function sc(e){this._internalRoot=e}sc.prototype.unstable_scheduleHydration=function(e){if(e){var t=YS();e={blockedOn:null,target:e,priority:t};for(var r=0;r<vn.length&&t!==0&&t<vn[r].priority;r++);vn.splice(r,0,e),r===0&&QS(e)}};function qv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function oc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function $y(){}function D5(e,t,r,n,s){if(s){if(typeof n=="function"){var o=n;n=function(){var u=jl(i);o.call(u)}}var i=vk(t,n,e,0,null,!1,!1,"",$y);return e._reactRootContainer=i,e[Yr]=i.current,bi(e.nodeType===8?e.parentNode:e),ps(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var a=n;n=function(){var u=jl(c);a.call(u)}}var c=Ov(e,0,!1,null,null,!1,!1,"",$y);return e._reactRootContainer=c,e[Yr]=c.current,bi(e.nodeType===8?e.parentNode:e),ps(function(){nc(t,c,r,n)}),c}function ic(e,t,r,n,s){var o=r._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var a=s;s=function(){var c=jl(i);a.call(c)}}nc(t,i,e,s)}else i=D5(r,t,e,s,n);return jl(i)}GS=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ho(t.pendingLanes);r!==0&&(sv(t,r|1),Et(t,$e()),!(ge&6)&&(so=$e()+500,$n()))}break;case 13:ps(function(){var n=Xr(e,1);if(n!==null){var s=xt();pr(n,e,1,s)}}),Lv(e,1)}};ov=function(e){if(e.tag===13){var t=Xr(e,134217728);if(t!==null){var r=xt();pr(t,e,134217728,r)}Lv(e,134217728)}};KS=function(e){if(e.tag===13){var t=Tn(e),r=Xr(e,t);if(r!==null){var n=xt();pr(r,e,t,n)}Lv(e,t)}};YS=function(){return be};XS=function(e,t){var r=be;try{return be=e,t()}finally{be=r}};Bm=function(e,t,r){switch(t){case"input":if(Dm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Xl(n);if(!s)throw Error(G(90));ES(n),Dm(n,s)}}}break;case"textarea":RS(e,r);break;case"select":t=r.value,t!=null&&Bs(e,!!r.multiple,t,!1)}};OS=Mv;LS=ps;var O5={usingClientEntryPoint:!1,Events:[Hi,As,Xl,PS,DS,Mv]},Ao={findFiberByHostInstance:Jn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},L5={bundleType:Ao.bundleType,version:Ao.version,rendererPackageName:Ao.rendererPackageName,rendererConfig:Ao.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:tn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=$S(e),e===null?null:e.stateNode},findFiberByHostInstance:Ao.findFiberByHostInstance||P5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ya=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ya.isDisabled&&ya.supportsFiber)try{Ul=ya.inject(L5),Cr=ya}catch{}}zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O5;zt.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qv(t))throw Error(G(200));return A5(e,t,null,r)};zt.createRoot=function(e,t){if(!qv(e))throw Error(G(299));var r=!1,n="",s=xk;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Ov(e,1,!1,null,null,r,!1,n,s),e[Yr]=t.current,bi(e.nodeType===8?e.parentNode:e),new zv(t)};zt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(G(188)):(e=Object.keys(e).join(","),Error(G(268,e)));return e=$S(t),e=e===null?null:e.stateNode,e};zt.flushSync=function(e){return ps(e)};zt.hydrate=function(e,t,r){if(!oc(t))throw Error(G(200));return ic(null,e,t,!0,r)};zt.hydrateRoot=function(e,t,r){if(!qv(e))throw Error(G(405));var n=r!=null&&r.hydratedSources||null,s=!1,o="",i=xk;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=vk(t,null,e,1,r??null,s,!1,o,i),e[Yr]=t.current,bi(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new sc(t)};zt.render=function(e,t,r){if(!oc(t))throw Error(G(200));return ic(null,e,t,!1,r)};zt.unmountComponentAtNode=function(e){if(!oc(e))throw Error(G(40));return e._reactRootContainer?(ps(function(){ic(null,null,e,!1,function(){e._reactRootContainer=null,e[Yr]=null})}),!0):!1};zt.unstable_batchedUpdates=Mv;zt.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!oc(r))throw Error(G(200));if(e==null||e._reactInternals===void 0)throw Error(G(38));return ic(e,t,r,!1,n)};zt.version="18.3.1-next-f1338f8080-20240426";function yk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(yk)}catch(e){console.error(e)}}yk(),yS.exports=zt;var $s=yS.exports,Fy=$s;Cm.createRoot=Fy.createRoot,Cm.hydrateRoot=Fy.hydrateRoot;function Rt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let r=0,n;r<e.length;r++)(n=Rt(e[r]))!==""&&(t+=(t&&" ")+n);else for(let r in e)e[r]&&(t+=(t&&" ")+r);return t}var bk={exports:{}},wk={},_k={exports:{}},Sk={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oo=m;function z5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var q5=typeof Object.is=="function"?Object.is:z5,$5=oo.useState,F5=oo.useEffect,B5=oo.useLayoutEffect,H5=oo.useDebugValue;function W5(e,t){var r=t(),n=$5({inst:{value:r,getSnapshot:t}}),s=n[0].inst,o=n[1];return B5(function(){s.value=r,s.getSnapshot=t,gu(s)&&o({inst:s})},[e,r,t]),F5(function(){return gu(s)&&o({inst:s}),e(function(){gu(s)&&o({inst:s})})},[e]),H5(r),r}function gu(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!q5(e,r)}catch{return!0}}function V5(e,t){return t()}var U5=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?V5:W5;Sk.useSyncExternalStore=oo.useSyncExternalStore!==void 0?oo.useSyncExternalStore:U5;_k.exports=Sk;var G5=_k.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ac=m,K5=G5;function Y5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var X5=typeof Object.is=="function"?Object.is:Y5,Q5=K5.useSyncExternalStore,Z5=ac.useRef,J5=ac.useEffect,e3=ac.useMemo,t3=ac.useDebugValue;wk.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var o=Z5(null);if(o.current===null){var i={hasValue:!1,value:null};o.current=i}else i=o.current;o=e3(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),s!==void 0&&i.hasValue){var y=i.value;if(s(y,h))return f=y}return f=h}if(y=f,X5(d,h))return y;var v=n(h);return s!==void 0&&s(y,v)?(d=h,y):(d=h,f=v)}var u=!1,d,f,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,s]);var a=Q5(e,o[0],o[1]);return J5(function(){i.hasValue=!0,i.value=a},[a]),t3(a),a};bk.exports=wk;var r3=bk.exports;const n3=Vg(r3),s3={},By=e=>{let t;const r=new Set,n=(d,f)=>{const p=typeof d=="function"?d(t):d;if(!Object.is(p,t)){const h=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(y=>y(t,h))}},s=()=>t,c={setState:n,getState:s,getInitialState:()=>u,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(s3?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,s,c);return c},o3=e=>e?By(e):By,{useDebugValue:i3}=W,{useSyncExternalStoreWithSelector:a3}=n3,l3=e=>e;function jk(e,t=l3,r){const n=a3(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return i3(n),n}const Hy=(e,t)=>{const r=o3(e),n=(s,o=t)=>jk(r,s,o);return Object.assign(n,r),n},c3=(e,t)=>e?Hy(e,t):Hy;function pt(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,s]of e)if(!Object.is(s,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(const n of r)if(!Object.prototype.hasOwnProperty.call(t,n)||!Object.is(e[n],t[n]))return!1;return!0}var u3={value:()=>{}};function lc(){for(var e=0,t=arguments.length,r={},n;e<t;++e){if(!(n=arguments[e]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new Xa(r)}function Xa(e){this._=e}function d3(e,t){return e.trim().split(/^|\s+/).map(function(r){var n="",s=r.indexOf(".");if(s>=0&&(n=r.slice(s+1),r=r.slice(0,s)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}Xa.prototype=lc.prototype={constructor:Xa,on:function(e,t){var r=this._,n=d3(e+"",r),s,o=-1,i=n.length;if(arguments.length<2){for(;++o<i;)if((s=(e=n[o]).type)&&(s=f3(r[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<i;)if(s=(e=n[o]).type)r[s]=Wy(r[s],e.name,t);else if(t==null)for(s in r)r[s]=Wy(r[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new Xa(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var r=new Array(s),n=0,s,o;n<s;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],n=0,s=o.length;n<s;++n)o[n].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],s=0,o=n.length;s<o;++s)n[s].value.apply(t,r)}};function f3(e,t){for(var r=0,n=e.length,s;r<n;++r)if((s=e[r]).name===t)return s.value}function Wy(e,t,r){for(var n=0,s=e.length;n<s;++n)if(e[n].name===t){e[n]=u3,e=e.slice(0,n).concat(e.slice(n+1));break}return r!=null&&e.push({name:t,value:r}),e}var wg="http://www.w3.org/1999/xhtml";const Vy={svg:"http://www.w3.org/2000/svg",xhtml:wg,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function cc(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),Vy.hasOwnProperty(t)?{space:Vy[t],local:e}:e}function p3(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===wg&&t.documentElement.namespaceURI===wg?t.createElement(e):t.createElementNS(r,e)}}function h3(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function kk(e){var t=cc(e);return(t.local?h3:p3)(t)}function m3(){}function $v(e){return e==null?m3:function(){return this.querySelector(e)}}function g3(e){typeof e!="function"&&(e=$v(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var o=t[s],i=o.length,a=n[s]=new Array(i),c,u,d=0;d<i;++d)(c=o[d])&&(u=e.call(c,c.__data__,d,o))&&("__data__"in c&&(u.__data__=c.__data__),a[d]=u);return new Lt(n,this._parents)}function v3(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function x3(){return[]}function Nk(e){return e==null?x3:function(){return this.querySelectorAll(e)}}function y3(e){return function(){return v3(e.apply(this,arguments))}}function b3(e){typeof e=="function"?e=y3(e):e=Nk(e);for(var t=this._groups,r=t.length,n=[],s=[],o=0;o<r;++o)for(var i=t[o],a=i.length,c,u=0;u<a;++u)(c=i[u])&&(n.push(e.call(c,c.__data__,u,i)),s.push(c));return new Lt(n,s)}function Ek(e){return function(){return this.matches(e)}}function Ck(e){return function(t){return t.matches(e)}}var w3=Array.prototype.find;function _3(e){return function(){return w3.call(this.children,e)}}function S3(){return this.firstElementChild}function j3(e){return this.select(e==null?S3:_3(typeof e=="function"?e:Ck(e)))}var k3=Array.prototype.filter;function N3(){return Array.from(this.children)}function E3(e){return function(){return k3.call(this.children,e)}}function C3(e){return this.selectAll(e==null?N3:E3(typeof e=="function"?e:Ck(e)))}function R3(e){typeof e!="function"&&(e=Ek(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var o=t[s],i=o.length,a=n[s]=[],c,u=0;u<i;++u)(c=o[u])&&e.call(c,c.__data__,u,o)&&a.push(c);return new Lt(n,this._parents)}function Rk(e){return new Array(e.length)}function T3(){return new Lt(this._enter||this._groups.map(Rk),this._parents)}function kl(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}kl.prototype={constructor:kl,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function I3(e){return function(){return e}}function M3(e,t,r,n,s,o){for(var i=0,a,c=t.length,u=o.length;i<u;++i)(a=t[i])?(a.__data__=o[i],n[i]=a):r[i]=new kl(e,o[i]);for(;i<c;++i)(a=t[i])&&(s[i]=a)}function A3(e,t,r,n,s,o,i){var a,c,u=new Map,d=t.length,f=o.length,p=new Array(d),h;for(a=0;a<d;++a)(c=t[a])&&(p[a]=h=i.call(c,c.__data__,a,t)+"",u.has(h)?s[a]=c:u.set(h,c));for(a=0;a<f;++a)h=i.call(e,o[a],a,o)+"",(c=u.get(h))?(n[a]=c,c.__data__=o[a],u.delete(h)):r[a]=new kl(e,o[a]);for(a=0;a<d;++a)(c=t[a])&&u.get(p[a])===c&&(s[a]=c)}function P3(e){return e.__data__}function D3(e,t){if(!arguments.length)return Array.from(this,P3);var r=t?A3:M3,n=this._parents,s=this._groups;typeof e!="function"&&(e=I3(e));for(var o=s.length,i=new Array(o),a=new Array(o),c=new Array(o),u=0;u<o;++u){var d=n[u],f=s[u],p=f.length,h=O3(e.call(d,d&&d.__data__,u,n)),y=h.length,v=a[u]=new Array(y),w=i[u]=new Array(y),g=c[u]=new Array(p);r(d,f,v,w,g,h,t);for(var x=0,b=0,_,S;x<y;++x)if(_=v[x]){for(x>=b&&(b=x+1);!(S=w[b])&&++b<y;);_._next=S||null}}return i=new Lt(i,n),i._enter=a,i._exit=c,i}function O3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function L3(){return new Lt(this._exit||this._groups.map(Rk),this._parents)}function z3(e,t,r){var n=this.enter(),s=this,o=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),r==null?o.remove():r(o),n&&s?n.merge(s).order():s}function q3(e){for(var t=e.selection?e.selection():e,r=this._groups,n=t._groups,s=r.length,o=n.length,i=Math.min(s,o),a=new Array(s),c=0;c<i;++c)for(var u=r[c],d=n[c],f=u.length,p=a[c]=new Array(f),h,y=0;y<f;++y)(h=u[y]||d[y])&&(p[y]=h);for(;c<s;++c)a[c]=r[c];return new Lt(a,this._parents)}function $3(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var n=e[t],s=n.length-1,o=n[s],i;--s>=0;)(i=n[s])&&(o&&i.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(i,o),o=i);return this}function F3(e){e||(e=B3);function t(f,p){return f&&p?e(f.__data__,p.__data__):!f-!p}for(var r=this._groups,n=r.length,s=new Array(n),o=0;o<n;++o){for(var i=r[o],a=i.length,c=s[o]=new Array(a),u,d=0;d<a;++d)(u=i[d])&&(c[d]=u);c.sort(t)}return new Lt(s,this._parents).order()}function B3(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function H3(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function W3(){return Array.from(this)}function V3(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],s=0,o=n.length;s<o;++s){var i=n[s];if(i)return i}return null}function U3(){let e=0;for(const t of this)++e;return e}function G3(){return!this.node()}function K3(e){for(var t=this._groups,r=0,n=t.length;r<n;++r)for(var s=t[r],o=0,i=s.length,a;o<i;++o)(a=s[o])&&e.call(a,a.__data__,o,s);return this}function Y3(e){return function(){this.removeAttribute(e)}}function X3(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Q3(e,t){return function(){this.setAttribute(e,t)}}function Z3(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function J3(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function eT(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function tT(e,t){var r=cc(e);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((t==null?r.local?X3:Y3:typeof t=="function"?r.local?eT:J3:r.local?Z3:Q3)(r,t))}function Tk(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function rT(e){return function(){this.style.removeProperty(e)}}function nT(e,t,r){return function(){this.style.setProperty(e,t,r)}}function sT(e,t,r){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,r)}}function oT(e,t,r){return arguments.length>1?this.each((t==null?rT:typeof t=="function"?sT:nT)(e,t,r??"")):io(this.node(),e)}function io(e,t){return e.style.getPropertyValue(t)||Tk(e).getComputedStyle(e,null).getPropertyValue(t)}function iT(e){return function(){delete this[e]}}function aT(e,t){return function(){this[e]=t}}function lT(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function cT(e,t){return arguments.length>1?this.each((t==null?iT:typeof t=="function"?lT:aT)(e,t)):this.node()[e]}function Ik(e){return e.trim().split(/^|\s+/)}function Fv(e){return e.classList||new Mk(e)}function Mk(e){this._node=e,this._names=Ik(e.getAttribute("class")||"")}Mk.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Ak(e,t){for(var r=Fv(e),n=-1,s=t.length;++n<s;)r.add(t[n])}function Pk(e,t){for(var r=Fv(e),n=-1,s=t.length;++n<s;)r.remove(t[n])}function uT(e){return function(){Ak(this,e)}}function dT(e){return function(){Pk(this,e)}}function fT(e,t){return function(){(t.apply(this,arguments)?Ak:Pk)(this,e)}}function pT(e,t){var r=Ik(e+"");if(arguments.length<2){for(var n=Fv(this.node()),s=-1,o=r.length;++s<o;)if(!n.contains(r[s]))return!1;return!0}return this.each((typeof t=="function"?fT:t?uT:dT)(r,t))}function hT(){this.textContent=""}function mT(e){return function(){this.textContent=e}}function gT(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function vT(e){return arguments.length?this.each(e==null?hT:(typeof e=="function"?gT:mT)(e)):this.node().textContent}function xT(){this.innerHTML=""}function yT(e){return function(){this.innerHTML=e}}function bT(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function wT(e){return arguments.length?this.each(e==null?xT:(typeof e=="function"?bT:yT)(e)):this.node().innerHTML}function _T(){this.nextSibling&&this.parentNode.appendChild(this)}function ST(){return this.each(_T)}function jT(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function kT(){return this.each(jT)}function NT(e){var t=typeof e=="function"?e:kk(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function ET(){return null}function CT(e,t){var r=typeof e=="function"?e:kk(e),n=t==null?ET:typeof t=="function"?t:$v(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function RT(){var e=this.parentNode;e&&e.removeChild(this)}function TT(){return this.each(RT)}function IT(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function MT(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function AT(e){return this.select(e?MT:IT)}function PT(e){return arguments.length?this.property("__data__",e):this.node().__data__}function DT(e){return function(t){e.call(this,t,this.__data__)}}function OT(e){return e.trim().split(/^|\s+/).map(function(t){var r="",n=t.indexOf(".");return n>=0&&(r=t.slice(n+1),t=t.slice(0,n)),{type:t,name:r}})}function LT(e){return function(){var t=this.__on;if(t){for(var r=0,n=-1,s=t.length,o;r<s;++r)o=t[r],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++n]=o;++n?t.length=n:delete this.__on}}}function zT(e,t,r){return function(){var n=this.__on,s,o=DT(t);if(n){for(var i=0,a=n.length;i<a;++i)if((s=n[i]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=o,s.options=r),s.value=t;return}}this.addEventListener(e.type,o,r),s={type:e.type,name:e.name,value:t,listener:o,options:r},n?n.push(s):this.__on=[s]}}function qT(e,t,r){var n=OT(e+""),s,o=n.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,d;c<u;++c)for(s=0,d=a[c];s<o;++s)if((i=n[s]).type===d.type&&i.name===d.name)return d.value}return}for(a=t?zT:LT,s=0;s<o;++s)this.each(a(n[s],t,r));return this}function Dk(e,t,r){var n=Tk(e),s=n.CustomEvent;typeof s=="function"?s=new s(t,r):(s=n.document.createEvent("Event"),r?(s.initEvent(t,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function $T(e,t){return function(){return Dk(this,e,t)}}function FT(e,t){return function(){return Dk(this,e,t.apply(this,arguments))}}function BT(e,t){return this.each((typeof t=="function"?FT:$T)(e,t))}function*HT(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var n=e[t],s=0,o=n.length,i;s<o;++s)(i=n[s])&&(yield i)}var Ok=[null];function Lt(e,t){this._groups=e,this._parents=t}function Vi(){return new Lt([[document.documentElement]],Ok)}function WT(){return this}Lt.prototype=Vi.prototype={constructor:Lt,select:g3,selectAll:b3,selectChild:j3,selectChildren:C3,filter:R3,data:D3,enter:T3,exit:L3,join:z3,merge:q3,selection:WT,order:$3,sort:F3,call:H3,nodes:W3,node:V3,size:U3,empty:G3,each:K3,attr:tT,style:oT,property:cT,classed:pT,text:vT,html:wT,raise:ST,lower:kT,append:NT,insert:CT,remove:TT,clone:AT,datum:PT,on:qT,dispatch:BT,[Symbol.iterator]:HT};function Kt(e){return typeof e=="string"?new Lt([[document.querySelector(e)]],[document.documentElement]):new Lt([[e]],Ok)}function VT(e){let t;for(;t=e.sourceEvent;)e=t;return e}function cr(e,t){if(e=VT(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const UT={passive:!1},Ri={capture:!0,passive:!1};function vu(e){e.stopImmediatePropagation()}function Ks(e){e.preventDefault(),e.stopImmediatePropagation()}function Lk(e){var t=e.document.documentElement,r=Kt(e).on("dragstart.drag",Ks,Ri);"onselectstart"in t?r.on("selectstart.drag",Ks,Ri):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function zk(e,t){var r=e.document.documentElement,n=Kt(e).on("dragstart.drag",null);t&&(n.on("click.drag",Ks,Ri),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in r?n.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const ba=e=>()=>e;function _g(e,{sourceEvent:t,subject:r,target:n,identifier:s,active:o,x:i,y:a,dx:c,dy:u,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}_g.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function GT(e){return!e.ctrlKey&&!e.button}function KT(){return this.parentNode}function YT(e,t){return t??{x:e.x,y:e.y}}function XT(){return navigator.maxTouchPoints||"ontouchstart"in this}function QT(){var e=GT,t=KT,r=YT,n=XT,s={},o=lc("start","drag","end"),i=0,a,c,u,d,f=0;function p(_){_.on("mousedown.drag",h).filter(n).on("touchstart.drag",w).on("touchmove.drag",g,UT).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(_,S){if(!(d||!e.call(this,_,S))){var k=b(this,t.call(this,_,S),_,S,"mouse");k&&(Kt(_.view).on("mousemove.drag",y,Ri).on("mouseup.drag",v,Ri),Lk(_.view),vu(_),u=!1,a=_.clientX,c=_.clientY,k("start",_))}}function y(_){if(Ks(_),!u){var S=_.clientX-a,k=_.clientY-c;u=S*S+k*k>f}s.mouse("drag",_)}function v(_){Kt(_.view).on("mousemove.drag mouseup.drag",null),zk(_.view,u),Ks(_),s.mouse("end",_)}function w(_,S){if(e.call(this,_,S)){var k=_.changedTouches,N=t.call(this,_,S),j=k.length,C,R;for(C=0;C<j;++C)(R=b(this,N,_,S,k[C].identifier,k[C]))&&(vu(_),R("start",_,k[C]))}}function g(_){var S=_.changedTouches,k=S.length,N,j;for(N=0;N<k;++N)(j=s[S[N].identifier])&&(Ks(_),j("drag",_,S[N]))}function x(_){var S=_.changedTouches,k=S.length,N,j;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),N=0;N<k;++N)(j=s[S[N].identifier])&&(vu(_),j("end",_,S[N]))}function b(_,S,k,N,j,C){var R=o.copy(),T=cr(C||k,S),L,$,E;if((E=r.call(_,new _g("beforestart",{sourceEvent:k,target:p,identifier:j,active:i,x:T[0],y:T[1],dx:0,dy:0,dispatch:R}),N))!=null)return L=E.x-T[0]||0,$=E.y-T[1]||0,function P(D,F,A){var I=T,z;switch(D){case"start":s[j]=P,z=i++;break;case"end":delete s[j],--i;case"drag":T=cr(A||F,S),z=i;break}R.call(D,_,new _g(D,{sourceEvent:F,subject:E,target:p,identifier:j,active:z,x:T[0]+L,y:T[1]+$,dx:T[0]-I[0],dy:T[1]-I[1],dispatch:R}),N)}}return p.filter=function(_){return arguments.length?(e=typeof _=="function"?_:ba(!!_),p):e},p.container=function(_){return arguments.length?(t=typeof _=="function"?_:ba(_),p):t},p.subject=function(_){return arguments.length?(r=typeof _=="function"?_:ba(_),p):r},p.touchable=function(_){return arguments.length?(n=typeof _=="function"?_:ba(!!_),p):n},p.on=function(){var _=o.on.apply(o,arguments);return _===o?p:_},p.clickDistance=function(_){return arguments.length?(f=(_=+_)*_,p):Math.sqrt(f)},p}function Bv(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function qk(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Ui(){}var Ti=.7,Nl=1/Ti,Ys="\\s*([+-]?\\d+)\\s*",Ii="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Tr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ZT=/^#([0-9a-f]{3,8})$/,JT=new RegExp(`^rgb\\(${Ys},${Ys},${Ys}\\)$`),eI=new RegExp(`^rgb\\(${Tr},${Tr},${Tr}\\)$`),tI=new RegExp(`^rgba\\(${Ys},${Ys},${Ys},${Ii}\\)$`),rI=new RegExp(`^rgba\\(${Tr},${Tr},${Tr},${Ii}\\)$`),nI=new RegExp(`^hsl\\(${Ii},${Tr},${Tr}\\)$`),sI=new RegExp(`^hsla\\(${Ii},${Tr},${Tr},${Ii}\\)$`),Uy={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Bv(Ui,Mi,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Gy,formatHex:Gy,formatHex8:oI,formatHsl:iI,formatRgb:Ky,toString:Ky});function Gy(){return this.rgb().formatHex()}function oI(){return this.rgb().formatHex8()}function iI(){return $k(this).formatHsl()}function Ky(){return this.rgb().formatRgb()}function Mi(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=ZT.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Yy(t):r===3?new jt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?wa(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?wa(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=JT.exec(e))?new jt(t[1],t[2],t[3],1):(t=eI.exec(e))?new jt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=tI.exec(e))?wa(t[1],t[2],t[3],t[4]):(t=rI.exec(e))?wa(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=nI.exec(e))?Zy(t[1],t[2]/100,t[3]/100,1):(t=sI.exec(e))?Zy(t[1],t[2]/100,t[3]/100,t[4]):Uy.hasOwnProperty(e)?Yy(Uy[e]):e==="transparent"?new jt(NaN,NaN,NaN,0):null}function Yy(e){return new jt(e>>16&255,e>>8&255,e&255,1)}function wa(e,t,r,n){return n<=0&&(e=t=r=NaN),new jt(e,t,r,n)}function aI(e){return e instanceof Ui||(e=Mi(e)),e?(e=e.rgb(),new jt(e.r,e.g,e.b,e.opacity)):new jt}function Sg(e,t,r,n){return arguments.length===1?aI(e):new jt(e,t,r,n??1)}function jt(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Bv(jt,Sg,qk(Ui,{brighter(e){return e=e==null?Nl:Math.pow(Nl,e),new jt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ti:Math.pow(Ti,e),new jt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new jt(as(this.r),as(this.g),as(this.b),El(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xy,formatHex:Xy,formatHex8:lI,formatRgb:Qy,toString:Qy}));function Xy(){return`#${rs(this.r)}${rs(this.g)}${rs(this.b)}`}function lI(){return`#${rs(this.r)}${rs(this.g)}${rs(this.b)}${rs((isNaN(this.opacity)?1:this.opacity)*255)}`}function Qy(){const e=El(this.opacity);return`${e===1?"rgb(":"rgba("}${as(this.r)}, ${as(this.g)}, ${as(this.b)}${e===1?")":`, ${e})`}`}function El(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function as(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function rs(e){return e=as(e),(e<16?"0":"")+e.toString(16)}function Zy(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new dr(e,t,r,n)}function $k(e){if(e instanceof dr)return new dr(e.h,e.s,e.l,e.opacity);if(e instanceof Ui||(e=Mi(e)),!e)return new dr;if(e instanceof dr)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,s=Math.min(t,r,n),o=Math.max(t,r,n),i=NaN,a=o-s,c=(o+s)/2;return a?(t===o?i=(r-n)/a+(r<n)*6:r===o?i=(n-t)/a+2:i=(t-r)/a+4,a/=c<.5?o+s:2-o-s,i*=60):a=c>0&&c<1?0:i,new dr(i,a,c,e.opacity)}function cI(e,t,r,n){return arguments.length===1?$k(e):new dr(e,t,r,n??1)}function dr(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Bv(dr,cI,qk(Ui,{brighter(e){return e=e==null?Nl:Math.pow(Nl,e),new dr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ti:Math.pow(Ti,e),new dr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,s=2*r-n;return new jt(xu(e>=240?e-240:e+120,s,n),xu(e,s,n),xu(e<120?e+240:e-120,s,n),this.opacity)},clamp(){return new dr(Jy(this.h),_a(this.s),_a(this.l),El(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=El(this.opacity);return`${e===1?"hsl(":"hsla("}${Jy(this.h)}, ${_a(this.s)*100}%, ${_a(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Jy(e){return e=(e||0)%360,e<0?e+360:e}function _a(e){return Math.max(0,Math.min(1,e||0))}function xu(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Fk=e=>()=>e;function uI(e,t){return function(r){return e+r*t}}function dI(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function fI(e){return(e=+e)==1?Bk:function(t,r){return r-t?dI(t,r,e):Fk(isNaN(t)?r:t)}}function Bk(e,t){var r=t-e;return r?uI(e,r):Fk(isNaN(e)?t:e)}const e0=function e(t){var r=fI(t);function n(s,o){var i=r((s=Sg(s)).r,(o=Sg(o)).r),a=r(s.g,o.g),c=r(s.b,o.b),u=Bk(s.opacity,o.opacity);return function(d){return s.r=i(d),s.g=a(d),s.b=c(d),s.opacity=u(d),s+""}}return n.gamma=e,n}(1);function hn(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var jg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yu=new RegExp(jg.source,"g");function pI(e){return function(){return e}}function hI(e){return function(t){return e(t)+""}}function mI(e,t){var r=jg.lastIndex=yu.lastIndex=0,n,s,o,i=-1,a=[],c=[];for(e=e+"",t=t+"";(n=jg.exec(e))&&(s=yu.exec(t));)(o=s.index)>r&&(o=t.slice(r,o),a[i]?a[i]+=o:a[++i]=o),(n=n[0])===(s=s[0])?a[i]?a[i]+=s:a[++i]=s:(a[++i]=null,c.push({i,x:hn(n,s)})),r=yu.lastIndex;return r<t.length&&(o=t.slice(r),a[i]?a[i]+=o:a[++i]=o),a.length<2?c[0]?hI(c[0].x):pI(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)a[(f=c[d]).i]=f.x(u);return a.join("")})}var t0=180/Math.PI,kg={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Hk(e,t,r,n,s,o){var i,a,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*r+t*n)&&(r-=e*c,n-=t*c),(a=Math.sqrt(r*r+n*n))&&(r/=a,n/=a,c/=a),e*n<t*r&&(e=-e,t=-t,c=-c,i=-i),{translateX:s,translateY:o,rotate:Math.atan2(t,e)*t0,skewX:Math.atan(c)*t0,scaleX:i,scaleY:a}}var Sa;function gI(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?kg:Hk(t.a,t.b,t.c,t.d,t.e,t.f)}function vI(e){return e==null||(Sa||(Sa=document.createElementNS("http://www.w3.org/2000/svg","g")),Sa.setAttribute("transform",e),!(e=Sa.transform.baseVal.consolidate()))?kg:(e=e.matrix,Hk(e.a,e.b,e.c,e.d,e.e,e.f))}function Wk(e,t,r,n){function s(u){return u.length?u.pop()+" ":""}function o(u,d,f,p,h,y){if(u!==f||d!==p){var v=h.push("translate(",null,t,null,r);y.push({i:v-4,x:hn(u,f)},{i:v-2,x:hn(d,p)})}else(f||p)&&h.push("translate("+f+t+p+r)}function i(u,d,f,p){u!==d?(u-d>180?d+=360:d-u>180&&(u+=360),p.push({i:f.push(s(f)+"rotate(",null,n)-2,x:hn(u,d)})):d&&f.push(s(f)+"rotate("+d+n)}function a(u,d,f,p){u!==d?p.push({i:f.push(s(f)+"skewX(",null,n)-2,x:hn(u,d)}):d&&f.push(s(f)+"skewX("+d+n)}function c(u,d,f,p,h,y){if(u!==f||d!==p){var v=h.push(s(h)+"scale(",null,",",null,")");y.push({i:v-4,x:hn(u,f)},{i:v-2,x:hn(d,p)})}else(f!==1||p!==1)&&h.push(s(h)+"scale("+f+","+p+")")}return function(u,d){var f=[],p=[];return u=e(u),d=e(d),o(u.translateX,u.translateY,d.translateX,d.translateY,f,p),i(u.rotate,d.rotate,f,p),a(u.skewX,d.skewX,f,p),c(u.scaleX,u.scaleY,d.scaleX,d.scaleY,f,p),u=d=null,function(h){for(var y=-1,v=p.length,w;++y<v;)f[(w=p[y]).i]=w.x(h);return f.join("")}}}var xI=Wk(gI,"px, ","px)","deg)"),yI=Wk(vI,", ",")",")"),bI=1e-12;function r0(e){return((e=Math.exp(e))+1/e)/2}function wI(e){return((e=Math.exp(e))-1/e)/2}function _I(e){return((e=Math.exp(2*e))-1)/(e+1)}const SI=function e(t,r,n){function s(o,i){var a=o[0],c=o[1],u=o[2],d=i[0],f=i[1],p=i[2],h=d-a,y=f-c,v=h*h+y*y,w,g;if(v<bI)g=Math.log(p/u)/t,w=function(N){return[a+N*h,c+N*y,u*Math.exp(t*N*g)]};else{var x=Math.sqrt(v),b=(p*p-u*u+n*v)/(2*u*r*x),_=(p*p-u*u-n*v)/(2*p*r*x),S=Math.log(Math.sqrt(b*b+1)-b),k=Math.log(Math.sqrt(_*_+1)-_);g=(k-S)/t,w=function(N){var j=N*g,C=r0(S),R=u/(r*x)*(C*_I(t*j+S)-wI(S));return[a+R*h,c+R*y,u*C/r0(t*j+S)]}}return w.duration=g*1e3*t/Math.SQRT2,w}return s.rho=function(o){var i=Math.max(.001,+o),a=i*i,c=a*a;return e(i,a,c)},s}(Math.SQRT2,2,4);var ao=0,Vo=0,Po=0,Vk=1e3,Cl,Uo,Rl=0,hs=0,uc=0,Ai=typeof performance=="object"&&performance.now?performance:Date,Uk=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Hv(){return hs||(Uk(jI),hs=Ai.now()+uc)}function jI(){hs=0}function Tl(){this._call=this._time=this._next=null}Tl.prototype=Gk.prototype={constructor:Tl,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?Hv():+r)+(t==null?0:+t),!this._next&&Uo!==this&&(Uo?Uo._next=this:Cl=this,Uo=this),this._call=e,this._time=r,Ng()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ng())}};function Gk(e,t,r){var n=new Tl;return n.restart(e,t,r),n}function kI(){Hv(),++ao;for(var e=Cl,t;e;)(t=hs-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ao}function n0(){hs=(Rl=Ai.now())+uc,ao=Vo=0;try{kI()}finally{ao=0,EI(),hs=0}}function NI(){var e=Ai.now(),t=e-Rl;t>Vk&&(uc-=t,Rl=e)}function EI(){for(var e,t=Cl,r,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:Cl=r);Uo=e,Ng(n)}function Ng(e){if(!ao){Vo&&(Vo=clearTimeout(Vo));var t=e-hs;t>24?(e<1/0&&(Vo=setTimeout(n0,e-Ai.now()-uc)),Po&&(Po=clearInterval(Po))):(Po||(Rl=Ai.now(),Po=setInterval(NI,Vk)),ao=1,Uk(n0))}}function s0(e,t,r){var n=new Tl;return t=t==null?0:+t,n.restart(s=>{n.stop(),e(s+t)},t,r),n}var CI=lc("start","end","cancel","interrupt"),RI=[],Kk=0,o0=1,Eg=2,Qa=3,i0=4,Cg=5,Za=6;function dc(e,t,r,n,s,o){var i=e.__transition;if(!i)e.__transition={};else if(r in i)return;TI(e,r,{name:t,index:n,group:s,on:CI,tween:RI,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Kk})}function Wv(e,t){var r=gr(e,t);if(r.state>Kk)throw new Error("too late; already scheduled");return r}function Ar(e,t){var r=gr(e,t);if(r.state>Qa)throw new Error("too late; already running");return r}function gr(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function TI(e,t,r){var n=e.__transition,s;n[t]=r,r.timer=Gk(o,0,r.time);function o(u){r.state=o0,r.timer.restart(i,r.delay,r.time),r.delay<=u&&i(u-r.delay)}function i(u){var d,f,p,h;if(r.state!==o0)return c();for(d in n)if(h=n[d],h.name===r.name){if(h.state===Qa)return s0(i);h.state===i0?(h.state=Za,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete n[d]):+d<t&&(h.state=Za,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete n[d])}if(s0(function(){r.state===Qa&&(r.state=i0,r.timer.restart(a,r.delay,r.time),a(u))}),r.state=Eg,r.on.call("start",e,e.__data__,r.index,r.group),r.state===Eg){for(r.state=Qa,s=new Array(p=r.tween.length),d=0,f=-1;d<p;++d)(h=r.tween[d].value.call(e,e.__data__,r.index,r.group))&&(s[++f]=h);s.length=f+1}}function a(u){for(var d=u<r.duration?r.ease.call(null,u/r.duration):(r.timer.restart(c),r.state=Cg,1),f=-1,p=s.length;++f<p;)s[f].call(e,d);r.state===Cg&&(r.on.call("end",e,e.__data__,r.index,r.group),c())}function c(){r.state=Za,r.timer.stop(),delete n[t];for(var u in n)return;delete e.__transition}}function Ja(e,t){var r=e.__transition,n,s,o=!0,i;if(r){t=t==null?null:t+"";for(i in r){if((n=r[i]).name!==t){o=!1;continue}s=n.state>Eg&&n.state<Cg,n.state=Za,n.timer.stop(),n.on.call(s?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[i]}o&&delete e.__transition}}function II(e){return this.each(function(){Ja(this,e)})}function MI(e,t){var r,n;return function(){var s=Ar(this,e),o=s.tween;if(o!==r){n=r=o;for(var i=0,a=n.length;i<a;++i)if(n[i].name===t){n=n.slice(),n.splice(i,1);break}}s.tween=n}}function AI(e,t,r){var n,s;if(typeof r!="function")throw new Error;return function(){var o=Ar(this,e),i=o.tween;if(i!==n){s=(n=i).slice();for(var a={name:t,value:r},c=0,u=s.length;c<u;++c)if(s[c].name===t){s[c]=a;break}c===u&&s.push(a)}o.tween=s}}function PI(e,t){var r=this._id;if(e+="",arguments.length<2){for(var n=gr(this.node(),r).tween,s=0,o=n.length,i;s<o;++s)if((i=n[s]).name===e)return i.value;return null}return this.each((t==null?MI:AI)(r,e,t))}function Vv(e,t,r){var n=e._id;return e.each(function(){var s=Ar(this,n);(s.value||(s.value={}))[t]=r.apply(this,arguments)}),function(s){return gr(s,n).value[t]}}function Yk(e,t){var r;return(typeof t=="number"?hn:t instanceof Mi?e0:(r=Mi(t))?(t=r,e0):mI)(e,t)}function DI(e){return function(){this.removeAttribute(e)}}function OI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function LI(e,t,r){var n,s=r+"",o;return function(){var i=this.getAttribute(e);return i===s?null:i===n?o:o=t(n=i,r)}}function zI(e,t,r){var n,s=r+"",o;return function(){var i=this.getAttributeNS(e.space,e.local);return i===s?null:i===n?o:o=t(n=i,r)}}function qI(e,t,r){var n,s,o;return function(){var i,a=r(this),c;return a==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=a+"",i===c?null:i===n&&c===s?o:(s=c,o=t(n=i,a)))}}function $I(e,t,r){var n,s,o;return function(){var i,a=r(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=a+"",i===c?null:i===n&&c===s?o:(s=c,o=t(n=i,a)))}}function FI(e,t){var r=cc(e),n=r==="transform"?yI:Yk;return this.attrTween(e,typeof t=="function"?(r.local?$I:qI)(r,n,Vv(this,"attr."+e,t)):t==null?(r.local?OI:DI)(r):(r.local?zI:LI)(r,n,t))}function BI(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function HI(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function WI(e,t){var r,n;function s(){var o=t.apply(this,arguments);return o!==n&&(r=(n=o)&&HI(e,o)),r}return s._value=t,s}function VI(e,t){var r,n;function s(){var o=t.apply(this,arguments);return o!==n&&(r=(n=o)&&BI(e,o)),r}return s._value=t,s}function UI(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var n=cc(e);return this.tween(r,(n.local?WI:VI)(n,t))}function GI(e,t){return function(){Wv(this,e).delay=+t.apply(this,arguments)}}function KI(e,t){return t=+t,function(){Wv(this,e).delay=t}}function YI(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?GI:KI)(t,e)):gr(this.node(),t).delay}function XI(e,t){return function(){Ar(this,e).duration=+t.apply(this,arguments)}}function QI(e,t){return t=+t,function(){Ar(this,e).duration=t}}function ZI(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?XI:QI)(t,e)):gr(this.node(),t).duration}function JI(e,t){if(typeof t!="function")throw new Error;return function(){Ar(this,e).ease=t}}function eM(e){var t=this._id;return arguments.length?this.each(JI(t,e)):gr(this.node(),t).ease}function tM(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Ar(this,e).ease=r}}function rM(e){if(typeof e!="function")throw new Error;return this.each(tM(this._id,e))}function nM(e){typeof e!="function"&&(e=Ek(e));for(var t=this._groups,r=t.length,n=new Array(r),s=0;s<r;++s)for(var o=t[s],i=o.length,a=n[s]=[],c,u=0;u<i;++u)(c=o[u])&&e.call(c,c.__data__,u,o)&&a.push(c);return new Zr(n,this._parents,this._name,this._id)}function sM(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,n=t.length,s=r.length,o=Math.min(n,s),i=new Array(n),a=0;a<o;++a)for(var c=t[a],u=r[a],d=c.length,f=i[a]=new Array(d),p,h=0;h<d;++h)(p=c[h]||u[h])&&(f[h]=p);for(;a<n;++a)i[a]=t[a];return new Zr(i,this._parents,this._name,this._id)}function oM(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function iM(e,t,r){var n,s,o=oM(t)?Wv:Ar;return function(){var i=o(this,e),a=i.on;a!==n&&(s=(n=a).copy()).on(t,r),i.on=s}}function aM(e,t){var r=this._id;return arguments.length<2?gr(this.node(),r).on.on(e):this.each(iM(r,e,t))}function lM(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function cM(){return this.on("end.remove",lM(this._id))}function uM(e){var t=this._name,r=this._id;typeof e!="function"&&(e=$v(e));for(var n=this._groups,s=n.length,o=new Array(s),i=0;i<s;++i)for(var a=n[i],c=a.length,u=o[i]=new Array(c),d,f,p=0;p<c;++p)(d=a[p])&&(f=e.call(d,d.__data__,p,a))&&("__data__"in d&&(f.__data__=d.__data__),u[p]=f,dc(u[p],t,r,p,u,gr(d,r)));return new Zr(o,this._parents,t,r)}function dM(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Nk(e));for(var n=this._groups,s=n.length,o=[],i=[],a=0;a<s;++a)for(var c=n[a],u=c.length,d,f=0;f<u;++f)if(d=c[f]){for(var p=e.call(d,d.__data__,f,c),h,y=gr(d,r),v=0,w=p.length;v<w;++v)(h=p[v])&&dc(h,t,r,v,p,y);o.push(p),i.push(d)}return new Zr(o,i,t,r)}var fM=Vi.prototype.constructor;function pM(){return new fM(this._groups,this._parents)}function hM(e,t){var r,n,s;return function(){var o=io(this,e),i=(this.style.removeProperty(e),io(this,e));return o===i?null:o===r&&i===n?s:s=t(r=o,n=i)}}function Xk(e){return function(){this.style.removeProperty(e)}}function mM(e,t,r){var n,s=r+"",o;return function(){var i=io(this,e);return i===s?null:i===n?o:o=t(n=i,r)}}function gM(e,t,r){var n,s,o;return function(){var i=io(this,e),a=r(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),io(this,e))),i===c?null:i===n&&c===s?o:(s=c,o=t(n=i,a))}}function vM(e,t){var r,n,s,o="style."+t,i="end."+o,a;return function(){var c=Ar(this,e),u=c.on,d=c.value[o]==null?a||(a=Xk(t)):void 0;(u!==r||s!==d)&&(n=(r=u).copy()).on(i,s=d),c.on=n}}function xM(e,t,r){var n=(e+="")=="transform"?xI:Yk;return t==null?this.styleTween(e,hM(e,n)).on("end.style."+e,Xk(e)):typeof t=="function"?this.styleTween(e,gM(e,n,Vv(this,"style."+e,t))).each(vM(this._id,e)):this.styleTween(e,mM(e,n,t),r).on("end.style."+e,null)}function yM(e,t,r){return function(n){this.style.setProperty(e,t.call(this,n),r)}}function bM(e,t,r){var n,s;function o(){var i=t.apply(this,arguments);return i!==s&&(n=(s=i)&&yM(e,i,r)),n}return o._value=t,o}function wM(e,t,r){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,bM(e,t,r??""))}function _M(e){return function(){this.textContent=e}}function SM(e){return function(){var t=e(this);this.textContent=t??""}}function jM(e){return this.tween("text",typeof e=="function"?SM(Vv(this,"text",e)):_M(e==null?"":e+""))}function kM(e){return function(t){this.textContent=e.call(this,t)}}function NM(e){var t,r;function n(){var s=e.apply(this,arguments);return s!==r&&(t=(r=s)&&kM(s)),t}return n._value=e,n}function EM(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,NM(e))}function CM(){for(var e=this._name,t=this._id,r=Qk(),n=this._groups,s=n.length,o=0;o<s;++o)for(var i=n[o],a=i.length,c,u=0;u<a;++u)if(c=i[u]){var d=gr(c,t);dc(c,e,r,u,i,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Zr(n,this._parents,e,r)}function RM(){var e,t,r=this,n=r._id,s=r.size();return new Promise(function(o,i){var a={value:i},c={value:function(){--s===0&&o()}};r.each(function(){var u=Ar(this,n),d=u.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),u.on=t}),s===0&&o()})}var TM=0;function Zr(e,t,r,n){this._groups=e,this._parents=t,this._name=r,this._id=n}function Qk(){return++TM}var Dr=Vi.prototype;Zr.prototype={constructor:Zr,select:uM,selectAll:dM,selectChild:Dr.selectChild,selectChildren:Dr.selectChildren,filter:nM,merge:sM,selection:pM,transition:CM,call:Dr.call,nodes:Dr.nodes,node:Dr.node,size:Dr.size,empty:Dr.empty,each:Dr.each,on:aM,attr:FI,attrTween:UI,style:xM,styleTween:wM,text:jM,textTween:EM,remove:cM,tween:PI,delay:YI,duration:ZI,ease:eM,easeVarying:rM,end:RM,[Symbol.iterator]:Dr[Symbol.iterator]};function IM(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var MM={time:null,delay:0,duration:250,ease:IM};function AM(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function PM(e){var t,r;e instanceof Zr?(t=e._id,e=e._name):(t=Qk(),(r=MM).time=Hv(),e=e==null?null:e+"");for(var n=this._groups,s=n.length,o=0;o<s;++o)for(var i=n[o],a=i.length,c,u=0;u<a;++u)(c=i[u])&&dc(c,e,t,u,i,r||AM(c,t));return new Zr(n,this._parents,e,t)}Vi.prototype.interrupt=II;Vi.prototype.transition=PM;const ja=e=>()=>e;function DM(e,{sourceEvent:t,target:r,transform:n,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:s}})}function Hr(e,t,r){this.k=e,this.x=t,this.y=r}Hr.prototype={constructor:Hr,scale:function(e){return e===1?this:new Hr(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Hr(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Gr=new Hr(1,0,0);Hr.prototype;function bu(e){e.stopImmediatePropagation()}function Do(e){e.preventDefault(),e.stopImmediatePropagation()}function OM(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function LM(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function a0(){return this.__zoom||Gr}function zM(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function qM(){return navigator.maxTouchPoints||"ontouchstart"in this}function $M(e,t,r){var n=e.invertX(t[0][0])-r[0][0],s=e.invertX(t[1][0])-r[1][0],o=e.invertY(t[0][1])-r[0][1],i=e.invertY(t[1][1])-r[1][1];return e.translate(s>n?(n+s)/2:Math.min(0,n)||Math.max(0,s),i>o?(o+i)/2:Math.min(0,o)||Math.max(0,i))}function Zk(){var e=OM,t=LM,r=$M,n=zM,s=qM,o=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,c=SI,u=lc("start","zoom","end"),d,f,p,h=500,y=150,v=0,w=10;function g(E){E.property("__zoom",a0).on("wheel.zoom",j,{passive:!1}).on("mousedown.zoom",C).on("dblclick.zoom",R).filter(s).on("touchstart.zoom",T).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",$).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(E,P,D,F){var A=E.selection?E.selection():E;A.property("__zoom",a0),E!==A?S(E,P,D,F):A.interrupt().each(function(){k(this,arguments).event(F).start().zoom(null,typeof P=="function"?P.apply(this,arguments):P).end()})},g.scaleBy=function(E,P,D,F){g.scaleTo(E,function(){var A=this.__zoom.k,I=typeof P=="function"?P.apply(this,arguments):P;return A*I},D,F)},g.scaleTo=function(E,P,D,F){g.transform(E,function(){var A=t.apply(this,arguments),I=this.__zoom,z=D==null?_(A):typeof D=="function"?D.apply(this,arguments):D,M=I.invert(z),q=typeof P=="function"?P.apply(this,arguments):P;return r(b(x(I,q),z,M),A,i)},D,F)},g.translateBy=function(E,P,D,F){g.transform(E,function(){return r(this.__zoom.translate(typeof P=="function"?P.apply(this,arguments):P,typeof D=="function"?D.apply(this,arguments):D),t.apply(this,arguments),i)},null,F)},g.translateTo=function(E,P,D,F,A){g.transform(E,function(){var I=t.apply(this,arguments),z=this.__zoom,M=F==null?_(I):typeof F=="function"?F.apply(this,arguments):F;return r(Gr.translate(M[0],M[1]).scale(z.k).translate(typeof P=="function"?-P.apply(this,arguments):-P,typeof D=="function"?-D.apply(this,arguments):-D),I,i)},F,A)};function x(E,P){return P=Math.max(o[0],Math.min(o[1],P)),P===E.k?E:new Hr(P,E.x,E.y)}function b(E,P,D){var F=P[0]-D[0]*E.k,A=P[1]-D[1]*E.k;return F===E.x&&A===E.y?E:new Hr(E.k,F,A)}function _(E){return[(+E[0][0]+ +E[1][0])/2,(+E[0][1]+ +E[1][1])/2]}function S(E,P,D,F){E.on("start.zoom",function(){k(this,arguments).event(F).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event(F).end()}).tween("zoom",function(){var A=this,I=arguments,z=k(A,I).event(F),M=t.apply(A,I),q=D==null?_(M):typeof D=="function"?D.apply(A,I):D,H=Math.max(M[1][0]-M[0][0],M[1][1]-M[0][1]),O=A.__zoom,B=typeof P=="function"?P.apply(A,I):P,Y=c(O.invert(q).concat(H/O.k),B.invert(q).concat(H/B.k));return function(te){if(te===1)te=B;else{var ne=Y(te),re=H/ne[2];te=new Hr(re,q[0]-ne[0]*re,q[1]-ne[1]*re)}z.zoom(null,te)}})}function k(E,P,D){return!D&&E.__zooming||new N(E,P)}function N(E,P){this.that=E,this.args=P,this.active=0,this.sourceEvent=null,this.extent=t.apply(E,P),this.taps=0}N.prototype={event:function(E){return E&&(this.sourceEvent=E),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(E,P){return this.mouse&&E!=="mouse"&&(this.mouse[1]=P.invert(this.mouse[0])),this.touch0&&E!=="touch"&&(this.touch0[1]=P.invert(this.touch0[0])),this.touch1&&E!=="touch"&&(this.touch1[1]=P.invert(this.touch1[0])),this.that.__zoom=P,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(E){var P=Kt(this.that).datum();u.call(E,this.that,new DM(E,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:u}),P)}};function j(E,...P){if(!e.apply(this,arguments))return;var D=k(this,P).event(E),F=this.__zoom,A=Math.max(o[0],Math.min(o[1],F.k*Math.pow(2,n.apply(this,arguments)))),I=cr(E);if(D.wheel)(D.mouse[0][0]!==I[0]||D.mouse[0][1]!==I[1])&&(D.mouse[1]=F.invert(D.mouse[0]=I)),clearTimeout(D.wheel);else{if(F.k===A)return;D.mouse=[I,F.invert(I)],Ja(this),D.start()}Do(E),D.wheel=setTimeout(z,y),D.zoom("mouse",r(b(x(F,A),D.mouse[0],D.mouse[1]),D.extent,i));function z(){D.wheel=null,D.end()}}function C(E,...P){if(p||!e.apply(this,arguments))return;var D=E.currentTarget,F=k(this,P,!0).event(E),A=Kt(E.view).on("mousemove.zoom",q,!0).on("mouseup.zoom",H,!0),I=cr(E,D),z=E.clientX,M=E.clientY;Lk(E.view),bu(E),F.mouse=[I,this.__zoom.invert(I)],Ja(this),F.start();function q(O){if(Do(O),!F.moved){var B=O.clientX-z,Y=O.clientY-M;F.moved=B*B+Y*Y>v}F.event(O).zoom("mouse",r(b(F.that.__zoom,F.mouse[0]=cr(O,D),F.mouse[1]),F.extent,i))}function H(O){A.on("mousemove.zoom mouseup.zoom",null),zk(O.view,F.moved),Do(O),F.event(O).end()}}function R(E,...P){if(e.apply(this,arguments)){var D=this.__zoom,F=cr(E.changedTouches?E.changedTouches[0]:E,this),A=D.invert(F),I=D.k*(E.shiftKey?.5:2),z=r(b(x(D,I),F,A),t.apply(this,P),i);Do(E),a>0?Kt(this).transition().duration(a).call(S,z,F,E):Kt(this).call(g.transform,z,F,E)}}function T(E,...P){if(e.apply(this,arguments)){var D=E.touches,F=D.length,A=k(this,P,E.changedTouches.length===F).event(E),I,z,M,q;for(bu(E),z=0;z<F;++z)M=D[z],q=cr(M,this),q=[q,this.__zoom.invert(q),M.identifier],A.touch0?!A.touch1&&A.touch0[2]!==q[2]&&(A.touch1=q,A.taps=0):(A.touch0=q,I=!0,A.taps=1+!!d);d&&(d=clearTimeout(d)),I&&(A.taps<2&&(f=q[0],d=setTimeout(function(){d=null},h)),Ja(this),A.start())}}function L(E,...P){if(this.__zooming){var D=k(this,P).event(E),F=E.changedTouches,A=F.length,I,z,M,q;for(Do(E),I=0;I<A;++I)z=F[I],M=cr(z,this),D.touch0&&D.touch0[2]===z.identifier?D.touch0[0]=M:D.touch1&&D.touch1[2]===z.identifier&&(D.touch1[0]=M);if(z=D.that.__zoom,D.touch1){var H=D.touch0[0],O=D.touch0[1],B=D.touch1[0],Y=D.touch1[1],te=(te=B[0]-H[0])*te+(te=B[1]-H[1])*te,ne=(ne=Y[0]-O[0])*ne+(ne=Y[1]-O[1])*ne;z=x(z,Math.sqrt(te/ne)),M=[(H[0]+B[0])/2,(H[1]+B[1])/2],q=[(O[0]+Y[0])/2,(O[1]+Y[1])/2]}else if(D.touch0)M=D.touch0[0],q=D.touch0[1];else return;D.zoom("touch",r(b(z,M,q),D.extent,i))}}function $(E,...P){if(this.__zooming){var D=k(this,P).event(E),F=E.changedTouches,A=F.length,I,z;for(bu(E),p&&clearTimeout(p),p=setTimeout(function(){p=null},h),I=0;I<A;++I)z=F[I],D.touch0&&D.touch0[2]===z.identifier?delete D.touch0:D.touch1&&D.touch1[2]===z.identifier&&delete D.touch1;if(D.touch1&&!D.touch0&&(D.touch0=D.touch1,delete D.touch1),D.touch0)D.touch0[1]=this.__zoom.invert(D.touch0[0]);else if(D.end(),D.taps===2&&(z=cr(z,this),Math.hypot(f[0]-z[0],f[1]-z[1])<w)){var M=Kt(this).on("dblclick.zoom");M&&M.apply(this,arguments)}}}return g.wheelDelta=function(E){return arguments.length?(n=typeof E=="function"?E:ja(+E),g):n},g.filter=function(E){return arguments.length?(e=typeof E=="function"?E:ja(!!E),g):e},g.touchable=function(E){return arguments.length?(s=typeof E=="function"?E:ja(!!E),g):s},g.extent=function(E){return arguments.length?(t=typeof E=="function"?E:ja([[+E[0][0],+E[0][1]],[+E[1][0],+E[1][1]]]),g):t},g.scaleExtent=function(E){return arguments.length?(o[0]=+E[0],o[1]=+E[1],g):[o[0],o[1]]},g.translateExtent=function(E){return arguments.length?(i[0][0]=+E[0][0],i[1][0]=+E[1][0],i[0][1]=+E[0][1],i[1][1]=+E[1][1],g):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},g.constrain=function(E){return arguments.length?(r=E,g):r},g.duration=function(E){return arguments.length?(a=+E,g):a},g.interpolate=function(E){return arguments.length?(c=E,g):c},g.on=function(){var E=u.on.apply(u,arguments);return E===u?g:E},g.clickDistance=function(E){return arguments.length?(v=(E=+E)*E,g):Math.sqrt(v)},g.tapDistance=function(E){return arguments.length?(w=+E,g):w},g}const fc=m.createContext(null),FM=fc.Provider,Jr={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Jk=Jr.error001();function Me(e,t){const r=m.useContext(fc);if(r===null)throw new Error(Jk);return jk(r,e,t)}const tt=()=>{const e=m.useContext(fc);if(e===null)throw new Error(Jk);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},BM=e=>e.userSelectionActive?"none":"all";function Mn({position:e,children:t,className:r,style:n,...s}){const o=Me(BM),i=`${e}`.split("-");return W.createElement("div",{className:Rt(["react-flow__panel",r,...i]),style:{...n,pointerEvents:o},...s},t)}function HM({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:W.createElement(Mn,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},W.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const WM=({x:e,y:t,label:r,labelStyle:n={},labelShowBg:s=!0,labelBgStyle:o={},labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:c,className:u,...d})=>{const f=m.useRef(null),[p,h]=m.useState({x:0,y:0,width:0,height:0}),y=Rt(["react-flow__edge-textwrapper",u]);return m.useEffect(()=>{if(f.current){const v=f.current.getBBox();h({x:v.x,y:v.y,width:v.width,height:v.height})}},[r]),typeof r>"u"||!r?null:W.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:y,visibility:p.width?"visible":"hidden",...d},s&&W.createElement("rect",{width:p.width+2*i[0],x:-i[0],y:-i[1],height:p.height+2*i[1],className:"react-flow__edge-textbg",style:o,rx:a,ry:a}),W.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:f,style:n},r),c)};var VM=m.memo(WM);const Uv=e=>({width:e.offsetWidth,height:e.offsetHeight}),lo=(e,t=0,r=1)=>Math.min(Math.max(e,t),r),Gv=(e={x:0,y:0},t)=>({x:lo(e.x,t[0][0],t[1][0]),y:lo(e.y,t[0][1],t[1][1])}),l0=(e,t,r)=>e<t?lo(Math.abs(e-t),1,50)/50:e>r?-lo(Math.abs(e-r),1,50)/50:0,eN=(e,t)=>{const r=l0(e.x,35,t.width-35)*20,n=l0(e.y,35,t.height-35)*20;return[r,n]},tN=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},rN=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Pi=({x:e,y:t,width:r,height:n})=>({x:e,y:t,x2:e+r,y2:t+n}),nN=({x:e,y:t,x2:r,y2:n})=>({x:e,y:t,width:r-e,height:n-t}),c0=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),UM=(e,t)=>nN(rN(Pi(e),Pi(t))),Rg=(e,t)=>{const r=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),n=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(r*n)},GM=e=>Xt(e.width)&&Xt(e.height)&&Xt(e.x)&&Xt(e.y),Xt=e=>!isNaN(e)&&isFinite(e),ze=Symbol.for("internals"),sN=["Enter"," ","Escape"],KM=(e,t)=>{},YM=e=>"nativeEvent"in e;function Tg(e){var s,o;const t=YM(e)?e.nativeEvent:e,r=((o=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:o[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(r==null?void 0:r.nodeName)||(r==null?void 0:r.hasAttribute("contenteditable"))||!!(r!=null&&r.closest(".nokey"))}const oN=e=>"clientX"in e,An=(e,t)=>{var o,i;const r=oN(e),n=r?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,s=r?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:n-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},Il=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},Gi=({id:e,path:t,labelX:r,labelY:n,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:p,interactionWidth:h=20})=>W.createElement(W.Fragment,null,W.createElement("path",{id:e,style:d,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:p}),h&&W.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),s&&Xt(r)&&Xt(n)?W.createElement(VM,{x:r,y:n,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u}):null);Gi.displayName="BaseEdge";function Oo(e,t,r){return r===void 0?r:n=>{const s=t().edges.find(o=>o.id===e);s&&r(n,{...s})}}function iN({sourceX:e,sourceY:t,targetX:r,targetY:n}){const s=Math.abs(r-e)/2,o=r<e?r+s:r-s,i=Math.abs(n-t)/2,a=n<t?n+i:n-i;return[o,a,s,i]}function aN({sourceX:e,sourceY:t,targetX:r,targetY:n,sourceControlX:s,sourceControlY:o,targetControlX:i,targetControlY:a}){const c=e*.125+s*.375+i*.375+r*.125,u=t*.125+o*.375+a*.375+n*.125,d=Math.abs(c-e),f=Math.abs(u-t);return[c,u,d,f]}var ms;(function(e){e.Strict="strict",e.Loose="loose"})(ms||(ms={}));var ns;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(ns||(ns={}));var Di;(function(e){e.Partial="partial",e.Full="full"})(Di||(Di={}));var yn;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(yn||(yn={}));var Ml;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Ml||(Ml={}));var J;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(J||(J={}));function u0({pos:e,x1:t,y1:r,x2:n,y2:s}){return e===J.Left||e===J.Right?[.5*(t+n),r]:[t,.5*(r+s)]}function lN({sourceX:e,sourceY:t,sourcePosition:r=J.Bottom,targetX:n,targetY:s,targetPosition:o=J.Top}){const[i,a]=u0({pos:r,x1:e,y1:t,x2:n,y2:s}),[c,u]=u0({pos:o,x1:n,y1:s,x2:e,y2:t}),[d,f,p,h]=aN({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:i,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${e},${t} C${i},${a} ${c},${u} ${n},${s}`,d,f,p,h]}const Kv=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:s=J.Bottom,targetPosition:o=J.Top,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:y,interactionWidth:v})=>{const[w,g,x]=lN({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:n,targetPosition:o});return W.createElement(Gi,{path:w,labelX:g,labelY:x,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:y,interactionWidth:v})});Kv.displayName="SimpleBezierEdge";const d0={[J.Left]:{x:-1,y:0},[J.Right]:{x:1,y:0},[J.Top]:{x:0,y:-1},[J.Bottom]:{x:0,y:1}},XM=({source:e,sourcePosition:t=J.Bottom,target:r})=>t===J.Left||t===J.Right?e.x<r.x?{x:1,y:0}:{x:-1,y:0}:e.y<r.y?{x:0,y:1}:{x:0,y:-1},f0=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function QM({source:e,sourcePosition:t=J.Bottom,target:r,targetPosition:n=J.Top,center:s,offset:o}){const i=d0[t],a=d0[n],c={x:e.x+i.x*o,y:e.y+i.y*o},u={x:r.x+a.x*o,y:r.y+a.y*o},d=XM({source:c,sourcePosition:t,target:u}),f=d.x!==0?"x":"y",p=d[f];let h=[],y,v;const w={x:0,y:0},g={x:0,y:0},[x,b,_,S]=iN({sourceX:e.x,sourceY:e.y,targetX:r.x,targetY:r.y});if(i[f]*a[f]===-1){y=s.x??x,v=s.y??b;const N=[{x:y,y:c.y},{x:y,y:u.y}],j=[{x:c.x,y:v},{x:u.x,y:v}];i[f]===p?h=f==="x"?N:j:h=f==="x"?j:N}else{const N=[{x:c.x,y:u.y}],j=[{x:u.x,y:c.y}];if(f==="x"?h=i.x===p?j:N:h=i.y===p?N:j,t===n){const $=Math.abs(e[f]-r[f]);if($<=o){const E=Math.min(o-1,o-$);i[f]===p?w[f]=(c[f]>e[f]?-1:1)*E:g[f]=(u[f]>r[f]?-1:1)*E}}if(t!==n){const $=f==="x"?"y":"x",E=i[f]===a[$],P=c[$]>u[$],D=c[$]<u[$];(i[f]===1&&(!E&&P||E&&D)||i[f]!==1&&(!E&&D||E&&P))&&(h=f==="x"?N:j)}const C={x:c.x+w.x,y:c.y+w.y},R={x:u.x+g.x,y:u.y+g.y},T=Math.max(Math.abs(C.x-h[0].x),Math.abs(R.x-h[0].x)),L=Math.max(Math.abs(C.y-h[0].y),Math.abs(R.y-h[0].y));T>=L?(y=(C.x+R.x)/2,v=h[0].y):(y=h[0].x,v=(C.y+R.y)/2)}return[[e,{x:c.x+w.x,y:c.y+w.y},...h,{x:u.x+g.x,y:u.y+g.y},r],y,v,_,S]}function ZM(e,t,r,n){const s=Math.min(f0(e,t)/2,f0(t,r)/2,n),{x:o,y:i}=t;if(e.x===o&&o===r.x||e.y===i&&i===r.y)return`L${o} ${i}`;if(e.y===i){const u=e.x<r.x?-1:1,d=e.y<r.y?1:-1;return`L ${o+s*u},${i}Q ${o},${i} ${o},${i+s*d}`}const a=e.x<r.x?1:-1,c=e.y<r.y?-1:1;return`L ${o},${i+s*c}Q ${o},${i} ${o+s*a},${i}`}function Ig({sourceX:e,sourceY:t,sourcePosition:r=J.Bottom,targetX:n,targetY:s,targetPosition:o=J.Top,borderRadius:i=5,centerX:a,centerY:c,offset:u=20}){const[d,f,p,h,y]=QM({source:{x:e,y:t},sourcePosition:r,target:{x:n,y:s},targetPosition:o,center:{x:a,y:c},offset:u});return[d.reduce((w,g,x)=>{let b="";return x>0&&x<d.length-1?b=ZM(d[x-1],g,d[x+1],i):b=`${x===0?"M":"L"}${g.x} ${g.y}`,w+=b,w},""),f,p,h,y]}const pc=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,sourcePosition:f=J.Bottom,targetPosition:p=J.Top,markerEnd:h,markerStart:y,pathOptions:v,interactionWidth:w})=>{const[g,x,b]=Ig({sourceX:e,sourceY:t,sourcePosition:f,targetX:r,targetY:n,targetPosition:p,borderRadius:v==null?void 0:v.borderRadius,offset:v==null?void 0:v.offset});return W.createElement(Gi,{path:g,labelX:x,labelY:b,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:h,markerStart:y,interactionWidth:w})});pc.displayName="SmoothStepEdge";const Yv=m.memo(e=>{var t;return W.createElement(pc,{...e,pathOptions:m.useMemo(()=>{var r;return{borderRadius:0,offset:(r=e.pathOptions)==null?void 0:r.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Yv.displayName="StepEdge";function JM({sourceX:e,sourceY:t,targetX:r,targetY:n}){const[s,o,i,a]=iN({sourceX:e,sourceY:t,targetX:r,targetY:n});return[`M ${e},${t}L ${r},${n}`,s,o,i,a]}const Xv=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:p,interactionWidth:h})=>{const[y,v,w]=JM({sourceX:e,sourceY:t,targetX:r,targetY:n});return W.createElement(Gi,{path:y,labelX:v,labelY:w,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:p,interactionWidth:h})});Xv.displayName="StraightEdge";function ka(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function p0({pos:e,x1:t,y1:r,x2:n,y2:s,c:o}){switch(e){case J.Left:return[t-ka(t-n,o),r];case J.Right:return[t+ka(n-t,o),r];case J.Top:return[t,r-ka(r-s,o)];case J.Bottom:return[t,r+ka(s-r,o)]}}function cN({sourceX:e,sourceY:t,sourcePosition:r=J.Bottom,targetX:n,targetY:s,targetPosition:o=J.Top,curvature:i=.25}){const[a,c]=p0({pos:r,x1:e,y1:t,x2:n,y2:s,c:i}),[u,d]=p0({pos:o,x1:n,y1:s,x2:e,y2:t,c:i}),[f,p,h,y]=aN({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:a,sourceControlY:c,targetControlX:u,targetControlY:d});return[`M${e},${t} C${a},${c} ${u},${d} ${n},${s}`,f,p,h,y]}const Al=m.memo(({sourceX:e,sourceY:t,targetX:r,targetY:n,sourcePosition:s=J.Bottom,targetPosition:o=J.Top,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:y,pathOptions:v,interactionWidth:w})=>{const[g,x,b]=cN({sourceX:e,sourceY:t,sourcePosition:s,targetX:r,targetY:n,targetPosition:o,curvature:v==null?void 0:v.curvature});return W.createElement(Gi,{path:g,labelX:x,labelY:b,label:i,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:y,interactionWidth:w})});Al.displayName="BezierEdge";const Qv=m.createContext(null),eA=Qv.Provider;Qv.Consumer;const tA=()=>m.useContext(Qv),rA=e=>"id"in e&&"source"in e&&"target"in e,nA=({source:e,sourceHandle:t,target:r,targetHandle:n})=>`reactflow__edge-${e}${t||""}-${r}${n||""}`,Mg=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join("&")}`,sA=(e,t)=>t.some(r=>r.source===e.source&&r.target===e.target&&(r.sourceHandle===e.sourceHandle||!r.sourceHandle&&!e.sourceHandle)&&(r.targetHandle===e.targetHandle||!r.targetHandle&&!e.targetHandle)),oA=(e,t)=>{if(!e.source||!e.target)return t;let r;return rA(e)?r={...e}:r={...e,id:nA(e)},sA(r,t)?t:t.concat(r)},Ag=({x:e,y:t},[r,n,s],o,[i,a])=>{const c={x:(e-r)/s,y:(t-n)/s};return o?{x:i*Math.round(c.x/i),y:a*Math.round(c.y/a)}:c},uN=({x:e,y:t},[r,n,s])=>({x:e*s+r,y:t*s+n}),ls=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const r=(e.width??0)*t[0],n=(e.height??0)*t[1],s={x:e.position.x-r,y:e.position.y-n};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-r,y:e.positionAbsolute.y-n}:s}},hc=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const r=e.reduce((n,s)=>{const{x:o,y:i}=ls(s,t).positionAbsolute;return rN(n,Pi({x:o,y:i,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return nN(r)},dN=(e,t,[r,n,s]=[0,0,1],o=!1,i=!1,a=[0,0])=>{const c={x:(t.x-r)/s,y:(t.y-n)/s,width:t.width/s,height:t.height/s},u=[];return e.forEach(d=>{const{width:f,height:p,selectable:h=!0,hidden:y=!1}=d;if(i&&!h||y)return!1;const{positionAbsolute:v}=ls(d,a),w={x:v.x,y:v.y,width:f||0,height:p||0},g=Rg(c,w),x=typeof f>"u"||typeof p>"u"||f===null||p===null,b=o&&g>0,_=(f||0)*(p||0);(x||b||g>=_||d.dragging)&&u.push(d)}),u},fN=(e,t)=>{const r=e.map(n=>n.id);return t.filter(n=>r.includes(n.source)||r.includes(n.target))},pN=(e,t,r,n,s,o=.1)=>{const i=t/(e.width*(1+o)),a=r/(e.height*(1+o)),c=Math.min(i,a),u=lo(c,n,s),d=e.x+e.width/2,f=e.y+e.height/2,p=t/2-d*u,h=r/2-f*u;return{x:p,y:h,zoom:u}},Qn=(e,t=0)=>e.transition().duration(t);function h0(e,t,r,n){return(t[r]||[]).reduce((s,o)=>{var i,a;return`${e.id}-${o.id}-${r}`!==n&&s.push({id:o.id||null,type:r,nodeId:e.id,x:(((i=e.positionAbsolute)==null?void 0:i.x)??0)+o.x+o.width/2,y:(((a=e.positionAbsolute)==null?void 0:a.y)??0)+o.y+o.height/2}),s},[])}function iA(e,t,r,n,s,o){const{x:i,y:a}=An(e),u=t.elementsFromPoint(i,a).find(y=>y.classList.contains("react-flow__handle"));if(u){const y=u.getAttribute("data-nodeid");if(y){const v=Zv(void 0,u),w=u.getAttribute("data-handleid"),g=o({nodeId:y,id:w,type:v});if(g){const x=s.find(b=>b.nodeId===y&&b.type===v&&b.id===w);return{handle:{id:w,type:v,nodeId:y,x:(x==null?void 0:x.x)||r.x,y:(x==null?void 0:x.y)||r.y},validHandleResult:g}}}}let d=[],f=1/0;if(s.forEach(y=>{const v=Math.sqrt((y.x-r.x)**2+(y.y-r.y)**2);if(v<=n){const w=o(y);v<=f&&(v<f?d=[{handle:y,validHandleResult:w}]:v===f&&d.push({handle:y,validHandleResult:w}),f=v)}}),!d.length)return{handle:null,validHandleResult:hN()};if(d.length===1)return d[0];const p=d.some(({validHandleResult:y})=>y.isValid),h=d.some(({handle:y})=>y.type==="target");return d.find(({handle:y,validHandleResult:v})=>h?y.type==="target":p?v.isValid:!0)||d[0]}const aA={source:null,target:null,sourceHandle:null,targetHandle:null},hN=()=>({handleDomNode:null,isValid:!1,connection:aA,endHandle:null});function mN(e,t,r,n,s,o,i){const a=s==="target",c=i.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...hN(),handleDomNode:c};if(c){const d=Zv(void 0,c),f=c.getAttribute("data-nodeid"),p=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),y=c.classList.contains("connectableend"),v={source:a?f:r,sourceHandle:a?p:n,target:a?r:f,targetHandle:a?n:p};u.connection=v,h&&y&&(t===ms.Strict?a&&d==="source"||!a&&d==="target":f!==r||p!==n)&&(u.endHandle={nodeId:f,handleId:p,type:d},u.isValid=o(v))}return u}function lA({nodes:e,nodeId:t,handleId:r,handleType:n}){return e.reduce((s,o)=>{if(o[ze]){const{handleBounds:i}=o[ze];let a=[],c=[];i&&(a=h0(o,i,"source",`${t}-${r}-${n}`),c=h0(o,i,"target",`${t}-${r}-${n}`)),s.push(...a,...c)}return s},[])}function Zv(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function wu(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function cA(e,t){let r=null;return t?r="valid":e&&!t&&(r="invalid"),r}function gN({event:e,handleId:t,nodeId:r,onConnect:n,isTarget:s,getState:o,setState:i,isValidConnection:a,edgeUpdaterType:c,onReconnectEnd:u}){const d=tN(e.target),{connectionMode:f,domNode:p,autoPanOnConnect:h,connectionRadius:y,onConnectStart:v,panBy:w,getNodes:g,cancelConnection:x}=o();let b=0,_;const{x:S,y:k}=An(e),N=d==null?void 0:d.elementFromPoint(S,k),j=Zv(c,N),C=p==null?void 0:p.getBoundingClientRect();if(!C||!j)return;let R,T=An(e,C),L=!1,$=null,E=!1,P=null;const D=lA({nodes:g(),nodeId:r,handleId:t,handleType:j}),F=()=>{if(!h)return;const[z,M]=eN(T,C);w({x:z,y:M}),b=requestAnimationFrame(F)};i({connectionPosition:T,connectionStatus:null,connectionNodeId:r,connectionHandleId:t,connectionHandleType:j,connectionStartHandle:{nodeId:r,handleId:t,type:j},connectionEndHandle:null}),v==null||v(e,{nodeId:r,handleId:t,handleType:j});function A(z){const{transform:M}=o();T=An(z,C);const{handle:q,validHandleResult:H}=iA(z,d,Ag(T,M,!1,[1,1]),y,D,O=>mN(O,f,r,t,s?"target":"source",a,d));if(_=q,L||(F(),L=!0),P=H.handleDomNode,$=H.connection,E=H.isValid,i({connectionPosition:_&&E?uN({x:_.x,y:_.y},M):T,connectionStatus:cA(!!_,E),connectionEndHandle:H.endHandle}),!_&&!E&&!P)return wu(R);$.source!==$.target&&P&&(wu(R),R=P,P.classList.add("connecting","react-flow__handle-connecting"),P.classList.toggle("valid",E),P.classList.toggle("react-flow__handle-valid",E))}function I(z){var M,q;(_||P)&&$&&E&&(n==null||n($)),(q=(M=o()).onConnectEnd)==null||q.call(M,z),c&&(u==null||u(z)),wu(R),x(),cancelAnimationFrame(b),L=!1,E=!1,$=null,P=null,d.removeEventListener("mousemove",A),d.removeEventListener("mouseup",I),d.removeEventListener("touchmove",A),d.removeEventListener("touchend",I)}d.addEventListener("mousemove",A),d.addEventListener("mouseup",I),d.addEventListener("touchmove",A),d.addEventListener("touchend",I)}const m0=()=>!0,uA=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),dA=(e,t,r)=>n=>{const{connectionStartHandle:s,connectionEndHandle:o,connectionClickStartHandle:i}=n;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===r||(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===r,clickConnecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===r}},vN=m.forwardRef(({type:e="source",position:t=J.Top,isValidConnection:r,isConnectable:n=!0,isConnectableStart:s=!0,isConnectableEnd:o=!0,id:i,onConnect:a,children:c,className:u,onMouseDown:d,onTouchStart:f,...p},h)=>{var C,R;const y=i||null,v=e==="target",w=tt(),g=tA(),{connectOnClick:x,noPanClassName:b}=Me(uA,pt),{connecting:_,clickConnecting:S}=Me(dA(g,y,e),pt);g||(R=(C=w.getState()).onError)==null||R.call(C,"010",Jr.error010());const k=T=>{const{defaultEdgeOptions:L,onConnect:$,hasDefaultEdges:E}=w.getState(),P={...L,...T};if(E){const{edges:D,setEdges:F}=w.getState();F(oA(P,D))}$==null||$(P),a==null||a(P)},N=T=>{if(!g)return;const L=oN(T);s&&(L&&T.button===0||!L)&&gN({event:T,handleId:y,nodeId:g,onConnect:k,isTarget:v,getState:w.getState,setState:w.setState,isValidConnection:r||w.getState().isValidConnection||m0}),L?d==null||d(T):f==null||f(T)},j=T=>{const{onClickConnectStart:L,onClickConnectEnd:$,connectionClickStartHandle:E,connectionMode:P,isValidConnection:D}=w.getState();if(!g||!E&&!s)return;if(!E){L==null||L(T,{nodeId:g,handleId:y,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:g,type:e,handleId:y}});return}const F=tN(T.target),A=r||D||m0,{connection:I,isValid:z}=mN({nodeId:g,id:y,type:e},P,E.nodeId,E.handleId||null,E.type,A,F);z&&k(I),$==null||$(T),w.setState({connectionClickStartHandle:null})};return W.createElement("div",{"data-handleid":y,"data-nodeid":g,"data-handlepos":t,"data-id":`${g}-${y}-${e}`,className:Rt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,u,{source:!v,target:v,connectable:n,connectablestart:s,connectableend:o,connecting:S,connectionindicator:n&&(s&&!_||o&&_)}]),onMouseDown:N,onTouchStart:N,onClick:x?j:void 0,ref:h,...p},c)});vN.displayName="Handle";var Ir=m.memo(vN);const xN=({data:e,isConnectable:t,targetPosition:r=J.Top,sourcePosition:n=J.Bottom})=>W.createElement(W.Fragment,null,W.createElement(Ir,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label,W.createElement(Ir,{type:"source",position:n,isConnectable:t}));xN.displayName="DefaultNode";var Pg=m.memo(xN);const yN=({data:e,isConnectable:t,sourcePosition:r=J.Bottom})=>W.createElement(W.Fragment,null,e==null?void 0:e.label,W.createElement(Ir,{type:"source",position:r,isConnectable:t}));yN.displayName="InputNode";var bN=m.memo(yN);const wN=({data:e,isConnectable:t,targetPosition:r=J.Top})=>W.createElement(W.Fragment,null,W.createElement(Ir,{type:"target",position:r,isConnectable:t}),e==null?void 0:e.label);wN.displayName="OutputNode";var _N=m.memo(wN);const Jv=()=>null;Jv.displayName="GroupNode";const fA=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),Na=e=>e.id;function pA(e,t){return pt(e.selectedNodes.map(Na),t.selectedNodes.map(Na))&&pt(e.selectedEdges.map(Na),t.selectedEdges.map(Na))}const SN=m.memo(({onSelectionChange:e})=>{const t=tt(),{selectedNodes:r,selectedEdges:n}=Me(fA,pA);return m.useEffect(()=>{const s={nodes:r,edges:n};e==null||e(s),t.getState().onSelectionChange.forEach(o=>o(s))},[r,n,e]),null});SN.displayName="SelectionListener";const hA=e=>!!e.onSelectionChange;function mA({onSelectionChange:e}){const t=Me(hA);return e||t?W.createElement(SN,{onSelectionChange:e}):null}const gA=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function js(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function le(e,t,r){m.useEffect(()=>{typeof t<"u"&&r({[e]:t})},[t])}const vA=({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:s,onConnectStart:o,onConnectEnd:i,onClickConnectStart:a,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:d,nodesFocusable:f,edgesFocusable:p,edgesUpdatable:h,elevateNodesOnSelect:y,minZoom:v,maxZoom:w,nodeExtent:g,onNodesChange:x,onEdgesChange:b,elementsSelectable:_,connectionMode:S,snapGrid:k,snapToGrid:N,translateExtent:j,connectOnClick:C,defaultEdgeOptions:R,fitView:T,fitViewOptions:L,onNodesDelete:$,onEdgesDelete:E,onNodeDrag:P,onNodeDragStart:D,onNodeDragStop:F,onSelectionDrag:A,onSelectionDragStart:I,onSelectionDragStop:z,noPanClassName:M,nodeOrigin:q,rfId:H,autoPanOnConnect:O,autoPanOnNodeDrag:B,onError:Y,connectionRadius:te,isValidConnection:ne,nodeDragThreshold:re})=>{const{setNodes:Q,setEdges:ce,setDefaultNodesAndEdges:ie,setMinZoom:xe,setMaxZoom:ee,setTranslateExtent:X,setNodeExtent:fe,reset:V}=Me(gA,pt),K=tt();return m.useEffect(()=>{const oe=n==null?void 0:n.map(U=>({...U,...R}));return ie(r,oe),()=>{V()}},[]),le("defaultEdgeOptions",R,K.setState),le("connectionMode",S,K.setState),le("onConnect",s,K.setState),le("onConnectStart",o,K.setState),le("onConnectEnd",i,K.setState),le("onClickConnectStart",a,K.setState),le("onClickConnectEnd",c,K.setState),le("nodesDraggable",u,K.setState),le("nodesConnectable",d,K.setState),le("nodesFocusable",f,K.setState),le("edgesFocusable",p,K.setState),le("edgesUpdatable",h,K.setState),le("elementsSelectable",_,K.setState),le("elevateNodesOnSelect",y,K.setState),le("snapToGrid",N,K.setState),le("snapGrid",k,K.setState),le("onNodesChange",x,K.setState),le("onEdgesChange",b,K.setState),le("connectOnClick",C,K.setState),le("fitViewOnInit",T,K.setState),le("fitViewOnInitOptions",L,K.setState),le("onNodesDelete",$,K.setState),le("onEdgesDelete",E,K.setState),le("onNodeDrag",P,K.setState),le("onNodeDragStart",D,K.setState),le("onNodeDragStop",F,K.setState),le("onSelectionDrag",A,K.setState),le("onSelectionDragStart",I,K.setState),le("onSelectionDragStop",z,K.setState),le("noPanClassName",M,K.setState),le("nodeOrigin",q,K.setState),le("rfId",H,K.setState),le("autoPanOnConnect",O,K.setState),le("autoPanOnNodeDrag",B,K.setState),le("onError",Y,K.setState),le("connectionRadius",te,K.setState),le("isValidConnection",ne,K.setState),le("nodeDragThreshold",re,K.setState),js(e,Q),js(t,ce),js(v,xe),js(w,ee),js(j,X),js(g,fe),null},g0={display:"none"},xA={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},jN="react-flow__node-desc",kN="react-flow__edge-desc",yA="react-flow__aria-live",bA=e=>e.ariaLiveMessage;function wA({rfId:e}){const t=Me(bA);return W.createElement("div",{id:`${yA}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:xA},t)}function _A({rfId:e,disableKeyboardA11y:t}){return W.createElement(W.Fragment,null,W.createElement("div",{id:`${jN}-${e}`,style:g0},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),W.createElement("div",{id:`${kN}-${e}`,style:g0},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&W.createElement(wA,{rfId:e}))}var Oi=(e=null,t={actInsideInputWithModifier:!0})=>{const[r,n]=m.useState(!1),s=m.useRef(!1),o=m.useRef(new Set([])),[i,a]=m.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),d=u.reduce((f,p)=>f.concat(...p),[]);return[u,d]}return[[],[]]},[e]);return m.useEffect(()=>{const c=typeof document<"u"?document:null,u=(t==null?void 0:t.target)||c;if(e!==null){const d=h=>{if(s.current=h.ctrlKey||h.metaKey||h.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Tg(h))return!1;const v=x0(h.code,a);o.current.add(h[v]),v0(i,o.current,!1)&&(h.preventDefault(),n(!0))},f=h=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Tg(h))return!1;const v=x0(h.code,a);v0(i,o.current,!0)?(n(!1),o.current.clear()):o.current.delete(h[v]),h.key==="Meta"&&o.current.clear(),s.current=!1},p=()=>{o.current.clear(),n(!1)};return u==null||u.addEventListener("keydown",d),u==null||u.addEventListener("keyup",f),window.addEventListener("blur",p),()=>{u==null||u.removeEventListener("keydown",d),u==null||u.removeEventListener("keyup",f),window.removeEventListener("blur",p)}}},[e,n]),r};function v0(e,t,r){return e.filter(n=>r||n.length===t.size).some(n=>n.every(s=>t.has(s)))}function x0(e,t){return t.includes(e)?"code":"key"}function NN(e,t,r,n){var a,c;const s=e.parentNode||e.parentId;if(!s)return r;const o=t.get(s),i=ls(o,n);return NN(o,t,{x:(r.x??0)+i.x,y:(r.y??0)+i.y,z:(((a=o[ze])==null?void 0:a.z)??0)>(r.z??0)?((c=o[ze])==null?void 0:c.z)??0:r.z??0},n)}function EN(e,t,r){e.forEach(n=>{var o;const s=n.parentNode||n.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||r!=null&&r[n.id]){const{x:i,y:a,z:c}=NN(n,e,{...n.position,z:((o=n[ze])==null?void 0:o.z)??0},t);n.positionAbsolute={x:i,y:a},n[ze].z=c,r!=null&&r[n.id]&&(n[ze].isParent=!0)}})}function _u(e,t,r,n){const s=new Map,o={},i=n?1e3:0;return e.forEach(a=>{var h;const c=(Xt(a.zIndex)?a.zIndex:0)+(a.selected?i:0),u=t.get(a.id),d={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},f=a.parentNode||a.parentId;f&&(o[f]=!0);const p=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==a.type;Object.defineProperty(d,ze,{enumerable:!1,value:{handleBounds:p||(h=u==null?void 0:u[ze])==null?void 0:h.handleBounds,z:c}}),s.set(a.id,d)}),EN(s,r,o),s}function CN(e,t={}){const{getNodes:r,width:n,height:s,minZoom:o,maxZoom:i,d3Zoom:a,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:d,nodeOrigin:f}=e(),p=t.initial&&!u&&d;if(a&&c&&(p||!t.initial)){const y=r().filter(w=>{var x;const g=t.includeHiddenNodes?w.width&&w.height:!w.hidden;return(x=t.nodes)!=null&&x.length?g&&t.nodes.some(b=>b.id===w.id):g}),v=y.every(w=>w.width&&w.height);if(y.length>0&&v){const w=hc(y,f),{x:g,y:x,zoom:b}=pN(w,n,s,t.minZoom??o,t.maxZoom??i,t.padding??.1),_=Gr.translate(g,x).scale(b);return typeof t.duration=="number"&&t.duration>0?a.transform(Qn(c,t.duration),_):a.transform(c,_),!0}}return!1}function SA(e,t){return e.forEach(r=>{const n=t.get(r.id);n&&t.set(n.id,{...n,[ze]:n[ze],selected:r.selected})}),new Map(t)}function jA(e,t){return t.map(r=>{const n=e.find(s=>s.id===r.id);return n&&(r.selected=n.selected),r})}function Ea({changedNodes:e,changedEdges:t,get:r,set:n}){const{nodeInternals:s,edges:o,onNodesChange:i,onEdgesChange:a,hasDefaultNodes:c,hasDefaultEdges:u}=r();e!=null&&e.length&&(c&&n({nodeInternals:SA(e,s)}),i==null||i(e)),t!=null&&t.length&&(u&&n({edges:jA(t,o)}),a==null||a(t))}const ks=()=>{},kA={zoomIn:ks,zoomOut:ks,zoomTo:ks,getZoom:()=>1,setViewport:ks,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:ks,fitBounds:ks,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},NA=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),EA=()=>{const e=tt(),{d3Zoom:t,d3Selection:r}=Me(NA,pt);return m.useMemo(()=>r&&t?{zoomIn:s=>t.scaleBy(Qn(r,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(Qn(r,s==null?void 0:s.duration),1/1.2),zoomTo:(s,o)=>t.scaleTo(Qn(r,o==null?void 0:o.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,o)=>{const[i,a,c]=e.getState().transform,u=Gr.translate(s.x??i,s.y??a).scale(s.zoom??c);t.transform(Qn(r,o==null?void 0:o.duration),u)},getViewport:()=>{const[s,o,i]=e.getState().transform;return{x:s,y:o,zoom:i}},fitView:s=>CN(e.getState,s),setCenter:(s,o,i)=>{const{width:a,height:c,maxZoom:u}=e.getState(),d=typeof(i==null?void 0:i.zoom)<"u"?i.zoom:u,f=a/2-s*d,p=c/2-o*d,h=Gr.translate(f,p).scale(d);t.transform(Qn(r,i==null?void 0:i.duration),h)},fitBounds:(s,o)=>{const{width:i,height:a,minZoom:c,maxZoom:u}=e.getState(),{x:d,y:f,zoom:p}=pN(s,i,a,c,u,(o==null?void 0:o.padding)??.1),h=Gr.translate(d,f).scale(p);t.transform(Qn(r,o==null?void 0:o.duration),h)},project:s=>{const{transform:o,snapToGrid:i,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Ag(s,o,i,a)},screenToFlowPosition:s=>{const{transform:o,snapToGrid:i,snapGrid:a,domNode:c}=e.getState();if(!c)return s;const{x:u,y:d}=c.getBoundingClientRect(),f={x:s.x-u,y:s.y-d};return Ag(f,o,i,a)},flowToScreenPosition:s=>{const{transform:o,domNode:i}=e.getState();if(!i)return s;const{x:a,y:c}=i.getBoundingClientRect(),u=uN(s,o);return{x:u.x+a,y:u.y+c}},viewportInitialized:!0}:kA,[t,r])};function mc(){const e=EA(),t=tt(),r=m.useCallback(()=>t.getState().getNodes().map(v=>({...v})),[]),n=m.useCallback(v=>t.getState().nodeInternals.get(v),[]),s=m.useCallback(()=>{const{edges:v=[]}=t.getState();return v.map(w=>({...w}))},[]),o=m.useCallback(v=>{const{edges:w=[]}=t.getState();return w.find(g=>g.id===v)},[]),i=m.useCallback(v=>{const{getNodes:w,setNodes:g,hasDefaultNodes:x,onNodesChange:b}=t.getState(),_=w(),S=typeof v=="function"?v(_):v;if(x)g(S);else if(b){const k=S.length===0?_.map(N=>({type:"remove",id:N.id})):S.map(N=>({item:N,type:"reset"}));b(k)}},[]),a=m.useCallback(v=>{const{edges:w=[],setEdges:g,hasDefaultEdges:x,onEdgesChange:b}=t.getState(),_=typeof v=="function"?v(w):v;if(x)g(_);else if(b){const S=_.length===0?w.map(k=>({type:"remove",id:k.id})):_.map(k=>({item:k,type:"reset"}));b(S)}},[]),c=m.useCallback(v=>{const w=Array.isArray(v)?v:[v],{getNodes:g,setNodes:x,hasDefaultNodes:b,onNodesChange:_}=t.getState();if(b){const k=[...g(),...w];x(k)}else if(_){const S=w.map(k=>({item:k,type:"add"}));_(S)}},[]),u=m.useCallback(v=>{const w=Array.isArray(v)?v:[v],{edges:g=[],setEdges:x,hasDefaultEdges:b,onEdgesChange:_}=t.getState();if(b)x([...g,...w]);else if(_){const S=w.map(k=>({item:k,type:"add"}));_(S)}},[]),d=m.useCallback(()=>{const{getNodes:v,edges:w=[],transform:g}=t.getState(),[x,b,_]=g;return{nodes:v().map(S=>({...S})),edges:w.map(S=>({...S})),viewport:{x,y:b,zoom:_}}},[]),f=m.useCallback(({nodes:v,edges:w})=>{const{nodeInternals:g,getNodes:x,edges:b,hasDefaultNodes:_,hasDefaultEdges:S,onNodesDelete:k,onEdgesDelete:N,onNodesChange:j,onEdgesChange:C}=t.getState(),R=(v||[]).map(P=>P.id),T=(w||[]).map(P=>P.id),L=x().reduce((P,D)=>{const F=D.parentNode||D.parentId,A=!R.includes(D.id)&&F&&P.find(z=>z.id===F);return(typeof D.deletable=="boolean"?D.deletable:!0)&&(R.includes(D.id)||A)&&P.push(D),P},[]),$=b.filter(P=>typeof P.deletable=="boolean"?P.deletable:!0),E=$.filter(P=>T.includes(P.id));if(L||E){const P=fN(L,$),D=[...E,...P],F=D.reduce((A,I)=>(A.includes(I.id)||A.push(I.id),A),[]);if((S||_)&&(S&&t.setState({edges:b.filter(A=>!F.includes(A.id))}),_&&(L.forEach(A=>{g.delete(A.id)}),t.setState({nodeInternals:new Map(g)}))),F.length>0&&(N==null||N(D),C&&C(F.map(A=>({id:A,type:"remove"})))),L.length>0&&(k==null||k(L),j)){const A=L.map(I=>({id:I.id,type:"remove"}));j(A)}}},[]),p=m.useCallback(v=>{const w=GM(v),g=w?null:t.getState().nodeInternals.get(v.id);return!w&&!g?[null,null,w]:[w?v:c0(g),g,w]},[]),h=m.useCallback((v,w=!0,g)=>{const[x,b,_]=p(v);return x?(g||t.getState().getNodes()).filter(S=>{if(!_&&(S.id===b.id||!S.positionAbsolute))return!1;const k=c0(S),N=Rg(k,x);return w&&N>0||N>=x.width*x.height}):[]},[]),y=m.useCallback((v,w,g=!0)=>{const[x]=p(v);if(!x)return!1;const b=Rg(x,w);return g&&b>0||b>=x.width*x.height},[]);return m.useMemo(()=>({...e,getNodes:r,getNode:n,getEdges:s,getEdge:o,setNodes:i,setEdges:a,addNodes:c,addEdges:u,toObject:d,deleteElements:f,getIntersectingNodes:h,isNodeIntersecting:y}),[e,r,n,s,o,i,a,c,u,d,f,h,y])}const CA={actInsideInputWithModifier:!1};var RA=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const r=tt(),{deleteElements:n}=mc(),s=Oi(e,CA),o=Oi(t);m.useEffect(()=>{if(s){const{edges:i,getNodes:a}=r.getState(),c=a().filter(d=>d.selected),u=i.filter(d=>d.selected);n({nodes:c,edges:u}),r.setState({nodesSelectionActive:!1})}},[s]),m.useEffect(()=>{r.setState({multiSelectionActive:o})},[o])};function TA(e){const t=tt();m.useEffect(()=>{let r;const n=()=>{var o,i;if(!e.current)return;const s=Uv(e.current);(s.height===0||s.width===0)&&((i=(o=t.getState()).onError)==null||i.call(o,"004",Jr.error004())),t.setState({width:s.width||500,height:s.height||500})};return n(),window.addEventListener("resize",n),e.current&&(r=new ResizeObserver(()=>n()),r.observe(e.current)),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}},[])}const ex={position:"absolute",width:"100%",height:"100%",top:0,left:0},IA=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Ca=e=>({x:e.x,y:e.y,zoom:e.k}),Ns=(e,t)=>e.target.closest(`.${t}`),y0=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),b0=e=>{const t=e.ctrlKey&&Il()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},MA=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),AA=({onMove:e,onMoveStart:t,onMoveEnd:r,onPaneContextMenu:n,zoomOnScroll:s=!0,zoomOnPinch:o=!0,panOnScroll:i=!1,panOnScrollSpeed:a=.5,panOnScrollMode:c=ns.Free,zoomOnDoubleClick:u=!0,elementsSelectable:d,panOnDrag:f=!0,defaultViewport:p,translateExtent:h,minZoom:y,maxZoom:v,zoomActivationKeyCode:w,preventScrolling:g=!0,children:x,noWheelClassName:b,noPanClassName:_})=>{const S=m.useRef(),k=tt(),N=m.useRef(!1),j=m.useRef(!1),C=m.useRef(null),R=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:T,d3Selection:L,d3ZoomHandler:$,userSelectionActive:E}=Me(MA,pt),P=Oi(w),D=m.useRef(0),F=m.useRef(!1),A=m.useRef();return TA(C),m.useEffect(()=>{if(C.current){const I=C.current.getBoundingClientRect(),z=Zk().scaleExtent([y,v]).translateExtent(h),M=Kt(C.current).call(z),q=Gr.translate(p.x,p.y).scale(lo(p.zoom,y,v)),H=[[0,0],[I.width,I.height]],O=z.constrain()(q,H,h);z.transform(M,O),z.wheelDelta(b0),k.setState({d3Zoom:z,d3Selection:M,d3ZoomHandler:M.on("wheel.zoom"),transform:[O.x,O.y,O.k],domNode:C.current.closest(".react-flow")})}},[]),m.useEffect(()=>{L&&T&&(i&&!P&&!E?L.on("wheel.zoom",I=>{if(Ns(I,b))return!1;I.preventDefault(),I.stopImmediatePropagation();const z=L.property("__zoom").k||1;if(I.ctrlKey&&o){const ne=cr(I),re=b0(I),Q=z*Math.pow(2,re);T.scaleTo(L,Q,ne,I);return}const M=I.deltaMode===1?20:1;let q=c===ns.Vertical?0:I.deltaX*M,H=c===ns.Horizontal?0:I.deltaY*M;!Il()&&I.shiftKey&&c!==ns.Vertical&&(q=I.deltaY*M,H=0),T.translateBy(L,-(q/z)*a,-(H/z)*a,{internal:!0});const O=Ca(L.property("__zoom")),{onViewportChangeStart:B,onViewportChange:Y,onViewportChangeEnd:te}=k.getState();clearTimeout(A.current),F.current||(F.current=!0,t==null||t(I,O),B==null||B(O)),F.current&&(e==null||e(I,O),Y==null||Y(O),A.current=setTimeout(()=>{r==null||r(I,O),te==null||te(O),F.current=!1},150))},{passive:!1}):typeof $<"u"&&L.on("wheel.zoom",function(I,z){if(!g&&I.type==="wheel"&&!I.ctrlKey||Ns(I,b))return null;I.preventDefault(),$.call(this,I,z)},{passive:!1}))},[E,i,c,L,T,$,P,o,g,b,t,e,r]),m.useEffect(()=>{T&&T.on("start",I=>{var q,H;if(!I.sourceEvent||I.sourceEvent.internal)return null;D.current=(q=I.sourceEvent)==null?void 0:q.button;const{onViewportChangeStart:z}=k.getState(),M=Ca(I.transform);N.current=!0,R.current=M,((H=I.sourceEvent)==null?void 0:H.type)==="mousedown"&&k.setState({paneDragging:!0}),z==null||z(M),t==null||t(I.sourceEvent,M)})},[T,t]),m.useEffect(()=>{T&&(E&&!N.current?T.on("zoom",null):E||T.on("zoom",I=>{var M;const{onViewportChange:z}=k.getState();if(k.setState({transform:[I.transform.x,I.transform.y,I.transform.k]}),j.current=!!(n&&y0(f,D.current??0)),(e||z)&&!((M=I.sourceEvent)!=null&&M.internal)){const q=Ca(I.transform);z==null||z(q),e==null||e(I.sourceEvent,q)}}))},[E,T,e,f,n]),m.useEffect(()=>{T&&T.on("end",I=>{if(!I.sourceEvent||I.sourceEvent.internal)return null;const{onViewportChangeEnd:z}=k.getState();if(N.current=!1,k.setState({paneDragging:!1}),n&&y0(f,D.current??0)&&!j.current&&n(I.sourceEvent),j.current=!1,(r||z)&&IA(R.current,I.transform)){const M=Ca(I.transform);R.current=M,clearTimeout(S.current),S.current=setTimeout(()=>{z==null||z(M),r==null||r(I.sourceEvent,M)},i?150:0)}})},[T,i,f,r,n]),m.useEffect(()=>{T&&T.filter(I=>{const z=P||s,M=o&&I.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&I.button===1&&I.type==="mousedown"&&(Ns(I,"react-flow__node")||Ns(I,"react-flow__edge")))return!0;if(!f&&!z&&!i&&!u&&!o||E||!u&&I.type==="dblclick"||Ns(I,b)&&I.type==="wheel"||Ns(I,_)&&(I.type!=="wheel"||i&&I.type==="wheel"&&!P)||!o&&I.ctrlKey&&I.type==="wheel"||!z&&!i&&!M&&I.type==="wheel"||!f&&(I.type==="mousedown"||I.type==="touchstart")||Array.isArray(f)&&!f.includes(I.button)&&I.type==="mousedown")return!1;const q=Array.isArray(f)&&f.includes(I.button)||!I.button||I.button<=1;return(!I.ctrlKey||I.type==="wheel")&&q})},[E,T,s,o,i,u,f,d,P]),W.createElement("div",{className:"react-flow__renderer",ref:C,style:ex},x)},PA=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function DA(){const{userSelectionActive:e,userSelectionRect:t}=Me(PA,pt);return e&&t?W.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function w0(e,t){const r=t.parentNode||t.parentId,n=e.find(s=>s.id===r);if(n){const s=t.position.x+t.width-n.width,o=t.position.y+t.height-n.height;if(s>0||o>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,s>0&&(n.style.width+=s),o>0&&(n.style.height+=o),t.position.x<0){const i=Math.abs(t.position.x);n.position.x=n.position.x-i,n.style.width+=i,t.position.x=0}if(t.position.y<0){const i=Math.abs(t.position.y);n.position.y=n.position.y-i,n.style.height+=i,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function RN(e,t){if(e.some(n=>n.type==="reset"))return e.filter(n=>n.type==="reset").map(n=>n.item);const r=e.filter(n=>n.type==="add").map(n=>n.item);return t.reduce((n,s)=>{const o=e.filter(a=>a.id===s.id);if(o.length===0)return n.push(s),n;const i={...s};for(const a of o)if(a)switch(a.type){case"select":{i.selected=a.selected;break}case"position":{typeof a.position<"u"&&(i.position=a.position),typeof a.positionAbsolute<"u"&&(i.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(i.dragging=a.dragging),i.expandParent&&w0(n,i);break}case"dimensions":{typeof a.dimensions<"u"&&(i.width=a.dimensions.width,i.height=a.dimensions.height),typeof a.updateStyle<"u"&&(i.style={...i.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(i.resizing=a.resizing),i.expandParent&&w0(n,i);break}case"remove":return n}return n.push(i),n},r)}function TN(e,t){return RN(e,t)}function OA(e,t){return RN(e,t)}const mn=(e,t)=>({id:e,type:"select",selected:t});function Fs(e,t){return e.reduce((r,n)=>{const s=t.includes(n.id);return!n.selected&&s?(n.selected=!0,r.push(mn(n.id,!0))):n.selected&&!s&&(n.selected=!1,r.push(mn(n.id,!1))),r},[])}const Su=(e,t)=>r=>{r.target===t.current&&(e==null||e(r))},LA=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),IN=m.memo(({isSelecting:e,selectionMode:t=Di.Full,panOnDrag:r,onSelectionStart:n,onSelectionEnd:s,onPaneClick:o,onPaneContextMenu:i,onPaneScroll:a,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:d,children:f})=>{const p=m.useRef(null),h=tt(),y=m.useRef(0),v=m.useRef(0),w=m.useRef(),{userSelectionActive:g,elementsSelectable:x,dragging:b}=Me(LA,pt),_=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),y.current=0,v.current=0},S=$=>{o==null||o($),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},k=$=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){$.preventDefault();return}i==null||i($)},N=a?$=>a($):void 0,j=$=>{const{resetSelectedElements:E,domNode:P}=h.getState();if(w.current=P==null?void 0:P.getBoundingClientRect(),!x||!e||$.button!==0||$.target!==p.current||!w.current)return;const{x:D,y:F}=An($,w.current);E(),h.setState({userSelectionRect:{width:0,height:0,startX:D,startY:F,x:D,y:F}}),n==null||n($)},C=$=>{const{userSelectionRect:E,nodeInternals:P,edges:D,transform:F,onNodesChange:A,onEdgesChange:I,nodeOrigin:z,getNodes:M}=h.getState();if(!e||!w.current||!E)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const q=An($,w.current),H=E.startX??0,O=E.startY??0,B={...E,x:q.x<H?q.x:H,y:q.y<O?q.y:O,width:Math.abs(q.x-H),height:Math.abs(q.y-O)},Y=M(),te=dN(P,B,F,t===Di.Partial,!0,z),ne=fN(te,D).map(Q=>Q.id),re=te.map(Q=>Q.id);if(y.current!==re.length){y.current=re.length;const Q=Fs(Y,re);Q.length&&(A==null||A(Q))}if(v.current!==ne.length){v.current=ne.length;const Q=Fs(D,ne);Q.length&&(I==null||I(Q))}h.setState({userSelectionRect:B})},R=$=>{if($.button!==0)return;const{userSelectionRect:E}=h.getState();!g&&E&&$.target===p.current&&(S==null||S($)),h.setState({nodesSelectionActive:y.current>0}),_(),s==null||s($)},T=$=>{g&&(h.setState({nodesSelectionActive:y.current>0}),s==null||s($)),_()},L=x&&(e||g);return W.createElement("div",{className:Rt(["react-flow__pane",{dragging:b,selection:e}]),onClick:L?void 0:Su(S,p),onContextMenu:Su(k,p),onWheel:Su(N,p),onMouseEnter:L?void 0:c,onMouseDown:L?j:void 0,onMouseMove:L?C:u,onMouseUp:L?R:void 0,onMouseLeave:L?T:d,ref:p,style:ex},f,W.createElement(DA,null))});IN.displayName="Pane";function MN(e,t){const r=e.parentNode||e.parentId;if(!r)return!1;const n=t.get(r);return n?n.selected?!0:MN(n,t):!1}function _0(e,t,r){let n=e;do{if(n!=null&&n.matches(t))return!0;if(n===r.current)return!1;n=n.parentElement}while(n);return!1}function zA(e,t,r,n){return Array.from(e.values()).filter(s=>(s.selected||s.id===n)&&(!s.parentNode||s.parentId||!MN(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var o,i;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:r.x-(((o=s.positionAbsolute)==null?void 0:o.x)??0),y:r.y-(((i=s.positionAbsolute)==null?void 0:i.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function qA(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function AN(e,t,r,n,s=[0,0],o){const i=qA(e,e.extent||n);let a=i;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=r.get(c),{x:p,y:h}=ls(f,s).positionAbsolute;a=f&&Xt(p)&&Xt(h)&&Xt(f.width)&&Xt(f.height)?[[p+e.width*s[0],h+e.height*s[1]],[p+f.width-e.width+e.width*s[0],h+f.height-e.height+e.height*s[1]]]:a}else o==null||o("005",Jr.error005()),a=i;else if(e.extent&&c&&e.extent!=="parent"){const f=r.get(c),{x:p,y:h}=ls(f,s).positionAbsolute;a=[[e.extent[0][0]+p,e.extent[0][1]+h],[e.extent[1][0]+p,e.extent[1][1]+h]]}let u={x:0,y:0};if(c){const f=r.get(c);u=ls(f,s).positionAbsolute}const d=a&&a!=="parent"?Gv(t,a):t;return{position:{x:d.x-u.x,y:d.y-u.y},positionAbsolute:d}}function ju({nodeId:e,dragItems:t,nodeInternals:r}){const n=t.map(s=>({...r.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?n.find(s=>s.id===e):n[0],n]}const S0=(e,t,r,n)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const o=Array.from(s),i=t.getBoundingClientRect(),a={x:i.width*n[0],y:i.height*n[1]};return o.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-i.left-a.x)/r,y:(u.top-i.top-a.y)/r,...Uv(c)}})};function Lo(e,t,r){return r===void 0?r:n=>{const s=t().nodeInternals.get(e);s&&r(n,{...s})}}function Dg({id:e,store:t,unselect:r=!1,nodeRef:n}){const{addSelectedNodes:s,unselectNodesAndEdges:o,multiSelectionActive:i,nodeInternals:a,onError:c}=t.getState(),u=a.get(e);if(!u){c==null||c("012",Jr.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(r||u.selected&&i)&&(o({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var d;return(d=n==null?void 0:n.current)==null?void 0:d.blur()})):s([e])}function $A(){const e=tt();return m.useCallback(({sourceEvent:r})=>{const{transform:n,snapGrid:s,snapToGrid:o}=e.getState(),i=r.touches?r.touches[0].clientX:r.clientX,a=r.touches?r.touches[0].clientY:r.clientY,c={x:(i-n[0])/n[2],y:(a-n[1])/n[2]};return{xSnapped:o?s[0]*Math.round(c.x/s[0]):c.x,ySnapped:o?s[1]*Math.round(c.y/s[1]):c.y,...c}},[])}function ku(e){return(t,r,n)=>e==null?void 0:e(t,n)}function PN({nodeRef:e,disabled:t=!1,noDragClassName:r,handleSelector:n,nodeId:s,isSelectable:o,selectNodesOnDrag:i}){const a=tt(),[c,u]=m.useState(!1),d=m.useRef([]),f=m.useRef({x:null,y:null}),p=m.useRef(0),h=m.useRef(null),y=m.useRef({x:0,y:0}),v=m.useRef(null),w=m.useRef(!1),g=m.useRef(!1),x=m.useRef(!1),b=$A();return m.useEffect(()=>{if(e!=null&&e.current){const _=Kt(e.current),S=({x:j,y:C})=>{const{nodeInternals:R,onNodeDrag:T,onSelectionDrag:L,updateNodePositions:$,nodeExtent:E,snapGrid:P,snapToGrid:D,nodeOrigin:F,onError:A}=a.getState();f.current={x:j,y:C};let I=!1,z={x:0,y:0,x2:0,y2:0};if(d.current.length>1&&E){const q=hc(d.current,F);z=Pi(q)}if(d.current=d.current.map(q=>{const H={x:j-q.distance.x,y:C-q.distance.y};D&&(H.x=P[0]*Math.round(H.x/P[0]),H.y=P[1]*Math.round(H.y/P[1]));const O=[[E[0][0],E[0][1]],[E[1][0],E[1][1]]];d.current.length>1&&E&&!q.extent&&(O[0][0]=q.positionAbsolute.x-z.x+E[0][0],O[1][0]=q.positionAbsolute.x+(q.width??0)-z.x2+E[1][0],O[0][1]=q.positionAbsolute.y-z.y+E[0][1],O[1][1]=q.positionAbsolute.y+(q.height??0)-z.y2+E[1][1]);const B=AN(q,H,R,O,F,A);return I=I||q.position.x!==B.position.x||q.position.y!==B.position.y,q.position=B.position,q.positionAbsolute=B.positionAbsolute,q}),!I)return;$(d.current,!0,!0),u(!0);const M=s?T:ku(L);if(M&&v.current){const[q,H]=ju({nodeId:s,dragItems:d.current,nodeInternals:R});M(v.current,q,H)}},k=()=>{if(!h.current)return;const[j,C]=eN(y.current,h.current);if(j!==0||C!==0){const{transform:R,panBy:T}=a.getState();f.current.x=(f.current.x??0)-j/R[2],f.current.y=(f.current.y??0)-C/R[2],T({x:j,y:C})&&S(f.current)}p.current=requestAnimationFrame(k)},N=j=>{var F;const{nodeInternals:C,multiSelectionActive:R,nodesDraggable:T,unselectNodesAndEdges:L,onNodeDragStart:$,onSelectionDragStart:E}=a.getState();g.current=!0;const P=s?$:ku(E);(!i||!o)&&!R&&s&&((F=C.get(s))!=null&&F.selected||L()),s&&o&&i&&Dg({id:s,store:a,nodeRef:e});const D=b(j);if(f.current=D,d.current=zA(C,T,D,s),P&&d.current){const[A,I]=ju({nodeId:s,dragItems:d.current,nodeInternals:C});P(j.sourceEvent,A,I)}};if(t)_.on(".drag",null);else{const j=QT().on("start",C=>{const{domNode:R,nodeDragThreshold:T}=a.getState();T===0&&N(C),x.current=!1;const L=b(C);f.current=L,h.current=(R==null?void 0:R.getBoundingClientRect())||null,y.current=An(C.sourceEvent,h.current)}).on("drag",C=>{var $,E;const R=b(C),{autoPanOnNodeDrag:T,nodeDragThreshold:L}=a.getState();if(C.sourceEvent.type==="touchmove"&&C.sourceEvent.touches.length>1&&(x.current=!0),!x.current){if(!w.current&&g.current&&T&&(w.current=!0,k()),!g.current){const P=R.xSnapped-((($=f==null?void 0:f.current)==null?void 0:$.x)??0),D=R.ySnapped-(((E=f==null?void 0:f.current)==null?void 0:E.y)??0);Math.sqrt(P*P+D*D)>L&&N(C)}(f.current.x!==R.xSnapped||f.current.y!==R.ySnapped)&&d.current&&g.current&&(v.current=C.sourceEvent,y.current=An(C.sourceEvent,h.current),S(R))}}).on("end",C=>{if(!(!g.current||x.current)&&(u(!1),w.current=!1,g.current=!1,cancelAnimationFrame(p.current),d.current)){const{updateNodePositions:R,nodeInternals:T,onNodeDragStop:L,onSelectionDragStop:$}=a.getState(),E=s?L:ku($);if(R(d.current,!1,!1),E){const[P,D]=ju({nodeId:s,dragItems:d.current,nodeInternals:T});E(C.sourceEvent,P,D)}}}).filter(C=>{const R=C.target;return!C.button&&(!r||!_0(R,`.${r}`,e))&&(!n||_0(R,n,e))});return _.call(j),()=>{_.on(".drag",null)}}}},[e,t,r,n,o,a,s,i,b]),c}function DN(){const e=tt();return m.useCallback(r=>{const{nodeInternals:n,nodeExtent:s,updateNodePositions:o,getNodes:i,snapToGrid:a,snapGrid:c,onError:u,nodesDraggable:d}=e.getState(),f=i().filter(x=>x.selected&&(x.draggable||d&&typeof x.draggable>"u")),p=a?c[0]:5,h=a?c[1]:5,y=r.isShiftPressed?4:1,v=r.x*p*y,w=r.y*h*y,g=f.map(x=>{if(x.positionAbsolute){const b={x:x.positionAbsolute.x+v,y:x.positionAbsolute.y+w};a&&(b.x=c[0]*Math.round(b.x/c[0]),b.y=c[1]*Math.round(b.y/c[1]));const{positionAbsolute:_,position:S}=AN(x,b,n,s,void 0,u);x.position=S,x.positionAbsolute=_}return x});o(g,!0,!1)},[])}const Xs={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var zo=e=>{const t=({id:r,type:n,data:s,xPos:o,yPos:i,xPosOrigin:a,yPosOrigin:c,selected:u,onClick:d,onMouseEnter:f,onMouseMove:p,onMouseLeave:h,onContextMenu:y,onDoubleClick:v,style:w,className:g,isDraggable:x,isSelectable:b,isConnectable:_,isFocusable:S,selectNodesOnDrag:k,sourcePosition:N,targetPosition:j,hidden:C,resizeObserver:R,dragHandle:T,zIndex:L,isParent:$,noDragClassName:E,noPanClassName:P,initialized:D,disableKeyboardA11y:F,ariaLabel:A,rfId:I,hasHandleBounds:z})=>{const M=tt(),q=m.useRef(null),H=m.useRef(null),O=m.useRef(N),B=m.useRef(j),Y=m.useRef(n),te=b||x||d||f||p||h,ne=DN(),re=Lo(r,M.getState,f),Q=Lo(r,M.getState,p),ce=Lo(r,M.getState,h),ie=Lo(r,M.getState,y),xe=Lo(r,M.getState,v),ee=V=>{const{nodeDragThreshold:K}=M.getState();if(b&&(!k||!x||K>0)&&Dg({id:r,store:M,nodeRef:q}),d){const oe=M.getState().nodeInternals.get(r);oe&&d(V,{...oe})}},X=V=>{if(!Tg(V)&&!F)if(sN.includes(V.key)&&b){const K=V.key==="Escape";Dg({id:r,store:M,unselect:K,nodeRef:q})}else x&&u&&Object.prototype.hasOwnProperty.call(Xs,V.key)&&(M.setState({ariaLiveMessage:`Moved selected node ${V.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~o}, y: ${~~i}`}),ne({x:Xs[V.key].x,y:Xs[V.key].y,isShiftPressed:V.shiftKey}))};m.useEffect(()=>()=>{H.current&&(R==null||R.unobserve(H.current),H.current=null)},[]),m.useEffect(()=>{if(q.current&&!C){const V=q.current;(!D||!z||H.current!==V)&&(H.current&&(R==null||R.unobserve(H.current)),R==null||R.observe(V),H.current=V)}},[C,D,z]),m.useEffect(()=>{const V=Y.current!==n,K=O.current!==N,oe=B.current!==j;q.current&&(V||K||oe)&&(V&&(Y.current=n),K&&(O.current=N),oe&&(B.current=j),M.getState().updateNodeDimensions([{id:r,nodeElement:q.current,forceUpdate:!0}]))},[r,n,N,j]);const fe=PN({nodeRef:q,disabled:C||!x,noDragClassName:E,handleSelector:T,nodeId:r,isSelectable:b,selectNodesOnDrag:k});return C?null:W.createElement("div",{className:Rt(["react-flow__node",`react-flow__node-${n}`,{[P]:x},g,{selected:u,selectable:b,parent:$,dragging:fe}]),ref:q,style:{zIndex:L,transform:`translate(${a}px,${c}px)`,pointerEvents:te?"all":"none",visibility:D?"visible":"hidden",...w},"data-id":r,"data-testid":`rf__node-${r}`,onMouseEnter:re,onMouseMove:Q,onMouseLeave:ce,onContextMenu:ie,onClick:ee,onDoubleClick:xe,onKeyDown:S?X:void 0,tabIndex:S?0:void 0,role:S?"button":void 0,"aria-describedby":F?void 0:`${jN}-${I}`,"aria-label":A},W.createElement(eA,{value:r},W.createElement(e,{id:r,data:s,type:n,xPos:o,yPos:i,selected:u,isConnectable:_,sourcePosition:N,targetPosition:j,dragging:fe,dragHandle:T,zIndex:L})))};return t.displayName="NodeWrapper",m.memo(t)};const FA=e=>{const t=e.getNodes().filter(r=>r.selected);return{...hc(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function BA({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:r}){const n=tt(),{width:s,height:o,x:i,y:a,transformString:c,userSelectionActive:u}=Me(FA,pt),d=DN(),f=m.useRef(null);if(m.useEffect(()=>{var y;r||(y=f.current)==null||y.focus({preventScroll:!0})},[r]),PN({nodeRef:f}),u||!s||!o)return null;const p=e?y=>{const v=n.getState().getNodes().filter(w=>w.selected);e(y,v)}:void 0,h=y=>{Object.prototype.hasOwnProperty.call(Xs,y.key)&&d({x:Xs[y.key].x,y:Xs[y.key].y,isShiftPressed:y.shiftKey})};return W.createElement("div",{className:Rt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},W.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:r?void 0:-1,onKeyDown:r?void 0:h,style:{width:s,height:o,top:a,left:i}}))}var HA=m.memo(BA);const WA=e=>e.nodesSelectionActive,ON=({children:e,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:o,onPaneScroll:i,deleteKeyCode:a,onMove:c,onMoveStart:u,onMoveEnd:d,selectionKeyCode:f,selectionOnDrag:p,selectionMode:h,onSelectionStart:y,onSelectionEnd:v,multiSelectionKeyCode:w,panActivationKeyCode:g,zoomActivationKeyCode:x,elementsSelectable:b,zoomOnScroll:_,zoomOnPinch:S,panOnScroll:k,panOnScrollSpeed:N,panOnScrollMode:j,zoomOnDoubleClick:C,panOnDrag:R,defaultViewport:T,translateExtent:L,minZoom:$,maxZoom:E,preventScrolling:P,onSelectionContextMenu:D,noWheelClassName:F,noPanClassName:A,disableKeyboardA11y:I})=>{const z=Me(WA),M=Oi(f),q=Oi(g),H=q||R,O=q||k,B=M||p&&H!==!0;return RA({deleteKeyCode:a,multiSelectionKeyCode:w}),W.createElement(AA,{onMove:c,onMoveStart:u,onMoveEnd:d,onPaneContextMenu:o,elementsSelectable:b,zoomOnScroll:_,zoomOnPinch:S,panOnScroll:O,panOnScrollSpeed:N,panOnScrollMode:j,zoomOnDoubleClick:C,panOnDrag:!M&&H,defaultViewport:T,translateExtent:L,minZoom:$,maxZoom:E,zoomActivationKeyCode:x,preventScrolling:P,noWheelClassName:F,noPanClassName:A},W.createElement(IN,{onSelectionStart:y,onSelectionEnd:v,onPaneClick:t,onPaneMouseEnter:r,onPaneMouseMove:n,onPaneMouseLeave:s,onPaneContextMenu:o,onPaneScroll:i,panOnDrag:H,isSelecting:!!B,selectionMode:h},e,z&&W.createElement(HA,{onSelectionContextMenu:D,noPanClassName:A,disableKeyboardA11y:I})))};ON.displayName="FlowRenderer";var VA=m.memo(ON);function UA(e){return Me(m.useCallback(r=>e?dN(r.nodeInternals,{x:0,y:0,width:r.width,height:r.height},r.transform,!0):r.getNodes(),[e]))}function GA(e){const t={input:zo(e.input||bN),default:zo(e.default||Pg),output:zo(e.output||_N),group:zo(e.group||Jv)},r={},n=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,o)=>(s[o]=zo(e[o]||Pg),s),r);return{...t,...n}}const KA=({x:e,y:t,width:r,height:n,origin:s})=>!r||!n?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-r*s[0],y:t-n*s[1]},YA=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),LN=e=>{const{nodesDraggable:t,nodesConnectable:r,nodesFocusable:n,elementsSelectable:s,updateNodeDimensions:o,onError:i}=Me(YA,pt),a=UA(e.onlyRenderVisibleElements),c=m.useRef(),u=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const d=new ResizeObserver(f=>{const p=f.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));o(p)});return c.current=d,d},[]);return m.useEffect(()=>()=>{var d;(d=c==null?void 0:c.current)==null||d.disconnect()},[]),W.createElement("div",{className:"react-flow__nodes",style:ex},a.map(d=>{var S,k,N;let f=d.type||"default";e.nodeTypes[f]||(i==null||i("003",Jr.error003(f)),f="default");const p=e.nodeTypes[f]||e.nodeTypes.default,h=!!(d.draggable||t&&typeof d.draggable>"u"),y=!!(d.selectable||s&&typeof d.selectable>"u"),v=!!(d.connectable||r&&typeof d.connectable>"u"),w=!!(d.focusable||n&&typeof d.focusable>"u"),g=e.nodeExtent?Gv(d.positionAbsolute,e.nodeExtent):d.positionAbsolute,x=(g==null?void 0:g.x)??0,b=(g==null?void 0:g.y)??0,_=KA({x,y:b,width:d.width??0,height:d.height??0,origin:e.nodeOrigin});return W.createElement(p,{key:d.id,id:d.id,className:d.className,style:d.style,type:f,data:d.data,sourcePosition:d.sourcePosition||J.Bottom,targetPosition:d.targetPosition||J.Top,hidden:d.hidden,xPos:x,yPos:b,xPosOrigin:_.x,yPosOrigin:_.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!d.selected,isDraggable:h,isSelectable:y,isConnectable:v,isFocusable:w,resizeObserver:u,dragHandle:d.dragHandle,zIndex:((S=d[ze])==null?void 0:S.z)??0,isParent:!!((k=d[ze])!=null&&k.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!d.width&&!!d.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:d.ariaLabel,hasHandleBounds:!!((N=d[ze])!=null&&N.handleBounds)})}))};LN.displayName="NodeRenderer";var XA=m.memo(LN);const QA=(e,t,r)=>r===J.Left?e-t:r===J.Right?e+t:e,ZA=(e,t,r)=>r===J.Top?e-t:r===J.Bottom?e+t:e,j0="react-flow__edgeupdater",k0=({position:e,centerX:t,centerY:r,radius:n=10,onMouseDown:s,onMouseEnter:o,onMouseOut:i,type:a})=>W.createElement("circle",{onMouseDown:s,onMouseEnter:o,onMouseOut:i,className:Rt([j0,`${j0}-${a}`]),cx:QA(t,n,e),cy:ZA(r,n,e),r:n,stroke:"transparent",fill:"transparent"}),JA=()=>!0;var Es=e=>{const t=({id:r,className:n,type:s,data:o,onClick:i,onEdgeDoubleClick:a,selected:c,animated:u,label:d,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:y,labelBgBorderRadius:v,style:w,source:g,target:x,sourceX:b,sourceY:_,targetX:S,targetY:k,sourcePosition:N,targetPosition:j,elementsSelectable:C,hidden:R,sourceHandleId:T,targetHandleId:L,onContextMenu:$,onMouseEnter:E,onMouseMove:P,onMouseLeave:D,reconnectRadius:F,onReconnect:A,onReconnectStart:I,onReconnectEnd:z,markerEnd:M,markerStart:q,rfId:H,ariaLabel:O,isFocusable:B,isReconnectable:Y,pathOptions:te,interactionWidth:ne,disableKeyboardA11y:re})=>{const Q=m.useRef(null),[ce,ie]=m.useState(!1),[xe,ee]=m.useState(!1),X=tt(),fe=m.useMemo(()=>`url('#${Mg(q,H)}')`,[q,H]),V=m.useMemo(()=>`url('#${Mg(M,H)}')`,[M,H]);if(R)return null;const K=je=>{var Ft;const{edges:nt,addSelectedEdges:Xe,unselectNodesAndEdges:st,multiSelectionActive:nr}=X.getState(),$t=nt.find(sn=>sn.id===r);$t&&(C&&(X.setState({nodesSelectionActive:!1}),$t.selected&&nr?(st({nodes:[],edges:[$t]}),(Ft=Q.current)==null||Ft.blur()):Xe([r])),i&&i(je,$t))},oe=Oo(r,X.getState,a),U=Oo(r,X.getState,$),we=Oo(r,X.getState,E),_e=Oo(r,X.getState,P),ue=Oo(r,X.getState,D),Se=(je,nt)=>{if(je.button!==0)return;const{edges:Xe,isValidConnection:st}=X.getState(),nr=nt?x:g,$t=(nt?L:T)||null,Ft=nt?"target":"source",sn=st||JA,So=nt,Bn=Xe.find(qe=>qe.id===r);ee(!0),I==null||I(je,Bn,Ft);const jo=qe=>{ee(!1),z==null||z(qe,Bn,Ft)};gN({event:je,handleId:$t,nodeId:nr,onConnect:qe=>A==null?void 0:A(Bn,qe),isTarget:So,getState:X.getState,setState:X.setState,isValidConnection:sn,edgeUpdaterType:Ft,onReconnectEnd:jo})},lt=je=>Se(je,!0),We=je=>Se(je,!1),rt=()=>ie(!0),Fe=()=>ie(!1),ht=!C&&!i,rr=je=>{var nt;if(!re&&sN.includes(je.key)&&C){const{unselectNodesAndEdges:Xe,addSelectedEdges:st,edges:nr}=X.getState();je.key==="Escape"?((nt=Q.current)==null||nt.blur(),Xe({edges:[nr.find(Ft=>Ft.id===r)]})):st([r])}};return W.createElement("g",{className:Rt(["react-flow__edge",`react-flow__edge-${s}`,n,{selected:c,animated:u,inactive:ht,updating:ce}]),onClick:K,onDoubleClick:oe,onContextMenu:U,onMouseEnter:we,onMouseMove:_e,onMouseLeave:ue,onKeyDown:B?rr:void 0,tabIndex:B?0:void 0,role:B?"button":"img","data-testid":`rf__edge-${r}`,"aria-label":O===null?void 0:O||`Edge from ${g} to ${x}`,"aria-describedby":B?`${kN}-${H}`:void 0,ref:Q},!xe&&W.createElement(e,{id:r,source:g,target:x,selected:c,animated:u,label:d,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:y,labelBgBorderRadius:v,data:o,style:w,sourceX:b,sourceY:_,targetX:S,targetY:k,sourcePosition:N,targetPosition:j,sourceHandleId:T,targetHandleId:L,markerStart:fe,markerEnd:V,pathOptions:te,interactionWidth:ne}),Y&&W.createElement(W.Fragment,null,(Y==="source"||Y===!0)&&W.createElement(k0,{position:N,centerX:b,centerY:_,radius:F,onMouseDown:lt,onMouseEnter:rt,onMouseOut:Fe,type:"source"}),(Y==="target"||Y===!0)&&W.createElement(k0,{position:j,centerX:S,centerY:k,radius:F,onMouseDown:We,onMouseEnter:rt,onMouseOut:Fe,type:"target"})))};return t.displayName="EdgeWrapper",m.memo(t)};function eP(e){const t={default:Es(e.default||Al),straight:Es(e.bezier||Xv),step:Es(e.step||Yv),smoothstep:Es(e.step||pc),simplebezier:Es(e.simplebezier||Kv)},r={},n=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,o)=>(s[o]=Es(e[o]||Al),s),r);return{...t,...n}}function N0(e,t,r=null){const n=((r==null?void 0:r.x)||0)+t.x,s=((r==null?void 0:r.y)||0)+t.y,o=(r==null?void 0:r.width)||t.width,i=(r==null?void 0:r.height)||t.height;switch(e){case J.Top:return{x:n+o/2,y:s};case J.Right:return{x:n+o,y:s+i/2};case J.Bottom:return{x:n+o/2,y:s+i};case J.Left:return{x:n,y:s+i/2}}}function E0(e,t){return e?e.length===1||!t?e[0]:t&&e.find(r=>r.id===t)||null:null}const tP=(e,t,r,n,s,o)=>{const i=N0(r,e,t),a=N0(o,n,s);return{sourceX:i.x,sourceY:i.y,targetX:a.x,targetY:a.y}};function rP({sourcePos:e,targetPos:t,sourceWidth:r,sourceHeight:n,targetWidth:s,targetHeight:o,width:i,height:a,transform:c}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+r,t.x+s),y2:Math.max(e.y+n,t.y+o)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const d=Pi({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:i/c[2],height:a/c[2]}),f=Math.max(0,Math.min(d.x2,u.x2)-Math.max(d.x,u.x)),p=Math.max(0,Math.min(d.y2,u.y2)-Math.max(d.y,u.y));return Math.ceil(f*p)>0}function C0(e){var n,s,o,i,a;const t=((n=e==null?void 0:e[ze])==null?void 0:n.handleBounds)||null,r=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.y)<"u";return[{x:((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!r]}const nP=[{level:0,isMaxLevel:!0,edges:[]}];function sP(e,t,r=!1){let n=-1;const s=e.reduce((i,a)=>{var d,f;const c=Xt(a.zIndex);let u=c?a.zIndex:0;if(r){const p=t.get(a.target),h=t.get(a.source),y=a.selected||(p==null?void 0:p.selected)||(h==null?void 0:h.selected),v=Math.max(((d=h==null?void 0:h[ze])==null?void 0:d.z)||0,((f=p==null?void 0:p[ze])==null?void 0:f.z)||0,1e3);u=(c?a.zIndex:0)+(y?v:0)}return i[u]?i[u].push(a):i[u]=[a],n=u>n?u:n,i},{}),o=Object.entries(s).map(([i,a])=>{const c=+i;return{edges:a,level:c,isMaxLevel:c===n}});return o.length===0?nP:o}function oP(e,t,r){const n=Me(m.useCallback(s=>e?s.edges.filter(o=>{const i=t.get(o.source),a=t.get(o.target);return(i==null?void 0:i.width)&&(i==null?void 0:i.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&rP({sourcePos:i.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:i.width,sourceHeight:i.height,targetWidth:a.width,targetHeight:a.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return sP(n,t,r)}const iP=({color:e="none",strokeWidth:t=1})=>W.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),aP=({color:e="none",strokeWidth:t=1})=>W.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),R0={[Ml.Arrow]:iP,[Ml.ArrowClosed]:aP};function lP(e){const t=tt();return m.useMemo(()=>{var s,o;return Object.prototype.hasOwnProperty.call(R0,e)?R0[e]:((o=(s=t.getState()).onError)==null||o.call(s,"009",Jr.error009(e)),null)},[e])}const cP=({id:e,type:t,color:r,width:n=12.5,height:s=12.5,markerUnits:o="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const c=lP(t);return c?W.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${n}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:a,refX:"0",refY:"0"},W.createElement(c,{color:r,strokeWidth:i})):null},uP=({defaultColor:e,rfId:t})=>r=>{const n=[];return r.edges.reduce((s,o)=>([o.markerStart,o.markerEnd].forEach(i=>{if(i&&typeof i=="object"){const a=Mg(i,t);n.includes(a)||(s.push({id:a,color:i.color||e,...i}),n.push(a))}}),s),[]).sort((s,o)=>s.id.localeCompare(o.id))},zN=({defaultColor:e,rfId:t})=>{const r=Me(m.useCallback(uP({defaultColor:e,rfId:t}),[e,t]),(n,s)=>!(n.length!==s.length||n.some((o,i)=>o.id!==s[i].id)));return W.createElement("defs",null,r.map(n=>W.createElement(cP,{id:n.id,key:n.id,type:n.type,color:n.color,width:n.width,height:n.height,markerUnits:n.markerUnits,strokeWidth:n.strokeWidth,orient:n.orient})))};zN.displayName="MarkerDefinitions";var dP=m.memo(zN);const fP=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),qN=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:r,rfId:n,edgeTypes:s,noPanClassName:o,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:d,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:y,reconnectRadius:v,children:w,disableKeyboardA11y:g})=>{const{edgesFocusable:x,edgesUpdatable:b,elementsSelectable:_,width:S,height:k,connectionMode:N,nodeInternals:j,onError:C}=Me(fP,pt),R=oP(t,j,r);return S?W.createElement(W.Fragment,null,R.map(({level:T,edges:L,isMaxLevel:$})=>W.createElement("svg",{key:T,style:{zIndex:T},width:S,height:k,className:"react-flow__edges react-flow__container"},$&&W.createElement(dP,{defaultColor:e,rfId:n}),W.createElement("g",null,L.map(E=>{const[P,D,F]=C0(j.get(E.source)),[A,I,z]=C0(j.get(E.target));if(!F||!z)return null;let M=E.type||"default";s[M]||(C==null||C("011",Jr.error011(M)),M="default");const q=s[M]||s.default,H=N===ms.Strict?I.target:(I.target??[]).concat(I.source??[]),O=E0(D.source,E.sourceHandle),B=E0(H,E.targetHandle),Y=(O==null?void 0:O.position)||J.Bottom,te=(B==null?void 0:B.position)||J.Top,ne=!!(E.focusable||x&&typeof E.focusable>"u"),re=E.reconnectable||E.updatable,Q=typeof p<"u"&&(re||b&&typeof re>"u");if(!O||!B)return C==null||C("008",Jr.error008(O,E)),null;const{sourceX:ce,sourceY:ie,targetX:xe,targetY:ee}=tP(P,O,Y,A,B,te);return W.createElement(q,{key:E.id,id:E.id,className:Rt([E.className,o]),type:M,data:E.data,selected:!!E.selected,animated:!!E.animated,hidden:!!E.hidden,label:E.label,labelStyle:E.labelStyle,labelShowBg:E.labelShowBg,labelBgStyle:E.labelBgStyle,labelBgPadding:E.labelBgPadding,labelBgBorderRadius:E.labelBgBorderRadius,style:E.style,source:E.source,target:E.target,sourceHandleId:E.sourceHandle,targetHandleId:E.targetHandle,markerEnd:E.markerEnd,markerStart:E.markerStart,sourceX:ce,sourceY:ie,targetX:xe,targetY:ee,sourcePosition:Y,targetPosition:te,elementsSelectable:_,onContextMenu:i,onMouseEnter:a,onMouseMove:c,onMouseLeave:u,onClick:d,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:y,reconnectRadius:v,rfId:n,ariaLabel:E.ariaLabel,isFocusable:ne,isReconnectable:Q,pathOptions:"pathOptions"in E?E.pathOptions:void 0,interactionWidth:E.interactionWidth,disableKeyboardA11y:g})})))),w):null};qN.displayName="EdgeRenderer";var pP=m.memo(qN);const hP=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function mP({children:e}){const t=Me(hP);return W.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function gP(e){const t=mc(),r=m.useRef(!1);m.useEffect(()=>{!r.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),r.current=!0)},[e,t.viewportInitialized])}const vP={[J.Left]:J.Right,[J.Right]:J.Left,[J.Top]:J.Bottom,[J.Bottom]:J.Top},$N=({nodeId:e,handleType:t,style:r,type:n=yn.Bezier,CustomComponent:s,connectionStatus:o})=>{var k,N,j;const{fromNode:i,handleId:a,toX:c,toY:u,connectionMode:d}=Me(m.useCallback(C=>({fromNode:C.nodeInternals.get(e),handleId:C.connectionHandleId,toX:(C.connectionPosition.x-C.transform[0])/C.transform[2],toY:(C.connectionPosition.y-C.transform[1])/C.transform[2],connectionMode:C.connectionMode}),[e]),pt),f=(k=i==null?void 0:i[ze])==null?void 0:k.handleBounds;let p=f==null?void 0:f[t];if(d===ms.Loose&&(p=p||(f==null?void 0:f[t==="source"?"target":"source"])),!i||!p)return null;const h=a?p.find(C=>C.id===a):p[0],y=h?h.x+h.width/2:(i.width??0)/2,v=h?h.y+h.height/2:i.height??0,w=(((N=i.positionAbsolute)==null?void 0:N.x)??0)+y,g=(((j=i.positionAbsolute)==null?void 0:j.y)??0)+v,x=h==null?void 0:h.position,b=x?vP[x]:null;if(!x||!b)return null;if(s)return W.createElement(s,{connectionLineType:n,connectionLineStyle:r,fromNode:i,fromHandle:h,fromX:w,fromY:g,toX:c,toY:u,fromPosition:x,toPosition:b,connectionStatus:o});let _="";const S={sourceX:w,sourceY:g,sourcePosition:x,targetX:c,targetY:u,targetPosition:b};return n===yn.Bezier?[_]=cN(S):n===yn.Step?[_]=Ig({...S,borderRadius:0}):n===yn.SmoothStep?[_]=Ig(S):n===yn.SimpleBezier?[_]=lN(S):_=`M${w},${g} ${c},${u}`,W.createElement("path",{d:_,fill:"none",className:"react-flow__connection-path",style:r})};$N.displayName="ConnectionLine";const xP=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function yP({containerStyle:e,style:t,type:r,component:n}){const{nodeId:s,handleType:o,nodesConnectable:i,width:a,height:c,connectionStatus:u}=Me(xP,pt);return!(s&&o&&a&&i)?null:W.createElement("svg",{style:e,width:a,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},W.createElement("g",{className:Rt(["react-flow__connection",u])},W.createElement($N,{nodeId:s,handleType:o,style:t,type:r,CustomComponent:n,connectionStatus:u})))}function T0(e,t){return m.useRef(null),tt(),m.useMemo(()=>t(e),[e])}const FN=({nodeTypes:e,edgeTypes:t,onMove:r,onMoveStart:n,onMoveEnd:s,onInit:o,onNodeClick:i,onEdgeClick:a,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,onSelectionContextMenu:y,onSelectionStart:v,onSelectionEnd:w,connectionLineType:g,connectionLineStyle:x,connectionLineComponent:b,connectionLineContainerStyle:_,selectionKeyCode:S,selectionOnDrag:k,selectionMode:N,multiSelectionKeyCode:j,panActivationKeyCode:C,zoomActivationKeyCode:R,deleteKeyCode:T,onlyRenderVisibleElements:L,elementsSelectable:$,selectNodesOnDrag:E,defaultViewport:P,translateExtent:D,minZoom:F,maxZoom:A,preventScrolling:I,defaultMarkerColor:z,zoomOnScroll:M,zoomOnPinch:q,panOnScroll:H,panOnScrollSpeed:O,panOnScrollMode:B,zoomOnDoubleClick:Y,panOnDrag:te,onPaneClick:ne,onPaneMouseEnter:re,onPaneMouseMove:Q,onPaneMouseLeave:ce,onPaneScroll:ie,onPaneContextMenu:xe,onEdgeContextMenu:ee,onEdgeMouseEnter:X,onEdgeMouseMove:fe,onEdgeMouseLeave:V,onReconnect:K,onReconnectStart:oe,onReconnectEnd:U,reconnectRadius:we,noDragClassName:_e,noWheelClassName:ue,noPanClassName:Se,elevateEdgesOnSelect:lt,disableKeyboardA11y:We,nodeOrigin:rt,nodeExtent:Fe,rfId:ht})=>{const rr=T0(e,GA),je=T0(t,eP);return gP(o),W.createElement(VA,{onPaneClick:ne,onPaneMouseEnter:re,onPaneMouseMove:Q,onPaneMouseLeave:ce,onPaneContextMenu:xe,onPaneScroll:ie,deleteKeyCode:T,selectionKeyCode:S,selectionOnDrag:k,selectionMode:N,onSelectionStart:v,onSelectionEnd:w,multiSelectionKeyCode:j,panActivationKeyCode:C,zoomActivationKeyCode:R,elementsSelectable:$,onMove:r,onMoveStart:n,onMoveEnd:s,zoomOnScroll:M,zoomOnPinch:q,zoomOnDoubleClick:Y,panOnScroll:H,panOnScrollSpeed:O,panOnScrollMode:B,panOnDrag:te,defaultViewport:P,translateExtent:D,minZoom:F,maxZoom:A,onSelectionContextMenu:y,preventScrolling:I,noDragClassName:_e,noWheelClassName:ue,noPanClassName:Se,disableKeyboardA11y:We},W.createElement(mP,null,W.createElement(pP,{edgeTypes:je,onEdgeClick:a,onEdgeDoubleClick:u,onlyRenderVisibleElements:L,onEdgeContextMenu:ee,onEdgeMouseEnter:X,onEdgeMouseMove:fe,onEdgeMouseLeave:V,onReconnect:K,onReconnectStart:oe,onReconnectEnd:U,reconnectRadius:we,defaultMarkerColor:z,noPanClassName:Se,elevateEdgesOnSelect:!!lt,disableKeyboardA11y:We,rfId:ht},W.createElement(yP,{style:x,type:g,component:b,containerStyle:_})),W.createElement("div",{className:"react-flow__edgelabel-renderer"}),W.createElement(XA,{nodeTypes:rr,onNodeClick:i,onNodeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,selectNodesOnDrag:E,onlyRenderVisibleElements:L,noPanClassName:Se,noDragClassName:_e,disableKeyboardA11y:We,nodeOrigin:rt,nodeExtent:Fe,rfId:ht})))};FN.displayName="GraphView";var bP=m.memo(FN);const Og=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],ln={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Og,nodeExtent:Og,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:ms.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:KM,isValidConnection:void 0},wP=()=>c3((e,t)=>({...ln,setNodes:r=>{const{nodeInternals:n,nodeOrigin:s,elevateNodesOnSelect:o}=t();e({nodeInternals:_u(r,n,s,o)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:r=>{const{defaultEdgeOptions:n={}}=t();e({edges:r.map(s=>({...n,...s}))})},setDefaultNodesAndEdges:(r,n)=>{const s=typeof r<"u",o=typeof n<"u",i=s?_u(r,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:i,edges:o?n:[],hasDefaultNodes:s,hasDefaultEdges:o})},updateNodeDimensions:r=>{const{onNodesChange:n,nodeInternals:s,fitViewOnInit:o,fitViewOnInitDone:i,fitViewOnInitOptions:a,domNode:c,nodeOrigin:u}=t(),d=c==null?void 0:c.querySelector(".react-flow__viewport");if(!d)return;const f=window.getComputedStyle(d),{m22:p}=new window.DOMMatrixReadOnly(f.transform),h=r.reduce((v,w)=>{const g=s.get(w.id);if(g!=null&&g.hidden)s.set(g.id,{...g,[ze]:{...g[ze],handleBounds:void 0}});else if(g){const x=Uv(w.nodeElement);!!(x.width&&x.height&&(g.width!==x.width||g.height!==x.height||w.forceUpdate))&&(s.set(g.id,{...g,[ze]:{...g[ze],handleBounds:{source:S0(".source",w.nodeElement,p,u),target:S0(".target",w.nodeElement,p,u)}},...x}),v.push({id:g.id,type:"dimensions",dimensions:x}))}return v},[]);EN(s,u);const y=i||o&&!i&&CN(t,{initial:!0,...a});e({nodeInternals:new Map(s),fitViewOnInitDone:y}),(h==null?void 0:h.length)>0&&(n==null||n(h))},updateNodePositions:(r,n=!0,s=!1)=>{const{triggerNodeChanges:o}=t(),i=r.map(a=>{const c={id:a.id,type:"position",dragging:s};return n&&(c.positionAbsolute=a.positionAbsolute,c.position=a.position),c});o(i)},triggerNodeChanges:r=>{const{onNodesChange:n,nodeInternals:s,hasDefaultNodes:o,nodeOrigin:i,getNodes:a,elevateNodesOnSelect:c}=t();if(r!=null&&r.length){if(o){const u=TN(r,a()),d=_u(u,s,i,c);e({nodeInternals:d})}n==null||n(r)}},addSelectedNodes:r=>{const{multiSelectionActive:n,edges:s,getNodes:o}=t();let i,a=null;n?i=r.map(c=>mn(c,!0)):(i=Fs(o(),r),a=Fs(s,[])),Ea({changedNodes:i,changedEdges:a,get:t,set:e})},addSelectedEdges:r=>{const{multiSelectionActive:n,edges:s,getNodes:o}=t();let i,a=null;n?i=r.map(c=>mn(c,!0)):(i=Fs(s,r),a=Fs(o(),[])),Ea({changedNodes:a,changedEdges:i,get:t,set:e})},unselectNodesAndEdges:({nodes:r,edges:n}={})=>{const{edges:s,getNodes:o}=t(),i=r||o(),a=n||s,c=i.map(d=>(d.selected=!1,mn(d.id,!1))),u=a.map(d=>mn(d.id,!1));Ea({changedNodes:c,changedEdges:u,get:t,set:e})},setMinZoom:r=>{const{d3Zoom:n,maxZoom:s}=t();n==null||n.scaleExtent([r,s]),e({minZoom:r})},setMaxZoom:r=>{const{d3Zoom:n,minZoom:s}=t();n==null||n.scaleExtent([s,r]),e({maxZoom:r})},setTranslateExtent:r=>{var n;(n=t().d3Zoom)==null||n.translateExtent(r),e({translateExtent:r})},resetSelectedElements:()=>{const{edges:r,getNodes:n}=t(),o=n().filter(a=>a.selected).map(a=>mn(a.id,!1)),i=r.filter(a=>a.selected).map(a=>mn(a.id,!1));Ea({changedNodes:o,changedEdges:i,get:t,set:e})},setNodeExtent:r=>{const{nodeInternals:n}=t();n.forEach(s=>{s.positionAbsolute=Gv(s.position,r)}),e({nodeExtent:r,nodeInternals:new Map(n)})},panBy:r=>{const{transform:n,width:s,height:o,d3Zoom:i,d3Selection:a,translateExtent:c}=t();if(!i||!a||!r.x&&!r.y)return!1;const u=Gr.translate(n[0]+r.x,n[1]+r.y).scale(n[2]),d=[[0,0],[s,o]],f=i==null?void 0:i.constrain()(u,d,c);return i.transform(a,f),n[0]!==f.x||n[1]!==f.y||n[2]!==f.k},cancelConnection:()=>e({connectionNodeId:ln.connectionNodeId,connectionHandleId:ln.connectionHandleId,connectionHandleType:ln.connectionHandleType,connectionStatus:ln.connectionStatus,connectionStartHandle:ln.connectionStartHandle,connectionEndHandle:ln.connectionEndHandle}),reset:()=>e({...ln})}),Object.is),gc=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=wP()),W.createElement(FM,{value:t.current},e)};gc.displayName="ReactFlowProvider";const BN=({children:e})=>m.useContext(fc)?W.createElement(W.Fragment,null,e):W.createElement(gc,null,e);BN.displayName="ReactFlowWrapper";const _P={input:bN,default:Pg,output:_N,group:Jv},SP={default:Al,straight:Xv,step:Yv,smoothstep:pc,simplebezier:Kv},jP=[0,0],kP=[15,15],NP={x:0,y:0,zoom:1},EP={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},tx=m.forwardRef(({nodes:e,edges:t,defaultNodes:r,defaultEdges:n,className:s,nodeTypes:o=_P,edgeTypes:i=SP,onNodeClick:a,onEdgeClick:c,onInit:u,onMove:d,onMoveStart:f,onMoveEnd:p,onConnect:h,onConnectStart:y,onConnectEnd:v,onClickConnectStart:w,onClickConnectEnd:g,onNodeMouseEnter:x,onNodeMouseMove:b,onNodeMouseLeave:_,onNodeContextMenu:S,onNodeDoubleClick:k,onNodeDragStart:N,onNodeDrag:j,onNodeDragStop:C,onNodesDelete:R,onEdgesDelete:T,onSelectionChange:L,onSelectionDragStart:$,onSelectionDrag:E,onSelectionDragStop:P,onSelectionContextMenu:D,onSelectionStart:F,onSelectionEnd:A,connectionMode:I=ms.Strict,connectionLineType:z=yn.Bezier,connectionLineStyle:M,connectionLineComponent:q,connectionLineContainerStyle:H,deleteKeyCode:O="Backspace",selectionKeyCode:B="Shift",selectionOnDrag:Y=!1,selectionMode:te=Di.Full,panActivationKeyCode:ne="Space",multiSelectionKeyCode:re=Il()?"Meta":"Control",zoomActivationKeyCode:Q=Il()?"Meta":"Control",snapToGrid:ce=!1,snapGrid:ie=kP,onlyRenderVisibleElements:xe=!1,selectNodesOnDrag:ee=!0,nodesDraggable:X,nodesConnectable:fe,nodesFocusable:V,nodeOrigin:K=jP,edgesFocusable:oe,edgesUpdatable:U,elementsSelectable:we,defaultViewport:_e=NP,minZoom:ue=.5,maxZoom:Se=2,translateExtent:lt=Og,preventScrolling:We=!0,nodeExtent:rt,defaultMarkerColor:Fe="#b1b1b7",zoomOnScroll:ht=!0,zoomOnPinch:rr=!0,panOnScroll:je=!1,panOnScrollSpeed:nt=.5,panOnScrollMode:Xe=ns.Free,zoomOnDoubleClick:st=!0,panOnDrag:nr=!0,onPaneClick:$t,onPaneMouseEnter:Ft,onPaneMouseMove:sn,onPaneMouseLeave:So,onPaneScroll:Bn,onPaneContextMenu:jo,children:Ve,onEdgeContextMenu:qe,onEdgeDoubleClick:mt,onEdgeMouseEnter:yr,onEdgeMouseMove:wt,onEdgeMouseLeave:gt,onEdgeUpdate:Bt,onEdgeUpdateStart:on,onEdgeUpdateEnd:Ue,onReconnect:br,onReconnectStart:Ht,onReconnectEnd:sr,reconnectRadius:Hn=10,edgeUpdaterRadius:Wn=10,onNodesChange:wr,onEdgesChange:Vn,noDragClassName:ko="nodrag",noWheelClassName:YC="nowheel",noPanClassName:Tx="nopan",fitView:XC=!1,fitViewOptions:QC,connectOnClick:ZC=!0,attributionPosition:JC,proOptions:e4,defaultEdgeOptions:t4,elevateNodesOnSelect:r4=!0,elevateEdgesOnSelect:n4=!1,disableKeyboardA11y:Ix=!1,autoPanOnConnect:s4=!0,autoPanOnNodeDrag:o4=!0,connectionRadius:i4=20,isValidConnection:a4,onError:l4,style:c4,id:Mx,nodeDragThreshold:u4,...d4},f4)=>{const Hc=Mx||"1";return W.createElement("div",{...d4,style:{...c4,...EP},ref:f4,className:Rt(["react-flow",s]),"data-testid":"rf__wrapper",id:Mx},W.createElement(BN,null,W.createElement(bP,{onInit:u,onMove:d,onMoveStart:f,onMoveEnd:p,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:x,onNodeMouseMove:b,onNodeMouseLeave:_,onNodeContextMenu:S,onNodeDoubleClick:k,nodeTypes:o,edgeTypes:i,connectionLineType:z,connectionLineStyle:M,connectionLineComponent:q,connectionLineContainerStyle:H,selectionKeyCode:B,selectionOnDrag:Y,selectionMode:te,deleteKeyCode:O,multiSelectionKeyCode:re,panActivationKeyCode:ne,zoomActivationKeyCode:Q,onlyRenderVisibleElements:xe,selectNodesOnDrag:ee,defaultViewport:_e,translateExtent:lt,minZoom:ue,maxZoom:Se,preventScrolling:We,zoomOnScroll:ht,zoomOnPinch:rr,zoomOnDoubleClick:st,panOnScroll:je,panOnScrollSpeed:nt,panOnScrollMode:Xe,panOnDrag:nr,onPaneClick:$t,onPaneMouseEnter:Ft,onPaneMouseMove:sn,onPaneMouseLeave:So,onPaneScroll:Bn,onPaneContextMenu:jo,onSelectionContextMenu:D,onSelectionStart:F,onSelectionEnd:A,onEdgeContextMenu:qe,onEdgeDoubleClick:mt,onEdgeMouseEnter:yr,onEdgeMouseMove:wt,onEdgeMouseLeave:gt,onReconnect:br??Bt,onReconnectStart:Ht??on,onReconnectEnd:sr??Ue,reconnectRadius:Hn??Wn,defaultMarkerColor:Fe,noDragClassName:ko,noWheelClassName:YC,noPanClassName:Tx,elevateEdgesOnSelect:n4,rfId:Hc,disableKeyboardA11y:Ix,nodeOrigin:K,nodeExtent:rt}),W.createElement(vA,{nodes:e,edges:t,defaultNodes:r,defaultEdges:n,onConnect:h,onConnectStart:y,onConnectEnd:v,onClickConnectStart:w,onClickConnectEnd:g,nodesDraggable:X,nodesConnectable:fe,nodesFocusable:V,edgesFocusable:oe,edgesUpdatable:U,elementsSelectable:we,elevateNodesOnSelect:r4,minZoom:ue,maxZoom:Se,nodeExtent:rt,onNodesChange:wr,onEdgesChange:Vn,snapToGrid:ce,snapGrid:ie,connectionMode:I,translateExtent:lt,connectOnClick:ZC,defaultEdgeOptions:t4,fitView:XC,fitViewOptions:QC,onNodesDelete:R,onEdgesDelete:T,onNodeDragStart:N,onNodeDrag:j,onNodeDragStop:C,onSelectionDrag:E,onSelectionDragStart:$,onSelectionDragStop:P,noPanClassName:Tx,nodeOrigin:K,rfId:Hc,autoPanOnConnect:s4,autoPanOnNodeDrag:o4,onError:l4,connectionRadius:i4,isValidConnection:a4,nodeDragThreshold:u4}),W.createElement(mA,{onSelectionChange:L}),Ve,W.createElement(HM,{proOptions:e4,position:JC}),W.createElement(_A,{rfId:Hc,disableKeyboardA11y:Ix})))});tx.displayName="ReactFlow";function HN(e){return t=>{const[r,n]=m.useState(t),s=m.useCallback(o=>n(i=>e(o,i)),[]);return[r,n,s]}}const WN=HN(TN),VN=HN(OA),UN=({id:e,x:t,y:r,width:n,height:s,style:o,color:i,strokeColor:a,strokeWidth:c,className:u,borderRadius:d,shapeRendering:f,onClick:p,selected:h})=>{const{background:y,backgroundColor:v}=o||{},w=i||y||v;return W.createElement("rect",{className:Rt(["react-flow__minimap-node",{selected:h},u]),x:t,y:r,rx:d,ry:d,width:n,height:s,fill:w,stroke:a,strokeWidth:c,shapeRendering:f,onClick:p?g=>p(g,e):void 0})};UN.displayName="MiniMapNode";var CP=m.memo(UN);const RP=e=>e.nodeOrigin,TP=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),Nu=e=>e instanceof Function?e:()=>e;function IP({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:r="",nodeBorderRadius:n=5,nodeStrokeWidth:s=2,nodeComponent:o=CP,onClick:i}){const a=Me(TP,pt),c=Me(RP),u=Nu(t),d=Nu(e),f=Nu(r),p=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return W.createElement(W.Fragment,null,a.map(h=>{const{x:y,y:v}=ls(h,c).positionAbsolute;return W.createElement(o,{key:h.id,x:y,y:v,width:h.width,height:h.height,style:h.style,selected:h.selected,className:f(h),color:u(h),borderRadius:n,strokeColor:d(h),strokeWidth:s,shapeRendering:p,onClick:i,id:h.id})}))}var MP=m.memo(IP);const AP=200,PP=150,DP=e=>{const t=e.getNodes(),r={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:r,boundingRect:t.length>0?UM(hc(t,e.nodeOrigin),r):r,rfId:e.rfId}},OP="react-flow__minimap-desc";function GN({style:e,className:t,nodeStrokeColor:r="transparent",nodeColor:n="#e2e2e2",nodeClassName:s="",nodeBorderRadius:o=5,nodeStrokeWidth:i=2,nodeComponent:a,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:d=1,position:f="bottom-right",onClick:p,onNodeClick:h,pannable:y=!1,zoomable:v=!1,ariaLabel:w="React Flow mini map",inversePan:g=!1,zoomStep:x=10,offsetScale:b=5}){const _=tt(),S=m.useRef(null),{boundingRect:k,viewBB:N,rfId:j}=Me(DP,pt),C=(e==null?void 0:e.width)??AP,R=(e==null?void 0:e.height)??PP,T=k.width/C,L=k.height/R,$=Math.max(T,L),E=$*C,P=$*R,D=b*$,F=k.x-(E-k.width)/2-D,A=k.y-(P-k.height)/2-D,I=E+D*2,z=P+D*2,M=`${OP}-${j}`,q=m.useRef(0);q.current=$,m.useEffect(()=>{if(S.current){const B=Kt(S.current),Y=re=>{const{transform:Q,d3Selection:ce,d3Zoom:ie}=_.getState();if(re.sourceEvent.type!=="wheel"||!ce||!ie)return;const xe=-re.sourceEvent.deltaY*(re.sourceEvent.deltaMode===1?.05:re.sourceEvent.deltaMode?1:.002)*x,ee=Q[2]*Math.pow(2,xe);ie.scaleTo(ce,ee)},te=re=>{const{transform:Q,d3Selection:ce,d3Zoom:ie,translateExtent:xe,width:ee,height:X}=_.getState();if(re.sourceEvent.type!=="mousemove"||!ce||!ie)return;const fe=q.current*Math.max(1,Q[2])*(g?-1:1),V={x:Q[0]-re.sourceEvent.movementX*fe,y:Q[1]-re.sourceEvent.movementY*fe},K=[[0,0],[ee,X]],oe=Gr.translate(V.x,V.y).scale(Q[2]),U=ie.constrain()(oe,K,xe);ie.transform(ce,U)},ne=Zk().on("zoom",y?te:null).on("zoom.wheel",v?Y:null);return B.call(ne),()=>{B.on("zoom",null)}}},[y,v,g,x]);const H=p?B=>{const Y=cr(B);p(B,{x:Y[0],y:Y[1]})}:void 0,O=h?(B,Y)=>{const te=_.getState().nodeInternals.get(Y);h(B,te)}:void 0;return W.createElement(Mn,{position:f,style:e,className:Rt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},W.createElement("svg",{width:C,height:R,viewBox:`${F} ${A} ${I} ${z}`,role:"img","aria-labelledby":M,ref:S,onClick:H},w&&W.createElement("title",{id:M},w),W.createElement(MP,{onClick:O,nodeColor:n,nodeStrokeColor:r,nodeBorderRadius:o,nodeClassName:s,nodeStrokeWidth:i,nodeComponent:a}),W.createElement("path",{className:"react-flow__minimap-mask",d:`M${F-D},${A-D}h${I+D*2}v${z+D*2}h${-I-D*2}z
        M${N.x},${N.y}h${N.width}v${N.height}h${-N.width}z`,fill:c,fillRule:"evenodd",stroke:u,strokeWidth:d,pointerEvents:"none"})))}GN.displayName="MiniMap";var KN=m.memo(GN);const Ra={active:"#f59e0b",complete:"#10b981",queued:"#64748b"},LP=180,zP=400,qP=260,$P=48;function FP(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}catch{return""}}function BP({projects:e,selectedId:t,onSelectProject:r,onNewProject:n,showArchived:s,onToggleShowArchived:o,userSection:i}){const[a,c]=m.useState(!1),[u,d]=m.useState(qP),[f,p]=m.useState(!1),h=m.useRef(null),y=m.useRef(null);m.useEffect(()=>{y.current&&y.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const v=m.useMemo(()=>Object.values(e).sort((S,k)=>{const N=(S.name||"").localeCompare(k.name||"");return N!==0?N:(S.projectId||"").localeCompare(k.projectId||"")}),[e]),w=()=>{n()},g=m.useCallback(S=>{S.preventDefault(),p(!0)},[]),x=m.useCallback(S=>{if(!f)return;const k=Math.min(zP,Math.max(LP,S.clientX));d(k)},[f]),b=m.useCallback(()=>{p(!1)},[]);m.useEffect(()=>(f?(document.addEventListener("mousemove",x),document.addEventListener("mouseup",b),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""}),[f,x,b]);const _=a?$P:u;return l.jsxs("div",{ref:h,className:"h-full flex flex-col relative",style:{width:_,minWidth:_,background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)",transition:f?"none":"width 0.2s ease"},children:[l.jsxs("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[!a&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Projects"}),l.jsx("button",{onClick:o,className:"p-1 rounded hover:bg-white/10 transition-colors",style:{color:s?"#f59e0b":"var(--text-muted)"},title:s?"Hide archived":"Show archived",children:l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})})]}),l.jsx("button",{onClick:()=>c(!a),className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:a?"Expand sidebar":"Collapse sidebar",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transform:a?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:l.jsx("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),!a&&l.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:v.map(S=>{const k=t===S.id;return l.jsxs("div",{ref:k?y:null,onClick:()=>r(S.id),className:"p-3 rounded-lg mb-2 cursor-pointer transition-all",style:{background:k?"var(--state-active-bg)":"transparent",border:k?"1px solid var(--state-active-bg)":"1px solid transparent",boxShadow:k?"0 0 12px rgba(245, 158, 11, 0.3)":"none"},children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:k?"#ffffff":Ra[S.status]||Ra.queued}}),l.jsx("span",{className:"text-sm font-medium truncate flex-1",style:{color:k?"#ffffff":"var(--text-primary)"},children:S.name}),S.isArchived&&l.jsx("svg",{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:k?"rgba(255,255,255,0.7)":"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",title:"Archived",children:l.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})]}),l.jsxs("div",{className:"flex items-center justify-between mt-0.5 ml-4",children:[l.jsx("span",{className:"text-[10px] font-mono",style:{color:k?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:S.projectId}),l.jsx("span",{className:"text-[10px]",style:{color:k?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:FP(S.createdAt)})]})]},S.id)})}),a&&l.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:v.map(S=>l.jsx("div",{onClick:()=>r(S.id),className:"flex items-center justify-center py-2 cursor-pointer hover:bg-white/5",title:S.name,children:l.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:Ra[S.status]||Ra.queued,boxShadow:t===S.id?"0 0 0 2px var(--bg-panel), 0 0 0 4px var(--border-node)":"none"}})},S.id))}),!a&&l.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:l.jsxs("button",{onClick:w,className:"w-full py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",style:{background:"#10b981",color:"white"},children:[l.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"}),l.jsx("span",{children:"New Project"})]})}),a&&l.jsx("div",{className:"p-2 border-t flex justify-center",style:{borderColor:"var(--border-panel)"},children:l.jsx("button",{onClick:w,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{background:"#10b981",color:"white"},title:"New Project",children:l.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})}),i,!a&&l.jsx("div",{onMouseDown:g,className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-emerald-500/50 transition-colors",style:{background:f?"var(--state-active-bg)":"transparent"}})]})}function HP({stations:e}){return e!=null&&e.length?l.jsx("div",{className:"flex items-center gap-0.5 mt-2",children:e.map((t,r)=>{const n=t.state==="complete"?"var(--state-stabilized-bg)":t.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)",s=t.state==="complete"?"var(--state-stabilized-bg)":"var(--state-queued-bg)",o=t.state==="active"?"var(--state-active-text)":"var(--text-muted)";return l.jsxs(W.Fragment,{children:[r>0&&l.jsx("div",{className:"w-4 h-0.5",style:{background:s}}),l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("div",{className:`w-3 h-3 rounded-full${t.state==="active"?" station-active":""}`,style:{background:n}}),l.jsx("span",{className:"text-[7px] mt-0.5",style:{color:o,fontWeight:t.state==="active"?500:400},children:t.label})]})]},t.id)})}):null}const I0={light:{stabilized:"#10b981",active:"#6366f1",queued:"#cbd5e1"},industrial:{stabilized:"#10b981",active:"#f59e0b",queued:"#334155"},blueprint:{stabilized:"#ffffff",active:"#fbbf24",queued:"#d4e8f8"}},YN=(e,t)=>{var r;return((r=I0[t])==null?void 0:r[e])||I0.industrial.queued},ir={EPICS_PER_ROW:3,EPIC_WIDTH:220,EPIC_HEIGHT:70,EPIC_GAP_X:50,EPIC_GAP_Y:100,EPIC_OFFSET_X:80,EPIC_OFFSET_Y:80},li={GAP:8,WIDTH:280},Eu=["pgc","asm","draft","qa","done"],bn=["industrial","light","blueprint"];function WP({questions:e,nodeWidth:t,onSubmit:r,onClose:n,onZoomComplete:s}){const[o,i]=m.useState({}),a=e.filter(c=>c.required).every(c=>o[c.id]);return m.useEffect(()=>{if(s){const c=setTimeout(()=>s(),150);return()=>clearTimeout(c)}},[s]),l.jsxs("div",{className:"absolute top-0 border border-amber-500/50 rounded-lg shadow-2xl tray-slide",style:{left:t+li.GAP,width:li.WIDTH,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[l.jsx("div",{className:"absolute border-t-2 border-dashed border-amber-500/60",style:{top:14,right:"100%",width:li.GAP}}),l.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-amber-500",style:{top:11,right:"100%",marginRight:-4}}),l.jsxs("div",{className:"bg-amber-500/10 border-b border-amber-500/30 px-3 py-2 flex justify-between items-center",children:[l.jsx("span",{className:"text-[9px] font-semibold text-amber-600 uppercase tracking-wide",children:"Operator Input Required"}),l.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),l.jsx("div",{className:"p-3 space-y-3 max-h-64 overflow-y-auto",children:e.map(c=>l.jsxs("div",{children:[l.jsxs("label",{className:"block text-[10px] mb-1",style:{color:"var(--text-sidecar-muted)"},children:[c.text," ",c.required&&l.jsx("span",{className:"text-amber-600",children:"*"})]}),l.jsx("input",{type:"text",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-sidecar)"},value:o[c.id]||"",onChange:u=>i(d=>({...d,[c.id]:u.target.value}))})]},c.id))}),l.jsx("div",{className:"p-3",style:{borderTop:"1px solid var(--border-node)"},children:l.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${a?"bg-amber-500 text-slate-900 hover:bg-amber-400":"subway-button cursor-not-allowed"}`,disabled:!a,onClick:()=>r(o),children:"Submit & Continue"})})]})}function VP({features:e,epicName:t,nodeWidth:r,onClose:n,onZoomComplete:s}){const o=e.length>6,i=o?240:320;return m.useEffect(()=>{if(s){const a=setTimeout(()=>s(),150);return()=>clearTimeout(a)}},[s]),l.jsxs("div",{className:"absolute top-0 border border-indigo-500/50 rounded-lg shadow-2xl tray-slide",style:{left:r+li.GAP,width:i,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)"},children:[l.jsx("div",{className:"absolute border-t-2 border-dashed border-indigo-500/60",style:{top:14,right:"100%",width:li.GAP}}),l.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-indigo-500",style:{top:11,right:"100%",marginRight:-4}}),l.jsxs("div",{className:"bg-indigo-500/10 border-b border-indigo-500/30 px-3 py-2 flex justify-between items-center",children:[l.jsxs("span",{className:"text-[9px] font-semibold uppercase tracking-wide",style:{color:"var(--text-sidecar-muted)"},children:["Features - ",t]}),l.jsx("button",{onClick:n,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),l.jsx("div",{className:`p-3 max-h-64 overflow-y-auto ${o?"":"grid grid-cols-2 gap-2"}`,children:e.map(a=>{const c=a.state==="complete"?"var(--state-stabilized-bg)":a.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)";return l.jsxs("div",{className:`flex items-center gap-2 p-1.5 rounded cursor-pointer hover:opacity-80 ${o?"mb-1":""}`,children:[l.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:c}}),l.jsx("span",{className:"text-[10px] truncate",style:{color:"var(--text-sidecar)"},children:a.name})]},a.id)})}),l.jsxs("div",{className:"px-3 py-2 text-[9px]",style:{borderTop:"1px solid var(--border-node)",color:"var(--text-sidecar-muted)"},children:[e.length," features"]})]})}const rx="/api/v1";class UP extends Error{constructor(t,r,n){super(t),this.name="ApiError",this.status=r,this.data=n}}function GP(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function ye(e,t={}){const r=`${rx}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t},s=await fetch(r,n);if(!s.ok){const o=await s.json().catch(()=>({}));throw new UP(o.detail||`Request failed: ${s.status}`,s.status,o)}return s.status===204?null:s.json()}const Ie={getMe:()=>fetch("/api/me",{credentials:"same-origin"}).then(e=>{if(e.status===401)return null;if(!e.ok)throw new Error(`Request failed: ${e.status}`);return e.json()}).catch(e=>(console.error("Auth check failed:",e),null)),logout:()=>fetch("/auth/logout",{method:"POST",credentials:"same-origin",headers:{"X-CSRF-Token":GP()||""}}),getProjects:(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.includeArchived&&t.set("include_archived","true");const r=t.toString();return ye(`/projects${r?"?"+r:""}`)},getProject:e=>ye(`/projects/${e}`),getProjectTree:e=>ye(`/projects/${e}/tree`),createProject:e=>ye("/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>ye(`/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),archiveProject:e=>ye(`/projects/${e}/archive`,{method:"POST"}),unarchiveProject:e=>ye(`/projects/${e}/unarchive`,{method:"POST"}),deleteProject:e=>ye(`/projects/${e}`,{method:"DELETE"}),getProductionStatus:e=>ye(`/production/status?project_id=${e}`),startProduction:(e,t=null)=>{const r=new URLSearchParams({project_id:e});return t&&r.set("document_type",t),ye(`/production/start?${r}`,{method:"POST"})},getProjectInterrupts:e=>ye(`/projects/${e}/interrupts`),resolveInterrupt:(e,t)=>ye(`/interrupts/${e}/resolve`,{method:"POST",body:JSON.stringify(t)}),startWorkflow:(e,t,r=null)=>ye("/document-workflows/start",{method:"POST",body:JSON.stringify({project_id:e,document_type:t,initial_context:r})}),submitWorkflowInput:(e,t,r=null)=>ye(`/document-workflows/executions/${e}/input`,{method:"POST",body:JSON.stringify({user_input:t,selected_option_id:r})}),getExecutionStatus:e=>ye(`/document-workflows/executions/${e}`),getPgcAnswers:e=>ye(`/document-workflows/executions/${e}/pgc-answers`),getDocument:(e,t)=>ye(`/projects/${e}/documents/${t}`),getDocumentRenderModel:(e,t)=>ye(`/projects/${e}/documents/${t}/render-model`),startIntake:()=>ye("/intake/start",{method:"POST"}),getIntakeState:e=>ye(`/intake/${e}`),submitIntakeMessage:(e,t)=>ye(`/intake/${e}/message`,{method:"POST",body:JSON.stringify({content:t})}),updateIntakeField:(e,t,r)=>ye(`/intake/${e}/field/${t}`,{method:"PATCH",body:JSON.stringify({value:r})}),initializeIntake:e=>ye(`/intake/${e}/initialize`,{method:"POST"}),getWorkflowInstance:e=>ye(`/projects/${e}/workflow`),createWorkflowInstance:(e,t,r)=>ye(`/projects/${e}/workflow`,{method:"POST",body:JSON.stringify({workflow_id:t,version:r})}),updateWorkflowInstance:(e,t)=>ye(`/projects/${e}/workflow`,{method:"PUT",body:JSON.stringify({effective_workflow:t})}),getWorkflowDrift:e=>ye(`/projects/${e}/workflow/drift`),getWorkflowHistory:(e,t=50,r=0)=>ye(`/projects/${e}/workflow/history?limit=${t}&offset=${r}`),completeWorkflowInstance:e=>ye(`/projects/${e}/workflow/complete`,{method:"POST"})};function KP(e){const t=`${rx}/production/events?project_id=${e}`;return new EventSource(t)}function YP(e){const t=`${rx}/intake/${e}/events`;return new EventSource(t)}function XP(e){return`/auth/login/${e}`}function QP({block:e}){const{data:t}=e,r=t.content||t.value||"";return r?l.jsxs("div",{style:{marginBottom:12},children:[l.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:r}),t.detail_ref&&l.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none",marginTop:4,display:"inline-block"},children:"View details "})]}):null}function M0({block:e}){const{data:t}=e,r=t.items||[],n=t.style||"bullet";if(r.length===0)return null;const s=n==="numbered"?"decimal":"disc";return l.jsxs("div",{style:{marginBottom:12},children:[t.title&&l.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:t.title}),l.jsx("ul",{style:{margin:0,paddingLeft:n==="check"?0:20,listStyle:n==="check"?"none":s},children:r.map((o,i)=>l.jsxs("li",{style:{fontSize:14,lineHeight:1.6,color:"#374151",marginBottom:4,display:n==="check"?"flex":"list-item",alignItems:"flex-start",gap:8},children:[n==="check"&&l.jsx("span",{style:{color:"#10b981"},children:""}),typeof o=="string"?o:(o==null?void 0:o.value)||(o==null?void 0:o.text)||(o==null?void 0:o.question)||(o==null?void 0:o.description)||JSON.stringify(o)]},i))})]})}function ZP({block:e}){const{data:t}=e,r=t.value||"unknown",n=t.label,o={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"},critical:{bg:"#fecaca",text:"#7f1d1d"},none:{bg:"#e5e7eb",text:"#374151"},external:{bg:"#dbeafe",text:"#1e40af"},qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"}}[r.toLowerCase()]||{bg:"#f3f4f6",text:"#374151"};return l.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginBottom:12},children:[n&&l.jsxs("span",{style:{fontSize:12,color:"#6b7280",fontWeight:500},children:[n,":"]}),l.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:20,background:o.bg,color:o.text,fontSize:12,fontWeight:500,textTransform:"capitalize"},children:r})]})}function XN({block:e}){const{data:t}=e,{id:r,text:n,blocking:s,why_it_matters:o,priority:i,tags:a,options:c}=t,u={must:{bg:"#fee2e2",text:"#991b1b"},should:{bg:"#fef3c7",text:"#92400e"},could:{bg:"#e5e7eb",text:"#374151"}},d=u[i]||u.should;return l.jsx("div",{style:{padding:"12px 16px",background:s?"#fef2f2":"#f8fafc",borderRadius:8,border:`1px solid ${s?"#fecaca":"#e2e8f0"}`,marginBottom:12},children:l.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[l.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6b7280",background:"#e5e7eb",padding:"2px 6px",borderRadius:4,flexShrink:0},children:r}),l.jsxs("div",{style:{flex:1},children:[l.jsx("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"#111827",marginBottom:6},children:n}),o&&l.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",fontStyle:"italic"},children:o}),l.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[s&&l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#fee2e2",color:"#991b1b",fontWeight:600},children:"BLOCKING"}),i&&l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:d.bg,color:d.text,textTransform:"uppercase"},children:i}),a==null?void 0:a.map((f,p)=>l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:f},p))]}),c&&c.length>0&&l.jsxs("div",{style:{marginTop:8},children:[l.jsx("span",{style:{fontSize:11,color:"#6b7280"},children:"Options: "}),c.map((f,p)=>l.jsx("span",{style:{fontSize:11,color:"#374151",marginLeft:p>0?8:4},children:f},p))]})]})]})})}function JP({block:e}){const{data:t}=e,r=t.items||[],n=t.total_count||r.length,s=t.blocking_count||r.filter(o=>o.blocking).length;return r.length===0?l.jsx("div",{style:{padding:"16px",background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0",textAlign:"center",color:"#166534",fontSize:14},children:"No open questions"}):l.jsxs("div",{children:[l.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12,padding:"8px 12px",background:"#f8fafc",borderRadius:6,fontSize:12},children:[l.jsxs("span",{style:{color:"#6b7280"},children:[l.jsx("strong",{style:{color:"#374151"},children:n})," questions"]}),s>0&&l.jsxs("span",{style:{color:"#dc2626"},children:[l.jsx("strong",{children:s})," blocking"]})]}),r.map((o,i)=>l.jsx(XN,{block:{type:"schema:OpenQuestionV1",data:o}},o.id||i))]})}function A0({block:e}){const{data:t}=e,r=t.items||[],n=t.title;if(r.length===0)return null;const s={low:{bg:"#d1fae5",text:"#065f46",border:"#a7f3d0"},medium:{bg:"#fef3c7",text:"#92400e",border:"#fde68a"},high:{bg:"#fee2e2",text:"#991b1b",border:"#fecaca"},critical:{bg:"#fecaca",text:"#7f1d1d",border:"#f87171"}};return l.jsxs("div",{style:{marginBottom:12},children:[n&&l.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:n}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((o,i)=>{const a=o.severity||o.likelihood||"medium",c=s[a]||s.medium;return l.jsx("div",{style:{padding:"10px 14px",background:c.bg,borderRadius:6,border:`1px solid ${c.border}`},children:l.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10},children:[o.id&&l.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:c.text,background:"rgba(255,255,255,0.5)",padding:"2px 6px",borderRadius:4,flexShrink:0},children:o.id}),l.jsxs("div",{style:{flex:1},children:[l.jsx("p",{style:{margin:0,fontSize:13,color:c.text,fontWeight:500},children:o.description||o.reason||JSON.stringify(o)}),o.impact&&l.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Impact: ",o.impact]}),o.mitigation&&l.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Mitigation: ",o.mitigation]})]}),l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"rgba(255,255,255,0.5)",color:c.text,textTransform:"uppercase",fontWeight:600},children:a})]})},o.id||i)})})]})}function e6({block:e}){const{data:t}=e,n=Object.entries({problem_understanding:"Problem Understanding",architectural_intent:"Architectural Intent",scope_pressure_points:"Scope Pressure Points",proposed_system_shape:"Proposed System Shape",overall_intent:"Overall Intent",mvp_definition:"MVP Definition"}).filter(([s])=>t[s]&&typeof t[s]=="string").map(([s,o])=>({title:o,content:t[s]}));return n.length===0?null:l.jsx("div",{style:{marginBottom:12},children:n.map((s,o)=>l.jsxs("div",{style:{marginBottom:o<n.length-1?16:0},children:[l.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:s.title}),l.jsx("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,borderLeft:"3px solid #6366f1"},children:l.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:s.content})})]},o))})}function P0({block:e}){const{data:t}=e,{epic_id:r,title:n,name:s,intent:o,phase:i,mvp_phase:a,risk_level:c,stories:u,detail_ref:d}=t,f=i||a,p=n||s,h={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}},y=h[c]||h.medium,v={mvp:{bg:"#dbeafe",text:"#1e40af"},"later-phase":{bg:"#e5e7eb",text:"#374151"},later:{bg:"#e5e7eb",text:"#374151"}},w=v[f]||v.mvp;return l.jsxs("div",{style:{padding:"14px 16px",background:"#ffffff",borderRadius:8,border:"1px solid #e2e8f0",marginBottom:12,boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[l.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12},children:[l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[r&&l.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6366f1",background:"#eef2ff",padding:"2px 6px",borderRadius:4},children:r}),l.jsx("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"#111827"},children:p})]}),o&&l.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:o}),u&&u.length>0&&l.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:[u.length," stories"]})]}),l.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,alignItems:"flex-end"},children:[f&&l.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:w.bg,color:w.text,textTransform:"uppercase",fontWeight:500},children:f==="later-phase"?"LATER":f}),c&&l.jsxs("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:y.bg,color:y.text,textTransform:"uppercase",fontWeight:500},children:[c," risk"]})]})]}),d&&l.jsx("div",{style:{marginTop:10,paddingTop:10,borderTop:"1px solid #f3f4f6"},children:l.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none"},children:"View epic details "})})]})}function t6({block:e}){const{data:t}=e,{story_id:r,title:n,intent:s,phase:o,risk_level:i,detail_ref:a}=t,u={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}}[i]||null,d={mvp:{bg:"#dbeafe",text:"#1e40af"},later:{bg:"#e5e7eb",text:"#374151"}},f=d[o]||d.mvp;return l.jsx("div",{style:{padding:"10px 14px",background:"#fafafa",borderRadius:6,border:"1px solid #e5e7eb",marginBottom:8},children:l.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:10},children:[l.jsxs("div",{style:{flex:1},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[r&&l.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#059669",background:"#ecfdf5",padding:"1px 5px",borderRadius:3},children:r}),l.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:n})]}),s&&l.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",lineHeight:1.4},children:s})]}),l.jsxs("div",{style:{display:"flex",gap:4},children:[o&&l.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:f.bg,color:f.text,textTransform:"uppercase",fontWeight:500},children:o}),u&&l.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:u.bg,color:u.text,textTransform:"uppercase",fontWeight:500},children:i})]})]})})}function r6({block:e}){const{type:t,data:r}=e;return l.jsxs("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,border:"1px solid #e2e8f0",marginBottom:12},children:[l.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginBottom:8,fontFamily:"monospace"},children:t}),l.jsx("pre",{style:{fontSize:12,color:"#475569",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(r,null,2)})]})}function n6({block:e}){const{data:t}=e,r=t.items||[],[n,s]=m.useState({});if(r.length===0)return null;const o=i=>{s(a=>({...a,[i]:!a[i]}))};return l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:r.map((i,a)=>{const c=n[a],u=i.why_it_matters||i.impact_if_unresolved;return l.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fef08a",borderRadius:6,borderLeft:"3px solid #eab308",overflow:"hidden"},children:[l.jsxs("button",{onClick:()=>u&&o(a),style:{width:"100%",padding:"10px 12px",background:"transparent",border:"none",cursor:u?"pointer":"default",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8,textAlign:"left"},children:[l.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#854d0e",lineHeight:1.4},children:i.question||i.value||i.text||"Unknown"}),u&&l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"#a16207",strokeWidth:"2",style:{flexShrink:0,marginTop:2,transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s"},children:l.jsx("path",{d:"M3 5l4 4 4-4"})})]}),c&&u&&l.jsxs("div",{style:{padding:"0 12px 12px",borderTop:"1px solid #fde68a",marginTop:0},children:[i.why_it_matters&&l.jsxs("div",{style:{marginTop:10},children:[l.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Why it matters"}),l.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:i.why_it_matters})]}),i.impact_if_unresolved&&l.jsxs("div",{style:{marginTop:10},children:[l.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Impact if unresolved"}),l.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:i.impact_if_unresolved})]})]})]},a)})})}function s6({block:e}){const{data:t}=e,{description:r,user_statement:n}=t;return l.jsxs("div",{style:{marginBottom:12},children:[r&&l.jsx("div",{style:{paddingLeft:16,borderLeft:"4px solid #8b5cf6",color:"#374151",marginBottom:16,fontSize:14,lineHeight:1.6},children:r}),n&&l.jsxs("blockquote",{style:{paddingLeft:16,borderLeft:"4px solid #d1d5db",color:"#6b7280",fontStyle:"italic",margin:0,fontSize:13,lineHeight:1.5},children:['"',n,'"']})]})}function o6({block:e}){const{data:t}=e,{category:r,confidence:n,rationale:s}=t;return l.jsxs("div",{style:{marginBottom:12},children:[l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[l.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:"#ede9fe",color:"#6d28d9"},children:r}),n&&l.jsxs("span",{style:{fontSize:13,color:"#6b7280"},children:["Confidence: ",n]})]}),s&&l.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:s})]})}function i6({block:e}){const{data:t}=e,{explicit:r=[],inferred:n=[]}=t,s=r&&r.length>0,o=n&&n.length>0;return!s&&!o?null:l.jsxs("div",{style:{marginBottom:12},children:[s&&l.jsxs("div",{style:{marginBottom:o?16:0},children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Explicit"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((i,a)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#f59e0b"},children:""}),l.jsx("span",{children:i})]},a))})]}),o&&l.jsxs("div",{children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Inferred"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((i,a)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#3b82f6"},children:""}),l.jsx("span",{children:i})]},a))})]})]})}function a6({block:e}){const{data:t}=e,{questions:r=[],missing_context:n=[],assumptions_made:s=[]}=t,o=r&&r.length>0,i=n&&n.length>0,a=s&&s.length>0;return!o&&!i&&!a?null:l.jsxs("div",{style:{marginBottom:12},children:[o&&l.jsxs("div",{style:{marginBottom:i||a?16:0},children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Questions"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((c,u)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#3b82f6"},children:""}),l.jsx("span",{children:c})]},u))})]}),i&&l.jsxs("div",{style:{marginBottom:a?16:0},children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Missing Context"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((c,u)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#f59e0b"},children:""}),l.jsx("span",{children:c})]},u))})]}),a&&l.jsxs("div",{children:[l.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Assumptions"}),l.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:s.map((c,u)=>l.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[l.jsx("span",{style:{color:"#6b7280"},children:""}),l.jsx("span",{children:c})]},u))})]})]})}function l6({block:e}){const{data:t}=e,{status:r,rationale:n,next_action:s}=t,i={qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"},out_of_scope:{bg:"#fee2e2",text:"#991b1b"},redirect:{bg:"#e0e7ff",text:"#3730a3"}}[r]||{bg:"#f3f4f6",text:"#374151"};return l.jsxs("div",{style:{marginBottom:12},children:[r&&l.jsx("div",{style:{marginBottom:12},children:l.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:i.bg,color:i.text},children:r})}),n&&l.jsx("p",{style:{margin:0,marginBottom:s?12:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:n}),s&&l.jsx("div",{style:{padding:12,borderRadius:8,background:"#ecfdf5",border:"1px solid #a7f3d0"},children:l.jsxs("span",{style:{fontSize:13,fontWeight:500,color:"#065f46"},children:["Next: ",s]})})]})}const c6={"schema:ParagraphBlockV1":QP,"schema:StringListBlockV1":M0,"schema:IndicatorBlockV1":ZP,"schema:OpenQuestionV1":XN,"schema:OpenQuestionsBlockV1":JP,"schema:RisksBlockV1":A0,"schema:DependenciesBlockV1":A0,"schema:SummaryBlockV1":e6,"schema:EpicSummaryBlockV1":P0,"schema:StorySummaryBlockV1":t6,"schema:EpicStoriesCardBlockV1":P0,"schema:StoriesBlockV1":M0,"schema:UnknownsBlockV1":n6,"schema:IntakeSummaryBlockV1":s6,"schema:IntakeProjectTypeBlockV1":o6,"schema:IntakeConstraintsBlockV1":i6,"schema:IntakeOpenGapsBlockV1":a6,"schema:IntakeOutcomeBlockV1":l6};function u6(e){return c6[e]||r6}function d6(e,t){const r=u6(e.type);return l.jsx(r,{block:e},e.key||t)}function QN({renderModel:e,variant:t="full",hideHeader:r=!1,onSectionClick:n,className:s=""}){var w;const[o,i]=m.useState(new Set(((w=e==null?void 0:e.sections)==null?void 0:w.map(g=>g.section_id))||[]));if(!e)return l.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280"},children:"No render model available"});const{title:a,subtitle:c,sections:u=[],metadata:d}=e;if(d!=null&&d.fallback&&e.raw_content)return l.jsx(p6,{title:a,content:e.raw_content,reason:d.reason});const f=g=>{i(x=>{const b=new Set(x);return b.has(g)?b.delete(g):b.add(g),b})},p=t==="compact"||t==="sidecar",y=t==="sidecar"?u.filter(g=>g.viewer_tab==="overview"||!g.viewer_tab):u,v=(()=>{if(!a)return"Document";const g=a.indexOf(": ");return g>-1?a.slice(g+2):a})();return l.jsxs("div",{className:s,children:[t==="full"&&!r&&l.jsxs("div",{style:{marginBottom:24},children:[l.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:v}),c&&l.jsx("p",{style:{margin:"8px 0 0",fontSize:14,color:"#6b7280"},children:c})]}),l.jsx("div",{style:{display:"flex",flexDirection:"column",gap:p?12:20},children:y.map(g=>l.jsx(f6,{section:g,isExpanded:o.has(g.section_id),onToggle:()=>f(g.section_id),onClick:()=>n==null?void 0:n(g),variant:t},g.section_id))}),y.length===0&&l.jsx("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",background:"#f9fafb",borderRadius:8},children:"No content sections available"})]})}function f6({section:e,isExpanded:t,onToggle:r,onClick:n,variant:s}){const{section_id:o,title:i,description:a,blocks:c=[],sidecar_max_items:u}=e,d=s==="compact"||s==="sidecar",f=s==="sidecar";if(c.length===0)return null;const p=f&&u&&c.length>u?c.slice(0,u):c,h=f&&u&&c.length>u;return l.jsxs("div",{style:{background:"#ffffff",borderRadius:8,border:"1px solid #e5e7eb",overflow:"hidden"},children:[l.jsxs("button",{onClick:r,style:{width:"100%",padding:d?"10px 14px":"14px 18px",background:"#f9fafb",border:"none",borderBottom:t?"1px solid #e5e7eb":"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"left"},children:[l.jsxs("div",{children:[l.jsxs("h3",{style:{margin:0,fontSize:d?13:15,fontWeight:600,color:"#111827"},children:[i,h&&l.jsxs("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6},children:["(showing ",u," of ",c.length,")"]})]}),a&&!d&&l.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:a})]}),l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"#9ca3af",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:l.jsx("path",{d:"M4 6l4 4 4-4"})})]}),t&&l.jsxs("div",{style:{padding:d?12:18},children:[p.map((y,v)=>d6(y,v)),h&&l.jsxs("div",{style:{marginTop:8,padding:"8px 12px",background:"#f3f4f6",borderRadius:4,fontSize:12,color:"#6b7280",textAlign:"center"},children:["+",c.length-u," more in full view"]})]})]})}function p6({title:e,content:t,reason:r}){return l.jsxs("div",{children:[l.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:["Displaying raw content (reason: ",r||"unknown",")"]}),l.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:l.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})}function h6({renderModel:e,projectCode:t,documentName:r,isExpanded:n,onToggleExpand:s,onClose:o,onViewFull:i,nodeWidth:a=280}){const p=n?900:520,h=n?900:600,y=`${t||"DOC"} - ${r||"Document"}`,v=w=>{w.stopPropagation()};return l.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:a+30,width:p,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:v,onPointerDown:v,children:[l.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),l.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),l.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:h,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[l.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"STABILIZED DOCUMENT"}),l.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:(()=>{const w=(e==null?void 0:e.title)||"DOCUMENT",g=w.indexOf(": ");return(g>-1?w.slice(g+2):w).toUpperCase()})()}),l.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:y})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:s,title:n?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:n?l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),l.jsx("button",{onClick:o,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),l.jsx("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:n?600:400},children:l.jsx(QN,{renderModel:e,variant:"sidecar"})}),l.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:l.jsxs("button",{onClick:i,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[l.jsx("span",{children:"View Full Document"}),l.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}function m6({document:e,projectId:t,projectCode:r,nodeWidth:n,onClose:s,onZoomComplete:o,onViewFull:i}){const[a,c]=m.useState(null),[u,d]=m.useState(null),[f,p]=m.useState(!0),[h,y]=m.useState(!1);return m.useEffect(()=>{if(o){const v=setTimeout(()=>o(),150);return()=>clearTimeout(v)}},[o]),m.useEffect(()=>{async function v(){var w;if(!t||!e.id){p(!1);return}try{p(!0);try{const x=await Ie.getDocumentRenderModel(t,e.id);if(x&&x.sections&&x.sections.length>0){c(x),d(null);return}if((w=x==null?void 0:x.metadata)!=null&&w.fallback&&x.raw_content){c(null),d(x.raw_content);return}}catch(x){console.log("RenderModel not available, falling back to raw document:",x.message)}const g=await Ie.getDocument(t,e.id);c(null),d((g==null?void 0:g.content)||null)}catch(g){console.error("Failed to fetch document for sidecar:",g)}finally{p(!1)}}v()},[t,e.id]),f?null:a?l.jsx(h6,{renderModel:a,projectCode:r,documentName:e.name,isExpanded:h,onToggleExpand:()=>y(!h),onClose:s,onViewFull:()=>i==null?void 0:i(e.id),nodeWidth:n}):l.jsx(g6,{document:e,projectCode:r,rawContent:u,nodeWidth:n,isExpanded:h,onToggleExpand:()=>y(!h),onClose:s,onViewFull:()=>i==null?void 0:i(e.id)})}function g6({document:e,projectCode:t,rawContent:r,nodeWidth:n,isExpanded:s,onToggleExpand:o,onClose:i,onViewFull:a}){var w;const p=s?900:520,h=s?900:600,y=`${t||"DOC"} - ${e.name||"Document"}`,v=g=>{g.stopPropagation()};return l.jsxs("div",{className:"absolute top-0 tray-slide",style:{left:n+30,width:p,zIndex:1e3,transition:"width 0.2s ease"},onMouseDown:v,onPointerDown:v,children:[l.jsx("div",{className:"absolute",style:{top:40,right:"100%",width:30,height:3,background:"#10b981"}}),l.jsx("div",{className:"absolute rounded-full",style:{top:36,right:"100%",marginRight:26,width:10,height:10,background:"#10b981"}}),l.jsxs("div",{style:{background:"#ffffff",borderRadius:2,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.5)",minHeight:h,transition:"min-height 0.2s ease",display:"flex",flexDirection:"column"},children:[l.jsx("div",{style:{padding:"24px 32px 16px",borderBottom:"2px solid #10b981",background:"linear-gradient(to bottom, #ffffff, #fafafa)"},children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("div",{style:{fontSize:10,letterSpacing:"0.15em",color:"#10b981",fontWeight:600,marginBottom:4},children:"PRODUCED DOCUMENT"}),l.jsx("h1",{style:{fontSize:20,fontFamily:"Georgia, serif",fontWeight:700,color:"#1a1a1a",margin:0},children:((w=e.name)==null?void 0:w.toUpperCase())||"DOCUMENT"}),l.jsx("div",{style:{fontSize:11,color:"#666",marginTop:4,fontFamily:"monospace"},children:y})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:o,title:s?"Contract":"Expand",style:{color:"#666",fontSize:16,lineHeight:1,padding:6,background:"none",border:"1px solid #e5e5e5",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:s?l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),l.jsx("button",{onClick:i,title:"Close",style:{color:"#999",fontSize:24,lineHeight:1,padding:4,background:"none",border:"none",cursor:"pointer"},children:""})]})]})}),l.jsxs("div",{style:{flex:1,padding:"16px 24px",overflowY:"auto",maxHeight:s?600:400},children:[l.jsx("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:"No view definition configured - displaying raw content"}),l.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:l.jsx("pre",{style:{margin:0,fontSize:11,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.5},children:JSON.stringify(r,null,2)})})]}),l.jsx("div",{style:{padding:"16px 32px 24px",borderTop:"1px solid #e5e5e5",background:"#fafafa"},children:l.jsxs("button",{onClick:a,style:{width:"100%",padding:"10px 16px",background:"#10b981",color:"white",border:"none",borderRadius:4,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[l.jsx("span",{children:"View Full Document"}),l.jsx("span",{style:{fontSize:14},children:""})]})})]})]})}const v6={produced:"Produced",in_production:"In Production",ready_for_production:"Ready",requirements_not_met:"Requirements Not Met",awaiting_operator:"Awaiting Operator",halted:"Halted",stabilized:"Produced",active:"In Production",queued:"Ready",blocked:"Requirements Not Met",ready:"Produced",waiting:"Ready"};function x6({data:e}){var _,S,k;const r=(e.level||1)===1,n=e.isExpanded,s=e.expandType,o=((_=e.questions)==null?void 0:_.length)>0,i=((S=e.features)==null?void 0:S.length)>0,a=(k=e.stations)==null?void 0:k.some(N=>N.needs_input),c=e.state||"ready_for_production",u=["produced","stabilized","ready"].includes(c),d=["in_production","active"].includes(c),f=["requirements_not_met","blocked"].includes(c),p=d&&e.stations,h=d?"node-active":"",y=r?"DOCUMENT":"EPIC",v=r?"subway-node-header-doc":"subway-node-header-epic",w=u?"var(--state-produced-bg, var(--state-stabilized-bg))":d?"var(--state-in-production-bg, var(--state-active-bg))":f?"var(--state-requirements-not-met-bg, var(--state-blocked-bg, var(--state-queued-bg)))":"var(--state-ready-bg, var(--state-queued-bg))",g=u?"var(--state-produced-text, var(--state-stabilized-text))":d?"var(--state-in-production-text, var(--state-active-text))":f?"var(--state-requirements-not-met-text, var(--state-blocked-text, var(--state-queued-text)))":"var(--state-ready-text, var(--state-queued-text))",x=d?"var(--state-in-production-bg, var(--state-active-bg))":u?"var(--state-produced-bg, var(--state-stabilized-bg))":"var(--border-node)",b=v6[c]||c;return l.jsxs("div",{className:"relative",children:[l.jsx(Ir,{type:"target",position:J.Top,className:"!opacity-0",style:{left:"15%"}}),l.jsxs("div",{className:`subway-node rounded-lg border ${h} overflow-hidden`,style:{width:e.width,minHeight:e.height,borderColor:x},children:[l.jsxs("div",{className:`${v} border-b px-3 py-1.5 flex items-center justify-between`,children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wider",style:{color:r?"var(--header-text-doc)":"var(--header-text-epic)"},children:y}),l.jsx("span",{className:"text-[10px] font-medium",style:{color:"var(--text-primary)"},children:e.name})]}),e.intent==="optional"&&l.jsx("span",{className:"subway-button text-[8px] px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),l.jsxs("div",{className:"p-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"rounded-full flex-shrink-0",style:{width:r?24:18,height:r?24:18,backgroundColor:w}}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide",style:{color:g},children:b}),r&&e.desc&&l.jsx("p",{className:"text-[9px] mt-0.5 truncate",style:{color:"var(--text-muted)"},children:e.desc})]})]}),p&&l.jsx(HP,{stations:e.stations}),l.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[r&&u&&l.jsx("button",{className:"px-2 py-1 bg-emerald-500/20 rounded text-[9px] hover:bg-emerald-500/30 transition-colors",style:{color:"var(--action-success)"},onClick:N=>{var j;N.stopPropagation(),(j=e.onExpand)==null||j.call(e,e.id,"document")},children:"View Document"}),a&&o&&!n&&l.jsx("button",{className:"px-2 py-1 bg-amber-500/20 rounded text-[9px] hover:bg-amber-500/30 transition-colors amber-pulse",style:{color:"var(--action-warning)"},onClick:N=>{var j;N.stopPropagation(),(j=e.onExpand)==null||j.call(e,e.id,"questions")},children:"Answer Questions"}),!r&&i&&(n&&s==="features"?l.jsxs("span",{className:"text-[9px] text-indigo-400",children:[e.features.length," features expanded"]}):l.jsxs("button",{className:"subway-button px-2 py-1 rounded text-[9px] transition-colors flex items-center gap-1",onClick:N=>{var j;N.stopPropagation(),(j=e.onExpand)==null||j.call(e,e.id,"features")},children:[l.jsx("span",{className:"text-indigo-400",children:e.features.length}),l.jsx("span",{children:"features"}),l.jsx("span",{className:"text-indigo-400",children:""})]}))]})]})]}),n&&s==="questions"&&o&&l.jsx(WP,{questions:e.questions,nodeWidth:e.width,onSubmit:N=>{var j;return(j=e.onSubmitQuestions)==null?void 0:j.call(e,e.id,N)},onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)}}),n&&s==="features"&&i&&l.jsx(VP,{features:e.features,epicName:e.name,nodeWidth:e.width,onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)}}),n&&s==="document"&&r&&u&&l.jsx(m6,{document:e,projectId:e.projectId,projectCode:e.projectCode,nodeWidth:e.width,onClose:()=>{var N;return(N=e.onCollapse)==null?void 0:N.call(e)},onZoomComplete:()=>{var N;return(N=e.onZoomToNode)==null?void 0:N.call(e,e.id)},onViewFull:N=>{var j;return(j=e.onViewFullDocument)==null?void 0:j.call(e,N)}}),l.jsx(Ir,{type:"source",position:J.Bottom,className:"!opacity-0",style:{left:"15%"}})]})}function y6(){return l.jsxs("div",{style:{width:1,height:1,background:"transparent"},children:[l.jsx(Ir,{type:"target",position:J.Top,style:{opacity:0}}),l.jsx(Ir,{type:"source",position:J.Bottom,style:{opacity:0}})]})}function b6({projectId:e,projectCode:t,docTypeId:r,onClose:n}){const[s,o]=m.useState(null),[i,a]=m.useState(null),[c,u]=m.useState(!0),[d,f]=m.useState(null);return m.useEffect(()=>{async function p(){var h;try{u(!0),f(null);try{const v=await Ie.getDocumentRenderModel(e,r);if(v&&v.sections&&v.sections.length>0){o(v),a(null);return}if((h=v==null?void 0:v.metadata)!=null&&h.fallback&&v.raw_content){o(null),a(v.raw_content);return}}catch(v){console.log("RenderModel not available, falling back to raw document:",v.message)}const y=await Ie.getDocument(e,r);o(null),a((y==null?void 0:y.content)||null)}catch(y){f(y.message),console.error("Failed to fetch document:",y)}finally{u(!1)}}p()},[e,r]),m.useEffect(()=>{const p=h=>{h.key==="Escape"&&n()};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[n]),c?l.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},children:l.jsx("div",{style:{color:"white",fontSize:14},children:"Loading..."})}):l.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:p=>p.target===p.currentTarget&&n(),children:l.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-lg shadow-2xl",style:{background:"#ffffff"},children:[l.jsxs("div",{className:"sticky top-0 px-6 py-4 border-b flex items-center justify-between",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[l.jsx("div",{children:t&&l.jsx("div",{style:{display:"inline-block",padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em"},children:t})}),l.jsx("button",{onClick:n,className:"p-2 rounded-lg hover:bg-gray-200 transition-colors",children:l.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),l.jsxs("div",{className:"overflow-y-auto p-6",style:{maxHeight:"calc(90vh - 80px)"},children:[d&&l.jsx("div",{className:"text-center py-12",children:l.jsx("p",{className:"text-red-500",children:d})}),s&&l.jsx(QN,{renderModel:s,variant:"full"}),i&&!s&&l.jsx(w6,{content:i,docTypeId:r}),!s&&!i&&!d&&l.jsx("div",{className:"text-center py-12",children:l.jsx("p",{className:"text-gray-500",children:"No content available"})})]})]})})}function w6({content:e,docTypeId:t}){if(!e)return l.jsx("p",{className:"text-gray-500",children:"No content available"});const r=e.project_name||e.title||e.name,n=e.description||e.summary||e.preliminary_summary;return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:13,color:"#92400e"},children:["No view definition configured for ",l.jsx("strong",{children:t})," - displaying raw content"]}),(r||n)&&l.jsxs("div",{style:{padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[r&&l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r}),n&&l.jsx("p",{className:"text-gray-700 text-sm",children:n})]}),l.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},children:l.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.6},children:JSON.stringify(e,null,2)})})]})}const _6="/api/v1/admin";class S6 extends Error{constructor(t,r,n){super(t),this.name="AdminApiError",this.status=r,this.data=n,this.errorCode=n==null?void 0:n.error_code}}function j6(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Re(e,t={}){var o;const r=`${_6}${e}`,n={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t};if(t.method&&t.method!=="GET"){const i=j6();i&&(n.headers["X-CSRF-Token"]=i)}const s=await fetch(r,n);if(!s.ok){const i=await s.json().catch(()=>({})),a=((o=i.detail)==null?void 0:o.message)||i.detail||`Request failed: ${s.status}`;throw new S6(a,s.status,i.detail||i)}return s.status===204?null:s.json()}const Ne={getCurrentWorkspace:async()=>{try{return await Re("/workspaces/current")}catch(e){if(e.status===404&&e.errorCode==="NO_WORKSPACE")return null;throw e}},createWorkspace:()=>Re("/workspaces",{method:"POST"}),getWorkspaceState:e=>Re(`/workspaces/${e}/state`),closeWorkspace:(e,t=!1)=>Re(`/workspaces/${e}?force=${t}`,{method:"DELETE"}),getArtifact:(e,t)=>Re(`/workspaces/${e}/artifacts/${t}`),writeArtifact:(e,t,r)=>Re(`/workspaces/${e}/artifacts/${t}`,{method:"PUT",body:JSON.stringify({content:r})}),getPreview:(e,t,r="execution")=>Re(`/workspaces/${e}/preview/${t}?mode=${r}`),getDiff:(e,t=null)=>{const r=t?`?artifact_id=${encodeURIComponent(t)}`:"";return Re(`/workspaces/${e}/diff${r}`)},commit:(e,t)=>Re(`/workspaces/${e}/commit`,{method:"POST",body:JSON.stringify({message:t})}),discard:e=>Re(`/workspaces/${e}/discard`,{method:"POST"}),getDocumentTypes:()=>Re("/workbench/document-types"),getDocumentType:(e,t=null)=>{const r=t?`?version=${t}`:"";return Re(`/workbench/document-types/${e}${r}`)},getDocumentTypeVersions:e=>Re(`/workbench/document-types/${e}/versions`),getRoles:()=>Re("/workbench/roles"),getTemplates:()=>Re("/workbench/templates"),getRole:(e,t=null)=>{const r=t?`?version=${t}`:"";return Re(`/workbench/roles/${e}${r}`)},getTemplate:(e,t=null)=>{const r=t?`?version=${t}`:"";return Re(`/workbench/templates/${e}${r}`)},getWorkflows:()=>Re("/workbench/workflows"),getOrchestrationWorkflows:()=>Re("/workbench/orchestration-workflows"),getWorkflow:(e,t=null)=>{const r=t?`?version=${t}`:"";return Re(`/workbench/workflows/${e}${r}`)},createOrchestrationWorkflow:(e,t)=>Re(`/workspaces/${e}/orchestration-workflows`,{method:"POST",body:JSON.stringify(t)}),deleteOrchestrationWorkflow:(e,t)=>Re(`/workspaces/${e}/orchestration-workflows/${t}`,{method:"DELETE"}),getActiveReleases:()=>Re("/workbench/active-releases"),invalidateCache:()=>Re("/workbench/cache/invalidate",{method:"POST"})};function k6({projectId:e}){const[t,r]=m.useState(null),[n,s]=m.useState(!0),[o,i]=m.useState(null),[a,c]=m.useState(!1),[u,d]=m.useState([]),[f,p]=m.useState(!1),[h,y]=m.useState(!1),[v,w]=m.useState(null),[g,x]=m.useState(!1),[b,_]=m.useState(!1),S=m.useCallback(async()=>{if(e){s(!0),i(null);try{const L=await Ie.getWorkflowInstance(e);r(L)}catch(L){L.status===404?r(null):i(L.message)}finally{s(!1)}}},[e]);m.useEffect(()=>{S()},[S]);const k=async()=>{c(!0),p(!0);try{const L=await Ne.getOrchestrationWorkflows();d(L.workflows||[])}catch{d([])}finally{p(!1)}},N=async L=>{y(!0);try{const $=await Ie.createWorkflowInstance(e,L.workflow_id,L.active_version);r($),c(!1)}catch($){i($.message)}finally{y(!1)}},j=async()=>{if(t&&(_(!b),!v)){x(!0);try{const L=await Ie.getWorkflowDrift(e);w(L)}catch(L){w({error:L.message})}finally{x(!1)}}};if(n)return l.jsx("div",{className:"p-4 text-xs",style:{color:"var(--text-muted)"},children:"Loading workflow..."});if(o&&!t)return l.jsx("div",{className:"p-4 text-xs",style:{color:"var(--status-error, #ef4444)"},children:o});if(!t)return l.jsxs("div",{className:"p-4",children:[l.jsx("div",{className:"text-xs mb-3",style:{color:"var(--text-muted)"},children:"No workflow assigned to this project."}),a?l.jsx(N6,{workflows:u,loading:f,assigning:h,onSelect:N,onCancel:()=>c(!1)}):l.jsx("button",{onClick:k,className:"text-xs px-3 py-1.5 rounded font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",border:"none",cursor:"pointer"},children:"Assign Workflow"})]});const C=t.effective_workflow||{},R=C.steps||[],T=t.base_workflow_ref||{};return l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:C.name||T.workflow_id||"Workflow"}),l.jsx(E6,{status:t.status})]}),l.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["From ",T.workflow_id," v",T.version,T.pow_class?` (${T.pow_class})`:""]})]}),l.jsx("button",{onClick:j,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:"pointer"},children:g?"Checking...":b?"Hide Drift":"Check Drift"})]}),b&&v&&l.jsx(C6,{drift:v}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:["Steps (",R.length,")"]}),R.length===0?l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No steps defined"}):l.jsx("div",{className:"space-y-1",children:R.map((L,$)=>l.jsx(R6,{step:L,index:$},L.step_id||$))})]}),o&&l.jsx("div",{className:"text-xs",style:{color:"var(--status-error, #ef4444)"},children:o})]})}function N6({workflows:e,loading:t,assigning:r,onSelect:n,onCancel:s}){const o=e.filter(a=>(a.pow_class||"reference")==="reference"),i=e.filter(a=>a.pow_class==="template");return l.jsxs("div",{className:"rounded p-3 space-y-2",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--text-primary)"},children:"Select a workflow to assign:"}),t?l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Loading..."}):l.jsxs(l.Fragment,{children:[o.length>0&&l.jsxs("div",{children:[l.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Reference Workflows"}),o.map(a=>l.jsxs("button",{onClick:()=>n(a),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[l.jsx("div",{className:"font-medium",children:a.name||a.workflow_id}),l.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",a.active_version,"  ",a.step_count," steps"]})]},a.workflow_id))]}),i.length>0&&l.jsxs("div",{children:[l.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Template Workflows"}),i.map(a=>l.jsxs("button",{onClick:()=>n(a),disabled:r,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:r?"default":"pointer",opacity:r?.5:1},children:[l.jsx("div",{className:"font-medium",children:a.name||a.workflow_id}),l.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",a.active_version,"  ",a.step_count," steps",a.derived_from_label?`  from ${a.derived_from_label}`:""]})]},a.workflow_id))]}),o.length===0&&i.length===0&&l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No workflows available"})]}),l.jsx("button",{onClick:s,className:"text-xs px-2 py-1 hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:"Cancel"})]})}function E6({status:e}){const t={active:{bg:"var(--action-primary)",color:"#000"},completed:{bg:"#22c55e",color:"#000"},archived:{bg:"var(--text-muted)",color:"#000"}},r=t[e]||t.active;return l.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:r.bg,color:r.color},children:e})}function C6({drift:e}){return e.error?l.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--status-error, #ef4444)"},children:["Drift check failed: ",e.error]}):l.jsxs("div",{className:"text-xs p-2 rounded space-y-1",style:{background:"var(--bg-panel)",border:`1px solid ${e.is_drifted?"var(--status-warning, #f59e0b)":"var(--border-panel)"}`},children:[l.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[l.jsx("span",{style:{color:e.is_drifted?"var(--status-warning, #f59e0b)":"#22c55e"},children:e.is_drifted?"Drifted":"In Sync"}),l.jsxs("span",{style:{color:"var(--text-muted)"},children:["vs ",e.base_workflow_id," v",e.base_version]})]}),e.is_drifted&&l.jsxs("div",{style:{color:"var(--text-secondary)"},children:[e.steps_added.length>0&&l.jsxs("div",{children:["+ Steps added: ",e.steps_added.join(", ")]}),e.steps_removed.length>0&&l.jsxs("div",{children:["- Steps removed: ",e.steps_removed.join(", ")]}),e.steps_reordered&&l.jsx("div",{children:"~ Steps reordered"}),e.metadata_changed&&l.jsx("div",{children:"~ Metadata changed"})]})]})}function R6({step:e,index:t}){return l.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("span",{className:"font-mono font-semibold",style:{color:"var(--text-muted)",minWidth:20,textAlign:"right"},children:t+1}),l.jsxs("div",{style:{flex:1},children:[l.jsx("div",{style:{color:"var(--text-primary)"},children:e.step_id||`Step ${t+1}`}),e.produces&&l.jsxs("div",{style:{color:"var(--text-muted)"},children:["produces: ",e.produces]})]}),e.scope&&l.jsx("span",{className:"px-1 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-muted)",fontSize:10},children:e.scope})]})}function nx(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Cu,D0;function T6(){if(D0)return Cu;D0=1;function e(){this.__data__=[],this.size=0}return Cu=e,Cu}var Ru,O0;function ho(){if(O0)return Ru;O0=1;function e(t,r){return t===r||t!==t&&r!==r}return Ru=e,Ru}var Tu,L0;function vc(){if(L0)return Tu;L0=1;var e=ho();function t(r,n){for(var s=r.length;s--;)if(e(r[s][0],n))return s;return-1}return Tu=t,Tu}var Iu,z0;function I6(){if(z0)return Iu;z0=1;var e=vc(),t=Array.prototype,r=t.splice;function n(s){var o=this.__data__,i=e(o,s);if(i<0)return!1;var a=o.length-1;return i==a?o.pop():r.call(o,i,1),--this.size,!0}return Iu=n,Iu}var Mu,q0;function M6(){if(q0)return Mu;q0=1;var e=vc();function t(r){var n=this.__data__,s=e(n,r);return s<0?void 0:n[s][1]}return Mu=t,Mu}var Au,$0;function A6(){if($0)return Au;$0=1;var e=vc();function t(r){return e(this.__data__,r)>-1}return Au=t,Au}var Pu,F0;function P6(){if(F0)return Pu;F0=1;var e=vc();function t(r,n){var s=this.__data__,o=e(s,r);return o<0?(++this.size,s.push([r,n])):s[o][1]=n,this}return Pu=t,Pu}var Du,B0;function xc(){if(B0)return Du;B0=1;var e=T6(),t=I6(),r=M6(),n=A6(),s=P6();function o(i){var a=-1,c=i==null?0:i.length;for(this.clear();++a<c;){var u=i[a];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=s,Du=o,Du}var Ou,H0;function D6(){if(H0)return Ou;H0=1;var e=xc();function t(){this.__data__=new e,this.size=0}return Ou=t,Ou}var Lu,W0;function O6(){if(W0)return Lu;W0=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return Lu=e,Lu}var zu,V0;function L6(){if(V0)return zu;V0=1;function e(t){return this.__data__.get(t)}return zu=e,zu}var qu,U0;function z6(){if(U0)return qu;U0=1;function e(t){return this.__data__.has(t)}return qu=e,qu}var $u,G0;function ZN(){if(G0)return $u;G0=1;var e=typeof ra=="object"&&ra&&ra.Object===Object&&ra;return $u=e,$u}var Fu,K0;function vr(){if(K0)return Fu;K0=1;var e=ZN(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return Fu=r,Fu}var Bu,Y0;function mo(){if(Y0)return Bu;Y0=1;var e=vr(),t=e.Symbol;return Bu=t,Bu}var Hu,X0;function q6(){if(X0)return Hu;X0=1;var e=mo(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,s=e?e.toStringTag:void 0;function o(i){var a=r.call(i,s),c=i[s];try{i[s]=void 0;var u=!0}catch{}var d=n.call(i);return u&&(a?i[s]=c:delete i[s]),d}return Hu=o,Hu}var Wu,Q0;function $6(){if(Q0)return Wu;Q0=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return Wu=r,Wu}var Vu,Z0;function xs(){if(Z0)return Vu;Z0=1;var e=mo(),t=q6(),r=$6(),n="[object Null]",s="[object Undefined]",o=e?e.toStringTag:void 0;function i(a){return a==null?a===void 0?s:n:o&&o in Object(a)?t(a):r(a)}return Vu=i,Vu}var Uu,J0;function er(){if(J0)return Uu;J0=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Uu=e,Uu}var Gu,e1;function Ki(){if(e1)return Gu;e1=1;var e=xs(),t=er(),r="[object AsyncFunction]",n="[object Function]",s="[object GeneratorFunction]",o="[object Proxy]";function i(a){if(!t(a))return!1;var c=e(a);return c==n||c==s||c==r||c==o}return Gu=i,Gu}var Ku,t1;function F6(){if(t1)return Ku;t1=1;var e=vr(),t=e["__core-js_shared__"];return Ku=t,Ku}var Yu,r1;function B6(){if(r1)return Yu;r1=1;var e=F6(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return Yu=r,Yu}var Xu,n1;function JN(){if(n1)return Xu;n1=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return Xu=r,Xu}var Qu,s1;function H6(){if(s1)return Qu;s1=1;var e=Ki(),t=B6(),r=er(),n=JN(),s=/[\\^$.*+?()[\]{}|]/g,o=/^\[object .+?Constructor\]$/,i=Function.prototype,a=Object.prototype,c=i.toString,u=a.hasOwnProperty,d=RegExp("^"+c.call(u).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(p){if(!r(p)||t(p))return!1;var h=e(p)?d:o;return h.test(n(p))}return Qu=f,Qu}var Zu,o1;function W6(){if(o1)return Zu;o1=1;function e(t,r){return t==null?void 0:t[r]}return Zu=e,Zu}var Ju,i1;function ys(){if(i1)return Ju;i1=1;var e=H6(),t=W6();function r(n,s){var o=t(n,s);return e(o)?o:void 0}return Ju=r,Ju}var ed,a1;function sx(){if(a1)return ed;a1=1;var e=ys(),t=vr(),r=e(t,"Map");return ed=r,ed}var td,l1;function yc(){if(l1)return td;l1=1;var e=ys(),t=e(Object,"create");return td=t,td}var rd,c1;function V6(){if(c1)return rd;c1=1;var e=yc();function t(){this.__data__=e?e(null):{},this.size=0}return rd=t,rd}var nd,u1;function U6(){if(u1)return nd;u1=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return nd=e,nd}var sd,d1;function G6(){if(d1)return sd;d1=1;var e=yc(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function s(o){var i=this.__data__;if(e){var a=i[o];return a===t?void 0:a}return n.call(i,o)?i[o]:void 0}return sd=s,sd}var od,f1;function K6(){if(f1)return od;f1=1;var e=yc(),t=Object.prototype,r=t.hasOwnProperty;function n(s){var o=this.__data__;return e?o[s]!==void 0:r.call(o,s)}return od=n,od}var id,p1;function Y6(){if(p1)return id;p1=1;var e=yc(),t="__lodash_hash_undefined__";function r(n,s){var o=this.__data__;return this.size+=this.has(n)?0:1,o[n]=e&&s===void 0?t:s,this}return id=r,id}var ad,h1;function X6(){if(h1)return ad;h1=1;var e=V6(),t=U6(),r=G6(),n=K6(),s=Y6();function o(i){var a=-1,c=i==null?0:i.length;for(this.clear();++a<c;){var u=i[a];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=s,ad=o,ad}var ld,m1;function Q6(){if(m1)return ld;m1=1;var e=X6(),t=xc(),r=sx();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return ld=n,ld}var cd,g1;function Z6(){if(g1)return cd;g1=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return cd=e,cd}var ud,v1;function bc(){if(v1)return ud;v1=1;var e=Z6();function t(r,n){var s=r.__data__;return e(n)?s[typeof n=="string"?"string":"hash"]:s.map}return ud=t,ud}var dd,x1;function J6(){if(x1)return dd;x1=1;var e=bc();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return dd=t,dd}var fd,y1;function eD(){if(y1)return fd;y1=1;var e=bc();function t(r){return e(this,r).get(r)}return fd=t,fd}var pd,b1;function tD(){if(b1)return pd;b1=1;var e=bc();function t(r){return e(this,r).has(r)}return pd=t,pd}var hd,w1;function rD(){if(w1)return hd;w1=1;var e=bc();function t(r,n){var s=e(this,r),o=s.size;return s.set(r,n),this.size+=s.size==o?0:1,this}return hd=t,hd}var md,_1;function ox(){if(_1)return md;_1=1;var e=Q6(),t=J6(),r=eD(),n=tD(),s=rD();function o(i){var a=-1,c=i==null?0:i.length;for(this.clear();++a<c;){var u=i[a];this.set(u[0],u[1])}}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=n,o.prototype.set=s,md=o,md}var gd,S1;function nD(){if(S1)return gd;S1=1;var e=xc(),t=sx(),r=ox(),n=200;function s(o,i){var a=this.__data__;if(a instanceof e){var c=a.__data__;if(!t||c.length<n-1)return c.push([o,i]),this.size=++a.size,this;a=this.__data__=new r(c)}return a.set(o,i),this.size=a.size,this}return gd=s,gd}var vd,j1;function wc(){if(j1)return vd;j1=1;var e=xc(),t=D6(),r=O6(),n=L6(),s=z6(),o=nD();function i(a){var c=this.__data__=new e(a);this.size=c.size}return i.prototype.clear=t,i.prototype.delete=r,i.prototype.get=n,i.prototype.has=s,i.prototype.set=o,vd=i,vd}var xd,k1;function ix(){if(k1)return xd;k1=1;function e(t,r){for(var n=-1,s=t==null?0:t.length;++n<s&&r(t[n],n,t)!==!1;);return t}return xd=e,xd}var yd,N1;function eE(){if(N1)return yd;N1=1;var e=ys(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return yd=t,yd}var bd,E1;function _c(){if(E1)return bd;E1=1;var e=eE();function t(r,n,s){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:s,writable:!0}):r[n]=s}return bd=t,bd}var wd,C1;function Sc(){if(C1)return wd;C1=1;var e=_c(),t=ho(),r=Object.prototype,n=r.hasOwnProperty;function s(o,i,a){var c=o[i];(!(n.call(o,i)&&t(c,a))||a===void 0&&!(i in o))&&e(o,i,a)}return wd=s,wd}var _d,R1;function Yi(){if(R1)return _d;R1=1;var e=Sc(),t=_c();function r(n,s,o,i){var a=!o;o||(o={});for(var c=-1,u=s.length;++c<u;){var d=s[c],f=i?i(o[d],n[d],d,o,n):void 0;f===void 0&&(f=n[d]),a?t(o,d,f):e(o,d,f)}return o}return _d=r,_d}var Sd,T1;function sD(){if(T1)return Sd;T1=1;function e(t,r){for(var n=-1,s=Array(t);++n<t;)s[n]=r(n);return s}return Sd=e,Sd}var jd,I1;function Pr(){if(I1)return jd;I1=1;function e(t){return t!=null&&typeof t=="object"}return jd=e,jd}var kd,M1;function oD(){if(M1)return kd;M1=1;var e=xs(),t=Pr(),r="[object Arguments]";function n(s){return t(s)&&e(s)==r}return kd=n,kd}var Nd,A1;function Xi(){if(A1)return Nd;A1=1;var e=oD(),t=Pr(),r=Object.prototype,n=r.hasOwnProperty,s=r.propertyIsEnumerable,o=e(function(){return arguments}())?e:function(i){return t(i)&&n.call(i,"callee")&&!s.call(i,"callee")};return Nd=o,Nd}var Ed,P1;function He(){if(P1)return Ed;P1=1;var e=Array.isArray;return Ed=e,Ed}var Go={exports:{}},Cd,D1;function iD(){if(D1)return Cd;D1=1;function e(){return!1}return Cd=e,Cd}Go.exports;var O1;function go(){return O1||(O1=1,function(e,t){var r=vr(),n=iD(),s=t&&!t.nodeType&&t,o=s&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===s,a=i?r.Buffer:void 0,c=a?a.isBuffer:void 0,u=c||n;e.exports=u}(Go,Go.exports)),Go.exports}var Rd,L1;function jc(){if(L1)return Rd;L1=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,s){var o=typeof n;return s=s??e,!!s&&(o=="number"||o!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<s}return Rd=r,Rd}var Td,z1;function ax(){if(z1)return Td;z1=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return Td=t,Td}var Id,q1;function aD(){if(q1)return Id;q1=1;var e=xs(),t=ax(),r=Pr(),n="[object Arguments]",s="[object Array]",o="[object Boolean]",i="[object Date]",a="[object Error]",c="[object Function]",u="[object Map]",d="[object Number]",f="[object Object]",p="[object RegExp]",h="[object Set]",y="[object String]",v="[object WeakMap]",w="[object ArrayBuffer]",g="[object DataView]",x="[object Float32Array]",b="[object Float64Array]",_="[object Int8Array]",S="[object Int16Array]",k="[object Int32Array]",N="[object Uint8Array]",j="[object Uint8ClampedArray]",C="[object Uint16Array]",R="[object Uint32Array]",T={};T[x]=T[b]=T[_]=T[S]=T[k]=T[N]=T[j]=T[C]=T[R]=!0,T[n]=T[s]=T[w]=T[o]=T[g]=T[i]=T[a]=T[c]=T[u]=T[d]=T[f]=T[p]=T[h]=T[y]=T[v]=!1;function L($){return r($)&&t($.length)&&!!T[e($)]}return Id=L,Id}var Md,$1;function kc(){if($1)return Md;$1=1;function e(t){return function(r){return t(r)}}return Md=e,Md}var Ko={exports:{}};Ko.exports;var F1;function lx(){return F1||(F1=1,function(e,t){var r=ZN(),n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===n,i=o&&r.process,a=function(){try{var c=s&&s.require&&s.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();e.exports=a}(Ko,Ko.exports)),Ko.exports}var Ad,B1;function Qi(){if(B1)return Ad;B1=1;var e=aD(),t=kc(),r=lx(),n=r&&r.isTypedArray,s=n?t(n):e;return Ad=s,Ad}var Pd,H1;function tE(){if(H1)return Pd;H1=1;var e=sD(),t=Xi(),r=He(),n=go(),s=jc(),o=Qi(),i=Object.prototype,a=i.hasOwnProperty;function c(u,d){var f=r(u),p=!f&&t(u),h=!f&&!p&&n(u),y=!f&&!p&&!h&&o(u),v=f||p||h||y,w=v?e(u.length,String):[],g=w.length;for(var x in u)(d||a.call(u,x))&&!(v&&(x=="length"||h&&(x=="offset"||x=="parent")||y&&(x=="buffer"||x=="byteLength"||x=="byteOffset")||s(x,g)))&&w.push(x);return w}return Pd=c,Pd}var Dd,W1;function Nc(){if(W1)return Dd;W1=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,s=typeof n=="function"&&n.prototype||e;return r===s}return Dd=t,Dd}var Od,V1;function rE(){if(V1)return Od;V1=1;function e(t,r){return function(n){return t(r(n))}}return Od=e,Od}var Ld,U1;function lD(){if(U1)return Ld;U1=1;var e=rE(),t=e(Object.keys,Object);return Ld=t,Ld}var zd,G1;function cx(){if(G1)return zd;G1=1;var e=Nc(),t=lD(),r=Object.prototype,n=r.hasOwnProperty;function s(o){if(!e(o))return t(o);var i=[];for(var a in Object(o))n.call(o,a)&&a!="constructor"&&i.push(a);return i}return zd=s,zd}var qd,K1;function rn(){if(K1)return qd;K1=1;var e=Ki(),t=ax();function r(n){return n!=null&&t(n.length)&&!e(n)}return qd=r,qd}var $d,Y1;function Fn(){if(Y1)return $d;Y1=1;var e=tE(),t=cx(),r=rn();function n(s){return r(s)?e(s):t(s)}return $d=n,$d}var Fd,X1;function cD(){if(X1)return Fd;X1=1;var e=Yi(),t=Fn();function r(n,s){return n&&e(s,t(s),n)}return Fd=r,Fd}var Bd,Q1;function uD(){if(Q1)return Bd;Q1=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return Bd=e,Bd}var Hd,Z1;function dD(){if(Z1)return Hd;Z1=1;var e=er(),t=Nc(),r=uD(),n=Object.prototype,s=n.hasOwnProperty;function o(i){if(!e(i))return r(i);var a=t(i),c=[];for(var u in i)u=="constructor"&&(a||!s.call(i,u))||c.push(u);return c}return Hd=o,Hd}var Wd,J1;function bs(){if(J1)return Wd;J1=1;var e=tE(),t=dD(),r=rn();function n(s){return r(s)?e(s,!0):t(s)}return Wd=n,Wd}var Vd,eb;function fD(){if(eb)return Vd;eb=1;var e=Yi(),t=bs();function r(n,s){return n&&e(s,t(s),n)}return Vd=r,Vd}var Yo={exports:{}};Yo.exports;var tb;function nE(){return tb||(tb=1,function(e,t){var r=vr(),n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===n,i=o?r.Buffer:void 0,a=i?i.allocUnsafe:void 0;function c(u,d){if(d)return u.slice();var f=u.length,p=a?a(f):new u.constructor(f);return u.copy(p),p}e.exports=c}(Yo,Yo.exports)),Yo.exports}var Ud,rb;function sE(){if(rb)return Ud;rb=1;function e(t,r){var n=-1,s=t.length;for(r||(r=Array(s));++n<s;)r[n]=t[n];return r}return Ud=e,Ud}var Gd,nb;function oE(){if(nb)return Gd;nb=1;function e(t,r){for(var n=-1,s=t==null?0:t.length,o=0,i=[];++n<s;){var a=t[n];r(a,n,t)&&(i[o++]=a)}return i}return Gd=e,Gd}var Kd,sb;function iE(){if(sb)return Kd;sb=1;function e(){return[]}return Kd=e,Kd}var Yd,ob;function ux(){if(ob)return Yd;ob=1;var e=oE(),t=iE(),r=Object.prototype,n=r.propertyIsEnumerable,s=Object.getOwnPropertySymbols,o=s?function(i){return i==null?[]:(i=Object(i),e(s(i),function(a){return n.call(i,a)}))}:t;return Yd=o,Yd}var Xd,ib;function pD(){if(ib)return Xd;ib=1;var e=Yi(),t=ux();function r(n,s){return e(n,t(n),s)}return Xd=r,Xd}var Qd,ab;function dx(){if(ab)return Qd;ab=1;function e(t,r){for(var n=-1,s=r.length,o=t.length;++n<s;)t[o+n]=r[n];return t}return Qd=e,Qd}var Zd,lb;function Ec(){if(lb)return Zd;lb=1;var e=rE(),t=e(Object.getPrototypeOf,Object);return Zd=t,Zd}var Jd,cb;function aE(){if(cb)return Jd;cb=1;var e=dx(),t=Ec(),r=ux(),n=iE(),s=Object.getOwnPropertySymbols,o=s?function(i){for(var a=[];i;)e(a,r(i)),i=t(i);return a}:n;return Jd=o,Jd}var ef,ub;function hD(){if(ub)return ef;ub=1;var e=Yi(),t=aE();function r(n,s){return e(n,t(n),s)}return ef=r,ef}var tf,db;function lE(){if(db)return tf;db=1;var e=dx(),t=He();function r(n,s,o){var i=s(n);return t(n)?i:e(i,o(n))}return tf=r,tf}var rf,fb;function cE(){if(fb)return rf;fb=1;var e=lE(),t=ux(),r=Fn();function n(s){return e(s,r,t)}return rf=n,rf}var nf,pb;function mD(){if(pb)return nf;pb=1;var e=lE(),t=aE(),r=bs();function n(s){return e(s,r,t)}return nf=n,nf}var sf,hb;function gD(){if(hb)return sf;hb=1;var e=ys(),t=vr(),r=e(t,"DataView");return sf=r,sf}var of,mb;function vD(){if(mb)return of;mb=1;var e=ys(),t=vr(),r=e(t,"Promise");return of=r,of}var af,gb;function uE(){if(gb)return af;gb=1;var e=ys(),t=vr(),r=e(t,"Set");return af=r,af}var lf,vb;function xD(){if(vb)return lf;vb=1;var e=ys(),t=vr(),r=e(t,"WeakMap");return lf=r,lf}var cf,xb;function vo(){if(xb)return cf;xb=1;var e=gD(),t=sx(),r=vD(),n=uE(),s=xD(),o=xs(),i=JN(),a="[object Map]",c="[object Object]",u="[object Promise]",d="[object Set]",f="[object WeakMap]",p="[object DataView]",h=i(e),y=i(t),v=i(r),w=i(n),g=i(s),x=o;return(e&&x(new e(new ArrayBuffer(1)))!=p||t&&x(new t)!=a||r&&x(r.resolve())!=u||n&&x(new n)!=d||s&&x(new s)!=f)&&(x=function(b){var _=o(b),S=_==c?b.constructor:void 0,k=S?i(S):"";if(k)switch(k){case h:return p;case y:return a;case v:return u;case w:return d;case g:return f}return _}),cf=x,cf}var uf,yb;function yD(){if(yb)return uf;yb=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var s=n.length,o=new n.constructor(s);return s&&typeof n[0]=="string"&&t.call(n,"index")&&(o.index=n.index,o.input=n.input),o}return uf=r,uf}var df,bb;function dE(){if(bb)return df;bb=1;var e=vr(),t=e.Uint8Array;return df=t,df}var ff,wb;function fx(){if(wb)return ff;wb=1;var e=dE();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return ff=t,ff}var pf,_b;function bD(){if(_b)return pf;_b=1;var e=fx();function t(r,n){var s=n?e(r.buffer):r.buffer;return new r.constructor(s,r.byteOffset,r.byteLength)}return pf=t,pf}var hf,Sb;function wD(){if(Sb)return hf;Sb=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return hf=t,hf}var mf,jb;function _D(){if(jb)return mf;jb=1;var e=mo(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(s){return r?Object(r.call(s)):{}}return mf=n,mf}var gf,kb;function fE(){if(kb)return gf;kb=1;var e=fx();function t(r,n){var s=n?e(r.buffer):r.buffer;return new r.constructor(s,r.byteOffset,r.length)}return gf=t,gf}var vf,Nb;function SD(){if(Nb)return vf;Nb=1;var e=fx(),t=bD(),r=wD(),n=_D(),s=fE(),o="[object Boolean]",i="[object Date]",a="[object Map]",c="[object Number]",u="[object RegExp]",d="[object Set]",f="[object String]",p="[object Symbol]",h="[object ArrayBuffer]",y="[object DataView]",v="[object Float32Array]",w="[object Float64Array]",g="[object Int8Array]",x="[object Int16Array]",b="[object Int32Array]",_="[object Uint8Array]",S="[object Uint8ClampedArray]",k="[object Uint16Array]",N="[object Uint32Array]";function j(C,R,T){var L=C.constructor;switch(R){case h:return e(C);case o:case i:return new L(+C);case y:return t(C,T);case v:case w:case g:case x:case b:case _:case S:case k:case N:return s(C,T);case a:return new L;case c:case f:return new L(C);case u:return r(C);case d:return new L;case p:return n(C)}}return vf=j,vf}var xf,Eb;function pE(){if(Eb)return xf;Eb=1;var e=er(),t=Object.create,r=function(){function n(){}return function(s){if(!e(s))return{};if(t)return t(s);n.prototype=s;var o=new n;return n.prototype=void 0,o}}();return xf=r,xf}var yf,Cb;function hE(){if(Cb)return yf;Cb=1;var e=pE(),t=Ec(),r=Nc();function n(s){return typeof s.constructor=="function"&&!r(s)?e(t(s)):{}}return yf=n,yf}var bf,Rb;function jD(){if(Rb)return bf;Rb=1;var e=vo(),t=Pr(),r="[object Map]";function n(s){return t(s)&&e(s)==r}return bf=n,bf}var wf,Tb;function kD(){if(Tb)return wf;Tb=1;var e=jD(),t=kc(),r=lx(),n=r&&r.isMap,s=n?t(n):e;return wf=s,wf}var _f,Ib;function ND(){if(Ib)return _f;Ib=1;var e=vo(),t=Pr(),r="[object Set]";function n(s){return t(s)&&e(s)==r}return _f=n,_f}var Sf,Mb;function ED(){if(Mb)return Sf;Mb=1;var e=ND(),t=kc(),r=lx(),n=r&&r.isSet,s=n?t(n):e;return Sf=s,Sf}var jf,Ab;function mE(){if(Ab)return jf;Ab=1;var e=wc(),t=ix(),r=Sc(),n=cD(),s=fD(),o=nE(),i=sE(),a=pD(),c=hD(),u=cE(),d=mD(),f=vo(),p=yD(),h=SD(),y=hE(),v=He(),w=go(),g=kD(),x=er(),b=ED(),_=Fn(),S=bs(),k=1,N=2,j=4,C="[object Arguments]",R="[object Array]",T="[object Boolean]",L="[object Date]",$="[object Error]",E="[object Function]",P="[object GeneratorFunction]",D="[object Map]",F="[object Number]",A="[object Object]",I="[object RegExp]",z="[object Set]",M="[object String]",q="[object Symbol]",H="[object WeakMap]",O="[object ArrayBuffer]",B="[object DataView]",Y="[object Float32Array]",te="[object Float64Array]",ne="[object Int8Array]",re="[object Int16Array]",Q="[object Int32Array]",ce="[object Uint8Array]",ie="[object Uint8ClampedArray]",xe="[object Uint16Array]",ee="[object Uint32Array]",X={};X[C]=X[R]=X[O]=X[B]=X[T]=X[L]=X[Y]=X[te]=X[ne]=X[re]=X[Q]=X[D]=X[F]=X[A]=X[I]=X[z]=X[M]=X[q]=X[ce]=X[ie]=X[xe]=X[ee]=!0,X[$]=X[E]=X[H]=!1;function fe(V,K,oe,U,we,_e){var ue,Se=K&k,lt=K&N,We=K&j;if(oe&&(ue=we?oe(V,U,we,_e):oe(V)),ue!==void 0)return ue;if(!x(V))return V;var rt=v(V);if(rt){if(ue=p(V),!Se)return i(V,ue)}else{var Fe=f(V),ht=Fe==E||Fe==P;if(w(V))return o(V,Se);if(Fe==A||Fe==C||ht&&!we){if(ue=lt||ht?{}:y(V),!Se)return lt?c(V,s(ue,V)):a(V,n(ue,V))}else{if(!X[Fe])return we?V:{};ue=h(V,Fe,Se)}}_e||(_e=new e);var rr=_e.get(V);if(rr)return rr;_e.set(V,ue),b(V)?V.forEach(function(Xe){ue.add(fe(Xe,K,oe,Xe,V,_e))}):g(V)&&V.forEach(function(Xe,st){ue.set(st,fe(Xe,K,oe,st,V,_e))});var je=We?lt?d:u:lt?S:_,nt=rt?void 0:je(V);return t(nt||V,function(Xe,st){nt&&(st=Xe,Xe=V[st]),r(ue,st,fe(Xe,K,oe,st,V,_e))}),ue}return jf=fe,jf}var kf,Pb;function CD(){if(Pb)return kf;Pb=1;var e=mE(),t=4;function r(n){return e(n,t)}return kf=r,kf}var Nf,Db;function px(){if(Db)return Nf;Db=1;function e(t){return function(){return t}}return Nf=e,Nf}var Ef,Ob;function RD(){if(Ob)return Ef;Ob=1;function e(t){return function(r,n,s){for(var o=-1,i=Object(r),a=s(r),c=a.length;c--;){var u=a[t?c:++o];if(n(i[u],u,i)===!1)break}return r}}return Ef=e,Ef}var Cf,Lb;function hx(){if(Lb)return Cf;Lb=1;var e=RD(),t=e();return Cf=t,Cf}var Rf,zb;function mx(){if(zb)return Rf;zb=1;var e=hx(),t=Fn();function r(n,s){return n&&e(n,s,t)}return Rf=r,Rf}var Tf,qb;function TD(){if(qb)return Tf;qb=1;var e=rn();function t(r,n){return function(s,o){if(s==null)return s;if(!e(s))return r(s,o);for(var i=s.length,a=n?i:-1,c=Object(s);(n?a--:++a<i)&&o(c[a],a,c)!==!1;);return s}}return Tf=t,Tf}var If,$b;function Cc(){if($b)return If;$b=1;var e=mx(),t=TD(),r=t(e);return If=r,If}var Mf,Fb;function ws(){if(Fb)return Mf;Fb=1;function e(t){return t}return Mf=e,Mf}var Af,Bb;function gE(){if(Bb)return Af;Bb=1;var e=ws();function t(r){return typeof r=="function"?r:e}return Af=t,Af}var Pf,Hb;function vE(){if(Hb)return Pf;Hb=1;var e=ix(),t=Cc(),r=gE(),n=He();function s(o,i){var a=n(o)?e:t;return a(o,r(i))}return Pf=s,Pf}var Df,Wb;function xE(){return Wb||(Wb=1,Df=vE()),Df}var Of,Vb;function ID(){if(Vb)return Of;Vb=1;var e=Cc();function t(r,n){var s=[];return e(r,function(o,i,a){n(o,i,a)&&s.push(o)}),s}return Of=t,Of}var Lf,Ub;function MD(){if(Ub)return Lf;Ub=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return Lf=t,Lf}var zf,Gb;function AD(){if(Gb)return zf;Gb=1;function e(t){return this.__data__.has(t)}return zf=e,zf}var qf,Kb;function yE(){if(Kb)return qf;Kb=1;var e=ox(),t=MD(),r=AD();function n(s){var o=-1,i=s==null?0:s.length;for(this.__data__=new e;++o<i;)this.add(s[o])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,qf=n,qf}var $f,Yb;function PD(){if(Yb)return $f;Yb=1;function e(t,r){for(var n=-1,s=t==null?0:t.length;++n<s;)if(r(t[n],n,t))return!0;return!1}return $f=e,$f}var Ff,Xb;function bE(){if(Xb)return Ff;Xb=1;function e(t,r){return t.has(r)}return Ff=e,Ff}var Bf,Qb;function wE(){if(Qb)return Bf;Qb=1;var e=yE(),t=PD(),r=bE(),n=1,s=2;function o(i,a,c,u,d,f){var p=c&n,h=i.length,y=a.length;if(h!=y&&!(p&&y>h))return!1;var v=f.get(i),w=f.get(a);if(v&&w)return v==a&&w==i;var g=-1,x=!0,b=c&s?new e:void 0;for(f.set(i,a),f.set(a,i);++g<h;){var _=i[g],S=a[g];if(u)var k=p?u(S,_,g,a,i,f):u(_,S,g,i,a,f);if(k!==void 0){if(k)continue;x=!1;break}if(b){if(!t(a,function(N,j){if(!r(b,j)&&(_===N||d(_,N,c,u,f)))return b.push(j)})){x=!1;break}}else if(!(_===S||d(_,S,c,u,f))){x=!1;break}}return f.delete(i),f.delete(a),x}return Bf=o,Bf}var Hf,Zb;function DD(){if(Zb)return Hf;Zb=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(s,o){n[++r]=[o,s]}),n}return Hf=e,Hf}var Wf,Jb;function gx(){if(Jb)return Wf;Jb=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(s){n[++r]=s}),n}return Wf=e,Wf}var Vf,ew;function OD(){if(ew)return Vf;ew=1;var e=mo(),t=dE(),r=ho(),n=wE(),s=DD(),o=gx(),i=1,a=2,c="[object Boolean]",u="[object Date]",d="[object Error]",f="[object Map]",p="[object Number]",h="[object RegExp]",y="[object Set]",v="[object String]",w="[object Symbol]",g="[object ArrayBuffer]",x="[object DataView]",b=e?e.prototype:void 0,_=b?b.valueOf:void 0;function S(k,N,j,C,R,T,L){switch(j){case x:if(k.byteLength!=N.byteLength||k.byteOffset!=N.byteOffset)return!1;k=k.buffer,N=N.buffer;case g:return!(k.byteLength!=N.byteLength||!T(new t(k),new t(N)));case c:case u:case p:return r(+k,+N);case d:return k.name==N.name&&k.message==N.message;case h:case v:return k==N+"";case f:var $=s;case y:var E=C&i;if($||($=o),k.size!=N.size&&!E)return!1;var P=L.get(k);if(P)return P==N;C|=a,L.set(k,N);var D=n($(k),$(N),C,R,T,L);return L.delete(k),D;case w:if(_)return _.call(k)==_.call(N)}return!1}return Vf=S,Vf}var Uf,tw;function LD(){if(tw)return Uf;tw=1;var e=cE(),t=1,r=Object.prototype,n=r.hasOwnProperty;function s(o,i,a,c,u,d){var f=a&t,p=e(o),h=p.length,y=e(i),v=y.length;if(h!=v&&!f)return!1;for(var w=h;w--;){var g=p[w];if(!(f?g in i:n.call(i,g)))return!1}var x=d.get(o),b=d.get(i);if(x&&b)return x==i&&b==o;var _=!0;d.set(o,i),d.set(i,o);for(var S=f;++w<h;){g=p[w];var k=o[g],N=i[g];if(c)var j=f?c(N,k,g,i,o,d):c(k,N,g,o,i,d);if(!(j===void 0?k===N||u(k,N,a,c,d):j)){_=!1;break}S||(S=g=="constructor")}if(_&&!S){var C=o.constructor,R=i.constructor;C!=R&&"constructor"in o&&"constructor"in i&&!(typeof C=="function"&&C instanceof C&&typeof R=="function"&&R instanceof R)&&(_=!1)}return d.delete(o),d.delete(i),_}return Uf=s,Uf}var Gf,rw;function zD(){if(rw)return Gf;rw=1;var e=wc(),t=wE(),r=OD(),n=LD(),s=vo(),o=He(),i=go(),a=Qi(),c=1,u="[object Arguments]",d="[object Array]",f="[object Object]",p=Object.prototype,h=p.hasOwnProperty;function y(v,w,g,x,b,_){var S=o(v),k=o(w),N=S?d:s(v),j=k?d:s(w);N=N==u?f:N,j=j==u?f:j;var C=N==f,R=j==f,T=N==j;if(T&&i(v)){if(!i(w))return!1;S=!0,C=!1}if(T&&!C)return _||(_=new e),S||a(v)?t(v,w,g,x,b,_):r(v,w,N,g,x,b,_);if(!(g&c)){var L=C&&h.call(v,"__wrapped__"),$=R&&h.call(w,"__wrapped__");if(L||$){var E=L?v.value():v,P=$?w.value():w;return _||(_=new e),b(E,P,g,x,_)}}return T?(_||(_=new e),n(v,w,g,x,b,_)):!1}return Gf=y,Gf}var Kf,nw;function _E(){if(nw)return Kf;nw=1;var e=zD(),t=Pr();function r(n,s,o,i,a){return n===s?!0:n==null||s==null||!t(n)&&!t(s)?n!==n&&s!==s:e(n,s,o,i,r,a)}return Kf=r,Kf}var Yf,sw;function qD(){if(sw)return Yf;sw=1;var e=wc(),t=_E(),r=1,n=2;function s(o,i,a,c){var u=a.length,d=u,f=!c;if(o==null)return!d;for(o=Object(o);u--;){var p=a[u];if(f&&p[2]?p[1]!==o[p[0]]:!(p[0]in o))return!1}for(;++u<d;){p=a[u];var h=p[0],y=o[h],v=p[1];if(f&&p[2]){if(y===void 0&&!(h in o))return!1}else{var w=new e;if(c)var g=c(y,v,h,o,i,w);if(!(g===void 0?t(v,y,r|n,c,w):g))return!1}}return!0}return Yf=s,Yf}var Xf,ow;function SE(){if(ow)return Xf;ow=1;var e=er();function t(r){return r===r&&!e(r)}return Xf=t,Xf}var Qf,iw;function $D(){if(iw)return Qf;iw=1;var e=SE(),t=Fn();function r(n){for(var s=t(n),o=s.length;o--;){var i=s[o],a=n[i];s[o]=[i,a,e(a)]}return s}return Qf=r,Qf}var Zf,aw;function jE(){if(aw)return Zf;aw=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return Zf=e,Zf}var Jf,lw;function FD(){if(lw)return Jf;lw=1;var e=qD(),t=$D(),r=jE();function n(s){var o=t(s);return o.length==1&&o[0][2]?r(o[0][0],o[0][1]):function(i){return i===s||e(i,s,o)}}return Jf=n,Jf}var ep,cw;function xo(){if(cw)return ep;cw=1;var e=xs(),t=Pr(),r="[object Symbol]";function n(s){return typeof s=="symbol"||t(s)&&e(s)==r}return ep=n,ep}var tp,uw;function vx(){if(uw)return tp;uw=1;var e=He(),t=xo(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function s(o,i){if(e(o))return!1;var a=typeof o;return a=="number"||a=="symbol"||a=="boolean"||o==null||t(o)?!0:n.test(o)||!r.test(o)||i!=null&&o in Object(i)}return tp=s,tp}var rp,dw;function BD(){if(dw)return rp;dw=1;var e=ox(),t="Expected a function";function r(n,s){if(typeof n!="function"||s!=null&&typeof s!="function")throw new TypeError(t);var o=function(){var i=arguments,a=s?s.apply(this,i):i[0],c=o.cache;if(c.has(a))return c.get(a);var u=n.apply(this,i);return o.cache=c.set(a,u)||c,u};return o.cache=new(r.Cache||e),o}return r.Cache=e,rp=r,rp}var np,fw;function HD(){if(fw)return np;fw=1;var e=BD(),t=500;function r(n){var s=e(n,function(i){return o.size===t&&o.clear(),i}),o=s.cache;return s}return np=r,np}var sp,pw;function WD(){if(pw)return sp;pw=1;var e=HD(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(s){var o=[];return s.charCodeAt(0)===46&&o.push(""),s.replace(t,function(i,a,c,u){o.push(c?u.replace(r,"$1"):a||i)}),o});return sp=n,sp}var op,hw;function Rc(){if(hw)return op;hw=1;function e(t,r){for(var n=-1,s=t==null?0:t.length,o=Array(s);++n<s;)o[n]=r(t[n],n,t);return o}return op=e,op}var ip,mw;function VD(){if(mw)return ip;mw=1;var e=mo(),t=Rc(),r=He(),n=xo(),s=e?e.prototype:void 0,o=s?s.toString:void 0;function i(a){if(typeof a=="string")return a;if(r(a))return t(a,i)+"";if(n(a))return o?o.call(a):"";var c=a+"";return c=="0"&&1/a==-1/0?"-0":c}return ip=i,ip}var ap,gw;function kE(){if(gw)return ap;gw=1;var e=VD();function t(r){return r==null?"":e(r)}return ap=t,ap}var lp,vw;function Tc(){if(vw)return lp;vw=1;var e=He(),t=vx(),r=WD(),n=kE();function s(o,i){return e(o)?o:t(o,i)?[o]:r(n(o))}return lp=s,lp}var cp,xw;function Zi(){if(xw)return cp;xw=1;var e=xo();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return cp=t,cp}var up,yw;function Ic(){if(yw)return up;yw=1;var e=Tc(),t=Zi();function r(n,s){s=e(s,n);for(var o=0,i=s.length;n!=null&&o<i;)n=n[t(s[o++])];return o&&o==i?n:void 0}return up=r,up}var dp,bw;function UD(){if(bw)return dp;bw=1;var e=Ic();function t(r,n,s){var o=r==null?void 0:e(r,n);return o===void 0?s:o}return dp=t,dp}var fp,ww;function GD(){if(ww)return fp;ww=1;function e(t,r){return t!=null&&r in Object(t)}return fp=e,fp}var pp,_w;function NE(){if(_w)return pp;_w=1;var e=Tc(),t=Xi(),r=He(),n=jc(),s=ax(),o=Zi();function i(a,c,u){c=e(c,a);for(var d=-1,f=c.length,p=!1;++d<f;){var h=o(c[d]);if(!(p=a!=null&&u(a,h)))break;a=a[h]}return p||++d!=f?p:(f=a==null?0:a.length,!!f&&s(f)&&n(h,f)&&(r(a)||t(a)))}return pp=i,pp}var hp,Sw;function EE(){if(Sw)return hp;Sw=1;var e=GD(),t=NE();function r(n,s){return n!=null&&t(n,s,e)}return hp=r,hp}var mp,jw;function KD(){if(jw)return mp;jw=1;var e=_E(),t=UD(),r=EE(),n=vx(),s=SE(),o=jE(),i=Zi(),a=1,c=2;function u(d,f){return n(d)&&s(f)?o(i(d),f):function(p){var h=t(p,d);return h===void 0&&h===f?r(p,d):e(f,h,a|c)}}return mp=u,mp}var gp,kw;function CE(){if(kw)return gp;kw=1;function e(t){return function(r){return r==null?void 0:r[t]}}return gp=e,gp}var vp,Nw;function YD(){if(Nw)return vp;Nw=1;var e=Ic();function t(r){return function(n){return e(n,r)}}return vp=t,vp}var xp,Ew;function XD(){if(Ew)return xp;Ew=1;var e=CE(),t=YD(),r=vx(),n=Zi();function s(o){return r(o)?e(n(o)):t(o)}return xp=s,xp}var yp,Cw;function nn(){if(Cw)return yp;Cw=1;var e=FD(),t=KD(),r=ws(),n=He(),s=XD();function o(i){return typeof i=="function"?i:i==null?r:typeof i=="object"?n(i)?t(i[0],i[1]):e(i):s(i)}return yp=o,yp}var bp,Rw;function RE(){if(Rw)return bp;Rw=1;var e=oE(),t=ID(),r=nn(),n=He();function s(o,i){var a=n(o)?e:t;return a(o,r(i,3))}return bp=s,bp}var wp,Tw;function QD(){if(Tw)return wp;Tw=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n,s){return n!=null&&t.call(n,s)}return wp=r,wp}var _p,Iw;function TE(){if(Iw)return _p;Iw=1;var e=QD(),t=NE();function r(n,s){return n!=null&&t(n,s,e)}return _p=r,_p}var Sp,Mw;function ZD(){if(Mw)return Sp;Mw=1;var e=cx(),t=vo(),r=Xi(),n=He(),s=rn(),o=go(),i=Nc(),a=Qi(),c="[object Map]",u="[object Set]",d=Object.prototype,f=d.hasOwnProperty;function p(h){if(h==null)return!0;if(s(h)&&(n(h)||typeof h=="string"||typeof h.splice=="function"||o(h)||a(h)||r(h)))return!h.length;var y=t(h);if(y==c||y==u)return!h.size;if(i(h))return!e(h).length;for(var v in h)if(f.call(h,v))return!1;return!0}return Sp=p,Sp}var jp,Aw;function IE(){if(Aw)return jp;Aw=1;function e(t){return t===void 0}return jp=e,jp}var kp,Pw;function ME(){if(Pw)return kp;Pw=1;var e=Cc(),t=rn();function r(n,s){var o=-1,i=t(n)?Array(n.length):[];return e(n,function(a,c,u){i[++o]=s(a,c,u)}),i}return kp=r,kp}var Np,Dw;function AE(){if(Dw)return Np;Dw=1;var e=Rc(),t=nn(),r=ME(),n=He();function s(o,i){var a=n(o)?e:r;return a(o,t(i,3))}return Np=s,Np}var Ep,Ow;function JD(){if(Ow)return Ep;Ow=1;function e(t,r,n,s){var o=-1,i=t==null?0:t.length;for(s&&i&&(n=t[++o]);++o<i;)n=r(n,t[o],o,t);return n}return Ep=e,Ep}var Cp,Lw;function eO(){if(Lw)return Cp;Lw=1;function e(t,r,n,s,o){return o(t,function(i,a,c){n=s?(s=!1,i):r(n,i,a,c)}),n}return Cp=e,Cp}var Rp,zw;function PE(){if(zw)return Rp;zw=1;var e=JD(),t=Cc(),r=nn(),n=eO(),s=He();function o(i,a,c){var u=s(i)?e:n,d=arguments.length<3;return u(i,r(a,4),c,d,t)}return Rp=o,Rp}var Tp,qw;function tO(){if(qw)return Tp;qw=1;var e=xs(),t=He(),r=Pr(),n="[object String]";function s(o){return typeof o=="string"||!t(o)&&r(o)&&e(o)==n}return Tp=s,Tp}var Ip,$w;function rO(){if($w)return Ip;$w=1;var e=CE(),t=e("length");return Ip=t,Ip}var Mp,Fw;function nO(){if(Fw)return Mp;Fw=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",s=t+r+n,o="\\ufe0e\\ufe0f",i="\\u200d",a=RegExp("["+i+e+s+o+"]");function c(u){return a.test(u)}return Mp=c,Mp}var Ap,Bw;function sO(){if(Bw)return Ap;Bw=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",s=t+r+n,o="\\ufe0e\\ufe0f",i="["+e+"]",a="["+s+"]",c="\\ud83c[\\udffb-\\udfff]",u="(?:"+a+"|"+c+")",d="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",y=u+"?",v="["+o+"]?",w="(?:"+h+"(?:"+[d,f,p].join("|")+")"+v+y+")*",g=v+y+w,x="(?:"+[d+a+"?",a,f,p,i].join("|")+")",b=RegExp(c+"(?="+c+")|"+x+g,"g");function _(S){for(var k=b.lastIndex=0;b.test(S);)++k;return k}return Ap=_,Ap}var Pp,Hw;function oO(){if(Hw)return Pp;Hw=1;var e=rO(),t=nO(),r=sO();function n(s){return t(s)?r(s):e(s)}return Pp=n,Pp}var Dp,Ww;function iO(){if(Ww)return Dp;Ww=1;var e=cx(),t=vo(),r=rn(),n=tO(),s=oO(),o="[object Map]",i="[object Set]";function a(c){if(c==null)return 0;if(r(c))return n(c)?s(c):c.length;var u=t(c);return u==o||u==i?c.size:e(c).length}return Dp=a,Dp}var Op,Vw;function aO(){if(Vw)return Op;Vw=1;var e=ix(),t=pE(),r=mx(),n=nn(),s=Ec(),o=He(),i=go(),a=Ki(),c=er(),u=Qi();function d(f,p,h){var y=o(f),v=y||i(f)||u(f);if(p=n(p,4),h==null){var w=f&&f.constructor;v?h=y?new w:[]:c(f)?h=a(w)?t(s(f)):{}:h={}}return(v?e:r)(f,function(g,x,b){return p(h,g,x,b)}),h}return Op=d,Op}var Lp,Uw;function lO(){if(Uw)return Lp;Uw=1;var e=mo(),t=Xi(),r=He(),n=e?e.isConcatSpreadable:void 0;function s(o){return r(o)||t(o)||!!(n&&o&&o[n])}return Lp=s,Lp}var zp,Gw;function xx(){if(Gw)return zp;Gw=1;var e=dx(),t=lO();function r(n,s,o,i,a){var c=-1,u=n.length;for(o||(o=t),a||(a=[]);++c<u;){var d=n[c];s>0&&o(d)?s>1?r(d,s-1,o,i,a):e(a,d):i||(a[a.length]=d)}return a}return zp=r,zp}var qp,Kw;function cO(){if(Kw)return qp;Kw=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return qp=e,qp}var $p,Yw;function DE(){if(Yw)return $p;Yw=1;var e=cO(),t=Math.max;function r(n,s,o){return s=t(s===void 0?n.length-1:s,0),function(){for(var i=arguments,a=-1,c=t(i.length-s,0),u=Array(c);++a<c;)u[a]=i[s+a];a=-1;for(var d=Array(s+1);++a<s;)d[a]=i[a];return d[s]=o(u),e(n,this,d)}}return $p=r,$p}var Fp,Xw;function uO(){if(Xw)return Fp;Xw=1;var e=px(),t=eE(),r=ws(),n=t?function(s,o){return t(s,"toString",{configurable:!0,enumerable:!1,value:e(o),writable:!0})}:r;return Fp=n,Fp}var Bp,Qw;function dO(){if(Qw)return Bp;Qw=1;var e=800,t=16,r=Date.now;function n(s){var o=0,i=0;return function(){var a=r(),c=t-(a-i);if(i=a,c>0){if(++o>=e)return arguments[0]}else o=0;return s.apply(void 0,arguments)}}return Bp=n,Bp}var Hp,Zw;function OE(){if(Zw)return Hp;Zw=1;var e=uO(),t=dO(),r=t(e);return Hp=r,Hp}var Wp,Jw;function Mc(){if(Jw)return Wp;Jw=1;var e=ws(),t=DE(),r=OE();function n(s,o){return r(t(s,o,e),s+"")}return Wp=n,Wp}var Vp,e_;function LE(){if(e_)return Vp;e_=1;function e(t,r,n,s){for(var o=t.length,i=n+(s?1:-1);s?i--:++i<o;)if(r(t[i],i,t))return i;return-1}return Vp=e,Vp}var Up,t_;function fO(){if(t_)return Up;t_=1;function e(t){return t!==t}return Up=e,Up}var Gp,r_;function pO(){if(r_)return Gp;r_=1;function e(t,r,n){for(var s=n-1,o=t.length;++s<o;)if(t[s]===r)return s;return-1}return Gp=e,Gp}var Kp,n_;function hO(){if(n_)return Kp;n_=1;var e=LE(),t=fO(),r=pO();function n(s,o,i){return o===o?r(s,o,i):e(s,t,i)}return Kp=n,Kp}var Yp,s_;function mO(){if(s_)return Yp;s_=1;var e=hO();function t(r,n){var s=r==null?0:r.length;return!!s&&e(r,n,0)>-1}return Yp=t,Yp}var Xp,o_;function gO(){if(o_)return Xp;o_=1;function e(t,r,n){for(var s=-1,o=t==null?0:t.length;++s<o;)if(n(r,t[s]))return!0;return!1}return Xp=e,Xp}var Qp,i_;function vO(){if(i_)return Qp;i_=1;function e(){}return Qp=e,Qp}var Zp,a_;function xO(){if(a_)return Zp;a_=1;var e=uE(),t=vO(),r=gx(),n=1/0,s=e&&1/r(new e([,-0]))[1]==n?function(o){return new e(o)}:t;return Zp=s,Zp}var Jp,l_;function yO(){if(l_)return Jp;l_=1;var e=yE(),t=mO(),r=gO(),n=bE(),s=xO(),o=gx(),i=200;function a(c,u,d){var f=-1,p=t,h=c.length,y=!0,v=[],w=v;if(d)y=!1,p=r;else if(h>=i){var g=u?null:s(c);if(g)return o(g);y=!1,p=n,w=new e}else w=u?[]:v;e:for(;++f<h;){var x=c[f],b=u?u(x):x;if(x=d||x!==0?x:0,y&&b===b){for(var _=w.length;_--;)if(w[_]===b)continue e;u&&w.push(b),v.push(x)}else p(w,b,d)||(w!==v&&w.push(b),v.push(x))}return v}return Jp=a,Jp}var eh,c_;function zE(){if(c_)return eh;c_=1;var e=rn(),t=Pr();function r(n){return t(n)&&e(n)}return eh=r,eh}var th,u_;function bO(){if(u_)return th;u_=1;var e=xx(),t=Mc(),r=yO(),n=zE(),s=t(function(o){return r(e(o,1,n,!0))});return th=s,th}var rh,d_;function wO(){if(d_)return rh;d_=1;var e=Rc();function t(r,n){return e(n,function(s){return r[s]})}return rh=t,rh}var nh,f_;function qE(){if(f_)return nh;f_=1;var e=wO(),t=Fn();function r(n){return n==null?[]:e(n,t(n))}return nh=r,nh}var sh,p_;function tr(){if(p_)return sh;p_=1;var e;if(typeof nx=="function")try{e={clone:CD(),constant:px(),each:xE(),filter:RE(),has:TE(),isArray:He(),isEmpty:ZD(),isFunction:Ki(),isUndefined:IE(),keys:Fn(),map:AE(),reduce:PE(),size:iO(),transform:aO(),union:bO(),values:qE()}}catch{}return e||(e=window._),sh=e,sh}var oh,h_;function yx(){if(h_)return oh;h_=1;var e=tr();oh=s;var t="\0",r="\0",n="";function s(d){this._isDirected=e.has(d,"directed")?d.directed:!0,this._isMultigraph=e.has(d,"multigraph")?d.multigraph:!1,this._isCompound=e.has(d,"compound")?d.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[r]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}s.prototype._nodeCount=0,s.prototype._edgeCount=0,s.prototype.isDirected=function(){return this._isDirected},s.prototype.isMultigraph=function(){return this._isMultigraph},s.prototype.isCompound=function(){return this._isCompound},s.prototype.setGraph=function(d){return this._label=d,this},s.prototype.graph=function(){return this._label},s.prototype.setDefaultNodeLabel=function(d){return e.isFunction(d)||(d=e.constant(d)),this._defaultNodeLabelFn=d,this},s.prototype.nodeCount=function(){return this._nodeCount},s.prototype.nodes=function(){return e.keys(this._nodes)},s.prototype.sources=function(){var d=this;return e.filter(this.nodes(),function(f){return e.isEmpty(d._in[f])})},s.prototype.sinks=function(){var d=this;return e.filter(this.nodes(),function(f){return e.isEmpty(d._out[f])})},s.prototype.setNodes=function(d,f){var p=arguments,h=this;return e.each(d,function(y){p.length>1?h.setNode(y,f):h.setNode(y)}),this},s.prototype.setNode=function(d,f){return e.has(this._nodes,d)?(arguments.length>1&&(this._nodes[d]=f),this):(this._nodes[d]=arguments.length>1?f:this._defaultNodeLabelFn(d),this._isCompound&&(this._parent[d]=r,this._children[d]={},this._children[r][d]=!0),this._in[d]={},this._preds[d]={},this._out[d]={},this._sucs[d]={},++this._nodeCount,this)},s.prototype.node=function(d){return this._nodes[d]},s.prototype.hasNode=function(d){return e.has(this._nodes,d)},s.prototype.removeNode=function(d){var f=this;if(e.has(this._nodes,d)){var p=function(h){f.removeEdge(f._edgeObjs[h])};delete this._nodes[d],this._isCompound&&(this._removeFromParentsChildList(d),delete this._parent[d],e.each(this.children(d),function(h){f.setParent(h)}),delete this._children[d]),e.each(e.keys(this._in[d]),p),delete this._in[d],delete this._preds[d],e.each(e.keys(this._out[d]),p),delete this._out[d],delete this._sucs[d],--this._nodeCount}return this},s.prototype.setParent=function(d,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=r;else{f+="";for(var p=f;!e.isUndefined(p);p=this.parent(p))if(p===d)throw new Error("Setting "+f+" as parent of "+d+" would create a cycle");this.setNode(f)}return this.setNode(d),this._removeFromParentsChildList(d),this._parent[d]=f,this._children[f][d]=!0,this},s.prototype._removeFromParentsChildList=function(d){delete this._children[this._parent[d]][d]},s.prototype.parent=function(d){if(this._isCompound){var f=this._parent[d];if(f!==r)return f}},s.prototype.children=function(d){if(e.isUndefined(d)&&(d=r),this._isCompound){var f=this._children[d];if(f)return e.keys(f)}else{if(d===r)return this.nodes();if(this.hasNode(d))return[]}},s.prototype.predecessors=function(d){var f=this._preds[d];if(f)return e.keys(f)},s.prototype.successors=function(d){var f=this._sucs[d];if(f)return e.keys(f)},s.prototype.neighbors=function(d){var f=this.predecessors(d);if(f)return e.union(f,this.successors(d))},s.prototype.isLeaf=function(d){var f;return this.isDirected()?f=this.successors(d):f=this.neighbors(d),f.length===0},s.prototype.filterNodes=function(d){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var p=this;e.each(this._nodes,function(v,w){d(w)&&f.setNode(w,v)}),e.each(this._edgeObjs,function(v){f.hasNode(v.v)&&f.hasNode(v.w)&&f.setEdge(v,p.edge(v))});var h={};function y(v){var w=p.parent(v);return w===void 0||f.hasNode(w)?(h[v]=w,w):w in h?h[w]:y(w)}return this._isCompound&&e.each(f.nodes(),function(v){f.setParent(v,y(v))}),f},s.prototype.setDefaultEdgeLabel=function(d){return e.isFunction(d)||(d=e.constant(d)),this._defaultEdgeLabelFn=d,this},s.prototype.edgeCount=function(){return this._edgeCount},s.prototype.edges=function(){return e.values(this._edgeObjs)},s.prototype.setPath=function(d,f){var p=this,h=arguments;return e.reduce(d,function(y,v){return h.length>1?p.setEdge(y,v,f):p.setEdge(y,v),v}),this},s.prototype.setEdge=function(){var d,f,p,h,y=!1,v=arguments[0];typeof v=="object"&&v!==null&&"v"in v?(d=v.v,f=v.w,p=v.name,arguments.length===2&&(h=arguments[1],y=!0)):(d=v,f=arguments[1],p=arguments[3],arguments.length>2&&(h=arguments[2],y=!0)),d=""+d,f=""+f,e.isUndefined(p)||(p=""+p);var w=a(this._isDirected,d,f,p);if(e.has(this._edgeLabels,w))return y&&(this._edgeLabels[w]=h),this;if(!e.isUndefined(p)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(d),this.setNode(f),this._edgeLabels[w]=y?h:this._defaultEdgeLabelFn(d,f,p);var g=c(this._isDirected,d,f,p);return d=g.v,f=g.w,Object.freeze(g),this._edgeObjs[w]=g,o(this._preds[f],d),o(this._sucs[d],f),this._in[f][w]=g,this._out[d][w]=g,this._edgeCount++,this},s.prototype.edge=function(d,f,p){var h=arguments.length===1?u(this._isDirected,arguments[0]):a(this._isDirected,d,f,p);return this._edgeLabels[h]},s.prototype.hasEdge=function(d,f,p){var h=arguments.length===1?u(this._isDirected,arguments[0]):a(this._isDirected,d,f,p);return e.has(this._edgeLabels,h)},s.prototype.removeEdge=function(d,f,p){var h=arguments.length===1?u(this._isDirected,arguments[0]):a(this._isDirected,d,f,p),y=this._edgeObjs[h];return y&&(d=y.v,f=y.w,delete this._edgeLabels[h],delete this._edgeObjs[h],i(this._preds[f],d),i(this._sucs[d],f),delete this._in[f][h],delete this._out[d][h],this._edgeCount--),this},s.prototype.inEdges=function(d,f){var p=this._in[d];if(p){var h=e.values(p);return f?e.filter(h,function(y){return y.v===f}):h}},s.prototype.outEdges=function(d,f){var p=this._out[d];if(p){var h=e.values(p);return f?e.filter(h,function(y){return y.w===f}):h}},s.prototype.nodeEdges=function(d,f){var p=this.inEdges(d,f);if(p)return p.concat(this.outEdges(d,f))};function o(d,f){d[f]?d[f]++:d[f]=1}function i(d,f){--d[f]||delete d[f]}function a(d,f,p,h){var y=""+f,v=""+p;if(!d&&y>v){var w=y;y=v,v=w}return y+n+v+n+(e.isUndefined(h)?t:h)}function c(d,f,p,h){var y=""+f,v=""+p;if(!d&&y>v){var w=y;y=v,v=w}var g={v:y,w:v};return h&&(g.name=h),g}function u(d,f){return a(d,f.v,f.w,f.name)}return oh}var ih,m_;function _O(){return m_||(m_=1,ih="2.1.8"),ih}var ah,g_;function SO(){return g_||(g_=1,ah={Graph:yx(),version:_O()}),ah}var lh,v_;function jO(){if(v_)return lh;v_=1;var e=tr(),t=yx();lh={write:r,read:o};function r(i){var a={options:{directed:i.isDirected(),multigraph:i.isMultigraph(),compound:i.isCompound()},nodes:n(i),edges:s(i)};return e.isUndefined(i.graph())||(a.value=e.clone(i.graph())),a}function n(i){return e.map(i.nodes(),function(a){var c=i.node(a),u=i.parent(a),d={v:a};return e.isUndefined(c)||(d.value=c),e.isUndefined(u)||(d.parent=u),d})}function s(i){return e.map(i.edges(),function(a){var c=i.edge(a),u={v:a.v,w:a.w};return e.isUndefined(a.name)||(u.name=a.name),e.isUndefined(c)||(u.value=c),u})}function o(i){var a=new t(i.options).setGraph(i.value);return e.each(i.nodes,function(c){a.setNode(c.v,c.value),c.parent&&a.setParent(c.v,c.parent)}),e.each(i.edges,function(c){a.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),a}return lh}var ch,x_;function kO(){if(x_)return ch;x_=1;var e=tr();ch=t;function t(r){var n={},s=[],o;function i(a){e.has(n,a)||(n[a]=!0,o.push(a),e.each(r.successors(a),i),e.each(r.predecessors(a),i))}return e.each(r.nodes(),function(a){o=[],i(a),o.length&&s.push(o)}),s}return ch}var uh,y_;function $E(){if(y_)return uh;y_=1;var e=tr();uh=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(r){return r.key})},t.prototype.has=function(r){return e.has(this._keyIndices,r)},t.prototype.priority=function(r){var n=this._keyIndices[r];if(n!==void 0)return this._arr[n].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(r,n){var s=this._keyIndices;if(r=String(r),!e.has(s,r)){var o=this._arr,i=o.length;return s[r]=i,o.push({key:r,priority:n}),this._decrease(i),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var r=this._arr.pop();return delete this._keyIndices[r.key],this._heapify(0),r.key},t.prototype.decrease=function(r,n){var s=this._keyIndices[r];if(n>this._arr[s].priority)throw new Error("New priority is greater than current priority. Key: "+r+" Old: "+this._arr[s].priority+" New: "+n);this._arr[s].priority=n,this._decrease(s)},t.prototype._heapify=function(r){var n=this._arr,s=2*r,o=s+1,i=r;s<n.length&&(i=n[s].priority<n[i].priority?s:i,o<n.length&&(i=n[o].priority<n[i].priority?o:i),i!==r&&(this._swap(r,i),this._heapify(i)))},t.prototype._decrease=function(r){for(var n=this._arr,s=n[r].priority,o;r!==0&&(o=r>>1,!(n[o].priority<s));)this._swap(r,o),r=o},t.prototype._swap=function(r,n){var s=this._arr,o=this._keyIndices,i=s[r],a=s[n];s[r]=a,s[n]=i,o[a.key]=r,o[i.key]=n},uh}var dh,b_;function FE(){if(b_)return dh;b_=1;var e=tr(),t=$E();dh=n;var r=e.constant(1);function n(o,i,a,c){return s(o,String(i),a||r,c||function(u){return o.outEdges(u)})}function s(o,i,a,c){var u={},d=new t,f,p,h=function(y){var v=y.v!==f?y.v:y.w,w=u[v],g=a(y),x=p.distance+g;if(g<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+y+" Weight: "+g);x<w.distance&&(w.distance=x,w.predecessor=f,d.decrease(v,x))};for(o.nodes().forEach(function(y){var v=y===i?0:Number.POSITIVE_INFINITY;u[y]={distance:v},d.add(y,v)});d.size()>0&&(f=d.removeMin(),p=u[f],p.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(h);return u}return dh}var fh,w_;function NO(){if(w_)return fh;w_=1;var e=FE(),t=tr();fh=r;function r(n,s,o){return t.transform(n.nodes(),function(i,a){i[a]=e(n,a,s,o)},{})}return fh}var ph,__;function BE(){if(__)return ph;__=1;var e=tr();ph=t;function t(r){var n=0,s=[],o={},i=[];function a(c){var u=o[c]={onStack:!0,lowlink:n,index:n++};if(s.push(c),r.successors(c).forEach(function(p){e.has(o,p)?o[p].onStack&&(u.lowlink=Math.min(u.lowlink,o[p].index)):(a(p),u.lowlink=Math.min(u.lowlink,o[p].lowlink))}),u.lowlink===u.index){var d=[],f;do f=s.pop(),o[f].onStack=!1,d.push(f);while(c!==f);i.push(d)}}return r.nodes().forEach(function(c){e.has(o,c)||a(c)}),i}return ph}var hh,S_;function EO(){if(S_)return hh;S_=1;var e=tr(),t=BE();hh=r;function r(n){return e.filter(t(n),function(s){return s.length>1||s.length===1&&n.hasEdge(s[0],s[0])})}return hh}var mh,j_;function CO(){if(j_)return mh;j_=1;var e=tr();mh=r;var t=e.constant(1);function r(s,o,i){return n(s,o||t,i||function(a){return s.outEdges(a)})}function n(s,o,i){var a={},c=s.nodes();return c.forEach(function(u){a[u]={},a[u][u]={distance:0},c.forEach(function(d){u!==d&&(a[u][d]={distance:Number.POSITIVE_INFINITY})}),i(u).forEach(function(d){var f=d.v===u?d.w:d.v,p=o(d);a[u][f]={distance:p,predecessor:u}})}),c.forEach(function(u){var d=a[u];c.forEach(function(f){var p=a[f];c.forEach(function(h){var y=p[u],v=d[h],w=p[h],g=y.distance+v.distance;g<w.distance&&(w.distance=g,w.predecessor=v.predecessor)})})}),a}return mh}var gh,k_;function HE(){if(k_)return gh;k_=1;var e=tr();gh=t,t.CycleException=r;function t(n){var s={},o={},i=[];function a(c){if(e.has(o,c))throw new r;e.has(s,c)||(o[c]=!0,s[c]=!0,e.each(n.predecessors(c),a),delete o[c],i.push(c))}if(e.each(n.sinks(),a),e.size(s)!==n.nodeCount())throw new r;return i}function r(){}return r.prototype=new Error,gh}var vh,N_;function RO(){if(N_)return vh;N_=1;var e=HE();vh=t;function t(r){try{e(r)}catch(n){if(n instanceof e.CycleException)return!1;throw n}return!0}return vh}var xh,E_;function WE(){if(E_)return xh;E_=1;var e=tr();xh=t;function t(n,s,o){e.isArray(s)||(s=[s]);var i=(n.isDirected()?n.successors:n.neighbors).bind(n),a=[],c={};return e.each(s,function(u){if(!n.hasNode(u))throw new Error("Graph does not have node: "+u);r(n,u,o==="post",c,i,a)}),a}function r(n,s,o,i,a,c){e.has(i,s)||(i[s]=!0,o||c.push(s),e.each(a(s),function(u){r(n,u,o,i,a,c)}),o&&c.push(s))}return xh}var yh,C_;function TO(){if(C_)return yh;C_=1;var e=WE();yh=t;function t(r,n){return e(r,n,"post")}return yh}var bh,R_;function IO(){if(R_)return bh;R_=1;var e=WE();bh=t;function t(r,n){return e(r,n,"pre")}return bh}var wh,T_;function MO(){if(T_)return wh;T_=1;var e=tr(),t=yx(),r=$E();wh=n;function n(s,o){var i=new t,a={},c=new r,u;function d(p){var h=p.v===u?p.w:p.v,y=c.priority(h);if(y!==void 0){var v=o(p);v<y&&(a[h]=u,c.decrease(h,v))}}if(s.nodeCount()===0)return i;e.each(s.nodes(),function(p){c.add(p,Number.POSITIVE_INFINITY),i.setNode(p)}),c.decrease(s.nodes()[0],0);for(var f=!1;c.size()>0;){if(u=c.removeMin(),e.has(a,u))i.setEdge(u,a[u]);else{if(f)throw new Error("Input graph is not connected: "+s);f=!0}s.nodeEdges(u).forEach(d)}return i}return wh}var _h,I_;function AO(){return I_||(I_=1,_h={components:kO(),dijkstra:FE(),dijkstraAll:NO(),findCycles:EO(),floydWarshall:CO(),isAcyclic:RO(),postorder:TO(),preorder:IO(),prim:MO(),tarjan:BE(),topsort:HE()}),_h}var Sh,M_;function PO(){if(M_)return Sh;M_=1;var e=SO();return Sh={Graph:e.Graph,json:jO(),alg:AO(),version:e.version},Sh}var Pl;if(typeof nx=="function")try{Pl=PO()}catch{}Pl||(Pl=window.graphlib);var xr=Pl,jh,A_;function DO(){if(A_)return jh;A_=1;var e=mE(),t=1,r=4;function n(s){return e(s,t|r)}return jh=n,jh}var kh,P_;function Ac(){if(P_)return kh;P_=1;var e=ho(),t=rn(),r=jc(),n=er();function s(o,i,a){if(!n(a))return!1;var c=typeof i;return(c=="number"?t(a)&&r(i,a.length):c=="string"&&i in a)?e(a[i],o):!1}return kh=s,kh}var Nh,D_;function OO(){if(D_)return Nh;D_=1;var e=Mc(),t=ho(),r=Ac(),n=bs(),s=Object.prototype,o=s.hasOwnProperty,i=e(function(a,c){a=Object(a);var u=-1,d=c.length,f=d>2?c[2]:void 0;for(f&&r(c[0],c[1],f)&&(d=1);++u<d;)for(var p=c[u],h=n(p),y=-1,v=h.length;++y<v;){var w=h[y],g=a[w];(g===void 0||t(g,s[w])&&!o.call(a,w))&&(a[w]=p[w])}return a});return Nh=i,Nh}var Eh,O_;function LO(){if(O_)return Eh;O_=1;var e=nn(),t=rn(),r=Fn();function n(s){return function(o,i,a){var c=Object(o);if(!t(o)){var u=e(i,3);o=r(o),i=function(f){return u(c[f],f,c)}}var d=s(o,i,a);return d>-1?c[u?o[d]:d]:void 0}}return Eh=n,Eh}var Ch,L_;function zO(){if(L_)return Ch;L_=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return Ch=t,Ch}var Rh,z_;function qO(){if(z_)return Rh;z_=1;var e=zO(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return Rh=r,Rh}var Th,q_;function $O(){if(q_)return Th;q_=1;var e=qO(),t=er(),r=xo(),n=NaN,s=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,i=/^0o[0-7]+$/i,a=parseInt;function c(u){if(typeof u=="number")return u;if(r(u))return n;if(t(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=t(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=e(u);var f=o.test(u);return f||i.test(u)?a(u.slice(2),f?2:8):s.test(u)?n:+u}return Th=c,Th}var Ih,$_;function VE(){if($_)return Ih;$_=1;var e=$O(),t=1/0,r=17976931348623157e292;function n(s){if(!s)return s===0?s:0;if(s=e(s),s===t||s===-t){var o=s<0?-1:1;return o*r}return s===s?s:0}return Ih=n,Ih}var Mh,F_;function FO(){if(F_)return Mh;F_=1;var e=VE();function t(r){var n=e(r),s=n%1;return n===n?s?n-s:n:0}return Mh=t,Mh}var Ah,B_;function BO(){if(B_)return Ah;B_=1;var e=LE(),t=nn(),r=FO(),n=Math.max;function s(o,i,a){var c=o==null?0:o.length;if(!c)return-1;var u=a==null?0:r(a);return u<0&&(u=n(c+u,0)),e(o,t(i,3),u)}return Ah=s,Ah}var Ph,H_;function HO(){if(H_)return Ph;H_=1;var e=LO(),t=BO(),r=e(t);return Ph=r,Ph}var Dh,W_;function UE(){if(W_)return Dh;W_=1;var e=xx();function t(r){var n=r==null?0:r.length;return n?e(r,1):[]}return Dh=t,Dh}var Oh,V_;function WO(){if(V_)return Oh;V_=1;var e=hx(),t=gE(),r=bs();function n(s,o){return s==null?s:e(s,t(o),r)}return Oh=n,Oh}var Lh,U_;function VO(){if(U_)return Lh;U_=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return Lh=e,Lh}var zh,G_;function UO(){if(G_)return zh;G_=1;var e=_c(),t=mx(),r=nn();function n(s,o){var i={};return o=r(o,3),t(s,function(a,c,u){e(i,c,o(a,c,u))}),i}return zh=n,zh}var qh,K_;function bx(){if(K_)return qh;K_=1;var e=xo();function t(r,n,s){for(var o=-1,i=r.length;++o<i;){var a=r[o],c=n(a);if(c!=null&&(u===void 0?c===c&&!e(c):s(c,u)))var u=c,d=a}return d}return qh=t,qh}var $h,Y_;function GO(){if(Y_)return $h;Y_=1;function e(t,r){return t>r}return $h=e,$h}var Fh,X_;function KO(){if(X_)return Fh;X_=1;var e=bx(),t=GO(),r=ws();function n(s){return s&&s.length?e(s,r,t):void 0}return Fh=n,Fh}var Bh,Q_;function GE(){if(Q_)return Bh;Q_=1;var e=_c(),t=ho();function r(n,s,o){(o!==void 0&&!t(n[s],o)||o===void 0&&!(s in n))&&e(n,s,o)}return Bh=r,Bh}var Hh,Z_;function YO(){if(Z_)return Hh;Z_=1;var e=xs(),t=Ec(),r=Pr(),n="[object Object]",s=Function.prototype,o=Object.prototype,i=s.toString,a=o.hasOwnProperty,c=i.call(Object);function u(d){if(!r(d)||e(d)!=n)return!1;var f=t(d);if(f===null)return!0;var p=a.call(f,"constructor")&&f.constructor;return typeof p=="function"&&p instanceof p&&i.call(p)==c}return Hh=u,Hh}var Wh,J_;function KE(){if(J_)return Wh;J_=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return Wh=e,Wh}var Vh,e2;function XO(){if(e2)return Vh;e2=1;var e=Yi(),t=bs();function r(n){return e(n,t(n))}return Vh=r,Vh}var Uh,t2;function QO(){if(t2)return Uh;t2=1;var e=GE(),t=nE(),r=fE(),n=sE(),s=hE(),o=Xi(),i=He(),a=zE(),c=go(),u=Ki(),d=er(),f=YO(),p=Qi(),h=KE(),y=XO();function v(w,g,x,b,_,S,k){var N=h(w,x),j=h(g,x),C=k.get(j);if(C){e(w,x,C);return}var R=S?S(N,j,x+"",w,g,k):void 0,T=R===void 0;if(T){var L=i(j),$=!L&&c(j),E=!L&&!$&&p(j);R=j,L||$||E?i(N)?R=N:a(N)?R=n(N):$?(T=!1,R=t(j,!0)):E?(T=!1,R=r(j,!0)):R=[]:f(j)||o(j)?(R=N,o(N)?R=y(N):(!d(N)||u(N))&&(R=s(j))):T=!1}T&&(k.set(j,R),_(R,j,b,S,k),k.delete(j)),e(w,x,R)}return Uh=v,Uh}var Gh,r2;function ZO(){if(r2)return Gh;r2=1;var e=wc(),t=GE(),r=hx(),n=QO(),s=er(),o=bs(),i=KE();function a(c,u,d,f,p){c!==u&&r(u,function(h,y){if(p||(p=new e),s(h))n(c,u,y,d,a,f,p);else{var v=f?f(i(c,y),h,y+"",c,u,p):void 0;v===void 0&&(v=h),t(c,y,v)}},o)}return Gh=a,Gh}var Kh,n2;function JO(){if(n2)return Kh;n2=1;var e=Mc(),t=Ac();function r(n){return e(function(s,o){var i=-1,a=o.length,c=a>1?o[a-1]:void 0,u=a>2?o[2]:void 0;for(c=n.length>3&&typeof c=="function"?(a--,c):void 0,u&&t(o[0],o[1],u)&&(c=a<3?void 0:c,a=1),s=Object(s);++i<a;){var d=o[i];d&&n(s,d,i,c)}return s})}return Kh=r,Kh}var Yh,s2;function e8(){if(s2)return Yh;s2=1;var e=ZO(),t=JO(),r=t(function(n,s,o){e(n,s,o)});return Yh=r,Yh}var Xh,o2;function YE(){if(o2)return Xh;o2=1;function e(t,r){return t<r}return Xh=e,Xh}var Qh,i2;function t8(){if(i2)return Qh;i2=1;var e=bx(),t=YE(),r=ws();function n(s){return s&&s.length?e(s,r,t):void 0}return Qh=n,Qh}var Zh,a2;function r8(){if(a2)return Zh;a2=1;var e=bx(),t=nn(),r=YE();function n(s,o){return s&&s.length?e(s,t(o,2),r):void 0}return Zh=n,Zh}var Jh,l2;function n8(){if(l2)return Jh;l2=1;var e=vr(),t=function(){return e.Date.now()};return Jh=t,Jh}var em,c2;function s8(){if(c2)return em;c2=1;var e=Sc(),t=Tc(),r=jc(),n=er(),s=Zi();function o(i,a,c,u){if(!n(i))return i;a=t(a,i);for(var d=-1,f=a.length,p=f-1,h=i;h!=null&&++d<f;){var y=s(a[d]),v=c;if(y==="__proto__"||y==="constructor"||y==="prototype")return i;if(d!=p){var w=h[y];v=u?u(w,y,h):void 0,v===void 0&&(v=n(w)?w:r(a[d+1])?[]:{})}e(h,y,v),h=h[y]}return i}return em=o,em}var tm,u2;function o8(){if(u2)return tm;u2=1;var e=Ic(),t=s8(),r=Tc();function n(s,o,i){for(var a=-1,c=o.length,u={};++a<c;){var d=o[a],f=e(s,d);i(f,d)&&t(u,r(d,s),f)}return u}return tm=n,tm}var rm,d2;function i8(){if(d2)return rm;d2=1;var e=o8(),t=EE();function r(n,s){return e(n,s,function(o,i){return t(n,i)})}return rm=r,rm}var nm,f2;function a8(){if(f2)return nm;f2=1;var e=UE(),t=DE(),r=OE();function n(s){return r(t(s,void 0,e),s+"")}return nm=n,nm}var sm,p2;function l8(){if(p2)return sm;p2=1;var e=i8(),t=a8(),r=t(function(n,s){return n==null?{}:e(n,s)});return sm=r,sm}var om,h2;function c8(){if(h2)return om;h2=1;var e=Math.ceil,t=Math.max;function r(n,s,o,i){for(var a=-1,c=t(e((s-n)/(o||1)),0),u=Array(c);c--;)u[i?c:++a]=n,n+=o;return u}return om=r,om}var im,m2;function u8(){if(m2)return im;m2=1;var e=c8(),t=Ac(),r=VE();function n(s){return function(o,i,a){return a&&typeof a!="number"&&t(o,i,a)&&(i=a=void 0),o=r(o),i===void 0?(i=o,o=0):i=r(i),a=a===void 0?o<i?1:-1:r(a),e(o,i,a,s)}}return im=n,im}var am,g2;function d8(){if(g2)return am;g2=1;var e=u8(),t=e();return am=t,am}var lm,v2;function f8(){if(v2)return lm;v2=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return lm=e,lm}var cm,x2;function p8(){if(x2)return cm;x2=1;var e=xo();function t(r,n){if(r!==n){var s=r!==void 0,o=r===null,i=r===r,a=e(r),c=n!==void 0,u=n===null,d=n===n,f=e(n);if(!u&&!f&&!a&&r>n||a&&c&&d&&!u&&!f||o&&c&&d||!s&&d||!i)return 1;if(!o&&!a&&!f&&r<n||f&&s&&i&&!o&&!a||u&&s&&i||!c&&i||!d)return-1}return 0}return cm=t,cm}var um,y2;function h8(){if(y2)return um;y2=1;var e=p8();function t(r,n,s){for(var o=-1,i=r.criteria,a=n.criteria,c=i.length,u=s.length;++o<c;){var d=e(i[o],a[o]);if(d){if(o>=u)return d;var f=s[o];return d*(f=="desc"?-1:1)}}return r.index-n.index}return um=t,um}var dm,b2;function m8(){if(b2)return dm;b2=1;var e=Rc(),t=Ic(),r=nn(),n=ME(),s=f8(),o=kc(),i=h8(),a=ws(),c=He();function u(d,f,p){f.length?f=e(f,function(v){return c(v)?function(w){return t(w,v.length===1?v[0]:v)}:v}):f=[a];var h=-1;f=e(f,o(r));var y=n(d,function(v,w,g){var x=e(f,function(b){return b(v)});return{criteria:x,index:++h,value:v}});return s(y,function(v,w){return i(v,w,p)})}return dm=u,dm}var fm,w2;function g8(){if(w2)return fm;w2=1;var e=xx(),t=m8(),r=Mc(),n=Ac(),s=r(function(o,i){if(o==null)return[];var a=i.length;return a>1&&n(o,i[0],i[1])?i=[]:a>2&&n(i[0],i[1],i[2])&&(i=[i[0]]),t(o,e(i,1),[])});return fm=s,fm}var pm,_2;function v8(){if(_2)return pm;_2=1;var e=kE(),t=0;function r(n){var s=++t;return e(n)+s}return pm=r,pm}var hm,S2;function x8(){if(S2)return hm;S2=1;function e(t,r,n){for(var s=-1,o=t.length,i=r.length,a={};++s<o;){var c=s<i?r[s]:void 0;n(a,t[s],c)}return a}return hm=e,hm}var mm,j2;function y8(){if(j2)return mm;j2=1;var e=Sc(),t=x8();function r(n,s){return t(n||[],s||[],e)}return mm=r,mm}var Dl;if(typeof nx=="function")try{Dl={cloneDeep:DO(),constant:px(),defaults:OO(),each:xE(),filter:RE(),find:HO(),flatten:UE(),forEach:vE(),forIn:WO(),has:TE(),isUndefined:IE(),last:VO(),map:AE(),mapValues:UO(),max:KO(),merge:e8(),min:t8(),minBy:r8(),now:n8(),pick:l8(),range:d8(),reduce:PE(),sortBy:g8(),uniqueId:v8(),values:qE(),zipObject:y8()}}catch{}Dl||(Dl=window._);var Ae=Dl,b8=Pc;function Pc(){var e={};e._next=e._prev=e,this._sentinel=e}Pc.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return XE(t),t};Pc.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&XE(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};Pc.prototype.toString=function(){for(var e=[],t=this._sentinel,r=t._prev;r!==t;)e.push(JSON.stringify(r,w8)),r=r._prev;return"["+e.join(", ")+"]"};function XE(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function w8(e,t){if(e!=="_next"&&e!=="_prev")return t}var Wr=Ae,_8=xr.Graph,S8=b8,j8=N8,k8=Wr.constant(1);function N8(e,t){if(e.nodeCount()<=1)return[];var r=C8(e,t||k8),n=E8(r.graph,r.buckets,r.zeroIdx);return Wr.flatten(Wr.map(n,function(s){return e.outEdges(s.v,s.w)}),!0)}function E8(e,t,r){for(var n=[],s=t[t.length-1],o=t[0],i;e.nodeCount();){for(;i=o.dequeue();)gm(e,t,r,i);for(;i=s.dequeue();)gm(e,t,r,i);if(e.nodeCount()){for(var a=t.length-2;a>0;--a)if(i=t[a].dequeue(),i){n=n.concat(gm(e,t,r,i,!0));break}}}return n}function gm(e,t,r,n,s){var o=s?[]:void 0;return Wr.forEach(e.inEdges(n.v),function(i){var a=e.edge(i),c=e.node(i.v);s&&o.push({v:i.v,w:i.w}),c.out-=a,Lg(t,r,c)}),Wr.forEach(e.outEdges(n.v),function(i){var a=e.edge(i),c=i.w,u=e.node(c);u.in-=a,Lg(t,r,u)}),e.removeNode(n.v),o}function C8(e,t){var r=new _8,n=0,s=0;Wr.forEach(e.nodes(),function(a){r.setNode(a,{v:a,in:0,out:0})}),Wr.forEach(e.edges(),function(a){var c=r.edge(a.v,a.w)||0,u=t(a),d=c+u;r.setEdge(a.v,a.w,d),s=Math.max(s,r.node(a.v).out+=u),n=Math.max(n,r.node(a.w).in+=u)});var o=Wr.range(s+n+3).map(function(){return new S8}),i=n+1;return Wr.forEach(r.nodes(),function(a){Lg(o,i,r.node(a))}),{graph:r,buckets:o,zeroIdx:i}}function Lg(e,t,r){r.out?r.in?e[r.out-r.in+t].enqueue(r):e[e.length-1].enqueue(r):e[0].enqueue(r)}var ss=Ae,R8=j8,T8={run:I8,undo:A8};function I8(e){var t=e.graph().acyclicer==="greedy"?R8(e,r(e)):M8(e);ss.forEach(t,function(n){var s=e.edge(n);e.removeEdge(n),s.forwardName=n.name,s.reversed=!0,e.setEdge(n.w,n.v,s,ss.uniqueId("rev"))});function r(n){return function(s){return n.edge(s).weight}}}function M8(e){var t=[],r={},n={};function s(o){ss.has(n,o)||(n[o]=!0,r[o]=!0,ss.forEach(e.outEdges(o),function(i){ss.has(r,i.w)?t.push(i):s(i.w)}),delete r[o])}return ss.forEach(e.nodes(),s),t}function A8(e){ss.forEach(e.edges(),function(t){var r=e.edge(t);if(r.reversed){e.removeEdge(t);var n=r.forwardName;delete r.reversed,delete r.forwardName,e.setEdge(t.w,t.v,r,n)}})}var ve=Ae,QE=xr.Graph,Ct={addDummyNode:ZE,simplify:P8,asNonCompoundGraph:D8,successorWeights:O8,predecessorWeights:L8,intersectRect:z8,buildLayerMatrix:q8,normalizeRanks:$8,removeEmptyRanks:F8,addBorderNode:B8,maxRank:JE,partition:H8,time:W8,notime:V8};function ZE(e,t,r,n){var s;do s=ve.uniqueId(n);while(e.hasNode(s));return r.dummy=t,e.setNode(s,r),s}function P8(e){var t=new QE().setGraph(e.graph());return ve.forEach(e.nodes(),function(r){t.setNode(r,e.node(r))}),ve.forEach(e.edges(),function(r){var n=t.edge(r.v,r.w)||{weight:0,minlen:1},s=e.edge(r);t.setEdge(r.v,r.w,{weight:n.weight+s.weight,minlen:Math.max(n.minlen,s.minlen)})}),t}function D8(e){var t=new QE({multigraph:e.isMultigraph()}).setGraph(e.graph());return ve.forEach(e.nodes(),function(r){e.children(r).length||t.setNode(r,e.node(r))}),ve.forEach(e.edges(),function(r){t.setEdge(r,e.edge(r))}),t}function O8(e){var t=ve.map(e.nodes(),function(r){var n={};return ve.forEach(e.outEdges(r),function(s){n[s.w]=(n[s.w]||0)+e.edge(s).weight}),n});return ve.zipObject(e.nodes(),t)}function L8(e){var t=ve.map(e.nodes(),function(r){var n={};return ve.forEach(e.inEdges(r),function(s){n[s.v]=(n[s.v]||0)+e.edge(s).weight}),n});return ve.zipObject(e.nodes(),t)}function z8(e,t){var r=e.x,n=e.y,s=t.x-r,o=t.y-n,i=e.width/2,a=e.height/2;if(!s&&!o)throw new Error("Not possible to find intersection inside of the rectangle");var c,u;return Math.abs(o)*i>Math.abs(s)*a?(o<0&&(a=-a),c=a*s/o,u=a):(s<0&&(i=-i),c=i,u=i*o/s),{x:r+c,y:n+u}}function q8(e){var t=ve.map(ve.range(JE(e)+1),function(){return[]});return ve.forEach(e.nodes(),function(r){var n=e.node(r),s=n.rank;ve.isUndefined(s)||(t[s][n.order]=r)}),t}function $8(e){var t=ve.min(ve.map(e.nodes(),function(r){return e.node(r).rank}));ve.forEach(e.nodes(),function(r){var n=e.node(r);ve.has(n,"rank")&&(n.rank-=t)})}function F8(e){var t=ve.min(ve.map(e.nodes(),function(o){return e.node(o).rank})),r=[];ve.forEach(e.nodes(),function(o){var i=e.node(o).rank-t;r[i]||(r[i]=[]),r[i].push(o)});var n=0,s=e.graph().nodeRankFactor;ve.forEach(r,function(o,i){ve.isUndefined(o)&&i%s!==0?--n:n&&ve.forEach(o,function(a){e.node(a).rank+=n})})}function B8(e,t,r,n){var s={width:0,height:0};return arguments.length>=4&&(s.rank=r,s.order=n),ZE(e,"border",s,t)}function JE(e){return ve.max(ve.map(e.nodes(),function(t){var r=e.node(t).rank;if(!ve.isUndefined(r))return r}))}function H8(e,t){var r={lhs:[],rhs:[]};return ve.forEach(e,function(n){t(n)?r.lhs.push(n):r.rhs.push(n)}),r}function W8(e,t){var r=ve.now();try{return t()}finally{console.log(e+" time: "+(ve.now()-r)+"ms")}}function V8(e,t){return t()}var eC=Ae,U8=Ct,G8={run:K8,undo:X8};function K8(e){e.graph().dummyChains=[],eC.forEach(e.edges(),function(t){Y8(e,t)})}function Y8(e,t){var r=t.v,n=e.node(r).rank,s=t.w,o=e.node(s).rank,i=t.name,a=e.edge(t),c=a.labelRank;if(o!==n+1){e.removeEdge(t);var u,d,f;for(f=0,++n;n<o;++f,++n)a.points=[],d={width:0,height:0,edgeLabel:a,edgeObj:t,rank:n},u=U8.addDummyNode(e,"edge",d,"_d"),n===c&&(d.width=a.width,d.height=a.height,d.dummy="edge-label",d.labelpos=a.labelpos),e.setEdge(r,u,{weight:a.weight},i),f===0&&e.graph().dummyChains.push(u),r=u;e.setEdge(r,s,{weight:a.weight},i)}}function X8(e){eC.forEach(e.graph().dummyChains,function(t){var r=e.node(t),n=r.edgeLabel,s;for(e.setEdge(r.edgeObj,n);r.dummy;)s=e.successors(t)[0],e.removeNode(t),n.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(n.x=r.x,n.y=r.y,n.width=r.width,n.height=r.height),t=s,r=e.node(t)})}var Ta=Ae,Dc={longestPath:Q8,slack:Z8};function Q8(e){var t={};function r(n){var s=e.node(n);if(Ta.has(t,n))return s.rank;t[n]=!0;var o=Ta.min(Ta.map(e.outEdges(n),function(i){return r(i.w)-e.edge(i).minlen}));return(o===Number.POSITIVE_INFINITY||o===void 0||o===null)&&(o=0),s.rank=o}Ta.forEach(e.sources(),r)}function Z8(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var Ol=Ae,J8=xr.Graph,Ll=Dc.slack,tC=eL;function eL(e){var t=new J8({directed:!1}),r=e.nodes()[0],n=e.nodeCount();t.setNode(r,{});for(var s,o;tL(t,e)<n;)s=rL(t,e),o=t.hasNode(s.v)?Ll(e,s):-Ll(e,s),nL(t,e,o);return t}function tL(e,t){function r(n){Ol.forEach(t.nodeEdges(n),function(s){var o=s.v,i=n===o?s.w:o;!e.hasNode(i)&&!Ll(t,s)&&(e.setNode(i,{}),e.setEdge(n,i,{}),r(i))})}return Ol.forEach(e.nodes(),r),e.nodeCount()}function rL(e,t){return Ol.minBy(t.edges(),function(r){if(e.hasNode(r.v)!==e.hasNode(r.w))return Ll(t,r)})}function nL(e,t,r){Ol.forEach(e.nodes(),function(n){t.node(n).rank+=r})}var en=Ae,sL=tC,oL=Dc.slack,iL=Dc.longestPath,aL=xr.alg.preorder,lL=xr.alg.postorder,cL=Ct.simplify,uL=_s;_s.initLowLimValues=_x;_s.initCutValues=wx;_s.calcCutValue=rC;_s.leaveEdge=sC;_s.enterEdge=oC;_s.exchangeEdges=iC;function _s(e){e=cL(e),iL(e);var t=sL(e);_x(t),wx(t,e);for(var r,n;r=sC(t);)n=oC(t,e,r),iC(t,e,r,n)}function wx(e,t){var r=lL(e,e.nodes());r=r.slice(0,r.length-1),en.forEach(r,function(n){dL(e,t,n)})}function dL(e,t,r){var n=e.node(r),s=n.parent;e.edge(r,s).cutvalue=rC(e,t,r)}function rC(e,t,r){var n=e.node(r),s=n.parent,o=!0,i=t.edge(r,s),a=0;return i||(o=!1,i=t.edge(s,r)),a=i.weight,en.forEach(t.nodeEdges(r),function(c){var u=c.v===r,d=u?c.w:c.v;if(d!==s){var f=u===o,p=t.edge(c).weight;if(a+=f?p:-p,pL(e,r,d)){var h=e.edge(r,d).cutvalue;a+=f?-h:h}}}),a}function _x(e,t){arguments.length<2&&(t=e.nodes()[0]),nC(e,{},1,t)}function nC(e,t,r,n,s){var o=r,i=e.node(n);return t[n]=!0,en.forEach(e.neighbors(n),function(a){en.has(t,a)||(r=nC(e,t,r,a,n))}),i.low=o,i.lim=r++,s?i.parent=s:delete i.parent,r}function sC(e){return en.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function oC(e,t,r){var n=r.v,s=r.w;t.hasEdge(n,s)||(n=r.w,s=r.v);var o=e.node(n),i=e.node(s),a=o,c=!1;o.lim>i.lim&&(a=i,c=!0);var u=en.filter(t.edges(),function(d){return c===k2(e,e.node(d.v),a)&&c!==k2(e,e.node(d.w),a)});return en.minBy(u,function(d){return oL(t,d)})}function iC(e,t,r,n){var s=r.v,o=r.w;e.removeEdge(s,o),e.setEdge(n.v,n.w,{}),_x(e),wx(e,t),fL(e,t)}function fL(e,t){var r=en.find(e.nodes(),function(s){return!t.node(s).parent}),n=aL(e,r);n=n.slice(1),en.forEach(n,function(s){var o=e.node(s).parent,i=t.edge(s,o),a=!1;i||(i=t.edge(o,s),a=!0),t.node(s).rank=t.node(o).rank+(a?i.minlen:-i.minlen)})}function pL(e,t,r){return e.hasEdge(t,r)}function k2(e,t,r){return r.low<=t.lim&&t.lim<=r.lim}var hL=Dc,aC=hL.longestPath,mL=tC,gL=uL,vL=xL;function xL(e){switch(e.graph().ranker){case"network-simplex":N2(e);break;case"tight-tree":bL(e);break;case"longest-path":yL(e);break;default:N2(e)}}var yL=aC;function bL(e){aC(e),mL(e)}function N2(e){gL(e)}var zg=Ae,wL=_L;function _L(e){var t=jL(e);zg.forEach(e.graph().dummyChains,function(r){for(var n=e.node(r),s=n.edgeObj,o=SL(e,t,s.v,s.w),i=o.path,a=o.lca,c=0,u=i[c],d=!0;r!==s.w;){if(n=e.node(r),d){for(;(u=i[c])!==a&&e.node(u).maxRank<n.rank;)c++;u===a&&(d=!1)}if(!d){for(;c<i.length-1&&e.node(u=i[c+1]).minRank<=n.rank;)c++;u=i[c]}e.setParent(r,u),r=e.successors(r)[0]}})}function SL(e,t,r,n){var s=[],o=[],i=Math.min(t[r].low,t[n].low),a=Math.max(t[r].lim,t[n].lim),c,u;c=r;do c=e.parent(c),s.push(c);while(c&&(t[c].low>i||a>t[c].lim));for(u=c,c=n;(c=e.parent(c))!==u;)o.push(c);return{path:s.concat(o.reverse()),lca:u}}function jL(e){var t={},r=0;function n(s){var o=r;zg.forEach(e.children(s),n),t[s]={low:o,lim:r++}}return zg.forEach(e.children(),n),t}var Vr=Ae,qg=Ct,kL={run:NL,cleanup:RL};function NL(e){var t=qg.addDummyNode(e,"root",{},"_root"),r=EL(e),n=Vr.max(Vr.values(r))-1,s=2*n+1;e.graph().nestingRoot=t,Vr.forEach(e.edges(),function(i){e.edge(i).minlen*=s});var o=CL(e)+1;Vr.forEach(e.children(),function(i){lC(e,t,s,o,n,r,i)}),e.graph().nodeRankFactor=s}function lC(e,t,r,n,s,o,i){var a=e.children(i);if(!a.length){i!==t&&e.setEdge(t,i,{weight:0,minlen:r});return}var c=qg.addBorderNode(e,"_bt"),u=qg.addBorderNode(e,"_bb"),d=e.node(i);e.setParent(c,i),d.borderTop=c,e.setParent(u,i),d.borderBottom=u,Vr.forEach(a,function(f){lC(e,t,r,n,s,o,f);var p=e.node(f),h=p.borderTop?p.borderTop:f,y=p.borderBottom?p.borderBottom:f,v=p.borderTop?n:2*n,w=h!==y?1:s-o[i]+1;e.setEdge(c,h,{weight:v,minlen:w,nestingEdge:!0}),e.setEdge(y,u,{weight:v,minlen:w,nestingEdge:!0})}),e.parent(i)||e.setEdge(t,c,{weight:0,minlen:s+o[i]})}function EL(e){var t={};function r(n,s){var o=e.children(n);o&&o.length&&Vr.forEach(o,function(i){r(i,s+1)}),t[n]=s}return Vr.forEach(e.children(),function(n){r(n,1)}),t}function CL(e){return Vr.reduce(e.edges(),function(t,r){return t+e.edge(r).weight},0)}function RL(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,Vr.forEach(e.edges(),function(r){var n=e.edge(r);n.nestingEdge&&e.removeEdge(r)})}var vm=Ae,TL=Ct,IL=ML;function ML(e){function t(r){var n=e.children(r),s=e.node(r);if(n.length&&vm.forEach(n,t),vm.has(s,"minRank")){s.borderLeft=[],s.borderRight=[];for(var o=s.minRank,i=s.maxRank+1;o<i;++o)E2(e,"borderLeft","_bl",r,s,o),E2(e,"borderRight","_br",r,s,o)}}vm.forEach(e.children(),t)}function E2(e,t,r,n,s,o){var i={width:0,height:0,rank:o,borderType:t},a=s[t][o-1],c=TL.addDummyNode(e,"border",i,r);s[t][o]=c,e.setParent(c,n),a&&e.setEdge(a,c,{weight:1})}var Er=Ae,AL={adjust:PL,undo:DL};function PL(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&cC(e)}function DL(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&OL(e),(t==="lr"||t==="rl")&&(LL(e),cC(e))}function cC(e){Er.forEach(e.nodes(),function(t){C2(e.node(t))}),Er.forEach(e.edges(),function(t){C2(e.edge(t))})}function C2(e){var t=e.width;e.width=e.height,e.height=t}function OL(e){Er.forEach(e.nodes(),function(t){xm(e.node(t))}),Er.forEach(e.edges(),function(t){var r=e.edge(t);Er.forEach(r.points,xm),Er.has(r,"y")&&xm(r)})}function xm(e){e.y=-e.y}function LL(e){Er.forEach(e.nodes(),function(t){ym(e.node(t))}),Er.forEach(e.edges(),function(t){var r=e.edge(t);Er.forEach(r.points,ym),Er.has(r,"x")&&ym(r)})}function ym(e){var t=e.x;e.x=e.y,e.y=t}var Or=Ae,zL=qL;function qL(e){var t={},r=Or.filter(e.nodes(),function(a){return!e.children(a).length}),n=Or.max(Or.map(r,function(a){return e.node(a).rank})),s=Or.map(Or.range(n+1),function(){return[]});function o(a){if(!Or.has(t,a)){t[a]=!0;var c=e.node(a);s[c.rank].push(a),Or.forEach(e.successors(a),o)}}var i=Or.sortBy(r,function(a){return e.node(a).rank});return Or.forEach(i,o),s}var cn=Ae,$L=FL;function FL(e,t){for(var r=0,n=1;n<t.length;++n)r+=BL(e,t[n-1],t[n]);return r}function BL(e,t,r){for(var n=cn.zipObject(r,cn.map(r,function(u,d){return d})),s=cn.flatten(cn.map(t,function(u){return cn.sortBy(cn.map(e.outEdges(u),function(d){return{pos:n[d.w],weight:e.edge(d).weight}}),"pos")}),!0),o=1;o<r.length;)o<<=1;var i=2*o-1;o-=1;var a=cn.map(new Array(i),function(){return 0}),c=0;return cn.forEach(s.forEach(function(u){var d=u.pos+o;a[d]+=u.weight;for(var f=0;d>0;)d%2&&(f+=a[d+1]),d=d-1>>1,a[d]+=u.weight;c+=u.weight*f})),c}var R2=Ae,HL=WL;function WL(e,t){return R2.map(t,function(r){var n=e.inEdges(r);if(n.length){var s=R2.reduce(n,function(o,i){var a=e.edge(i),c=e.node(i.v);return{sum:o.sum+a.weight*c.order,weight:o.weight+a.weight}},{sum:0,weight:0});return{v:r,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:r}})}var At=Ae,VL=UL;function UL(e,t){var r={};At.forEach(e,function(s,o){var i=r[s.v]={indegree:0,in:[],out:[],vs:[s.v],i:o};At.isUndefined(s.barycenter)||(i.barycenter=s.barycenter,i.weight=s.weight)}),At.forEach(t.edges(),function(s){var o=r[s.v],i=r[s.w];!At.isUndefined(o)&&!At.isUndefined(i)&&(i.indegree++,o.out.push(r[s.w]))});var n=At.filter(r,function(s){return!s.indegree});return GL(n)}function GL(e){var t=[];function r(o){return function(i){i.merged||(At.isUndefined(i.barycenter)||At.isUndefined(o.barycenter)||i.barycenter>=o.barycenter)&&KL(o,i)}}function n(o){return function(i){i.in.push(o),--i.indegree===0&&e.push(i)}}for(;e.length;){var s=e.pop();t.push(s),At.forEach(s.in.reverse(),r(s)),At.forEach(s.out,n(s))}return At.map(At.filter(t,function(o){return!o.merged}),function(o){return At.pick(o,["vs","i","barycenter","weight"])})}function KL(e,t){var r=0,n=0;e.weight&&(r+=e.barycenter*e.weight,n+=e.weight),t.weight&&(r+=t.barycenter*t.weight,n+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=r/n,e.weight=n,e.i=Math.min(t.i,e.i),t.merged=!0}var Xo=Ae,YL=Ct,XL=QL;function QL(e,t){var r=YL.partition(e,function(d){return Xo.has(d,"barycenter")}),n=r.lhs,s=Xo.sortBy(r.rhs,function(d){return-d.i}),o=[],i=0,a=0,c=0;n.sort(ZL(!!t)),c=T2(o,s,c),Xo.forEach(n,function(d){c+=d.vs.length,o.push(d.vs),i+=d.barycenter*d.weight,a+=d.weight,c=T2(o,s,c)});var u={vs:Xo.flatten(o,!0)};return a&&(u.barycenter=i/a,u.weight=a),u}function T2(e,t,r){for(var n;t.length&&(n=Xo.last(t)).i<=r;)t.pop(),e.push(n.vs),r++;return r}function ZL(e){return function(t,r){return t.barycenter<r.barycenter?-1:t.barycenter>r.barycenter?1:e?r.i-t.i:t.i-r.i}}var wn=Ae,JL=HL,ez=VL,tz=XL,rz=uC;function uC(e,t,r,n){var s=e.children(t),o=e.node(t),i=o?o.borderLeft:void 0,a=o?o.borderRight:void 0,c={};i&&(s=wn.filter(s,function(y){return y!==i&&y!==a}));var u=JL(e,s);wn.forEach(u,function(y){if(e.children(y.v).length){var v=uC(e,y.v,r,n);c[y.v]=v,wn.has(v,"barycenter")&&sz(y,v)}});var d=ez(u,r);nz(d,c);var f=tz(d,n);if(i&&(f.vs=wn.flatten([i,f.vs,a],!0),e.predecessors(i).length)){var p=e.node(e.predecessors(i)[0]),h=e.node(e.predecessors(a)[0]);wn.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+p.order+h.order)/(f.weight+2),f.weight+=2}return f}function nz(e,t){wn.forEach(e,function(r){r.vs=wn.flatten(r.vs.map(function(n){return t[n]?t[n].vs:n}),!0)})}function sz(e,t){wn.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var Qo=Ae,oz=xr.Graph,iz=az;function az(e,t,r){var n=lz(e),s=new oz({compound:!0}).setGraph({root:n}).setDefaultNodeLabel(function(o){return e.node(o)});return Qo.forEach(e.nodes(),function(o){var i=e.node(o),a=e.parent(o);(i.rank===t||i.minRank<=t&&t<=i.maxRank)&&(s.setNode(o),s.setParent(o,a||n),Qo.forEach(e[r](o),function(c){var u=c.v===o?c.w:c.v,d=s.edge(u,o),f=Qo.isUndefined(d)?0:d.weight;s.setEdge(u,o,{weight:e.edge(c).weight+f})}),Qo.has(i,"minRank")&&s.setNode(o,{borderLeft:i.borderLeft[t],borderRight:i.borderRight[t]}))}),s}function lz(e){for(var t;e.hasNode(t=Qo.uniqueId("_root")););return t}var cz=Ae,uz=dz;function dz(e,t,r){var n={},s;cz.forEach(r,function(o){for(var i=e.parent(o),a,c;i;){if(a=e.parent(i),a?(c=n[a],n[a]=i):(c=s,s=i),c&&c!==i){t.setEdge(c,i);return}i=a}})}var Pn=Ae,fz=zL,pz=$L,hz=rz,mz=iz,gz=uz,vz=xr.Graph,I2=Ct,xz=yz;function yz(e){var t=I2.maxRank(e),r=M2(e,Pn.range(1,t+1),"inEdges"),n=M2(e,Pn.range(t-1,-1,-1),"outEdges"),s=fz(e);A2(e,s);for(var o=Number.POSITIVE_INFINITY,i,a=0,c=0;c<4;++a,++c){bz(a%2?r:n,a%4>=2),s=I2.buildLayerMatrix(e);var u=pz(e,s);u<o&&(c=0,i=Pn.cloneDeep(s),o=u)}A2(e,i)}function M2(e,t,r){return Pn.map(t,function(n){return mz(e,n,r)})}function bz(e,t){var r=new vz;Pn.forEach(e,function(n){var s=n.graph().root,o=hz(n,s,r,t);Pn.forEach(o.vs,function(i,a){n.node(i).order=a}),gz(n,r,o.vs)})}function A2(e,t){Pn.forEach(t,function(r){Pn.forEach(r,function(n,s){e.node(n).order=s})})}var se=Ae,wz=xr.Graph,_z=Ct,Sz={positionX:Pz};function jz(e,t){var r={};function n(s,o){var i=0,a=0,c=s.length,u=se.last(o);return se.forEach(o,function(d,f){var p=Nz(e,d),h=p?e.node(p).order:c;(p||d===u)&&(se.forEach(o.slice(a,f+1),function(y){se.forEach(e.predecessors(y),function(v){var w=e.node(v),g=w.order;(g<i||h<g)&&!(w.dummy&&e.node(y).dummy)&&dC(r,v,y)})}),a=f+1,i=h)}),o}return se.reduce(t,n),r}function kz(e,t){var r={};function n(o,i,a,c,u){var d;se.forEach(se.range(i,a),function(f){d=o[f],e.node(d).dummy&&se.forEach(e.predecessors(d),function(p){var h=e.node(p);h.dummy&&(h.order<c||h.order>u)&&dC(r,p,d)})})}function s(o,i){var a=-1,c,u=0;return se.forEach(i,function(d,f){if(e.node(d).dummy==="border"){var p=e.predecessors(d);p.length&&(c=e.node(p[0]).order,n(i,u,f,a,c),u=f,a=c)}n(i,u,i.length,c,o.length)}),i}return se.reduce(t,s),r}function Nz(e,t){if(e.node(t).dummy)return se.find(e.predecessors(t),function(r){return e.node(r).dummy})}function dC(e,t,r){if(t>r){var n=t;t=r,r=n}var s=e[t];s||(e[t]=s={}),s[r]=!0}function Ez(e,t,r){if(t>r){var n=t;t=r,r=n}return se.has(e[t],r)}function Cz(e,t,r,n){var s={},o={},i={};return se.forEach(t,function(a){se.forEach(a,function(c,u){s[c]=c,o[c]=c,i[c]=u})}),se.forEach(t,function(a){var c=-1;se.forEach(a,function(u){var d=n(u);if(d.length){d=se.sortBy(d,function(v){return i[v]});for(var f=(d.length-1)/2,p=Math.floor(f),h=Math.ceil(f);p<=h;++p){var y=d[p];o[u]===u&&c<i[y]&&!Ez(r,u,y)&&(o[y]=u,o[u]=s[u]=s[y],c=i[y])}}})}),{root:s,align:o}}function Rz(e,t,r,n,s){var o={},i=Tz(e,t,r,s),a=s?"borderLeft":"borderRight";function c(f,p){for(var h=i.nodes(),y=h.pop(),v={};y;)v[y]?f(y):(v[y]=!0,h.push(y),h=h.concat(p(y))),y=h.pop()}function u(f){o[f]=i.inEdges(f).reduce(function(p,h){return Math.max(p,o[h.v]+i.edge(h))},0)}function d(f){var p=i.outEdges(f).reduce(function(y,v){return Math.min(y,o[v.w]-i.edge(v))},Number.POSITIVE_INFINITY),h=e.node(f);p!==Number.POSITIVE_INFINITY&&h.borderType!==a&&(o[f]=Math.max(o[f],p))}return c(u,i.predecessors.bind(i)),c(d,i.successors.bind(i)),se.forEach(n,function(f){o[f]=o[r[f]]}),o}function Tz(e,t,r,n){var s=new wz,o=e.graph(),i=Dz(o.nodesep,o.edgesep,n);return se.forEach(t,function(a){var c;se.forEach(a,function(u){var d=r[u];if(s.setNode(d),c){var f=r[c],p=s.edge(f,d);s.setEdge(f,d,Math.max(i(e,u,c),p||0))}c=u})}),s}function Iz(e,t){return se.minBy(se.values(t),function(r){var n=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;return se.forIn(r,function(o,i){var a=Oz(e,i)/2;n=Math.max(o+a,n),s=Math.min(o-a,s)}),n-s})}function Mz(e,t){var r=se.values(t),n=se.min(r),s=se.max(r);se.forEach(["u","d"],function(o){se.forEach(["l","r"],function(i){var a=o+i,c=e[a],u;if(c!==t){var d=se.values(c);u=i==="l"?n-se.min(d):s-se.max(d),u&&(e[a]=se.mapValues(c,function(f){return f+u}))}})})}function Az(e,t){return se.mapValues(e.ul,function(r,n){if(t)return e[t.toLowerCase()][n];var s=se.sortBy(se.map(e,n));return(s[1]+s[2])/2})}function Pz(e){var t=_z.buildLayerMatrix(e),r=se.merge(jz(e,t),kz(e,t)),n={},s;se.forEach(["u","d"],function(i){s=i==="u"?t:se.values(t).reverse(),se.forEach(["l","r"],function(a){a==="r"&&(s=se.map(s,function(f){return se.values(f).reverse()}));var c=(i==="u"?e.predecessors:e.successors).bind(e),u=Cz(e,s,r,c),d=Rz(e,s,u.root,u.align,a==="r");a==="r"&&(d=se.mapValues(d,function(f){return-f})),n[i+a]=d})});var o=Iz(e,n);return Mz(n,o),Az(n,e.graph().align)}function Dz(e,t,r){return function(n,s,o){var i=n.node(s),a=n.node(o),c=0,u;if(c+=i.width/2,se.has(i,"labelpos"))switch(i.labelpos.toLowerCase()){case"l":u=-i.width/2;break;case"r":u=i.width/2;break}if(u&&(c+=r?u:-u),u=0,c+=(i.dummy?t:e)/2,c+=(a.dummy?t:e)/2,c+=a.width/2,se.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":u=a.width/2;break;case"r":u=-a.width/2;break}return u&&(c+=r?u:-u),u=0,c}}function Oz(e,t){return e.node(t).width}var Zo=Ae,fC=Ct,Lz=Sz.positionX,zz=qz;function qz(e){e=fC.asNonCompoundGraph(e),$z(e),Zo.forEach(Lz(e),function(t,r){e.node(r).x=t})}function $z(e){var t=fC.buildLayerMatrix(e),r=e.graph().ranksep,n=0;Zo.forEach(t,function(s){var o=Zo.max(Zo.map(s,function(i){return e.node(i).height}));Zo.forEach(s,function(i){e.node(i).y=n+o/2}),n+=o+r})}var ae=Ae,P2=T8,D2=G8,Fz=vL,Bz=Ct.normalizeRanks,Hz=wL,Wz=Ct.removeEmptyRanks,O2=kL,Vz=IL,L2=AL,Uz=xz,Gz=zz,Ln=Ct,Kz=xr.Graph,Yz=Xz;function Xz(e,t){var r=t&&t.debugTiming?Ln.time:Ln.notime;r("layout",function(){var n=r("  buildLayoutGraph",function(){return aq(e)});r("  runLayout",function(){Qz(n,r)}),r("  updateInputGraph",function(){Zz(e,n)})})}function Qz(e,t){t("    makeSpaceForEdgeLabels",function(){lq(e)}),t("    removeSelfEdges",function(){vq(e)}),t("    acyclic",function(){P2.run(e)}),t("    nestingGraph.run",function(){O2.run(e)}),t("    rank",function(){Fz(Ln.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){cq(e)}),t("    removeEmptyRanks",function(){Wz(e)}),t("    nestingGraph.cleanup",function(){O2.cleanup(e)}),t("    normalizeRanks",function(){Bz(e)}),t("    assignRankMinMax",function(){uq(e)}),t("    removeEdgeLabelProxies",function(){dq(e)}),t("    normalize.run",function(){D2.run(e)}),t("    parentDummyChains",function(){Hz(e)}),t("    addBorderSegments",function(){Vz(e)}),t("    order",function(){Uz(e)}),t("    insertSelfEdges",function(){xq(e)}),t("    adjustCoordinateSystem",function(){L2.adjust(e)}),t("    position",function(){Gz(e)}),t("    positionSelfEdges",function(){yq(e)}),t("    removeBorderNodes",function(){gq(e)}),t("    normalize.undo",function(){D2.undo(e)}),t("    fixupEdgeLabelCoords",function(){hq(e)}),t("    undoCoordinateSystem",function(){L2.undo(e)}),t("    translateGraph",function(){fq(e)}),t("    assignNodeIntersects",function(){pq(e)}),t("    reversePoints",function(){mq(e)}),t("    acyclic.undo",function(){P2.undo(e)})}function Zz(e,t){ae.forEach(e.nodes(),function(r){var n=e.node(r),s=t.node(r);n&&(n.x=s.x,n.y=s.y,t.children(r).length&&(n.width=s.width,n.height=s.height))}),ae.forEach(e.edges(),function(r){var n=e.edge(r),s=t.edge(r);n.points=s.points,ae.has(s,"x")&&(n.x=s.x,n.y=s.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var Jz=["nodesep","edgesep","ranksep","marginx","marginy"],eq={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},tq=["acyclicer","ranker","rankdir","align"],rq=["width","height"],nq={width:0,height:0},sq=["minlen","weight","width","height","labeloffset"],oq={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},iq=["labelpos"];function aq(e){var t=new Kz({multigraph:!0,compound:!0}),r=wm(e.graph());return t.setGraph(ae.merge({},eq,bm(r,Jz),ae.pick(r,tq))),ae.forEach(e.nodes(),function(n){var s=wm(e.node(n));t.setNode(n,ae.defaults(bm(s,rq),nq)),t.setParent(n,e.parent(n))}),ae.forEach(e.edges(),function(n){var s=wm(e.edge(n));t.setEdge(n,ae.merge({},oq,bm(s,sq),ae.pick(s,iq)))}),t}function lq(e){var t=e.graph();t.ranksep/=2,ae.forEach(e.edges(),function(r){var n=e.edge(r);n.minlen*=2,n.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?n.width+=n.labeloffset:n.height+=n.labeloffset)})}function cq(e){ae.forEach(e.edges(),function(t){var r=e.edge(t);if(r.width&&r.height){var n=e.node(t.v),s=e.node(t.w),o={rank:(s.rank-n.rank)/2+n.rank,e:t};Ln.addDummyNode(e,"edge-proxy",o,"_ep")}})}function uq(e){var t=0;ae.forEach(e.nodes(),function(r){var n=e.node(r);n.borderTop&&(n.minRank=e.node(n.borderTop).rank,n.maxRank=e.node(n.borderBottom).rank,t=ae.max(t,n.maxRank))}),e.graph().maxRank=t}function dq(e){ae.forEach(e.nodes(),function(t){var r=e.node(t);r.dummy==="edge-proxy"&&(e.edge(r.e).labelRank=r.rank,e.removeNode(t))})}function fq(e){var t=Number.POSITIVE_INFINITY,r=0,n=Number.POSITIVE_INFINITY,s=0,o=e.graph(),i=o.marginx||0,a=o.marginy||0;function c(u){var d=u.x,f=u.y,p=u.width,h=u.height;t=Math.min(t,d-p/2),r=Math.max(r,d+p/2),n=Math.min(n,f-h/2),s=Math.max(s,f+h/2)}ae.forEach(e.nodes(),function(u){c(e.node(u))}),ae.forEach(e.edges(),function(u){var d=e.edge(u);ae.has(d,"x")&&c(d)}),t-=i,n-=a,ae.forEach(e.nodes(),function(u){var d=e.node(u);d.x-=t,d.y-=n}),ae.forEach(e.edges(),function(u){var d=e.edge(u);ae.forEach(d.points,function(f){f.x-=t,f.y-=n}),ae.has(d,"x")&&(d.x-=t),ae.has(d,"y")&&(d.y-=n)}),o.width=r-t+i,o.height=s-n+a}function pq(e){ae.forEach(e.edges(),function(t){var r=e.edge(t),n=e.node(t.v),s=e.node(t.w),o,i;r.points?(o=r.points[0],i=r.points[r.points.length-1]):(r.points=[],o=s,i=n),r.points.unshift(Ln.intersectRect(n,o)),r.points.push(Ln.intersectRect(s,i))})}function hq(e){ae.forEach(e.edges(),function(t){var r=e.edge(t);if(ae.has(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function mq(e){ae.forEach(e.edges(),function(t){var r=e.edge(t);r.reversed&&r.points.reverse()})}function gq(e){ae.forEach(e.nodes(),function(t){if(e.children(t).length){var r=e.node(t),n=e.node(r.borderTop),s=e.node(r.borderBottom),o=e.node(ae.last(r.borderLeft)),i=e.node(ae.last(r.borderRight));r.width=Math.abs(i.x-o.x),r.height=Math.abs(s.y-n.y),r.x=o.x+r.width/2,r.y=n.y+r.height/2}}),ae.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function vq(e){ae.forEach(e.edges(),function(t){if(t.v===t.w){var r=e.node(t.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function xq(e){var t=Ln.buildLayerMatrix(e);ae.forEach(t,function(r){var n=0;ae.forEach(r,function(s,o){var i=e.node(s);i.order=o+n,ae.forEach(i.selfEdges,function(a){Ln.addDummyNode(e,"selfedge",{width:a.label.width,height:a.label.height,rank:i.rank,order:o+ ++n,e:a.e,label:a.label},"_se")}),delete i.selfEdges})})}function yq(e){ae.forEach(e.nodes(),function(t){var r=e.node(t);if(r.dummy==="selfedge"){var n=e.node(r.e.v),s=n.x+n.width/2,o=n.y,i=r.x-s,a=n.height/2;e.setEdge(r.e,r.label),e.removeNode(t),r.label.points=[{x:s+2*i/3,y:o-a},{x:s+5*i/6,y:o-a},{x:s+i,y:o},{x:s+5*i/6,y:o+a},{x:s+2*i/3,y:o+a}],r.label.x=r.x,r.label.y=r.y}})}function bm(e,t){return ae.mapValues(ae.pick(e,t),Number)}function wm(e){var t={};return ae.forEach(e,function(r,n){t[n.toLowerCase()]=r}),t}var Ia=Ae,bq=Ct,wq=xr.Graph,_q={debugOrdering:Sq};function Sq(e){var t=bq.buildLayerMatrix(e),r=new wq({compound:!0,multigraph:!0}).setGraph({});return Ia.forEach(e.nodes(),function(n){r.setNode(n,{label:n}),r.setParent(n,"layer"+e.node(n).rank)}),Ia.forEach(e.edges(),function(n){r.setEdge(n.v,n.w,{},n.name)}),Ia.forEach(t,function(n,s){var o="layer"+s;r.setNode(o,{rank:"same"}),Ia.reduce(n,function(i,a){return r.setEdge(i,a,{style:"invis"}),a})}),r}var jq="0.8.5",kq={graphlib:xr,layout:Yz,debug:_q,util:{time:Ct.time,notime:Ct.notime},version:jq};const zl=Vg(kq),z2=(e,t)=>{const r=new zl.graphlib.Graph;return r.setGraph({rankdir:"TB",align:"UL",nodesep:20,ranksep:70,marginx:100,marginy:30,ranker:"longest-path"}),r.setDefaultEdgeLabel(()=>({})),e.forEach(n=>{r.setNode(n.id,{width:n.data.width??280,height:n.data.height??90})}),t.forEach(n=>{r.setEdge(n.source,n.target)}),zl.layout(r),{nodes:e.map(n=>{const s=r.node(n.id);return{...n,targetPosition:J.Top,sourcePosition:J.Bottom,position:{x:s.x-(n.data.width??280)/2,y:s.y-(n.data.height??90)/2}}}),edges:t}},q2=(e,t,r)=>{let n=[],s=[],o=null,i=null,a=[];const c=r.theme||"industrial";return e.forEach((u,d)=>{var y,v;if((u.level||1)!==1)return;const f=280;let p=95;u.state==="active"&&u.stations&&(p+=35);const h=t===u.id;if(n.push({id:u.id,type:"documentNode",data:{...u,width:f,height:p,isExpanded:h,...r},draggable:!1,connectable:!1,position:{x:0,y:0},zIndex:h?1e3:0}),o){const w=(y=e[d-1])==null?void 0:y.state;s.push({id:"e-"+o+"-"+u.id,source:o,target:u.id,type:"smoothstep",animated:w==="active",style:{stroke:YN(w,c),strokeWidth:3}})}((v=u.children)==null?void 0:v.length)>0&&(i=u.id,a=u.children),o=u.id}),{nodes:n,edges:s,epicBacklogId:i,epicChildren:a}},$2=(e,t,r,n,s)=>{const{nodes:o,edges:i}=e;if(!t||!r.length)return{nodes:o,edges:i};const a=o.find(b=>b.id===t);if(!a)return{nodes:o,edges:i};const c=a.position.x,u=a.position.y+(a.data.height||95),d=a.data.state,f=s.theme||"industrial",p=YN(d,f),h=d==="active",y=ir.EPIC_HEIGHT+ir.EPIC_GAP_Y,v=Math.ceil(r.length/ir.EPICS_PER_ROW),w=c+280*.15,g=50,x={};r.forEach((b,_)=>{const S=Math.floor(_/ir.EPICS_PER_ROW);x[S]||(x[S]=[]),x[S].push({epic:b,idx:_})});for(let b=0;b<v;b++){const _=x[b]||[];if(_.length===0)continue;const S=u+ir.EPIC_OFFSET_Y+b*y,k=`junction-row-${b}`;o.push({id:k,type:"waypoint",position:{x:w,y:S-g},draggable:!1,connectable:!1,selectable:!1}),b===0?i.push({id:`e-spine-drop-${b}`,source:t,target:k,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}):i.push({id:`e-spine-${b-1}-to-${b}`,source:`junction-row-${b-1}`,target:k,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}),_.forEach(({epic:N,idx:j})=>{const C=j%ir.EPICS_PER_ROW,R=c+ir.EPIC_OFFSET_X+C*(ir.EPIC_WIDTH+ir.EPIC_GAP_X),T=S,L=n===N.id;o.push({id:N.id,type:"documentNode",data:{...N,width:ir.EPIC_WIDTH,height:ir.EPIC_HEIGHT,isExpanded:L,...s},draggable:!1,connectable:!1,position:{x:R,y:T},targetPosition:J.Top,sourcePosition:J.Bottom,zIndex:L?1e3:0}),i.push({id:`e-branch-${N.id}`,source:k,target:N.id,type:"smoothstep",pathOptions:{borderRadius:20},animated:h,style:{stroke:p,strokeWidth:2}})})}return{nodes:o,edges:i}},Nq={produced:"produced",in_production:"in_production",ready_for_production:"ready_for_production",requirements_not_met:"requirements_not_met",awaiting_operator:"awaiting_operator",halted:"halted",queued:"ready_for_production",blocked:"requirements_not_met",assembling:"in_production",binding:"in_production",auditing:"in_production",remediating:"in_production",stabilized:"produced"},F2={pgc:"PGC",bind:"BIND",asm:"ASM",aud:"AUD",rem:"REM",done:"DONE"};function Eq(e){const t={};for(const r of e.projects)t[r.id]={id:r.id,projectId:r.project_id,name:r.name,description:r.description||"",status:r.status==="active"?"active":r.is_archived?"complete":"queued",icon:r.icon,createdAt:r.created_at,isArchived:r.is_archived||!1};return t}function Cq(e,t=[]){const r=[],n=[],s={};for(const o of e.tracks){const i=Rq(o,t);if((o.scope||"project")==="project")n.push({...i,mayOwn:o.may_own||[],childDocType:o.child_doc_type});else{const c=o.document_type;s[c]||(s[c]=[]),s[c].push(i)}}for(const o of n)o.childDocType&&s[o.childDocType]&&(o.children=s[o.childDocType].map(i=>({...i,level:2}))),r.push(o);return r}function Rq(e,t=[]){const r=Nq[e.state]||"ready_for_production",n=e.state==="awaiting_operator",s=t.find(a=>a.document_type===e.document_type);let o=null;(r==="in_production"||n)&&(o=Tq(e.stations,e.state,e.station));let i=null;return s&&s.questions&&(i=s.questions.map((a,c)=>({id:a.id||`q${c+1}`,text:a.question||a.text||a,required:a.required!==!1}))),{id:e.document_type,name:e.document_name||Iq(e.document_type),desc:e.description||"",state:r,intent:"mandatory",level:1,stations:o,questions:i,interruptId:s==null?void 0:s.id,blockedBy:e.blocked_by||[]}}function Tq(e,t,r){if(!e||e.length===0){const n=r||(t==="awaiting_operator"?"pgc":t==="in_production"?"asm":null);return Eu.map(s=>({id:s,label:F2[s]||s.toUpperCase(),state:n===s?"active":Eu.indexOf(s)<Eu.indexOf(n)?"complete":"pending",needs_input:s==="pgc"&&t==="awaiting_operator"}))}return e.map(n=>({id:n.station,label:F2[n.station]||n.station.toUpperCase(),state:n.state||"pending",needs_input:n.needs_input||!1}))}function Iq(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function Mq({includeArchived:e=!1}={}){const[t,r]=m.useState({}),[n,s]=m.useState(!0),[o,i]=m.useState(null),a=m.useCallback(async()=>{s(!0),i(null);try{const u=await Ie.getProjects({includeArchived:e}),d=Eq(u);r(d)}catch(u){i(u.message),console.error("Failed to fetch projects:",u)}finally{s(!1)}},[e]),c=m.useCallback(async u=>{try{const d=await Ie.createProject({name:u,description:""});return r(f=>({...f,[d.id]:{id:d.id,projectId:d.project_id,name:d.name,description:d.description||"",status:"active",icon:d.icon,createdAt:d.created_at}})),d}catch(d){throw i(d.message),console.error("Failed to create project:",d),d}},[]);return m.useEffect(()=>{a()},[a]),{projects:t,loading:n,error:o,addProject:c,refresh:a}}function Aq(e){const[t,r]=m.useState([]),[n,s]=m.useState("idle"),[o,i]=m.useState([]),[a,c]=m.useState(!0),[u,d]=m.useState(null),[f,p]=m.useState(!1),h=m.useRef(null),y=m.useRef(null),v=m.useCallback(async()=>{if(e)try{c(!0),d(null);const[_,S]=await Promise.all([Ie.getProductionStatus(e),Ie.getProjectInterrupts(e).catch(()=>[])]);i(S),s(_.line_state),r(Cq(_,S))}catch(_){d(_.message),console.error("Failed to fetch production status:",_)}finally{c(!1)}},[e]),w=m.useCallback(()=>{if(!e)return;h.current&&h.current.close();const _=KP(e);h.current=_,_.addEventListener("connected",()=>{p(!0),d(null),console.log(`SSE connected for project ${e}`)}),_.addEventListener("station_transition",S=>{try{const k=JSON.parse(S.data);console.log("Station transition:",k),v()}catch(k){console.error("Failed to parse station_transition:",k)}}),_.addEventListener("line_stopped",S=>{try{const k=JSON.parse(S.data);console.log("Line stopped:",k),s("stopped"),v()}catch(k){console.error("Failed to parse line_stopped:",k)}}),_.addEventListener("production_complete",S=>{try{const k=JSON.parse(S.data);console.log("Production complete:",k),s("complete"),v()}catch(k){console.error("Failed to parse production_complete:",k)}}),_.addEventListener("interrupt_resolved",S=>{try{const k=JSON.parse(S.data);console.log("Interrupt resolved:",k),v()}catch(k){console.error("Failed to parse interrupt_resolved:",k)}}),_.addEventListener("track_started",S=>{try{const k=JSON.parse(S.data);console.log("Track started:",k),s("active"),v()}catch(k){console.error("Failed to parse track_started:",k)}}),_.onerror=S=>{console.error("SSE error:",S),p(!1),d("Connection lost"),_.close(),y.current=setTimeout(()=>{console.log("Attempting SSE reconnect..."),w()},3e3)}},[e,v]),g=m.useCallback(()=>{y.current&&clearTimeout(y.current),h.current&&(h.current.close(),h.current=null),p(!1)},[]),x=m.useCallback(async(_,S)=>{try{await Ie.resolveInterrupt(_,{answers:S}),await v()}catch(k){throw console.error("Failed to resolve interrupt:",k),k}},[v]),b=m.useCallback(async(_=null)=>{try{await Ie.startProduction(e,_),s("active"),await v()}catch(S){throw console.error("Failed to start production:",S),S}},[e,v]);return m.useEffect(()=>(v(),w(),()=>g()),[v,w,g]),{data:t,lineState:n,interrupts:o,loading:a,error:u,connected:f,refresh:v,resolveInterrupt:x,startProduction:b}}const B2="combine-theme";function pC(e="industrial"){const[t,r]=m.useState(()=>{if(typeof window>"u")return e;const o=localStorage.getItem(B2);return o&&bn.includes(o)?o:e});m.useEffect(()=>{localStorage.setItem(B2,t)},[t]);const n=m.useCallback(o=>{bn.includes(o)&&r(o)},[]),s=m.useCallback(()=>{r(o=>{const i=bn.indexOf(o);return bn[(i+1)%bn.length]})},[]);return{theme:t,setTheme:n,cycleTheme:s}}function Pq(){const[e,t]=m.useState(null),[r,n]=m.useState("idle"),[s,o]=m.useState([]),[i,a]=m.useState(null),[c,u]=m.useState(null),[d,f]=m.useState({}),[p,h]=m.useState(0),[y,v]=m.useState([]),[w,g]=m.useState(!1),[x,b]=m.useState(null),[_,S]=m.useState(null),[k,N]=m.useState(null),[j,C]=m.useState(!1),[R,T]=m.useState(!1),L=m.useRef(null),$=m.useRef(!0);m.useEffect(()=>($.current=!0,()=>{$.current=!1,L.current&&L.current.close()}),[]);const E=m.useCallback(M=>{$.current&&(n(M.phase),o(M.messages||[]),a(M.pending_prompt),u(M.pending_choices),f(M.interpretation||{}),h(M.confidence||0),v(M.missing_fields||[]),g(M.can_initialize||!1),b(M.gate_outcome),S(M.project))},[]),P=m.useCallback(async()=>{N(null),C(!0);try{const M=await Ie.startIntake();if(!$.current)return;t(M.execution_id),n(M.phase||"describe"),a(M.pending_prompt),o([]),f({}),S(null),b(null)}catch(M){if(!$.current)return;N(M.message||"Failed to start intake")}finally{$.current&&C(!1)}},[]),D=m.useCallback(async M=>{if(!e||!M.trim())return;N(null),T(!0);const q={role:"user",content:M};o(H=>[...H,q]);try{const H=await Ie.submitIntakeMessage(e,M);if(!$.current)return;E(H)}catch(H){if(!$.current)return;o(O=>O.filter(B=>B!==q)),N(H.message||"Failed to submit message")}finally{$.current&&T(!1)}},[e,E]),F=m.useCallback(async(M,q)=>{if(e){N(null),f(H=>({...H,[M]:{value:q,source:"user",locked:!0}}));try{const H=await Ie.updateIntakeField(e,M,q);if(!$.current)return;E(H)}catch(H){if(!$.current)return;N(H.message||"Failed to update field");const O=await Ie.getIntakeState(e);$.current&&E(O)}}},[e,E]),A=m.useCallback(async()=>{if(!(!e||!w)){N(null),C(!0);try{const M=await Ie.initializeIntake(e);if(!$.current)return;E(M),M.phase==="generating"&&I()}catch(M){if(!$.current)return;N(M.message||"Failed to initialize project"),C(!1)}}},[e,w,E]),I=m.useCallback(()=>{L.current&&L.current.close();const M=YP(e);L.current=M,M.addEventListener("started",q=>{if(!$.current)return;const H=JSON.parse(q.data);console.log("Intake started:",H)}),M.addEventListener("progress",q=>{if(!$.current)return;const H=JSON.parse(q.data);console.log("Intake progress:",H.current_node)}),M.addEventListener("complete",async q=>{if(!$.current)return;const H=JSON.parse(q.data);console.log("Intake complete:",H),M.close(),L.current=null,n("complete"),b(H.gate_outcome),S(H.project),C(!1)}),M.addEventListener("error",q=>{if($.current&&M.readyState!==EventSource.CLOSED){try{const H=JSON.parse(q.data);N(H.message||"Generation failed")}catch{N("Connection lost during generation")}M.close(),L.current=null,C(!1)}}),M.onerror=()=>{$.current&&M.readyState===EventSource.CLOSED&&(L.current=null,C(!1))}},[e]),z=m.useCallback(()=>{L.current&&(L.current.close(),L.current=null),t(null),n("idle"),o([]),a(null),u(null),f({}),h(0),v([]),g(!1),b(null),S(null),N(null),C(!1),T(!1)},[]);return{executionId:e,phase:r,messages:s,pendingPrompt:i,pendingChoices:c,interpretation:d,confidence:p,missingFields:y,canInitialize:w,gateOutcome:x,project:_,error:k,loading:j,submitting:R,startIntake:P,submitMessage:D,updateField:F,lockAndGenerate:A,reset:z}}const hC=m.createContext(null);function Dq({children:e}){const[t,r]=m.useState(null),[n,s]=m.useState(!0),[o,i]=m.useState(null);m.useEffect(()=>{a()},[]);const a=m.useCallback(async()=>{s(!0),i(null);try{const f=await Ie.getMe();f&&f.user?r(f.user):r(null)}catch(f){console.error("Auth check failed:",f),i(f.message),r(null)}finally{s(!1)}},[]),c=m.useCallback(f=>{window.location.href=XP(f)},[]),u=m.useCallback(async()=>{try{await Ie.logout(),r(null),window.location.href="/"}catch(f){console.error("Logout failed:",f),r(null)}},[]),d={user:t,loading:n,error:o,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.is_admin)||!1,login:c,logout:u,checkAuth:a};return l.jsx(hC.Provider,{value:d,children:e})}function yo(){const e=m.useContext(hC);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function Oq(){const[e,t]=m.useState(null),[r,n]=m.useState(null),[s,o]=m.useState(!0),[i,a]=m.useState(null),c=m.useCallback(async()=>{o(!0),a(null);try{let d=await Ne.getCurrentWorkspace();d||(d=await Ne.createWorkspace()),t(d.workspace_id),n(d.branch)}catch(d){a(d.message),console.error("Failed to initialize workspace:",d)}finally{o(!1)}},[]),u=m.useCallback(async(d=!1)=>{if(e)try{await Ne.closeWorkspace(e,d),t(null),n(null)}catch(f){throw f}},[e]);return m.useEffect(()=>{c()},[c]),{workspaceId:e,branch:r,loading:s,error:i,closeWorkspace:u,reinitialize:c}}function Lq(e,t=1e4){var d,f;const[r,n]=m.useState(null),[s,o]=m.useState(!0),[i,a]=m.useState(null),c=m.useRef(null),u=m.useCallback(async()=>{if(!e){n(null),o(!1);return}try{const p=await Ne.getWorkspaceState(e);n(p),a(null)}catch(p){a(p.message),console.error("Failed to fetch workspace state:",p)}finally{o(!1)}},[e]);return m.useEffect(()=>{e&&(o(!0),u())},[e,u]),m.useEffect(()=>{if(!(!e||!t))return c.current=setInterval(u,t),()=>{c.current&&clearInterval(c.current)}},[e,t,u]),{state:r,loading:s,error:i,refresh:u,isDirty:(r==null?void 0:r.is_dirty)??!1,modifiedArtifacts:(r==null?void 0:r.modified_artifacts)??[],tier1Passed:((d=r==null?void 0:r.tier1)==null?void 0:d.passed)??!0,tier1Results:((f=r==null?void 0:r.tier1)==null?void 0:f.results)??[],expiresAt:r!=null&&r.expires_at?new Date(r.expires_at):null}}function zq(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),i=m.useCallback(async()=>{n(!0),o(null);try{const a=await Ne.getDocumentTypes();t(a.document_types||[])}catch(a){o(a.message),console.error("Failed to fetch document types:",a)}finally{n(!1)}},[]);return m.useEffect(()=>{i()},[i]),{documentTypes:e,loading:r,error:s,refresh:i}}function qq(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),i=m.useCallback(async()=>{n(!0),o(null);try{const a=await Ne.getRoles();t(a.roles||[])}catch(a){o(a.message),console.error("Failed to fetch roles:",a)}finally{n(!1)}},[]);return m.useEffect(()=>{i()},[i]),{roles:e,loading:r,error:s,refresh:i}}function Sx(e,t,{debounceMs:r=500,onSave:n}={}){const[s,o]=m.useState(""),[i,a]=m.useState(""),[c,u]=m.useState(!0),[d,f]=m.useState(null),[p,h]=m.useState(!1),[y,v]=m.useState(null),w=m.useRef(null),g=m.useRef(null),x=m.useCallback(async()=>{if(!e||!t){o(""),a(""),u(!1);return}u(!0),f(null);try{const j=await Ne.getArtifact(e,t);o(j.content),a(j.content)}catch(j){f(j.message),console.error("Failed to load artifact:",j)}finally{u(!1)}},[e,t]),b=m.useCallback(async j=>{if(!(!e||!t)){h(!0),f(null);try{const C=await Ne.writeArtifact(e,t,j);v(C),a(j),n&&n(C)}catch(C){f(C.message),console.error("Failed to save artifact:",C)}finally{h(!1)}}},[e,t,n]),_=m.useCallback(j=>{g.current=j,w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{g.current!==null&&(b(g.current),g.current=null)},r)},[b,r]),S=m.useCallback(j=>{o(j),j!==i&&_(j)},[i,_]),k=m.useCallback(()=>{w.current&&clearTimeout(w.current),g.current=null,o(i)},[i]),N=m.useCallback(()=>{w.current&&clearTimeout(w.current),s!==i&&b(s)},[s,i,b]);return m.useEffect(()=>(x(),()=>{w.current&&clearTimeout(w.current)}),[x]),{content:s,originalContent:i,loading:c,error:d,saving:p,lastSaveResult:y,isDirty:s!==i,updateContent:S,reset:k,saveNow:N,reload:x}}const $q={documentNode:x6,waypoint:y6},Fq={industrial:"Industrial",light:"Light",blueprint:"Blueprint"};function Bq({projectId:e,projectCode:t,projectName:r,isArchived:n,autoExpandNodeId:s,theme:o,onThemeChange:i,onProjectUpdate:a,onProjectArchive:c,onProjectUnarchive:u,onProjectDelete:d}){const{data:f,lineState:p,loading:h,error:y,connected:v,resolveInterrupt:w}=Aq(e),[g,x]=m.useState([]),[b,_]=m.useState(null),[S,k]=m.useState(null),[N,j]=m.useState(null),[C,R]=m.useState(!1),[T,L]=m.useState(""),[$,E]=m.useState(!1),[P,D]=m.useState(!1),[F,A]=m.useState(!1),I=mc();m.useEffect(()=>{f.length>0&&x(f)},[f]),m.useEffect(()=>{s&&g.length>0&&setTimeout(()=>{_(s),k("questions")},300)},[s,g.length]),m.useEffect(()=>{_(null),k(null)},[e]);const z=m.useCallback(()=>{const V=bn.indexOf(o);i(bn[(V+1)%bn.length])},[o,i]),M=m.useCallback(()=>{L(r||""),R(!0)},[r]),q=m.useCallback(async()=>{if(!T.trim()||T===r){R(!1);return}D(!0);try{await a(e,{name:T.trim()}),R(!1)}catch(V){console.error("Failed to update name:",V)}finally{D(!1)}},[T,r,e,a]),H=m.useCallback(()=>{R(!1),L("")},[]),O=m.useCallback(async()=>{D(!0);try{n?await u(e):await c(e)}catch(V){console.error("Failed to toggle archive:",V)}finally{D(!1)}},[e,n,c,u]),B=m.useCallback(async()=>{D(!0);try{await d(e),E(!1)}catch(V){console.error("Failed to delete:",V)}finally{D(!1)}},[e,d]),Y=m.useCallback(V=>{const K=I.getNode(V);if(K){const U=window.innerWidth,we=-K.position.x*.9+U/2-400,_e=-K.position.y*.9+120;I.setViewport({x:we,y:_e,zoom:.9},{duration:800})}},[I]),te=m.useMemo(()=>({onExpand:(V,K)=>{_(V),k(K)},onCollapse:()=>{_(null),k(null),setTimeout(()=>I.fitView({padding:.2,duration:300}),50)},onViewFullDocument:V=>{j(V)},onSubmitQuestions:async(V,K)=>{console.log("Submitted:",V,K);const oe=g.find(U=>U.id===V);if(oe!=null&&oe.interruptId)try{await w(oe.interruptId,K)}catch(U){console.error("Failed to submit answers:",U)}_(null),k(null),x(U=>{const we=_e=>_e.map(ue=>ue.id===V&&ue.stations?{...ue,stations:ue.stations.map(Se=>Se.id==="pgc"?{...Se,state:"complete",needs_input:!1}:Se.id==="asm"?{...Se,state:"active"}:Se)}:ue.children?{...ue,children:we(ue.children)}:ue);return we(U)})}}),[I,g,w]),{layoutNodes:ne,layoutEdges:re}=m.useMemo(()=>{if(g.length===0)return{layoutNodes:[],layoutEdges:[]};const V={...te,expandType:S,theme:o,onZoomToNode:Y,projectId:e,projectCode:t},{nodes:K,edges:oe,epicBacklogId:U,epicChildren:we}=q2(g,b,V),_e=z2(K,oe),{nodes:ue,edges:Se}=$2(_e,U,we,b,V);return{layoutNodes:ue.map(We=>({...We,data:{...We.data,expandType:We.id===b?S:null}})),layoutEdges:Se}},[g,b,S,te,o,Y,e,t]),[Q,ce,ie]=WN(ne),[xe,ee,X]=VN(re);m.useEffect(()=>{if(g.length===0)return;const V={...te,expandType:S,theme:o,onZoomToNode:Y,projectId:e,projectCode:t},{nodes:K,edges:oe,epicBacklogId:U,epicChildren:we}=q2(g,b,V),_e=z2(K,oe),{nodes:ue,edges:Se}=$2(_e,U,we,b,V),lt=ue.map(We=>({...We,data:{...We.data,expandType:We.id===b?S:null}}));ce(lt),ee(Se)},[g,b,S,te,ce,ee,o,Y,e,t]);const fe=m.useCallback((V,K)=>{},[]);return h&&g.length===0?l.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",children:[l.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-12 mx-auto mb-4 animate-pulse"}),l.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading production line..."})]})}):y&&g.length===0?l.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:l.jsx("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:l.jsx("p",{className:"text-red-500 mb-4",children:y})})}):l.jsxs("div",{className:"w-full h-full",children:[l.jsxs(tx,{nodes:Q,edges:xe,onNodesChange:ie,onEdgesChange:X,onNodeClick:fe,nodeTypes:$q,nodesDraggable:!1,nodesConnectable:!1,edgesUpdatable:!1,edgesFocusable:!1,elementsSelectable:!1,fitView:!0,fitViewOptions:{padding:.2},minZoom:.3,maxZoom:1.5,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},children:[l.jsx(Mn,{position:"top-left",children:l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:l.jsxs("div",{className:"flex items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Production Line"}),l.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[p==="active"&&l.jsx("span",{className:"text-amber-500",children:" Active"}),p==="stopped"&&l.jsx("span",{className:"text-red-500",children:" Stopped"}),p==="complete"&&l.jsx("span",{className:"text-emerald-500",children:" Complete"}),p==="idle"&&l.jsx("span",{children:" Idle"}),!v&&l.jsx("span",{className:"ml-2 text-red-400",children:"(Disconnected)"})]})]}),l.jsx("button",{onClick:z,className:"subway-button px-3 py-1.5 rounded-md text-xs font-medium transition-colors",children:Fq[o]})]})}),l.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:"var(--state-active-bg)"},children:l.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("p",{className:"text-xs font-mono",style:{color:"var(--text-muted)"},children:t||"No Project"}),C?l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx("input",{type:"text",value:T,onChange:V=>L(V.target.value),onKeyDown:V=>{V.key==="Enter"&&q(),V.key==="Escape"&&H()},className:"flex-1 px-2 py-1 text-sm rounded border bg-transparent",style:{color:"var(--text-primary)",borderColor:"var(--border-panel)"},autoFocus:!0,disabled:P}),l.jsx("button",{onClick:q,disabled:P,className:"p-1 rounded hover:bg-white/10",title:"Save",children:l.jsx("svg",{className:"w-4 h-4 text-emerald-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M5 13l4 4L19 7"})})}),l.jsx("button",{onClick:H,disabled:P,className:"p-1 rounded hover:bg-white/10",title:"Cancel",children:l.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):l.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:r||"Untitled Project"})]}),!C&&l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("button",{onClick:M,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Edit name",children:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),l.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),l.jsx("button",{onClick:O,disabled:P,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:n?"#f59e0b":"var(--text-muted)"},title:n?"Unarchive project":"Archive project",children:l.jsxs("svg",{className:"w-4 h-4 relative",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}),n&&l.jsx("path",{d:"M4 20L20 4",strokeWidth:"2.5",stroke:"currentColor"})]})}),l.jsx("button",{onClick:()=>E(!0),disabled:P||!n,className:`p-1.5 rounded transition-colors ${n?"hover:bg-red-500/20":""}`,style:{color:"var(--text-muted)",opacity:n?1:.3,cursor:n?"pointer":"not-allowed"},title:n?"Delete project":"Archive project first to delete",children:l.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),l.jsxs("div",{className:"subway-panel backdrop-blur rounded-lg border overflow-hidden",children:[l.jsxs("button",{onClick:()=>A(!F),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-semibold hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer"},children:[l.jsx("span",{children:"Workflow"}),l.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:F?"":""})]}),F&&l.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:l.jsx(k6,{projectId:e})})]})]})}),l.jsx(KN,{position:"top-right",nodeColor:V=>{var oe;const K=(oe=V.data)==null?void 0:oe.state;return["produced","stabilized","ready"].includes(K)?"#10b981":["in_production","active"].includes(K)?"#f59e0b":["requirements_not_met","blocked"].includes(K)?"#ef4444":"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),l.jsx(Mn,{position:"bottom-left",children:l.jsxs("div",{className:"subway-panel flex gap-4 text-[10px] backdrop-blur px-4 py-2.5 rounded-lg border",children:[l.jsx("span",{style:{color:"var(--text-muted)"},className:"font-medium",children:"STATE:"}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-stabilized-bg)"}}),l.jsx("span",{style:{color:"var(--text-muted)"},children:"Produced"})]}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-active-bg)"}}),l.jsx("span",{style:{color:"var(--text-muted)"},children:"In Production"})]}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-queued-bg)"}}),l.jsx("span",{style:{color:"var(--text-muted)"},children:"Ready"})]})]})}),l.jsx(Mn,{position:"bottom-right",children:l.jsx("div",{className:"subway-panel text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Scroll to zoom | Drag to pan"})})]}),N&&l.jsx(b6,{projectId:e,projectCode:t,docTypeId:N,onClose:()=>j(null)}),$&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:l.jsxs("div",{className:"rounded-lg p-6 max-w-sm mx-4",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Delete Project?"}),l.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:["This will permanently delete ",l.jsx("strong",{children:r})," and all its documents. This action cannot be undone."]}),l.jsxs("div",{className:"flex gap-3 justify-end",children:[l.jsx("button",{onClick:()=>E(!1),disabled:P,className:"px-4 py-2 rounded text-sm font-medium transition-colors",style:{color:"var(--text-muted)"},children:"Cancel"}),l.jsx("button",{onClick:B,disabled:P,className:"px-4 py-2 rounded text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:P?"Deleting...":"Delete"})]})]})})]})}function Ma({messages:e,pendingPrompt:t}){const r=m.useRef(null);return m.useEffect(()=>{var n;(n=r.current)==null||n.scrollIntoView({behavior:"smooth"})},[e,t]),l.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[e.map((n,s)=>l.jsx("div",{className:`flex ${n.role==="user"?"justify-end":"justify-start"}`,children:l.jsx("div",{className:`max-w-[85%] rounded-lg px-3 py-2 text-sm ${n.role==="user"?"bg-emerald-500/20 text-emerald-100 rounded-br-sm":"bg-violet-500/20 text-violet-100 rounded-bl-sm"}`,children:n.content})},s)),t&&l.jsx("div",{className:"flex justify-start",children:l.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-violet-500/20 text-violet-100 rounded-bl-sm",children:t})}),l.jsx("div",{ref:r})]})}function Hq({onSubmit:e,disabled:t,placeholder:r}){const[n,s]=m.useState(""),o=m.useRef(null);m.useEffect(()=>{var c;t||(c=o.current)==null||c.focus()},[t]);const i=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),n.trim()&&!t&&(e(n.trim()),s("")))},a=()=>{n.trim()&&!t&&(e(n.trim()),s(""))};return l.jsxs("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsx("textarea",{ref:o,value:n,onChange:c=>s(c.target.value),onKeyDown:i,disabled:t,placeholder:r||"Type your message...",rows:2,className:"flex-1 rounded-lg px-3 py-2 text-sm resize-none",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),l.jsx("button",{onClick:a,disabled:t||!n.trim(),className:`px-4 rounded-lg font-medium text-sm transition-colors ${t||!n.trim()?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-violet-500 text-white hover:bg-violet-400"}`,children:"Send"})]}),l.jsx("p",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:"Press Enter to send, Shift+Enter for newline"})]})}const Wq={project_name:"Project Name",problem_statement:"Problem Statement",project_type:"Project Type"},Vq=["project_name","problem_statement","project_type"];function Uq({interpretation:e,missingFields:t,canInitialize:r,onUpdateField:n,onInitialize:s,loading:o}){const[i,a]=m.useState(null),[c,u]=m.useState(""),d=(h,y)=>{a(h),u(y)},f=async()=>{i&&c.trim()&&(await n(i,c.trim()),a(null),u(""))},p=()=>{a(null),u("")};return l.jsxs("div",{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Review & Lock"}),t.length>0&&l.jsxs("span",{className:"text-[10px] px-2 py-0.5 rounded bg-amber-500/20 text-amber-400",children:[t.length," missing"]})]}),Vq.map(h=>{const y=e[h];if(!y)return null;const v=y.locked,w=t.includes(h),g=i===h;return l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("label",{className:"text-[10px] font-medium",style:{color:"var(--text-muted)"},children:[Wq[h]||h,w&&l.jsx("span",{className:"text-amber-400 ml-1",children:"*"})]}),v&&l.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-emerald-500/20 text-emerald-400",children:"locked"})]}),g?l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:c,onChange:x=>u(x.target.value),onKeyDown:x=>{x.key==="Enter"&&f(),x.key==="Escape"&&p()},autoFocus:!0,className:"flex-1 rounded px-2 py-1.5 text-xs",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),l.jsx("button",{onClick:f,className:"px-2 py-1 rounded text-xs bg-emerald-500 text-white",children:"Save"}),l.jsx("button",{onClick:p,className:"px-2 py-1 rounded text-xs",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Cancel"})]}):l.jsx("div",{onClick:()=>!v&&d(h,y.value),className:`rounded px-2 py-1.5 text-xs ${v?"cursor-default":"cursor-pointer hover:bg-white/5"} ${w?"border border-amber-500/50":""}`,style:{background:"var(--bg-input)",color:y.value?"var(--text-primary)":"var(--text-muted)"},children:y.value||"Click to edit..."})]},h)}),l.jsx("button",{onClick:s,disabled:!r||o,className:`w-full py-2.5 rounded-lg text-sm font-medium transition-colors ${r&&!o?"bg-violet-500 text-white hover:bg-violet-400":"bg-slate-600 text-slate-400 cursor-not-allowed"}`,children:o?"Initializing...":"Lock & Initialize Project"}),!r&&l.jsx("p",{className:"text-[10px] text-center",style:{color:"var(--text-muted)"},children:"Fill all required fields to continue"})]})}function Gq(){return l.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-4",children:[l.jsxs("div",{className:"relative w-16 h-16 mb-4",children:[l.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-violet-500/20"}),l.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent animate-spin"}),l.jsx("div",{className:"absolute inset-3 rounded-full bg-violet-500/20 animate-pulse"})]}),l.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:"var(--text-primary)"},children:"Generating Project"}),l.jsx("p",{className:"text-xs text-center max-w-[200px]",style:{color:"var(--text-muted)"},children:"Creating intake document and running quality checks..."}),l.jsxs("div",{className:"flex gap-1 mt-4",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 rounded-full bg-violet-500 animate-bounce",style:{animationDelay:"300ms"}})]})]})}const H2={qualified:{icon:"check",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",title:"Project Created",description:"Your project is ready for PM Discovery."},not_ready:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Not Ready",description:"Additional information is needed before proceeding."},out_of_scope:{icon:"x",iconBg:"bg-slate-500/20",iconColor:"text-slate-400",title:"Out of Scope",description:"This request is outside the scope of The Combine."},redirect:{icon:"arrow",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",title:"Redirected",description:"This request has been redirected to a different engagement type."},blocked:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Blocked",description:"The workflow could not complete due to validation issues."}};function Kq({type:e,className:t}){switch(e){case"check":return l.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("polyline",{points:"20 6 9 17 4 12"})});case"warning":return l.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M12 9v4M12 17h.01"}),l.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"})]});case"x":return l.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"arrow":return l.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),l.jsx("polyline",{points:"12 5 19 12 12 19"})]});default:return null}}function Yq({gateOutcome:e,project:t,onViewProject:r,onClose:n}){const s=H2[e]||H2.blocked,o=e==="qualified";return l.jsxs("div",{className:"p-6 text-center",children:[l.jsx("div",{className:`w-16 h-16 rounded-full ${s.iconBg} flex items-center justify-center mx-auto mb-4`,children:l.jsx(Kq,{type:s.icon,className:`w-8 h-8 ${s.iconColor}`})}),l.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:s.title}),l.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:s.description}),o&&t&&l.jsxs("div",{className:"rounded-lg p-3 mb-4",style:{background:"var(--bg-input)"},children:[l.jsx("p",{className:"text-xs font-mono mb-1",style:{color:"var(--text-muted)"},children:t.project_id}),l.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:t.name})]}),l.jsxs("div",{className:"flex gap-2 justify-center",children:[o&&t&&l.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500 text-white hover:bg-emerald-400 transition-colors",children:"View Project"}),l.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Close"})]})]})}function Xq({onClose:e,onComplete:t}){const{phase:r,messages:n,pendingPrompt:s,interpretation:o,missingFields:i,canInitialize:a,gateOutcome:c,project:u,error:d,loading:f,submitting:p,startIntake:h,submitMessage:y,updateField:v,lockAndGenerate:w,reset:g}=Pq();m.useEffect(()=>(h(),()=>g()),[]);const x=()=>{g(),e()},b=()=>{u&&t&&t(u),x()},_=()=>{const k=[{id:"describe",label:"Describe"},{id:"review",label:"Review"},{id:"generating",label:"Generate"},{id:"complete",label:"Done"}],N=k.findIndex(j=>j.id===r);return l.jsx("div",{className:"flex items-center gap-1 text-[10px]",children:k.map((j,C)=>l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:`px-2 py-0.5 rounded ${C===N?"bg-violet-500/30 text-violet-300":C<N?"text-emerald-400":"text-slate-500"}`,children:j.label}),C<k.length-1&&l.jsx("span",{className:"mx-1 text-slate-600",children:"/"})]},j.id))})},S=()=>{if(f&&r==="idle")return l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsx("div",{className:"w-8 h-8 border-2 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})});switch(r){case"describe":return l.jsxs(l.Fragment,{children:[l.jsx(Ma,{messages:n,pendingPrompt:s}),l.jsx(Hq,{onSubmit:y,disabled:p,placeholder:"Describe what you want to build..."})]});case"review":return l.jsxs(l.Fragment,{children:[l.jsx(Ma,{messages:n}),l.jsx("div",{className:"border-t",style:{borderColor:"var(--border-panel)"},children:l.jsx(Uq,{interpretation:o,missingFields:i,canInitialize:a,onUpdateField:v,onInitialize:w,loading:f})})]});case"generating":return l.jsxs(l.Fragment,{children:[l.jsx(Ma,{messages:n}),l.jsx(Gq,{})]});case"complete":return l.jsxs(l.Fragment,{children:[l.jsx(Ma,{messages:n}),l.jsx(Yq,{gateOutcome:c,project:u,onViewProject:b,onClose:x})]});default:return null}};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)"},children:l.jsxs("div",{className:"flex flex-col w-full max-w-lg h-[80vh] rounded-xl shadow-2xl tray-slide",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-violet-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"New Project"}),_()]})]}),l.jsx("button",{onClick:x,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),d&&l.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-300 text-sm",children:d}),S()]})})}function Qq({onClose:e}){const{user:t,logout:r,isAdmin:n}=yo(),[s,o]=m.useState(null),[i,a]=m.useState([]),[c,u]=m.useState(!1),[d,f]=m.useState(null);m.useEffect(()=>{s==="linked"&&p()},[s]);const p=async()=>{try{u(!0);const S=await fetch("/auth/accounts",{credentials:"include"});if(S.ok){const k=await S.json();a(k.identities||[])}}catch(S){console.error("Failed to load accounts:",S)}finally{u(!1)}},h=S=>{window.location.href=`/auth/accounts/link/${S}`},y=async S=>{var k;if(i.length<=1){f({type:"error",text:"Cannot unlink your only account"});return}if(confirm(`Unlink your ${S} account?`))try{const N=(k=document.cookie.split("; ").find(C=>C.startsWith("csrf=")||C.startsWith("__Host-csrf=")))==null?void 0:k.split("=")[1],j=await fetch(`/auth/accounts/${S}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":N||""}});if(j.ok)f({type:"success",text:"Account unlinked"}),await p();else{const C=await j.json();throw new Error(C.detail||"Failed to unlink")}}catch(N){f({type:"error",text:N.message})}},v=async()=>{await r(),e()},w=S=>{o(s===S?null:S),f(null)},g={google:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[l.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),l.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),l.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),l.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),microsoft:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 23 23",children:[l.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),l.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),l.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),l.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]})},x=[{id:"account",label:"Account",icon:"user",future:!1},{id:"linked",label:"Linked Accounts",icon:"link",future:!1},{id:"team",label:"Team / Org",icon:"users",future:!0},{id:"billing",label:"Billing",icon:"credit-card",future:!0},{id:"preferences",label:"Preferences",icon:"settings",future:!0}],b=S=>{const k={user:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),link:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),l.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),users:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"9",cy:"7",r:"4"}),l.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),l.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"credit-card":l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),l.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),settings:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"3"}),l.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return k[S]||k.user},_=S=>{switch(S){case"account":return l.jsxs("div",{className:"px-4 py-3 space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Email"}),l.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.email)||"-"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Member since"}),l.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:t!=null&&t.user_created_at?new Date(t.user_created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"-"})]})]});case"linked":return l.jsxs("div",{className:"px-4 py-3",children:[d&&l.jsx("div",{className:`mb-3 px-3 py-2 rounded text-xs ${d.type==="error"?"bg-red-500/20 text-red-300":"bg-emerald-500/20 text-emerald-300"}`,children:d.text}),c?l.jsx("div",{className:"flex items-center justify-center py-4",children:l.jsx("div",{className:"w-5 h-5 border-2 border-t-blue-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"space-y-2 mb-4",children:i.map(k=>l.jsxs("div",{className:"flex items-center justify-between p-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-2",children:[g[k.provider_id],l.jsx("span",{className:"text-xs",style:{color:"var(--text-primary)"},children:k.provider_email})]}),l.jsx("button",{onClick:()=>y(k.provider_id),disabled:i.length<=1,className:`text-xs px-2 py-1 rounded ${i.length<=1?"text-slate-600 cursor-not-allowed":"text-red-400 hover:bg-red-500/20"}`,children:"Unlink"})]},k.provider_id))}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"text-xs uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:"Link another"}),l.jsxs("button",{onClick:()=>h("google"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[g.google,"Google"]}),l.jsxs("button",{onClick:()=>h("microsoft"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[g.microsoft,"Microsoft"]})]})]})]});default:return l.jsx("div",{className:"px-4 py-3 text-xs",style:{color:"var(--text-muted)"},children:"Coming soon"})}};return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 z-40",style:{background:"rgba(0, 0, 0, 0.3)"},onClick:e}),l.jsxs("div",{className:"fixed top-12 bottom-0 z-50 w-72 flex flex-col shadow-2xl",style:{left:"240px",background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"px-4 py-4 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t!=null&&t.avatar_url?l.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-10 h-10 rounded-full"}):l.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)"},children:[l.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),l.jsxs("div",{className:"flex-1 overflow-hidden",children:[l.jsx("div",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.name)||"User"}),l.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(t==null?void 0:t.email)||""})]}),l.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),l.jsx("div",{className:"text-xs px-2 py-1 rounded inline-block",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Plan: Individual"})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto",children:[n&&l.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[l.jsx("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:l.jsx("span",{className:"text-[10px] uppercase tracking-wide font-medium",style:{color:"var(--text-muted)"},children:"Administration"})}),l.jsxs("a",{href:"/admin",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[l.jsx("span",{style:{color:"var(--amber-400, #fbbf24)"},children:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),l.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"})]})}),l.jsx("span",{className:"text-sm",children:"Admin Panel"})]}),l.jsxs("a",{href:"/admin/workbench",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[l.jsx("span",{style:{color:"var(--purple-400, #a78bfa)"},children:l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),l.jsx("polyline",{points:"14 2 14 8 20 8"}),l.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),l.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),l.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})}),l.jsx("span",{className:"text-sm",children:"Prompt Workbench"})]})]}),x.map(S=>l.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[l.jsxs("button",{onClick:()=>!S.future&&w(S.id),className:`w-full flex items-center gap-3 px-4 py-3 transition-colors ${S.future?"cursor-not-allowed opacity-50":"hover:bg-white/5"}`,style:{color:"var(--text-primary)"},disabled:S.future,children:[l.jsx("span",{style:{color:"var(--text-muted)"},children:b(S.icon)}),l.jsx("span",{className:"flex-1 text-sm text-left",children:S.label}),S.future?l.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Soon"}):l.jsx("svg",{className:"w-4 h-4 transition-transform",style:{color:"var(--text-muted)",transform:s===S.id?"rotate(90deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("polyline",{points:"9 18 15 12 9 6"})})]}),s===S.id&&!S.future&&l.jsx("div",{style:{background:"var(--bg-canvas)",borderTop:"1px solid var(--border-panel)"},children:_(S.id)})]},S.id))]}),l.jsx("div",{className:"p-4 border-t",style:{borderColor:"var(--border-panel)"},children:l.jsxs("button",{onClick:v,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded text-sm transition-colors hover:bg-white/5",style:{color:"var(--text-muted)"},children:[l.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),l.jsx("polyline",{points:"16 17 21 12 16 7"}),l.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})}const me={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function Zq(){return l.jsx("header",{className:"h-16 flex items-center justify-center border-b",style:{background:me.bg,borderColor:me.border},children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-8"}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-bold tracking-[0.2em]",style:{color:me.textPrimary},children:"THE COMBINE"}),l.jsx("span",{className:"text-xs tracking-wide ml-4",style:{color:me.textMuted},children:"Industrial AI for Knowledge Work"})]})]})})}function Jq(){return l.jsxs("section",{className:"text-center max-w-2xl mx-auto",children:[l.jsx("h1",{className:"text-3xl font-semibold mb-6 leading-tight",style:{color:me.textPrimary},children:"Turn complex intent into governed, repeatable artifacts."}),l.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:me.textSecondary},children:"The Combine applies manufacturing discipline to AI knowledge work. Every output is traceable. Every decision is auditable. Production over prompting."}),l.jsxs("a",{href:"/learn",className:"text-sm transition-colors inline-flex items-center gap-1",style:{color:me.textMuted},onMouseOver:e=>e.currentTarget.style.color=me.textSecondary,onMouseOut:e=>e.currentTarget.style.color=me.textMuted,children:["Learn how The Combine works",l.jsx("span",{"aria-hidden":"true",children:""})]})]})}function e$(){const e=[{icon:l.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Express Intent",description:"Describe what you need"},{icon:l.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Line Assembles",description:"Stations configure"},{icon:l.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Gates Enforce",description:"Validation required"},{icon:l.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:l.jsx("path",{d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Artifacts Stabilize",description:"Versioned, ready"}];return l.jsx("section",{className:"max-w-4xl mx-auto",children:l.jsx("div",{className:"flex items-start justify-between gap-4",children:e.map((t,r)=>l.jsxs("div",{className:"flex-1 text-center group",children:[l.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full mb-3",style:{background:me.bgElevated,border:`1px solid ${me.border}`,color:me.textMuted},children:t.icon}),l.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:me.textPrimary},children:t.title}),l.jsx("p",{className:"text-xs",style:{color:me.textMuted},children:t.description}),r<e.length-1&&l.jsx("div",{className:"absolute top-5 -right-2 hidden md:block",style:{color:me.border}})]},r))})})}function t$(){const e=["Auditable outputs","Traceable decisions","Validated delivery","Human accountability"];return l.jsx("section",{className:"text-center",children:l.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2",children:e.map((t,r)=>l.jsx("span",{className:"text-xs",style:{color:me.textMuted},children:t},r))})})}function r$({onLogin:e}){return l.jsxs("section",{className:"text-center",children:[l.jsx("p",{className:"text-sm font-medium mb-4",style:{color:me.textSecondary},children:"Ready?"}),l.jsxs("div",{className:"inline-flex flex-col gap-3",children:[l.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:me.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=me.accentHover,onMouseOut:t=>t.currentTarget.style.background=me.accent,children:[l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[l.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),l.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),l.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),l.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),l.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:me.bg,border:`1px solid ${me.border}`,color:me.textPrimary},onMouseOver:t=>t.currentTarget.style.background=me.bgElevated,onMouseOut:t=>t.currentTarget.style.background=me.bg,children:[l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[l.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),l.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),l.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),l.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function n$(){return l.jsxs("footer",{className:"py-6 flex items-center justify-center gap-6",children:[l.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:me.textSubtle},onMouseOver:e=>e.currentTarget.style.color=me.textMuted,onMouseOut:e=>e.currentTarget.style.color=me.textSubtle,children:"Terms"}),l.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:me.textSubtle},onMouseOver:e=>e.currentTarget.style.color=me.textMuted,onMouseOut:e=>e.currentTarget.style.color=me.textSubtle,children:"Privacy"}),l.jsx("span",{className:"text-xs",style:{color:me.border},children:" 2026 The Combine"})]})}function s$(){const{login:e}=yo();return l.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:me.bg},children:[l.jsx(Zq,{}),l.jsx("main",{className:"flex-1 flex flex-col justify-center px-8 py-12",children:l.jsxs("div",{className:"space-y-12",children:[l.jsx(Jq,{}),l.jsx(e$,{}),l.jsx(t$,{}),l.jsx(r$,{onLogin:e})]})}),l.jsx(n$,{})]})}const pe={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function o$(){return l.jsxs("header",{className:"h-16 flex items-center justify-between px-6 border-b",style:{background:pe.bg,borderColor:pe.border},children:[l.jsxs("a",{href:"/",className:"flex items-center gap-3 transition-colors",style:{color:pe.textMuted},onMouseOver:e=>e.currentTarget.style.color=pe.textSecondary,onMouseOut:e=>e.currentTarget.style.color=pe.textMuted,children:[l.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),l.jsx("span",{className:"text-sm",children:"Back"})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6"}),l.jsx("span",{className:"text-sm font-bold tracking-[0.15em]",style:{color:pe.textPrimary},children:"THE COMBINE"})]}),l.jsx("div",{className:"w-16"})," "]})}function Un({title:e,children:t}){return l.jsxs("section",{className:"mb-16",children:[e&&l.jsx("h2",{className:"text-xl font-semibold mb-6",style:{color:pe.textPrimary},children:e}),t]})}function Qe({children:e,className:t=""}){return l.jsx("p",{className:`text-base leading-relaxed mb-4 ${t}`,style:{color:pe.textSecondary},children:e})}function qo({children:e}){return l.jsx("p",{className:"text-base leading-relaxed mb-4 pl-4",style:{color:pe.textPrimary,borderLeft:`2px solid ${pe.border}`},children:e})}function Aa({items:e}){return l.jsx("ul",{className:"space-y-2 mb-4",children:e.map((t,r)=>l.jsxs("li",{className:"text-base flex items-start gap-3",style:{color:pe.textSecondary},children:[l.jsx("span",{style:{color:pe.textMuted},children:"-"}),t]},r))})}function Pa({number:e,title:t,children:r}){return l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[l.jsxs("span",{className:"text-sm font-mono",style:{color:pe.textMuted},children:[e,"."]}),l.jsx("h3",{className:"text-base font-medium",style:{color:pe.textPrimary},children:t})]}),l.jsx("div",{className:"pl-7",children:l.jsx(Qe,{children:r})})]})}function Da({title:e,children:t}){return l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-base font-medium mb-2",style:{color:pe.textPrimary},children:e}),l.jsx(Qe,{className:"mb-0",children:t})]})}function i$({onLogin:e}){return l.jsxs("section",{className:"text-center py-12 rounded-lg",style:{background:pe.bgElevated,border:`1px solid ${pe.border}`},children:[l.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:pe.textPrimary},children:"When You're Ready"}),l.jsx(Qe,{className:"max-w-md mx-auto mb-2",children:"You don't need to prepare anything."}),l.jsx(Qe,{className:"max-w-md mx-auto mb-2",children:"You don't need to know the workflow in advance."}),l.jsx(Qe,{className:"max-w-md mx-auto mb-8",children:"You start by stating intent  the system handles the rest."}),l.jsxs("div",{className:"inline-flex flex-col gap-3",children:[l.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:pe.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=pe.accentHover,onMouseOut:t=>t.currentTarget.style.background=pe.accent,children:[l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[l.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),l.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),l.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),l.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),l.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:pe.bg,border:`1px solid ${pe.border}`,color:pe.textPrimary},onMouseOver:t=>t.currentTarget.style.background=pe.bgElevated,onMouseOut:t=>t.currentTarget.style.background=pe.bg,children:[l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[l.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),l.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),l.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),l.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function a$(){return l.jsxs("footer",{className:"py-8 text-center",children:[l.jsx("p",{className:"text-sm mb-6",style:{color:pe.textMuted},children:"The Combine does not replace human judgment. It makes it visible."}),l.jsxs("div",{className:"flex items-center justify-center gap-6",children:[l.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:pe.textSubtle},onMouseOver:e=>e.currentTarget.style.color=pe.textMuted,onMouseOut:e=>e.currentTarget.style.color=pe.textSubtle,children:"Terms"}),l.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:pe.textSubtle},onMouseOver:e=>e.currentTarget.style.color=pe.textMuted,onMouseOut:e=>e.currentTarget.style.color=pe.textSubtle,children:"Privacy"}),l.jsx("span",{className:"text-xs",style:{color:pe.border},children:" 2026 The Combine"})]})]})}function l$(){const{login:e}=yo();return l.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:pe.bg},children:[l.jsx(o$,{}),l.jsx("main",{className:"flex-1 px-6 py-12",children:l.jsxs("article",{className:"max-w-2xl mx-auto",children:[l.jsx("h1",{className:"text-3xl font-semibold mb-12 text-center",style:{color:pe.textPrimary},children:"Learn More"}),l.jsxs(Un,{title:"What The Combine Is",children:[l.jsx(Qe,{children:"The Combine is an AI-assisted production system for knowledge work."}),l.jsx(Qe,{children:"It applies manufacturing discipline to work that is normally informal, fragile, and difficult to audit  system design, architecture, requirements, analysis, and planning."}),l.jsx(qo,{children:"Instead of prompts and chat history, The Combine produces governed artifacts."}),l.jsx(qo,{children:"Instead of experimentation without memory, it runs repeatable production lines."})]}),l.jsxs(Un,{title:"Why It Exists",children:[l.jsx(Qe,{children:"Most AI tools optimize for speed and creativity. That works well for drafts and exploration."}),l.jsx(Qe,{children:"It breaks down when the work must be:"}),l.jsx(Aa,{items:["Auditable","Traceable","Reviewed","Approved","Reused","Defended"]}),l.jsx(Qe,{children:"The Combine exists for situations where quality, accountability, and repeatability matter more than cleverness."})]}),l.jsxs(Un,{title:'Why "The Combine"',children:[l.jsx(Qe,{children:"The Combine takes its name from the combine harvester  one of the most important industrial inventions of the 20th century."}),l.jsx(Qe,{children:"Before the combine, harvesting was fragmented, manual, and inconsistent. Separate steps. Separate tools. High variability. Heavy dependence on individual skill."}),l.jsx(Qe,{children:"The combine harvester changed that by integrating many steps into a single, governed production line  increasing consistency, traceability, and scale without removing human oversight."}),l.jsx(Qe,{children:"The Combine applies the same philosophy to AI-driven knowledge work."}),l.jsx(Qe,{children:"Instead of scattered prompts, fragile documents, and unrepeatable decisions, it assembles intent through a structured line:"}),l.jsx(Aa,{items:["Inputs are clarified","Work moves through defined stations","Quality gates enforce discipline","Outputs stabilize into reusable artifacts"]}),l.jsx(Qe,{children:"This is not automation for speed. It is industrialization for reliability."}),l.jsx(qo,{children:"As with the original combine, the breakthrough is not intelligence, but integration."})]}),l.jsxs(Un,{title:"How It Works",children:[l.jsx(Pa,{number:1,title:"You express intent",children:"You describe what you want to build. The system listens, asks clarifying questions, and confirms scope and constraints."}),l.jsx(Pa,{number:2,title:"A production line is assembled",children:"Based on your intent, The Combine configures a sequence of specialized stations  each responsible for producing a specific artifact."}),l.jsx(Pa,{number:3,title:"Quality gates enforce discipline",children:"Artifacts move forward only when they meet defined criteria. Nothing proceeds without validation."}),l.jsx(Pa,{number:4,title:"Outputs stabilize",children:"Approved artifacts are versioned, bound, and ready for use  not just today, but later."})]}),l.jsxs(Un,{title:"What Makes It Different",children:[l.jsx(Da,{title:"Production over prompting",children:"Work progresses through defined stages, not conversations."}),l.jsx(Da,{title:"Human accountability remains central",children:"AI assists, but humans approve. Nothing ships without oversight."}),l.jsx(Da,{title:"Every decision is traceable",children:"Why something exists, who approved it, and what assumptions were made are always visible."}),l.jsx(Da,{title:"Designed for real-world constraints",children:"Compliance, audits, handoffs, and change management are first-class concerns."})]}),l.jsxs(Un,{title:"What The Combine Is Not",children:[l.jsx(Aa,{items:["A chat interface","A creative writing tool","An autonomous agent that acts without approval","A system that hides its reasoning or decisions"]}),l.jsx(Qe,{children:"If you want improvisation, there are better tools."}),l.jsx(qo,{children:"If you need defensible outcomes, this is what The Combine is built for."})]}),l.jsxs(Un,{title:"Who It's For",children:[l.jsx(Qe,{children:"The Combine is designed for people responsible for outcomes, including:"}),l.jsx(Aa,{items:["Architects and technical leaders","Product and delivery leaders","Compliance-conscious teams","Organizations that need repeatable, explainable AI support"]}),l.jsx(qo,{children:`If the phrase "nothing ships without validation" resonates, you're in the right place.`})]}),l.jsx(i$,{onLogin:e})]})}),l.jsx(a$,{})]})}function c$(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),i=m.useCallback(async()=>{n(!0),o(null);try{const a=await Ne.getTemplates();t(a.templates||[])}catch(a){o(a.message),console.error("Failed to fetch templates:",a)}finally{n(!1)}},[]);return m.useEffect(()=>{i()},[i]),{templates:e,loading:r,error:s,refresh:i}}function u$(){const[e,t]=m.useState([]),[r,n]=m.useState(!0),[s,o]=m.useState(null),i=m.useCallback(async()=>{n(!0),o(null);try{const a=await Ne.getOrchestrationWorkflows();t(a.workflows||[])}catch(a){o(a.message),console.error("Failed to fetch orchestration workflows:",a)}finally{n(!1)}},[]);return m.useEffect(()=>{i()},[i]),{workflows:e,loading:r,error:s,refresh:i}}const _m="doctype-browser-collapsed";function mC(e,t){const[r,n]=m.useState(()=>{try{const o=JSON.parse(localStorage.getItem(_m)||"{}");return e in o?o[e]:t}catch{return t}}),s=m.useCallback(o=>{const i=typeof o=="function"?o(r):o;n(i);try{const a=JSON.parse(localStorage.getItem(_m)||"{}");a[e]=i,localStorage.setItem(_m,JSON.stringify(a))}catch{}},[e,r]);return[r,s]}function Sm({title:e,defaultOpen:t=!0,children:r}){const[n,s]=mC(`group:${e}`,t);return l.jsxs("div",{children:[l.jsxs("button",{onClick:()=>s(!n),className:"w-full px-4 py-2.5 flex items-center justify-between text-left",style:{background:"var(--bg-group-header)",border:"none",borderBottom:"1px solid var(--border-panel)",cursor:"pointer"},children:[l.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:e}),l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",transform:n?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block"},children:""})]}),n&&r]})}function un({title:e,action:t,defaultOpen:r=!0,children:n}){const[s,o]=mC(`sub:${e}`,r);return l.jsxs("div",{children:[l.jsxs("div",{className:"px-4 py-1.5 flex items-center justify-between",style:{background:"var(--bg-subsection-header)",borderBottom:"1px solid var(--border-panel)",paddingLeft:"1.25rem"},children:[l.jsxs("button",{onClick:()=>o(!s),className:"flex items-center gap-1.5",style:{background:"transparent",border:"none",cursor:"pointer",padding:0},children:[l.jsx("span",{style:{color:"var(--text-muted)",transform:s?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),l.jsx("span",{className:"font-medium",style:{color:"var(--text-muted)",fontSize:11},children:e})]}),t]}),s&&n]})}function dn({selected:e,onClick:t,label:r,sublabel:n}){return l.jsxs("button",{onClick:t,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:e?"var(--bg-selected)":"transparent",color:e?"var(--text-primary)":"var(--text-secondary)",borderLeft:e?"2px solid var(--action-primary)":"2px solid transparent"},children:[l.jsx("div",{className:"font-medium truncate",children:r}),n&&l.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:n})]})}function Gn({loading:e,empty:t,emptyMessage:r="None found"}){return e?l.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?l.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:r}):null}function d$({documentTypes:e=[],roles:t=[],templates:r=[],workflows:n=[],loading:s=!1,rolesLoading:o=!1,templatesLoading:i=!1,workflowsLoading:a=!1,selectedDocType:c=null,docTypeSource:u=null,selectedRole:d=null,selectedTemplate:f=null,selectedWorkflow:p=null,onSelectDocType:h,onSelectRole:y,onSelectTemplate:v,onSelectWorkflow:w,onCreateWorkflow:g,onSelectTask:x,onSelectSchema:b}){const[_,S]=m.useState(null),[k,N]=m.useState(null),[j,C]=m.useState(""),[R,T]=m.useState(!1),L=e.reduce((O,B)=>{const Y=B.category||"other";return O[Y]||(O[Y]=[]),O[Y].push(B),O},{}),$=["intake","architecture","planning","other"],E=Object.keys(L).sort((O,B)=>{const Y=$.indexOf(O),te=$.indexOf(B);return Y===-1&&te===-1?O.localeCompare(B):Y===-1?1:te===-1?-1:Y-te}),P=()=>{S(null),N(null),C("")},D=async()=>{const O=j.trim().toLowerCase().replace(/\s+/g,"_");if(!(!O||!/^[a-z][a-z0-9_]*$/.test(O))){T(!0);try{const B={workflow_id:O,pow_class:"template"};k&&(B.derived_from={workflow_id:k.workflow_id,version:k.active_version},B.source_version=k.active_version),await(g==null?void 0:g(B)),P()}catch{}finally{T(!1)}}},F=e.map(O=>({doc_type_id:O.doc_type_id,display_name:O.display_name,active_version:O.active_version})),A=e.map(O=>({doc_type_id:O.doc_type_id,display_name:O.display_name,active_version:O.active_version})),I=n.filter(O=>(O.pow_class||"reference")==="reference"),z=n.filter(O=>O.pow_class==="template"),M=n.filter(O=>O.pow_class==="instance"),q=e.filter(O=>O.active_version).length+n.filter(O=>O.active_version).length,H=O=>{const B=`v${O.active_version}`,Y=O.step_count!=null?`  ${O.step_count} steps`:"";return O.pow_class==="template"&&O.derived_from_label?`${B}${Y}  from ${O.derived_from_label}`:`${B}${Y}`};return l.jsx("div",{className:"w-60 flex flex-col border-r h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsxs("div",{className:"flex-1 overflow-y-auto",children:[l.jsxs(Sm,{title:"Production Workflows",defaultOpen:!0,children:[l.jsxs(un,{title:"Reference Workflows",children:[l.jsx(Gn,{loading:a,empty:!a&&I.length===0,emptyMessage:"No reference workflows"}),!a&&I.length>0&&l.jsx("div",{className:"py-1",children:I.map(O=>l.jsx(dn,{selected:(p==null?void 0:p.workflow_id)===O.workflow_id,onClick:()=>w==null?void 0:w(O),label:O.name||O.workflow_id.replace(/_/g," ").replace(/\b\w/g,B=>B.toUpperCase()),sublabel:H(O)},O.workflow_id))})]}),l.jsxs(un,{title:"Template Workflows",action:g&&l.jsx("button",{onClick:()=>S(_?null:"choose"),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new template workflow",children:"+ New"}),children:[_==="choose"&&l.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[l.jsxs("button",{onClick:()=>S("from_reference"),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-1 hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:"pointer"},disabled:I.length===0,children:["From Reference",I.length===0?" (none available)":""]}),l.jsx("button",{onClick:()=>S("blank"),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:"Blank Workflow"}),l.jsx("button",{onClick:P,className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]}),_==="from_reference"&&!k&&l.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Select reference to fork:"}),I.map(O=>l.jsxs("button",{onClick:()=>N(O),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:[l.jsx("div",{className:"font-medium",children:O.name||O.workflow_id.replace(/_/g," ").replace(/\b\w/g,B=>B.toUpperCase())}),l.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",O.active_version]})]},O.workflow_id)),l.jsx("button",{onClick:()=>S("choose"),className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Back"})]}),(_==="blank"||_==="from_reference"&&k)&&l.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[k&&l.jsxs("div",{className:"text-xs mb-1.5 px-2 py-1 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["Forking: ",k.name||k.workflow_id," v",k.active_version]}),l.jsx("input",{type:"text",value:j,onChange:O=>C(O.target.value),onKeyDown:O=>{O.key==="Enter"&&D(),O.key==="Escape"&&P()},placeholder:"workflow_id (snake_case)",autoFocus:!0,disabled:R,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:D,disabled:R||!j.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:R?"wait":"pointer",opacity:!j.trim()||R?.5:1},children:R?"Creating...":"Create"}),l.jsx("button",{onClick:P,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),l.jsx(Gn,{loading:a,empty:!a&&z.length===0,emptyMessage:"No template workflows"}),!a&&z.length>0&&l.jsx("div",{className:"py-1",children:z.map(O=>l.jsx(dn,{selected:(p==null?void 0:p.workflow_id)===O.workflow_id,onClick:()=>w==null?void 0:w(O),label:O.name||O.workflow_id.replace(/_/g," ").replace(/\b\w/g,B=>B.toUpperCase()),sublabel:H(O)},O.workflow_id))})]}),M.length>0&&l.jsx(un,{title:"Instance Workflows",children:l.jsx("div",{className:"py-1",children:M.map(O=>l.jsx(dn,{selected:(p==null?void 0:p.workflow_id)===O.workflow_id,onClick:()=>w==null?void 0:w(O),label:O.name||O.workflow_id.replace(/_/g," ").replace(/\b\w/g,B=>B.toUpperCase()),sublabel:H(O)},O.workflow_id))})}),l.jsxs(un,{title:"Document Workflows",children:[l.jsx(Gn,{loading:s,empty:!s&&e.length===0,emptyMessage:"No document workflows"}),!s&&e.length>0&&l.jsx(l.Fragment,{children:E.map(O=>l.jsxs("div",{className:"py-1",children:[l.jsx("div",{className:"px-4 py-1 text-xs font-medium uppercase tracking-wider",style:{color:"var(--text-muted)"},children:O}),L[O].map(B=>l.jsx(dn,{selected:u==="docworkflow"&&(c==null?void 0:c.doc_type_id)===B.doc_type_id,onClick:()=>h==null?void 0:h(B),label:B.display_name,sublabel:`v${B.active_version}${B.authority_level?`  ${B.authority_level}`:""}`},B.doc_type_id))]},O))})]})]}),l.jsxs(Sm,{title:"Building Blocks",defaultOpen:!0,children:[l.jsxs(un,{title:"Roles",children:[l.jsx(Gn,{loading:o,empty:!o&&t.length===0,emptyMessage:"No roles"}),!o&&t.length>0&&l.jsx("div",{className:"py-1",children:t.map(O=>l.jsx(dn,{selected:(d==null?void 0:d.role_id)===O.role_id,onClick:()=>y==null?void 0:y(O),label:O.role_id.replace(/_/g," ").replace(/\b\w/g,B=>B.toUpperCase()),sublabel:`v${O.active_version}`},O.role_id))})]}),l.jsxs(un,{title:"Interactions",children:[l.jsx(Gn,{loading:s,empty:!s&&F.length===0,emptyMessage:"No interactions"}),!s&&F.length>0&&l.jsx("div",{className:"py-1",children:F.map(O=>l.jsx(dn,{selected:u==="task"&&(c==null?void 0:c.doc_type_id)===O.doc_type_id,onClick:()=>{var B;return(B=x||h)==null?void 0:B({doc_type_id:O.doc_type_id,display_name:O.display_name,active_version:O.active_version})},label:O.display_name,sublabel:`from ${O.doc_type_id}`},`task-${O.doc_type_id}`))})]}),l.jsxs(un,{title:"Schemas",children:[l.jsx(Gn,{loading:s,empty:!s&&A.length===0,emptyMessage:"No schemas"}),!s&&A.length>0&&l.jsx("div",{className:"py-1",children:A.map(O=>l.jsx(dn,{selected:u==="schema"&&(c==null?void 0:c.doc_type_id)===O.doc_type_id,onClick:()=>{var B;return(B=b||h)==null?void 0:B({doc_type_id:O.doc_type_id,display_name:O.display_name,active_version:O.active_version})},label:O.display_name,sublabel:`from ${O.doc_type_id}`},`schema-${O.doc_type_id}`))})]}),l.jsxs(un,{title:"Templates",children:[l.jsx(Gn,{loading:i,empty:!i&&r.length===0,emptyMessage:"No templates"}),!i&&r.length>0&&l.jsx("div",{className:"py-1",children:r.map(O=>l.jsx(dn,{selected:(f==null?void 0:f.template_id)===O.template_id,onClick:()=>v==null?void 0:v(O),label:O.template_id.replace(/_/g," ").replace(/\b\w/g,B=>B.toUpperCase()),sublabel:`v${O.active_version}`},O.template_id))})]})]}),l.jsx(Sm,{title:"Governance",defaultOpen:!1,children:l.jsx("div",{className:"px-4 py-3",children:l.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"font-semibold uppercase tracking-wide mb-1",children:"Active Releases"}),l.jsxs("div",{children:[q," active ",q===1?"release":"releases"]})]})})})]})})}function Zn({content:e,onChange:t,loading:r=!1,saving:n=!1,isDirty:s=!1,error:o=null,readOnly:i=!1,placeholder:a="Enter prompt content...",isJson:c=!1}){const u=m.useCallback(()=>{if(!(!e||!c))try{const d=JSON.parse(e),f=JSON.stringify(d,null,2);t==null||t(f)}catch(d){console.warn("Invalid JSON, cannot format:",d.message)}},[e,c,t]);return l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-2",children:[i&&l.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"}),!i&&s&&l.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[c&&!i&&l.jsx("button",{onClick:u,className:"px-2 py-0.5 rounded text-xs hover:opacity-80",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Format JSON"}),r&&l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."}),n&&l.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),!n&&!r&&s&&l.jsx("span",{style:{color:"var(--action-success)"},children:"Saved"}),o&&l.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",o]})]})]}),l.jsx("div",{className:"flex-1 relative",children:r?l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading content..."})}):l.jsx("textarea",{value:e,onChange:d=>t==null?void 0:t(d.target.value),placeholder:a,readOnly:i,className:"w-full h-full p-4 resize-none font-mono text-sm",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",border:"none",outline:"none"},spellCheck:!1})})]})}function f$({workspaceId:e,artifactId:t}){const[r,n]=m.useState(null),[s,o]=m.useState(!0),[i,a]=m.useState(null);return m.useEffect(()=>{if(!e||!t){n(null),o(!1);return}(async()=>{o(!0),a(null);try{const u=await Ne.getPreview(e,t);n(u)}catch(u){a(u.message),console.error("Failed to load preview:",u)}finally{o(!1)}})()},[e,t]),l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Resolved Prompt (for execution)"}),l.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"})]}),(r==null?void 0:r.provenance)&&l.jsxs("div",{className:"space-y-1 font-mono",style:{color:"var(--text-muted)"},children:[r.provenance.role&&l.jsxs("div",{children:["Role: ",r.provenance.role]}),r.provenance.schema&&l.jsxs("div",{children:["Schema: ",r.provenance.schema]}),r.provenance.package&&l.jsxs("div",{children:["Package: ",r.provenance.package]})]})]}),l.jsx("div",{className:"flex-1 relative overflow-auto",children:s?l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading preview..."})}):i?l.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-4 rounded",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--state-error-bg)"},children:[l.jsx("div",{className:"font-medium mb-2",style:{color:"var(--state-error-text)"},children:"Preview Failed"}),l.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:i})]})}):l.jsx("pre",{className:"p-4 font-mono text-sm whitespace-pre-wrap",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",margin:0},children:(r==null?void 0:r.resolved_prompt)||"No preview available"})})]})}function p$({workspaceId:e,docType:t,roles:r=[],onSave:n}){const[s,o]=m.useState(null),[i,a]=m.useState(!1),[c,u]=m.useState(!1),[d,f]=m.useState(null),[p,h]=m.useState(!1);m.useEffect(()=>{var b,_,S;t&&(o({display_name:t.display_name||"",description:t.description||"",authority_level:t.authority_level||"elaborative",creation_mode:t.creation_mode||"llm_generated",production_mode:t.production_mode||"",scope:t.scope||"project",role_prompt_ref:t.role_prompt_ref||"",template_ref:t.template_ref||"",required_inputs:t.required_inputs||[],optional_inputs:t.optional_inputs||[],creates_children:t.creates_children||[],parent_doc_type:t.parent_doc_type||"",ui_icon:((b=t.ui)==null?void 0:b.icon)||"",ui_category:((_=t.ui)==null?void 0:_.category)||"",ui_display_order:((S=t.ui)==null?void 0:S.display_order)||0}),h(!1),f(null))},[t]);const y=m.useCallback((b,_)=>{o(S=>({...S,[b]:_})),h(!0)},[]),v=m.useCallback((b,_)=>{const S=_.split(",").map(k=>k.trim()).filter(k=>k);o(k=>({...k,[b]:S})),h(!0)},[]),w=m.useCallback(b=>{if(!b)return"";const _=r.find(S=>S.role_id===b);return _?`prompt:role:${b}:${_.active_version}`:""},[r]),g=m.useCallback(b=>{if(!b)return"";const _=b.split(":");return _.length>=3&&_[0]==="prompt"&&_[1]==="role"?_[2]:""},[]),x=m.useCallback(async()=>{if(!(!e||!t||!s)){u(!0),f(null);try{const b=t.version||t.active_version,_=`doctype:${t.doc_type_id}:${b}:manifest`,S=h$(t.doc_type_id,b,s),k=await Ne.writeArtifact(e,_,S);h(!1),n==null||n(_,k)}catch(b){console.error("Failed to save package:",b),f(b.message)}finally{u(!1)}}},[e,t,s,n]);return!t||!s?l.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"var(--text-muted)"},children:"Loading package configuration..."}):l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsx("div",{className:"flex items-center gap-2",children:p&&l.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})}),l.jsxs("div",{className:"flex items-center gap-2",children:[c&&l.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),d&&l.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",d]}),l.jsx("button",{onClick:x,disabled:!p||c,className:"px-3 py-1 rounded text-xs",style:{background:p?"var(--action-primary)":"var(--bg-panel)",color:p?"#000":"var(--text-muted)",opacity:p&&!c?1:.5},children:"Save Package"})]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"max-w-2xl space-y-6",children:[l.jsxs($o,{title:"Identity",children:[l.jsx(It,{label:"Display Name",children:l.jsx("input",{type:"text",value:s.display_name,onChange:b=>y("display_name",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(It,{label:"Description",children:l.jsx("textarea",{value:s.description,onChange:b=>y("description",b.target.value),rows:3,className:"w-full px-3 py-2 rounded text-sm resize-none",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),l.jsxs($o,{title:"Classification",children:[l.jsx(It,{label:"Authority Level",children:l.jsxs("select",{value:s.authority_level,onChange:b=>y("authority_level",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"descriptive",children:"Descriptive"}),l.jsx("option",{value:"prescriptive",children:"Prescriptive"}),l.jsx("option",{value:"constructive",children:"Constructive"}),l.jsx("option",{value:"elaborative",children:"Elaborative"})]})}),l.jsx(It,{label:"Creation Mode",children:l.jsxs("select",{value:s.creation_mode,onChange:b=>y("creation_mode",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"llm_generated",children:"LLM Generated"}),l.jsx("option",{value:"constructed",children:"Constructed"}),l.jsx("option",{value:"extracted",children:"Extracted"})]})}),l.jsx(It,{label:"Scope",children:l.jsxs("select",{value:s.scope,onChange:b=>y("scope",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"project",children:"Project"}),l.jsx("option",{value:"epic",children:"Epic"}),l.jsx("option",{value:"feature",children:"Feature"})]})})]}),l.jsx($o,{title:"Shared References",children:l.jsxs(It,{label:"Role Prompt",children:[l.jsxs("select",{value:g(s.role_prompt_ref),onChange:b=>y("role_prompt_ref",w(b.target.value)),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"",children:"None"}),r.map(b=>l.jsx("option",{value:b.role_id,children:b.role_id.replace(/_/g," ").replace(/\b\w/g,_=>_.toUpperCase())},b.role_id))]}),s.role_prompt_ref&&l.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:s.role_prompt_ref})]})}),l.jsxs($o,{title:"Dependencies",children:[l.jsx(It,{label:"Required Inputs",hint:"Comma-separated doc type IDs",children:l.jsx("input",{type:"text",value:s.required_inputs.join(", "),onChange:b=>v("required_inputs",b.target.value),placeholder:"e.g., project_discovery, technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(It,{label:"Optional Inputs",hint:"Comma-separated doc type IDs",children:l.jsx("input",{type:"text",value:s.optional_inputs.join(", "),onChange:b=>v("optional_inputs",b.target.value),placeholder:"e.g., technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(It,{label:"Parent Doc Type",children:l.jsx("input",{type:"text",value:s.parent_doc_type,onChange:b=>y("parent_doc_type",b.target.value),placeholder:"e.g., implementation_plan",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(It,{label:"Creates Children",hint:"Comma-separated doc type IDs",children:l.jsx("input",{type:"text",value:s.creates_children.join(", "),onChange:b=>v("creates_children",b.target.value),placeholder:"e.g., feature, story",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),l.jsxs($o,{title:"UI Configuration",children:[l.jsx(It,{label:"Icon",children:l.jsx("input",{type:"text",value:s.ui_icon,onChange:b=>y("ui_icon",b.target.value),placeholder:"e.g., search, package, map",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),l.jsx(It,{label:"Category",children:l.jsxs("select",{value:s.ui_category,onChange:b=>y("ui_category",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[l.jsx("option",{value:"",children:"Select category..."}),l.jsx("option",{value:"intake",children:"Intake"}),l.jsx("option",{value:"architecture",children:"Architecture"}),l.jsx("option",{value:"planning",children:"Planning"}),l.jsx("option",{value:"execution",children:"Execution"})]})}),l.jsx(It,{label:"Display Order",children:l.jsx("input",{type:"number",value:s.ui_display_order,onChange:b=>y("ui_display_order",parseInt(b.target.value)||0),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]})]})})]})}function $o({title:e,children:t}){return l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-semibold mb-3 uppercase tracking-wide",style:{color:"var(--text-muted)"},children:e}),l.jsx("div",{className:"space-y-4",children:t})]})}function It({label:e,hint:t,children:r}){return l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm mb-1",style:{color:"var(--text-secondary)"},children:[e,t&&l.jsxs("span",{className:"ml-2 text-xs",style:{color:"var(--text-muted)"},children:["(",t,")"]})]}),r]})}function h$(e,t,r){return[`# ${r.display_name} Package`,`# Version ${t}`,"",`doc_type_id: ${e}`,`display_name: "${r.display_name}"`,`version: "${t}"`,"description: >",`  ${r.description.replace(/\n/g,`
  `)}`,"","# Classification",`authority_level: ${r.authority_level}`,`creation_mode: ${r.creation_mode}`,r.production_mode?`production_mode: ${r.production_mode}`:"production_mode: null",`scope: ${r.scope}`,"","# Dependencies",`required_inputs: [${r.required_inputs.map(s=>`"${s}"`).join(", ")}]`,`optional_inputs: [${r.optional_inputs.map(s=>`"${s}"`).join(", ")}]`,`creates_children: [${r.creates_children.map(s=>`"${s}"`).join(", ")}]`,`parent_doc_type: ${r.parent_doc_type?`"${r.parent_doc_type}"`:"null"}`,"","# Shared artifact references",`role_prompt_ref: ${r.role_prompt_ref?`"${r.role_prompt_ref}"`:"null"}`,`template_ref: ${r.template_ref?`"${r.template_ref}"`:"null"}`,"","# Packaged artifacts","artifacts:",'  task_prompt: "prompts/task.prompt.txt"',"  qa_prompt: null","  reflection_prompt: null","  pgc_context: null","  questions_prompt: null",'  schema: "schemas/output.schema.json"',"","# Tests","tests:","  fixtures: []","  golden_traces: []","","# Gating rules","gating_rules:","  lifecycle_states: []","  design_status: []","  acceptance_required: false","  accepted_by: []","","# UI configuration","ui:",`  icon: ${r.ui_icon||"file"}`,`  category: ${r.ui_category||"other"}`,`  display_order: ${r.ui_display_order||0}`,""].join(`
`)}function gC(e,t,{debounceMs:r=1e3,onSave:n}={}){const[s,o]=m.useState(null),[i,a]=m.useState(null),[c,u]=m.useState(!0),[d,f]=m.useState(null),[p,h]=m.useState(!1),[y,v]=m.useState(null),w=m.useRef(null),g=m.useRef(null),x=m.useCallback(async()=>{if(!e||!t){o(null),a(null),u(!1);return}u(!0),f(null);try{const N=await Ne.getArtifact(e,t),j=JSON.parse(N.content);o(j),a(j)}catch(N){f(N.message),console.error("Failed to load workflow artifact:",N)}finally{u(!1)}},[e,t]),b=m.useCallback(async N=>{if(!(!e||!t)){h(!0),f(null);try{const j=JSON.stringify(N,null,2),C=await Ne.writeArtifact(e,t,j);v(C),a(N),n&&n(C)}catch(j){f(j.message),console.error("Failed to save workflow:",j)}finally{h(!1)}}},[e,t,n]),_=m.useCallback(N=>{g.current=N,w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{g.current!==null&&(b(g.current),g.current=null)},r)},[b,r]),S=m.useCallback(N=>{o(N),_(N)},[_]),k=m.useCallback(()=>{w.current&&clearTimeout(w.current),s&&b(s)},[s,b]);return m.useEffect(()=>(x(),()=>{w.current&&clearTimeout(w.current)}),[x]),{workflowJson:s,originalJson:i,loading:c,error:d,saving:p,lastSaveResult:y,isDirty:s!==i,updateWorkflow:S,saveNow:k,reload:x}}function m$({data:e,selected:t}){const{config:r,isEntry:n}=e,s=e.type==="end";return l.jsxs("div",{style:{background:r.bgColor,border:`2px solid ${t?r.color:r.borderColor}`,borderRadius:8,padding:"8px 12px",minWidth:180,maxWidth:220,boxShadow:t?`0 0 12px ${r.color}40`:"none",transition:"box-shadow 0.2s"},children:[l.jsx(Ir,{type:"target",position:J.Top,style:{background:r.color,width:8,height:8,border:"none"}}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[l.jsx("span",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:r.color,letterSpacing:"0.05em"},children:r.label}),n&&l.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:r.color,color:"#fff",fontWeight:700,letterSpacing:"0.05em"},children:"ENTRY"})]}),l.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",marginBottom:2},children:e.node_id}),e.description&&l.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"14px",maxHeight:"28px"},children:e.description}),l.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap"},children:[e.produces&&l.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(59,130,246,0.2)",color:"#3b82f6"},children:e.produces}),e.terminal_outcome&&l.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:e.terminal_outcome==="stabilized"?"rgba(16,185,129,0.2)":"rgba(239,68,68,0.2)",color:e.terminal_outcome==="stabilized"?"#10b981":"#ef4444"},children:e.terminal_outcome}),e.requires_qa&&l.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.2)",color:"#8b5cf6"},children:"QA"}),e.qa_mode&&l.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.1)",color:"#8b5cf6"},children:e.qa_mode})]}),!s&&l.jsx(Ir,{type:"source",position:J.Bottom,style:{background:r.color,width:8,height:8,border:"none"}})]})}const g$=m.memo(m$),ql={intake_gate:{color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",borderColor:"rgba(245, 158, 11, 0.5)",label:"Intake Gate"},task:{color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",label:"Task"},qa:{color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",borderColor:"rgba(139, 92, 246, 0.5)",label:"QA"},pgc:{color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",borderColor:"rgba(6, 182, 212, 0.5)",label:"PGC"},gate:{color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",borderColor:"rgba(249, 115, 22, 0.5)",label:"Gate"},end:{color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",borderColor:"rgba(16, 185, 129, 0.5)",label:"End"}},v$={color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",label:"End"},W2=220,V2=110;function U2(e){if(!e||!e.nodes)return{nodes:[],edges:[]};const t=e.entry_node_ids||[],r=e.nodes.map(s=>{const o=ql[s.type]||ql.task,a=s.type==="end"&&["blocked","abandoned"].includes(s.terminal_outcome)?v$:o;return{id:s.node_id,type:"workflowNode",position:s._position||{x:0,y:0},data:{...s,config:a,isEntry:t.includes(s.node_id)}}}),n=(e.edges||[]).map(s=>{const o=s.non_advancing||!s.to_node_id,i=s.conditions&&s.conditions.length>0;let a=s.label||s.outcome;if(i){const c=s.conditions[0],u={eq:"=",ne:"!=",lt:"<",lte:"<=",gt:">",gte:">="}[c.operator]||c.operator;a=`${a} (${c.type} ${u} ${c.value})`}return{id:s.edge_id,source:s.from_node_id,target:s.to_node_id||s.from_node_id,type:"smoothstep",animated:o,label:a,data:{...s},style:{stroke:o?"#6b7280":"#64748b",strokeWidth:2,strokeDasharray:o?"5,5":void 0},labelStyle:{fontSize:10,fill:"var(--text-muted)"},labelBgStyle:{fill:"var(--bg-panel)",fillOpacity:.9},markerEnd:s.to_node_id?{type:"arrowclosed",color:"#64748b"}:void 0}});return{nodes:r,edges:n}}function G2(e,t,r="TB"){const n=new zl.graphlib.Graph;return n.setDefaultEdgeLabel(()=>({})),n.setGraph({rankdir:r,nodesep:60,ranksep:80,marginx:40,marginy:40}),e.forEach(s=>{n.setNode(s.id,{width:W2,height:V2})}),t.forEach(s=>{s.target!==s.source&&n.setEdge(s.source,s.target)}),zl.layout(n),e.map(s=>{const o=n.node(s.id);return o?{...s,position:{x:o.x-W2/2,y:o.y-V2/2}}:s})}function x$(e,t){const r=new Set(t.map(o=>o.id||o.node_id));let n=1,s=`${e}_${n}`;for(;r.has(s);)n++,s=`${e}_${n}`;return s}function y$(e,t,r){const n=new Set(r.map(i=>i.id||i.edge_id));let s=1,o=`${e}_to_${t}`;for(;n.has(o);)s++,o=`${e}_to_${t}_${s}`;return o}function b$(e,t={x:100,y:100}){const n={node_id:e+"_new",type:e,description:""};return e==="end"&&(n.terminal_outcome="stabilized"),(e==="task"||e==="pgc")&&(n.task_ref="",n.includes={}),e==="qa"&&(n.requires_qa=!0,n.qa_mode="semantic"),n}const w$={workflowNode:g$},_$=[{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"},{value:"intake_gate",label:"Intake Gate"}];function S$({workflowJson:e,onWorkflowChange:t,selectedNodeId:r,selectedEdgeId:n,onNodeSelect:s,onEdgeSelect:o}){const i=mc(),[a,c,u]=WN([]),[d,f,p]=VN([]),[h,y]=m.useState(!1),v=m.useRef(!1);m.useEffect(()=>{if(!e){c([]),f([]);return}let{nodes:C,edges:R}=U2(e);(!C.some(L=>L.position.x!==0||L.position.y!==0)||!v.current)&&(C=G2(C,R),v.current=!0),c(C),f(R)},[e,c,f]);const w=m.useCallback(C=>{if(!e)return;const T={edge_id:y$(C.source,C.target,e.edges||[]),from_node_id:C.source,to_node_id:C.target,outcome:"success",label:"",kind:"auto"},L={...e,edges:[...e.edges||[],T]};t(L)},[e,t]),g=m.useCallback((C,R)=>{if(!e)return;const T=e.nodes.map(L=>L.node_id===R.id?{...L,_position:R.position}:L);t({...e,nodes:T})},[e,t]),x=m.useCallback((C,R)=>{s==null||s(R.id)},[s]),b=m.useCallback((C,R)=>{o==null||o(R.id)},[o]),_=m.useCallback(()=>{s==null||s(null),o==null||o(null)},[s,o]),S=m.useCallback(C=>{if(C.key==="Delete"||C.key==="Backspace"){if(r&&e){const R={...e,nodes:e.nodes.filter(T=>T.node_id!==r),edges:e.edges.filter(T=>T.from_node_id!==r&&T.to_node_id!==r),entry_node_ids:(e.entry_node_ids||[]).filter(T=>T!==r)};t(R),s==null||s(null)}else if(n&&e){const R={...e,edges:e.edges.filter(T=>T.edge_id!==n)};t(R),o==null||o(null)}}},[r,n,e,t,s,o]),k=m.useCallback(C=>{if(!e)return;const R=x$(C,e.nodes||[]),T=b$(C);T.node_id=R;const L=i.getViewport(),$=(-L.x+window.innerWidth/2)/L.zoom,E=(-L.y+window.innerHeight/2)/L.zoom;T._position={x:$-110,y:E-50};const P={...e,nodes:[...e.nodes||[],T]};t(P),y(!1),s==null||s(R)},[e,t,i,s]),N=m.useCallback(()=>{if(!e)return;let{nodes:C,edges:R}=U2(e);C=G2(C,R);const T=e.nodes.map(L=>{const $=C.find(E=>E.id===L.node_id);return $?{...L,_position:$.position}:L});t({...e,nodes:T}),setTimeout(()=>{i.fitView({padding:.2,duration:300})},50)},[e,t,i]),j=m.useCallback(()=>{i.fitView({padding:.2,duration:300})},[i]);return l.jsx("div",{className:"flex-1 relative",onKeyDown:S,tabIndex:0,style:{outline:"none"},children:l.jsxs(tx,{nodes:a,edges:d,onNodesChange:u,onEdgesChange:p,onConnect:w,onNodeDragStop:g,onNodeClick:x,onEdgeClick:b,onPaneClick:_,nodeTypes:w$,fitView:!0,fitViewOptions:{padding:.2},minZoom:.2,maxZoom:2,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},deleteKeyCode:null,children:[l.jsx(Mn,{position:"top-left",children:l.jsxs("div",{className:"flex gap-2 px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"relative",children:[l.jsx("button",{onClick:()=>y(!h),className:"px-2.5 py-1.5 rounded text-xs font-medium transition-colors hover:opacity-80",style:{background:"var(--action-primary)",color:"#000"},children:"+ Add Node"}),h&&l.jsx("div",{className:"absolute top-full left-0 mt-1 rounded-lg border shadow-xl z-10",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)",minWidth:140},children:_$.map(C=>{const R=ql[C.value]||{};return l.jsxs("button",{onClick:()=>k(C.value),className:"w-full px-3 py-2 text-left text-xs hover:opacity-80 transition-colors flex items-center gap-2",style:{color:"var(--text-primary)"},children:[l.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),C.label]},C.value)})})]}),l.jsx("button",{onClick:N,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Auto Layout"}),l.jsx("button",{onClick:j,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Fit View"})]})}),l.jsx(KN,{position:"bottom-right",nodeColor:C=>{var T;const R=(T=C.data)==null?void 0:T.config;return(R==null?void 0:R.color)||"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),l.jsx(Mn,{position:"bottom-left",children:l.jsx("div",{className:"flex gap-3 text-[10px] px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:Object.entries(ql).map(([C,R])=>l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),l.jsx("span",{style:{color:"var(--text-muted)"},children:R.label})]},C))})}),l.jsx(Mn,{position:"top-right",children:l.jsx("div",{className:"text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Drag to connect | Delete to remove | Scroll to zoom"})})]})})}const j$=[{value:"intake_gate",label:"Intake Gate"},{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"}],k$=["semantic","structural","hybrid"],N$=["stabilized","blocked","abandoned"],Sr={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},Lr={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function E$({node:e,onChange:t,onDelete:r}){const[n,s]=m.useState(e);m.useEffect(()=>{s(e)},[e]);const o=(u,d)=>{const f={...n,[u]:d};s(f),t(f)},i=(u,d)=>{const f={...n.includes,[u]:d},p={...n,includes:f};s(p),t(p)},a=u=>{const d={...n.includes};delete d[u];const f={...n,includes:d};s(f),t(f)},c=()=>{const u={...n.includes,NEW_KEY:""},d={...n,includes:u};s(d),t(d)};return n?l.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[l.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Node Properties"}),l.jsx("button",{onClick:()=>r(n.node_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete node",children:l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),l.jsxs("div",{className:"p-3 space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"Node ID"}),l.jsx("input",{type:"text",value:n.node_id||"",onChange:u=>o("node_id",u.target.value),style:Sr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"Type"}),l.jsx("select",{value:n.type||"task",onChange:u=>o("type",u.target.value),style:Sr,children:j$.map(u=>l.jsx("option",{value:u.value,children:u.label},u.value))})]}),l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"Description"}),l.jsx("textarea",{value:n.description||"",onChange:u=>o("description",u.target.value),rows:3,style:{...Sr,resize:"vertical"}})]}),["task","qa","pgc","intake_gate"].includes(n.type)&&l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"Task Ref"}),l.jsx("input",{type:"text",value:n.task_ref||"",onChange:u=>o("task_ref",u.target.value),placeholder:"tasks/Name v1.0",style:Sr})]}),["task","intake_gate"].includes(n.type)&&l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"Produces"}),l.jsx("input",{type:"text",value:n.produces||"",onChange:u=>o("produces",u.target.value),placeholder:"document_type",style:Sr})]}),n.type==="qa"&&l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"QA Mode"}),l.jsx("select",{value:n.qa_mode||"semantic",onChange:u=>o("qa_mode",u.target.value),style:Sr,children:k$.map(u=>l.jsx("option",{value:u,children:u},u))})]}),n.type==="end"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"Terminal Outcome"}),l.jsx("select",{value:n.terminal_outcome||"stabilized",onChange:u=>o("terminal_outcome",u.target.value),style:Sr,children:N$.map(u=>l.jsx("option",{value:u,children:u},u))})]}),l.jsxs("div",{children:[l.jsx("label",{style:Lr,children:"Gate Outcome"}),l.jsx("input",{type:"text",value:n.gate_outcome||"",onChange:u=>o("gate_outcome",u.target.value),placeholder:"e.g., complete, failed",style:Sr})]})]}),l.jsxs("div",{className:"flex gap-4",children:[n.type==="qa"&&l.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[l.jsx("input",{type:"checkbox",checked:n.requires_qa||!1,onChange:u=>o("requires_qa",u.target.checked)}),"Requires QA"]}),l.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[l.jsx("input",{type:"checkbox",checked:n.non_advancing||!1,onChange:u=>o("non_advancing",u.target.checked)}),"Non-advancing"]})]}),["task","pgc"].includes(n.type)&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("label",{style:Lr,children:"Includes"}),l.jsx("button",{onClick:c,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),l.jsx("div",{className:"space-y-2",children:Object.entries(n.includes||{}).map(([u,d])=>l.jsxs("div",{className:"flex gap-1",children:[l.jsx("input",{type:"text",value:u,onChange:f=>{const p={...n.includes};delete p[u],p[f.target.value]=d;const h={...n,includes:p};s(h),t(h)},style:{...Sr,width:"35%",fontSize:10},placeholder:"KEY"}),l.jsx("input",{type:"text",value:d,onChange:f=>i(u,f.target.value),style:{...Sr,flex:1,fontSize:10},placeholder:"path/to/file"}),l.jsx("button",{onClick:()=>a(u),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]},u))})]})]})]}):null}const C$=["auto","user_choice"],R$=["eq","ne","lt","lte","gt","gte"],zr={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},Kn={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function T$({edge:e,nodeIds:t,onChange:r,onDelete:n}){const[s,o]=m.useState(e);m.useEffect(()=>{o(e)},[e]);const i=(d,f)=>{const p={...s,[d]:f};o(p),r(p)},a=()=>{const d=[...s.conditions||[],{type:"retry_count",operator:"lt",value:2}];i("conditions",d)},c=(d,f,p)=>{const h=[...s.conditions||[]];h[d]={...h[d],[f]:p},i("conditions",h)},u=d=>{const f=(s.conditions||[]).filter((p,h)=>h!==d);i("conditions",f)};return s?l.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[l.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Edge Properties"}),l.jsx("button",{onClick:()=>n(s.edge_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete edge",children:l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),l.jsxs("div",{className:"p-3 space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{style:Kn,children:"Edge ID"}),l.jsx("input",{type:"text",value:s.edge_id||"",onChange:d=>i("edge_id",d.target.value),style:zr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Kn,children:"From Node"}),l.jsx("select",{value:s.from_node_id||"",onChange:d=>i("from_node_id",d.target.value),style:zr,children:t.map(d=>l.jsx("option",{value:d,children:d},d))})]}),l.jsxs("div",{children:[l.jsx("label",{style:Kn,children:"To Node"}),l.jsxs("select",{value:s.to_node_id||"",onChange:d=>i("to_node_id",d.target.value||null),style:zr,children:[l.jsx("option",{value:"",children:"(none - non-advancing)"}),t.map(d=>l.jsx("option",{value:d,children:d},d))]})]}),l.jsxs("div",{children:[l.jsx("label",{style:Kn,children:"Outcome"}),l.jsx("input",{type:"text",value:s.outcome||"",onChange:d=>i("outcome",d.target.value),placeholder:"success, failed, etc.",style:zr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Kn,children:"Label"}),l.jsx("input",{type:"text",value:s.label||"",onChange:d=>i("label",d.target.value),placeholder:"Human-readable label",style:zr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Kn,children:"Kind"}),l.jsx("select",{value:s.kind||"auto",onChange:d=>i("kind",d.target.value),style:zr,children:C$.map(d=>l.jsx("option",{value:d,children:d},d))})]}),l.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[l.jsx("input",{type:"checkbox",checked:s.non_advancing||!1,onChange:d=>i("non_advancing",d.target.checked)}),"Non-advancing"]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("label",{style:Kn,children:"Conditions"}),l.jsx("button",{onClick:a,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),l.jsx("div",{className:"space-y-2",children:(s.conditions||[]).map((d,f)=>l.jsx("div",{className:"p-2 rounded space-y-1",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:l.jsxs("div",{className:"flex gap-1 items-center",children:[l.jsx("input",{type:"text",value:d.type||"",onChange:p=>c(f,"type",p.target.value),placeholder:"retry_count",style:{...zr,flex:1,fontSize:10}}),l.jsx("select",{value:d.operator||"lt",onChange:p=>c(f,"operator",p.target.value),style:{...zr,width:"auto",fontSize:10},children:R$.map(p=>l.jsx("option",{value:p,children:p},p))}),l.jsx("input",{type:"text",value:d.value??"",onChange:p=>{const h=isNaN(p.target.value)?p.target.value:Number(p.target.value);c(f,"value",h)},placeholder:"value",style:{...zr,width:50,fontSize:10}}),l.jsx("button",{onClick:()=>u(f),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]})},f))})]})]})]}):null}const I$={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"};function M$({workspaceId:e,artifactId:t,onArtifactSave:r}){var A,I,z;const[n,s]=m.useState("canvas"),[o,i]=m.useState(null),[a,c]=m.useState(null),[u,d]=m.useState(""),[f,p]=m.useState(null),{workflowJson:h,loading:y,error:v,saving:w,lastSaveResult:g,updateWorkflow:x}=gC(e,t,{onSave:M=>{r==null||r(t,M)}}),b=m.useMemo(()=>{var M;return!o||!h?null:((M=h.nodes)==null?void 0:M.find(q=>q.node_id===o))||null},[o,h]),_=m.useMemo(()=>{var M;return!a||!h?null:((M=h.edges)==null?void 0:M.find(q=>q.edge_id===a))||null},[a,h]),S=m.useMemo(()=>h!=null&&h.nodes?h.nodes.map(M=>M.node_id):[],[h]),k=m.useCallback(M=>{x(M)},[x]),N=m.useCallback(M=>{if(!h)return;const q=h.nodes.map(B=>B.node_id===o?M:B);let H=h.edges,O=h.entry_node_ids||[];M.node_id!==o&&(H=h.edges.map(B=>({...B,from_node_id:B.from_node_id===o?M.node_id:B.from_node_id,to_node_id:B.to_node_id===o?M.node_id:B.to_node_id})),O=O.map(B=>B===o?M.node_id:B),i(M.node_id)),x({...h,nodes:q,edges:H,entry_node_ids:O})},[h,o,x]),j=m.useCallback(M=>{if(!h)return;const q=h.edges.map(H=>H.edge_id===a?M:H);M.edge_id!==a&&c(M.edge_id),x({...h,edges:q})},[h,a,x]),C=m.useCallback(M=>{h&&(x({...h,nodes:h.nodes.filter(q=>q.node_id!==M),edges:h.edges.filter(q=>q.from_node_id!==M&&q.to_node_id!==M),entry_node_ids:(h.entry_node_ids||[]).filter(q=>q!==M)}),i(null))},[h,x]),R=m.useCallback(M=>{h&&(x({...h,edges:h.edges.filter(q=>q.edge_id!==M)}),c(null))},[h,x]),T=m.useCallback(M=>{i(M),M&&c(null)},[]),L=m.useCallback(M=>{c(M),M&&i(null)},[]),$=m.useCallback(M=>{M==="json"&&h&&(d(JSON.stringify(h,null,2)),p(null)),s(M)},[h]),E=m.useCallback(M=>{const q=M.target.value;d(q);try{const H=JSON.parse(q);p(null),x(H)}catch(H){p(H.message)}},[x]),P=((A=g==null?void 0:g.tier1_report)==null?void 0:A.results)||[],D=P.filter(M=>M.severity==="error").length,F=P.filter(M=>M.severity==="warning").length;return l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"flex items-center justify-between px-4 py-1.5 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsxs("div",{className:"flex items-center gap-3",children:[w&&l.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),v&&l.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:v}),!w&&!v&&h&&l.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[((I=h.nodes)==null?void 0:I.length)||0," nodes, ",((z=h.edges)==null?void 0:z.length)||0," edges"]})]})}),l.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"canvas",label:"Canvas"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(M=>l.jsx("button",{onClick:()=>$(M.id),style:{...I$,color:n===M.id?"var(--text-primary)":"var(--text-muted)",borderBottom:n===M.id?"2px solid var(--action-primary)":"2px solid transparent"},children:M.label},M.id))}),y?l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):l.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[n==="canvas"&&l.jsxs(l.Fragment,{children:[l.jsx(gc,{children:l.jsx(S$,{workflowJson:h,onWorkflowChange:k,selectedNodeId:o,selectedEdgeId:a,onNodeSelect:T,onEdgeSelect:L})}),b&&l.jsx(E$,{node:b,onChange:N,onDelete:C}),_&&l.jsx(T$,{edge:_,nodeIds:S,onChange:j,onDelete:R})]}),n==="json"&&l.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[l.jsx("textarea",{value:u,onChange:E,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:f?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),f&&l.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",f]})]}),n==="metadata"&&l.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:h?l.jsx(A$,{workflow:h}):l.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]}),P.length>0&&l.jsxs("div",{className:"px-4 py-1.5 border-t flex items-center gap-3 text-xs",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[D>0&&l.jsxs("span",{style:{color:"#ef4444"},children:[D," error",D!==1?"s":""]}),F>0&&l.jsxs("span",{style:{color:"#f59e0b"},children:[F," warning",F!==1?"s":""]}),D===0&&F===0&&l.jsx("span",{style:{color:"#10b981"},children:"Valid"}),l.jsx("span",{style:{color:"var(--text-muted)"},children:P.map(M=>M.message).join(" | ")})]})]})}function A$({workflow:e}){const t={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},r={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},n=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"version",label:"Version"},{key:"description",label:"Description"}],s=e.thread_ownership||{},o=Object.entries(s),i=e.entry_node_ids||[];return l.jsxs("div",{className:"space-y-4 max-w-lg",children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),n.map(a=>l.jsxs("div",{children:[l.jsx("label",{style:r,children:a.label}),l.jsx("div",{style:t,children:e[a.key]||"-"})]},a.key)),l.jsxs("div",{children:[l.jsx("label",{style:r,children:"Entry Node IDs"}),l.jsx("div",{style:t,children:i.length>0?i.join(", "):"-"})]}),o.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Thread Ownership"}),o.map(([a,c])=>l.jsxs("div",{children:[l.jsx("label",{style:r,children:a}),l.jsx("div",{style:t,children:c})]},a))]})]})}function P$({workspaceId:e,docType:t,loading:r=!1,roles:n=[],onArtifactSave:s,initialTab:o=null}){var V,K,oe;const[i,a]=m.useState(o||"task_prompt");m.useEffect(()=>{o&&a(o)},[o]);const[c,u]=m.useState("source"),[d,f]=m.useState(null),[p,h]=m.useState(!1),[y,v]=m.useState(null),[w,g]=m.useState(null),[x,b]=m.useState(!1),[_,S]=m.useState(null),[k,N]=m.useState(null),[j,C]=m.useState(!1),[R,T]=m.useState(null),[L,$]=m.useState(null),[E,P]=m.useState(!1),[D,F]=m.useState(null),A=m.useMemo(()=>{if(!(t!=null&&t.role_prompt_ref))return null;const U=t.role_prompt_ref.split(":");return U.length!==4||U[0]!=="prompt"||U[1]!=="role"?null:{roleId:U[2],version:U[3]}},[t==null?void 0:t.role_prompt_ref]),I=m.useMemo(()=>{if(!(t!=null&&t.template_ref))return null;const U=t.template_ref.split(":");return U.length!==4||U[0]!=="prompt"||U[1]!=="template"?null:{templateId:U[2],version:U[3]}},[t==null?void 0:t.template_ref]),z=m.useMemo(()=>{if(!(t!=null&&t.qa_template_ref))return null;const U=t.qa_template_ref.split(":");return U.length!==4||U[0]!=="prompt"||U[1]!=="template"?null:{templateId:U[2],version:U[3]}},[t==null?void 0:t.qa_template_ref]),M=m.useMemo(()=>{if(!(t!=null&&t.pgc_template_ref))return null;const U=t.pgc_template_ref.split(":");return U.length!==4||U[0]!=="prompt"||U[1]!=="template"?null:{templateId:U[2],version:U[3]}},[t==null?void 0:t.pgc_template_ref]);m.useEffect(()=>{if(!A){f(null);return}h(!0),v(null),Ne.getRole(A.roleId,A.version).then(U=>{f(U.content)}).catch(U=>{console.error("Failed to load role:",U),v(U.message)}).finally(()=>{h(!1)})},[A]),m.useEffect(()=>{if(!I){g(null);return}b(!0),S(null),Ne.getTemplate(I.templateId,I.version).then(U=>{g(U.content)}).catch(U=>{console.error("Failed to load template:",U),S(U.message)}).finally(()=>{b(!1)})},[I]),m.useEffect(()=>{if(!z){N(null);return}C(!0),T(null),Ne.getTemplate(z.templateId,z.version).then(U=>{N(U.content)}).catch(U=>{console.error("Failed to load QA template:",U),T(U.message)}).finally(()=>{C(!1)})},[z]),m.useEffect(()=>{if(!M){$(null);return}P(!0),F(null),Ne.getTemplate(M.templateId,M.version).then(U=>{$(U.content)}).catch(U=>{console.error("Failed to load PGC template:",U),F(U.message)}).finally(()=>{P(!1)})},[M]);const q=m.useMemo(()=>{if(!t||i==="role_prompt")return null;const U=t.version||t.active_version;return`doctype:${t.doc_type_id}:${U}:${i}`},[t,i]),{content:H,loading:O,error:B,saving:Y,isDirty:te,updateContent:ne,lastSaveResult:re}=Sx(e,q,{onSave:U=>{s==null||s(q,U)}}),Q=[{id:"package",label:"Package",isPackage:!0},{id:"role_prompt",label:"Role Prompt",viewOnly:!0},{id:"template",label:"Template",viewOnly:!0},{id:"task_prompt",label:"Task Prompt"},{id:"qa_prompt",label:"QA Prompt"},{id:"qa_template",label:"QA Template",viewOnly:!0},{id:"reflection_prompt",label:"Reflection"},{id:"pgc_context",label:"PGC Context"},{id:"pgc_template",label:"PGC Template",viewOnly:!0},{id:"schema",label:"Schema",isJson:!0},{id:"workflow",label:"Workflow",isWorkflow:!0}],ce=m.useMemo(()=>t?Q.filter(U=>U.id==="package"?!0:U.id==="role_prompt"?!!t.role_prompt_ref:U.id==="template"?!!t.template_ref:U.id==="qa_template"?!!t.qa_template_ref:U.id==="pgc_template"?!!t.pgc_template_ref:U.id==="workflow"?!!t.workflow_ref:t.artifacts?t.artifacts[U.id]!=null:!1):[],[t]);m.useEffect(()=>{ce.length>0&&!ce.find(U=>U.id===i)&&a(ce[0].id)},[ce,i]);const ie=i==="role_prompt"||i==="template"||i==="qa_template"||i==="pgc_template",xe=i==="package",ee=i==="schema",X=i==="workflow",fe=!ie&&!xe&&!ee&&!X;return!t&&!r?l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-2",children:"No Document Type Selected"}),l.jsx("div",{className:"text-sm",children:"Select a document type from the browser to edit its prompts."})]})}):r?l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-2",children:"Loading..."}),l.jsx("div",{className:"text-sm",children:"Fetching document type details..."})]})}):l.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:t.display_name}),l.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.version||t.active_version,t.authority_level&&`  ${t.authority_level}`]})]})})}),l.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:ce.map(U=>{const we=i===U.id;return l.jsxs("button",{onClick:()=>{a(U.id),u("source")},className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:we?"var(--text-primary)":"var(--text-muted)",background:we?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:we?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px"},children:[U.label,U.viewOnly&&l.jsx("span",{className:"ml-1 text-xs font-normal",style:{color:"var(--text-muted)"},children:"(view)"})]},U.id)})}),fe&&l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:()=>u("source"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:c==="source"?"var(--action-primary)":"transparent",color:c==="source"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Source"}),l.jsx("button",{onClick:()=>u("resolved"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:c==="resolved"?"var(--action-primary)":"transparent",color:c==="resolved"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Resolved"})]}),c==="source"&&((V=t==null?void 0:t.artifacts)==null?void 0:V[i])&&l.jsxs("span",{className:"text-xs font-mono truncate ml-4",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts[i]}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts[i]]})]}),ie&&l.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:i==="role_prompt"?"View Only - Edit roles in the Roles section":"View Only - Shared template"}),i==="role_prompt"&&A&&l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[A.roleId.replace(/_/g," ")," v",A.version]}),i==="template"&&I&&l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[I.templateId.replace(/_/g," ")," v",I.version]}),i==="qa_template"&&z&&l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[z.templateId.replace(/_/g," ")," v",z.version]}),i==="pgc_template"&&M&&l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[M.templateId.replace(/_/g," ")," v",M.version]})]}),ee&&((K=t==null?void 0:t.artifacts)==null?void 0:K.schema)&&l.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:l.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts.schema}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts.schema]})}),l.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:X?l.jsx(M$,{workspaceId:e,artifactId:t.workflow_ref,onArtifactSave:s}):i==="package"?l.jsx(p$,{workspaceId:e,docType:t,roles:n,onSave:s}):i==="role_prompt"?l.jsx(Zn,{content:d||"",onChange:()=>{},loading:p,saving:!1,isDirty:!1,error:y,readOnly:!0,placeholder:"No role prompt configured for this document type"}):i==="template"?l.jsx(Zn,{content:w||"",onChange:()=>{},loading:x,saving:!1,isDirty:!1,error:_,readOnly:!0,placeholder:"No template configured for this document type"}):i==="qa_template"?l.jsx(Zn,{content:k||"",onChange:()=>{},loading:j,saving:!1,isDirty:!1,error:R,readOnly:!0,placeholder:"No QA template configured for this document type"}):i==="pgc_template"?l.jsx(Zn,{content:L||"",onChange:()=>{},loading:E,saving:!1,isDirty:!1,error:D,readOnly:!0,placeholder:"No PGC template configured for this document type"}):c==="source"||ee?l.jsx(Zn,{content:H,onChange:ne,loading:O,saving:Y,isDirty:te,error:B,placeholder:`Enter ${((oe=ce.find(U=>U.id===i))==null?void 0:oe.label)||"prompt"} content...`,isJson:ee}):l.jsx(f$,{workspaceId:e,artifactId:q})}),fe&&(re==null?void 0:re.tier1)&&!re.tier1.passed&&l.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:l.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function D$({workspaceId:e,role:t,onArtifactSave:r}){const n=t?`role:${t.role_id}:${t.active_version}:role_prompt`:null,{content:s,loading:o,error:i,saving:a,isDirty:c,updateContent:u,lastSaveResult:d}=Sx(e,n,{onSave:p=>{r==null||r(n,p)}});if(!t)return l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-2",children:"No Role Selected"}),l.jsx("div",{className:"text-sm",children:"Select a role from the browser to edit its prompt."})]})});const f=t.role_id.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());return l.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),l.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Role Prompt"]})]})})}),l.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Role Prompt"})}),l.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:l.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/roles/",t.role_id,"/releases/",t.active_version,"/role.prompt.txt"]})}),l.jsx("div",{className:"flex-1 overflow-hidden",children:l.jsx(Zn,{content:s,onChange:u,loading:o,saving:a,isDirty:c,error:i,placeholder:"Enter role prompt content..."})}),(d==null?void 0:d.tier1)&&!d.tier1.passed&&l.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:l.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function O$({workspaceId:e,template:t,onArtifactSave:r}){const n=t?`template:${t.template_id}:${t.active_version}:template`:null,{content:s,loading:o,error:i,saving:a,isDirty:c,updateContent:u,lastSaveResult:d}=Sx(e,n,{onSave:p=>{r==null||r(n,p)}});if(!t)return l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-2",children:"No Template Selected"}),l.jsx("div",{className:"text-sm",children:"Select a template from the browser to edit its content."})]})});const f=t.template_id.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());return l.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),l.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Shared Template"]})]})})}),l.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Template"})}),l.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:l.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/templates/",t.template_id,"/releases/",t.active_version,"/template.txt"]})}),l.jsx("div",{className:"flex-1 overflow-hidden",children:l.jsx(Zn,{content:s,onChange:u,loading:o,saving:a,isDirty:c,error:i,placeholder:"Enter template content..."})}),(d==null?void 0:d.tier1)&&!d.tier1.passed&&l.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:l.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function L$(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>n=>{t.forEach(s=>s(n))},t)}const Oc=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function bo(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function jx(e){return"nodeType"in e}function Tt(e){var t,r;return e?bo(e)?e:jx(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function kx(e){const{Document:t}=Tt(e);return e instanceof t}function Ji(e){return bo(e)?!1:e instanceof Tt(e).HTMLElement}function vC(e){return e instanceof Tt(e).SVGElement}function wo(e){return e?bo(e)?e.document:jx(e)?kx(e)?e:Ji(e)||vC(e)?e.ownerDocument:document:document:document}const Mr=Oc?m.useLayoutEffect:m.useEffect;function Nx(e){const t=m.useRef(e);return Mr(()=>{t.current=e}),m.useCallback(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return t.current==null?void 0:t.current(...n)},[])}function z$(){const e=m.useRef(null),t=m.useCallback((n,s)=>{e.current=setInterval(n,s)},[]),r=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function Li(e,t){t===void 0&&(t=[e]);const r=m.useRef(e);return Mr(()=>{r.current!==e&&(r.current=e)},t),r}function ea(e,t){const r=m.useRef();return m.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function $l(e){const t=Nx(e),r=m.useRef(null),n=m.useCallback(s=>{s!==r.current&&(t==null||t(s,r.current)),r.current=s},[]);return[r,n]}function $g(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let jm={};function ta(e,t){return m.useMemo(()=>{if(t)return t;const r=jm[e]==null?0:jm[e]+1;return jm[e]=r,e+"-"+r},[e,t])}function xC(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];return n.reduce((o,i)=>{const a=Object.entries(i);for(const[c,u]of a){const d=o[c];d!=null&&(o[c]=d+e*u)}return o},{...t})}}const Qs=xC(1),zi=xC(-1);function q$(e){return"clientX"in e&&"clientY"in e}function Ex(e){if(!e)return!1;const{KeyboardEvent:t}=Tt(e.target);return t&&e instanceof t}function $$(e){if(!e)return!1;const{TouchEvent:t}=Tt(e.target);return t&&e instanceof t}function Fg(e){if($$(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return q$(e)?{x:e.clientX,y:e.clientY}:null}const co=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[co.Translate.toString(e),co.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),K2="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function F$(e){return e.matches(K2)?e:e.querySelector(K2)}const B$={display:"none"};function H$(e){let{id:t,value:r}=e;return W.createElement("div",{id:t,style:B$},r)}function W$(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return W.createElement("div",{id:t,style:s,role:"status","aria-live":n,"aria-atomic":!0},r)}function V$(){const[e,t]=m.useState("");return{announce:m.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const yC=m.createContext(null);function U$(e){const t=m.useContext(yC);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function G$(){const[e]=m.useState(()=>new Set),t=m.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[m.useCallback(n=>{let{type:s,event:o}=n;e.forEach(i=>{var a;return(a=i[s])==null?void 0:a.call(i,o)})},[e]),t]}const K$={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Y$={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function X$(e){let{announcements:t=Y$,container:r,hiddenTextDescribedById:n,screenReaderInstructions:s=K$}=e;const{announce:o,announcement:i}=V$(),a=ta("DndLiveRegion"),[c,u]=m.useState(!1);if(m.useEffect(()=>{u(!0)},[]),U$(m.useMemo(()=>({onDragStart(f){let{active:p}=f;o(t.onDragStart({active:p}))},onDragMove(f){let{active:p,over:h}=f;t.onDragMove&&o(t.onDragMove({active:p,over:h}))},onDragOver(f){let{active:p,over:h}=f;o(t.onDragOver({active:p,over:h}))},onDragEnd(f){let{active:p,over:h}=f;o(t.onDragEnd({active:p,over:h}))},onDragCancel(f){let{active:p,over:h}=f;o(t.onDragCancel({active:p,over:h}))}}),[o,t])),!c)return null;const d=W.createElement(W.Fragment,null,W.createElement(H$,{id:n,value:s.draggable}),W.createElement(W$,{id:a,announcement:i}));return r?$s.createPortal(d,r):d}var Ke;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Ke||(Ke={}));function Fl(){}function Bl(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function bC(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return m.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const mr=Object.freeze({x:0,y:0});function wC(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function _C(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function Q$(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function Y2(e){let{left:t,top:r,height:n,width:s}=e;return[{x:t,y:r},{x:t+s,y:r},{x:t,y:r+n},{x:t+s,y:r+n}]}function SC(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function X2(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const jC=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=X2(t,t.left,t.top),o=[];for(const i of n){const{id:a}=i,c=r.get(a);if(c){const u=wC(X2(c),s);o.push({id:a,data:{droppableContainer:i,value:u}})}}return o.sort(_C)},Z$=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=Y2(t),o=[];for(const i of n){const{id:a}=i,c=r.get(a);if(c){const u=Y2(c),d=s.reduce((p,h,y)=>p+wC(u[y],h),0),f=Number((d/4).toFixed(4));o.push({id:a,data:{droppableContainer:i,value:f}})}}return o.sort(_C)};function J$(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),i=s-n,a=o-r;if(n<s&&r<o){const c=t.width*t.height,u=e.width*e.height,d=i*a,f=d/(c+u-d);return Number(f.toFixed(4))}return 0}const eF=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const s=[];for(const o of n){const{id:i}=o,a=r.get(i);if(a){const c=J$(a,t);c>0&&s.push({id:i,data:{droppableContainer:o,value:c}})}}return s.sort(Q$)};function tF(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function kC(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:mr}function rF(e){return function(r){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return s.reduce((i,a)=>({...i,top:i.top+e*a.y,bottom:i.bottom+e*a.y,left:i.left+e*a.x,right:i.right+e*a.x}),{...r})}}const nF=rF(1);function sF(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function oF(e,t,r){const n=sF(t);if(!n)return e;const{scaleX:s,scaleY:o,x:i,y:a}=n,c=e.left-i-(1-s)*parseFloat(r),u=e.top-a-(1-o)*parseFloat(r.slice(r.indexOf(" ")+1)),d=s?e.width/s:e.width,f=o?e.height/o:e.height;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c}}const iF={ignoreTransform:!1};function _o(e,t){t===void 0&&(t=iF);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=Tt(e).getComputedStyle(e);u&&(r=oF(r,u,d))}const{top:n,left:s,width:o,height:i,bottom:a,right:c}=r;return{top:n,left:s,width:o,height:i,bottom:a,right:c}}function Q2(e){return _o(e,{ignoreTransform:!0})}function aF(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function lF(e,t){return t===void 0&&(t=Tt(e).getComputedStyle(e)),t.position==="fixed"}function cF(e,t){t===void 0&&(t=Tt(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const o=t[s];return typeof o=="string"?r.test(o):!1})}function Lc(e,t){const r=[];function n(s){if(t!=null&&r.length>=t||!s)return r;if(kx(s)&&s.scrollingElement!=null&&!r.includes(s.scrollingElement))return r.push(s.scrollingElement),r;if(!Ji(s)||vC(s)||r.includes(s))return r;const o=Tt(e).getComputedStyle(s);return s!==e&&cF(s,o)&&r.push(s),lF(s,o)?r:n(s.parentNode)}return e?n(e):r}function NC(e){const[t]=Lc(e,1);return t??null}function km(e){return!Oc||!e?null:bo(e)?e:jx(e)?kx(e)||e===wo(e).scrollingElement?window:Ji(e)?e:null:null}function EC(e){return bo(e)?e.scrollX:e.scrollLeft}function CC(e){return bo(e)?e.scrollY:e.scrollTop}function Bg(e){return{x:EC(e),y:CC(e)}}var Je;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Je||(Je={}));function RC(e){return!Oc||!e?!1:e===document.scrollingElement}function TC(e){const t={x:0,y:0},r=RC(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},s=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,i=e.scrollTop>=n.y,a=e.scrollLeft>=n.x;return{isTop:s,isLeft:o,isBottom:i,isRight:a,maxScroll:n,minScroll:t}}const uF={x:.2,y:.2};function dF(e,t,r,n,s){let{top:o,left:i,right:a,bottom:c}=r;n===void 0&&(n=10),s===void 0&&(s=uF);const{isTop:u,isBottom:d,isLeft:f,isRight:p}=TC(e),h={x:0,y:0},y={x:0,y:0},v={height:t.height*s.y,width:t.width*s.x};return!u&&o<=t.top+v.height?(h.y=Je.Backward,y.y=n*Math.abs((t.top+v.height-o)/v.height)):!d&&c>=t.bottom-v.height&&(h.y=Je.Forward,y.y=n*Math.abs((t.bottom-v.height-c)/v.height)),!p&&a>=t.right-v.width?(h.x=Je.Forward,y.x=n*Math.abs((t.right-v.width-a)/v.width)):!f&&i<=t.left+v.width&&(h.x=Je.Backward,y.x=n*Math.abs((t.left+v.width-i)/v.width)),{direction:h,speed:y}}function fF(e){if(e===document.scrollingElement){const{innerWidth:o,innerHeight:i}=window;return{top:0,left:0,right:o,bottom:i,width:o,height:i}}const{top:t,left:r,right:n,bottom:s}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:s,width:e.clientWidth,height:e.clientHeight}}function IC(e){return e.reduce((t,r)=>Qs(t,Bg(r)),mr)}function pF(e){return e.reduce((t,r)=>t+EC(r),0)}function hF(e){return e.reduce((t,r)=>t+CC(r),0)}function mF(e,t){if(t===void 0&&(t=_o),!e)return;const{top:r,left:n,bottom:s,right:o}=t(e);NC(e)&&(s<=0||o<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const gF=[["x",["left","right"],pF],["y",["top","bottom"],hF]];class Cx{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=Lc(r),s=IC(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[o,i,a]of gF)for(const c of i)Object.defineProperty(this,c,{get:()=>{const u=a(n),d=s[o]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ci{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var s;(s=this.target)==null||s.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function vF(e){const{EventTarget:t}=Tt(e);return e instanceof t?e:wo(e)}function Nm(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var Vt;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Vt||(Vt={}));function Z2(e){e.preventDefault()}function xF(e){e.stopPropagation()}var he;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(he||(he={}));const MC={start:[he.Space,he.Enter],cancel:[he.Esc],end:[he.Space,he.Enter,he.Tab]},yF=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case he.Right:return{...r,x:r.x+25};case he.Left:return{...r,x:r.x-25};case he.Down:return{...r,y:r.y+25};case he.Up:return{...r,y:r.y-25}}};class zc{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new ci(wo(r)),this.windowListeners=new ci(Tt(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Vt.Resize,this.handleCancel),this.windowListeners.add(Vt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Vt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&mF(n),r(mr)}handleKeyDown(t){if(Ex(t)){const{active:r,context:n,options:s}=this.props,{keyboardCodes:o=MC,coordinateGetter:i=yF,scrollBehavior:a="smooth"}=s,{code:c}=t;if(o.end.includes(c)){this.handleEnd(t);return}if(o.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:u}=n.current,d=u?{x:u.left,y:u.top}:mr;this.referenceCoordinates||(this.referenceCoordinates=d);const f=i(t,{active:r,context:n.current,currentCoordinates:d});if(f){const p=zi(f,d),h={x:0,y:0},{scrollableAncestors:y}=n.current;for(const v of y){const w=t.code,{isTop:g,isRight:x,isLeft:b,isBottom:_,maxScroll:S,minScroll:k}=TC(v),N=fF(v),j={x:Math.min(w===he.Right?N.right-N.width/2:N.right,Math.max(w===he.Right?N.left:N.left+N.width/2,f.x)),y:Math.min(w===he.Down?N.bottom-N.height/2:N.bottom,Math.max(w===he.Down?N.top:N.top+N.height/2,f.y))},C=w===he.Right&&!x||w===he.Left&&!b,R=w===he.Down&&!_||w===he.Up&&!g;if(C&&j.x!==f.x){const T=v.scrollLeft+p.x,L=w===he.Right&&T<=S.x||w===he.Left&&T>=k.x;if(L&&!p.y){v.scrollTo({left:T,behavior:a});return}L?h.x=v.scrollLeft-T:h.x=w===he.Right?v.scrollLeft-S.x:v.scrollLeft-k.x,h.x&&v.scrollBy({left:-h.x,behavior:a});break}else if(R&&j.y!==f.y){const T=v.scrollTop+p.y,L=w===he.Down&&T<=S.y||w===he.Up&&T>=k.y;if(L&&!p.x){v.scrollTo({top:T,behavior:a});return}L?h.y=v.scrollTop-T:h.y=w===he.Down?v.scrollTop-S.y:v.scrollTop-k.y,h.y&&v.scrollBy({top:-h.y,behavior:a});break}}this.handleMove(t,Qs(zi(f,this.referenceCoordinates),h))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}zc.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=MC,onActivation:s}=t,{active:o}=r;const{code:i}=e.nativeEvent;if(n.start.includes(i)){const a=o.activatorNode.current;return a&&e.target!==a?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function J2(e){return!!(e&&"distance"in e)}function eS(e){return!!(e&&"delay"in e)}class Rx{constructor(t,r,n){var s;n===void 0&&(n=vF(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:o}=t,{target:i}=o;this.props=t,this.events=r,this.document=wo(i),this.documentListeners=new ci(this.document),this.listeners=new ci(n),this.windowListeners=new ci(Tt(i)),this.initialCoordinates=(s=Fg(o))!=null?s:mr,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Vt.Resize,this.handleCancel),this.windowListeners.add(Vt.DragStart,Z2),this.windowListeners.add(Vt.VisibilityChange,this.handleCancel),this.windowListeners.add(Vt.ContextMenu,Z2),this.documentListeners.add(Vt.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(eS(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(J2(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:s}=this.props;s(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(Vt.Click,xF,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Vt.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:s,props:o}=this,{onMove:i,options:{activationConstraint:a}}=o;if(!s)return;const c=(r=Fg(t))!=null?r:mr,u=zi(s,c);if(!n&&a){if(J2(a)){if(a.tolerance!=null&&Nm(u,a.tolerance))return this.handleCancel();if(Nm(u,a.distance))return this.handleStart()}if(eS(a)&&Nm(u,a.tolerance))return this.handleCancel();this.handlePending(a,u);return}t.cancelable&&t.preventDefault(),i(c)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===he.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const bF={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class qc extends Rx{constructor(t){const{event:r}=t,n=wo(r.target);super(t,bF,n)}}qc.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];const wF={move:{name:"mousemove"},end:{name:"mouseup"}};var Hg;(function(e){e[e.RightClick=2]="RightClick"})(Hg||(Hg={}));class _F extends Rx{constructor(t){super(t,wF,wo(t.event.target))}}_F.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===Hg.RightClick?!1:(n==null||n({event:r}),!0)}}];const Em={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class SF extends Rx{constructor(t){super(t,Em)}static setup(){return window.addEventListener(Em.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Em.move.name,t)};function t(){}}}SF.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:s}=r;return s.length>1?!1:(n==null||n({event:r}),!0)}}];var ui;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(ui||(ui={}));var Hl;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Hl||(Hl={}));function jF(e){let{acceleration:t,activator:r=ui.Pointer,canScroll:n,draggingRect:s,enabled:o,interval:i=5,order:a=Hl.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:f,threshold:p}=e;const h=NF({delta:f,disabled:!o}),[y,v]=z$(),w=m.useRef({x:0,y:0}),g=m.useRef({x:0,y:0}),x=m.useMemo(()=>{switch(r){case ui.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case ui.DraggableRect:return s}},[r,s,c]),b=m.useRef(null),_=m.useCallback(()=>{const k=b.current;if(!k)return;const N=w.current.x*g.current.x,j=w.current.y*g.current.y;k.scrollBy(N,j)},[]),S=m.useMemo(()=>a===Hl.TreeOrder?[...u].reverse():u,[a,u]);m.useEffect(()=>{if(!o||!u.length||!x){v();return}for(const k of S){if((n==null?void 0:n(k))===!1)continue;const N=u.indexOf(k),j=d[N];if(!j)continue;const{direction:C,speed:R}=dF(k,j,x,t,p);for(const T of["x","y"])h[T][C[T]]||(R[T]=0,C[T]=0);if(R.x>0||R.y>0){v(),b.current=k,y(_,i),w.current=R,g.current=C;return}}w.current={x:0,y:0},g.current={x:0,y:0},v()},[t,_,n,v,o,i,JSON.stringify(x),JSON.stringify(h),y,u,S,d,JSON.stringify(p)])}const kF={x:{[Je.Backward]:!1,[Je.Forward]:!1},y:{[Je.Backward]:!1,[Je.Forward]:!1}};function NF(e){let{delta:t,disabled:r}=e;const n=$g(t);return ea(s=>{if(r||!n||!s)return kF;const o={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[Je.Backward]:s.x[Je.Backward]||o.x===-1,[Je.Forward]:s.x[Je.Forward]||o.x===1},y:{[Je.Backward]:s.y[Je.Backward]||o.y===-1,[Je.Forward]:s.y[Je.Forward]||o.y===1}}},[r,t,n])}function EF(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return ea(s=>{var o;return t==null?null:(o=n??s)!=null?o:null},[n,t])}function CF(e,t){return m.useMemo(()=>e.reduce((r,n)=>{const{sensor:s}=n,o=s.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,n)}));return[...r,...o]},[]),[e,t])}var qi;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(qi||(qi={}));var Wg;(function(e){e.Optimized="optimized"})(Wg||(Wg={}));const tS=new Map;function RF(e,t){let{dragging:r,dependencies:n,config:s}=t;const[o,i]=m.useState(null),{frequency:a,measure:c,strategy:u}=s,d=m.useRef(e),f=w(),p=Li(f),h=m.useCallback(function(g){g===void 0&&(g=[]),!p.current&&i(x=>x===null?g:x.concat(g.filter(b=>!x.includes(b))))},[p]),y=m.useRef(null),v=ea(g=>{if(f&&!r)return tS;if(!g||g===tS||d.current!==e||o!=null){const x=new Map;for(let b of e){if(!b)continue;if(o&&o.length>0&&!o.includes(b.id)&&b.rect.current){x.set(b.id,b.rect.current);continue}const _=b.node.current,S=_?new Cx(c(_),_):null;b.rect.current=S,S&&x.set(b.id,S)}return x}return g},[e,o,r,f,c]);return m.useEffect(()=>{d.current=e},[e]),m.useEffect(()=>{f||h()},[r,f]),m.useEffect(()=>{o&&o.length>0&&i(null)},[JSON.stringify(o)]),m.useEffect(()=>{f||typeof a!="number"||y.current!==null||(y.current=setTimeout(()=>{h(),y.current=null},a))},[a,f,h,...n]),{droppableRects:v,measureDroppableContainers:h,measuringScheduled:o!=null};function w(){switch(u){case qi.Always:return!1;case qi.BeforeDragging:return r;default:return!r}}}function AC(e,t){return ea(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function TF(e,t){return AC(e,t)}function IF(e){let{callback:t,disabled:r}=e;const n=Nx(t),s=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(n)},[n,r]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function $c(e){let{callback:t,disabled:r}=e;const n=Nx(t),s=m.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(n)},[r]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function MF(e){return new Cx(_o(e),e)}function rS(e,t,r){t===void 0&&(t=MF);const[n,s]=m.useState(null);function o(){s(c=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=c??r)!=null?u:null}const d=t(e);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const i=IF({callback(c){if(e)for(const u of c){const{type:d,target:f}=u;if(d==="childList"&&f instanceof HTMLElement&&f.contains(e)){o();break}}}}),a=$c({callback:o});return Mr(()=>{o(),e?(a==null||a.observe(e),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),i==null||i.disconnect())},[e]),n}function AF(e){const t=AC(e);return kC(e,t)}const nS=[];function PF(e){const t=m.useRef(e),r=ea(n=>e?n&&n!==nS&&e&&t.current&&e.parentNode===t.current.parentNode?n:Lc(e):nS,[e]);return m.useEffect(()=>{t.current=e},[e]),r}function DF(e){const[t,r]=m.useState(null),n=m.useRef(e),s=m.useCallback(o=>{const i=km(o.target);i&&r(a=>a?(a.set(i,Bg(i)),new Map(a)):null)},[]);return m.useEffect(()=>{const o=n.current;if(e!==o){i(o);const a=e.map(c=>{const u=km(c);return u?(u.addEventListener("scroll",s,{passive:!0}),[u,Bg(u)]):null}).filter(c=>c!=null);r(a.length?new Map(a):null),n.current=e}return()=>{i(e),i(o)};function i(a){a.forEach(c=>{const u=km(c);u==null||u.removeEventListener("scroll",s)})}},[s,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((o,i)=>Qs(o,i),mr):IC(e):mr,[e,t])}function sS(e,t){t===void 0&&(t=[]);const r=m.useRef(null);return m.useEffect(()=>{r.current=null},t),m.useEffect(()=>{const n=e!==mr;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?zi(e,r.current):mr}function OF(e){m.useEffect(()=>{if(!Oc)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function LF(e,t){return m.useMemo(()=>e.reduce((r,n)=>{let{eventName:s,handler:o}=n;return r[s]=i=>{o(i,t)},r},{}),[e,t])}function PC(e){return m.useMemo(()=>e?aF(e):null,[e])}const oS=[];function zF(e,t){t===void 0&&(t=_o);const[r]=e,n=PC(r?Tt(r):null),[s,o]=m.useState(oS);function i(){o(()=>e.length?e.map(c=>RC(c)?n:new Cx(t(c),c)):oS)}const a=$c({callback:i});return Mr(()=>{a==null||a.disconnect(),i(),e.forEach(c=>a==null?void 0:a.observe(c))},[e]),s}function qF(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ji(t)?t:e}function $F(e){let{measure:t}=e;const[r,n]=m.useState(null),s=m.useCallback(u=>{for(const{target:d}of u)if(Ji(d)){n(f=>{const p=t(d);return f?{...f,width:p.width,height:p.height}:p});break}},[t]),o=$c({callback:s}),i=m.useCallback(u=>{const d=qF(u);o==null||o.disconnect(),d&&(o==null||o.observe(d)),n(d?t(d):null)},[t,o]),[a,c]=$l(i);return m.useMemo(()=>({nodeRef:a,rect:r,setRef:c}),[r,a,c])}const FF=[{sensor:qc,options:{}},{sensor:zc,options:{}}],BF={current:{}},el={draggable:{measure:Q2},droppable:{measure:Q2,strategy:qi.WhileDragging,frequency:Wg.Optimized},dragOverlay:{measure:_o}};class di extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const HF={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new di,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Fl},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:el,measureDroppableContainers:Fl,windowRect:null,measuringScheduled:!1},WF={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Fl,draggableNodes:new Map,over:null,measureDroppableContainers:Fl},Fc=m.createContext(WF),DC=m.createContext(HF);function VF(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new di}}}function UF(e,t){switch(t.type){case Ke.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Ke.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Ke.DragEnd:case Ke.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ke.RegisterDroppable:{const{element:r}=t,{id:n}=r,s=new di(e.droppable.containers);return s.set(n,r),{...e,droppable:{...e.droppable,containers:s}}}case Ke.SetDroppableDisabled:{const{id:r,key:n,disabled:s}=t,o=e.droppable.containers.get(r);if(!o||n!==o.key)return e;const i=new di(e.droppable.containers);return i.set(r,{...o,disabled:s}),{...e,droppable:{...e.droppable,containers:i}}}case Ke.UnregisterDroppable:{const{id:r,key:n}=t,s=e.droppable.containers.get(r);if(!s||n!==s.key)return e;const o=new di(e.droppable.containers);return o.delete(r),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function GF(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:s}=m.useContext(Fc),o=$g(n),i=$g(r==null?void 0:r.id);return m.useEffect(()=>{if(!t&&!n&&o&&i!=null){if(!Ex(o)||document.activeElement===o.target)return;const a=s.get(i);if(!a)return;const{activatorNode:c,node:u}=a;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const f=F$(d);if(f){f.focus();break}}})}},[n,t,s,i,o]),null}function KF(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((s,o)=>o({transform:s,...n}),r):r}function YF(e){return m.useMemo(()=>({draggable:{...el.draggable,...e==null?void 0:e.draggable},droppable:{...el.droppable,...e==null?void 0:e.droppable},dragOverlay:{...el.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function XF(e){let{activeNode:t,measure:r,initialRect:n,config:s=!0}=e;const o=m.useRef(!1),{x:i,y:a}=typeof s=="boolean"?{x:s,y:s}:s;Mr(()=>{if(!i&&!a||!t){o.current=!1;return}if(o.current||!n)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const d=r(u),f=kC(d,n);if(i||(f.x=0),a||(f.y=0),o.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const p=NC(u);p&&p.scrollBy({top:f.y,left:f.x})}},[t,i,a,n,r])}const OC=m.createContext({...mr,scaleX:1,scaleY:1});var gn;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(gn||(gn={}));const LC=m.memo(function(t){var r,n,s,o;let{id:i,accessibility:a,autoScroll:c=!0,children:u,sensors:d=FF,collisionDetection:f=eF,measuring:p,modifiers:h,...y}=t;const v=m.useReducer(UF,void 0,VF),[w,g]=v,[x,b]=G$(),[_,S]=m.useState(gn.Uninitialized),k=_===gn.Initialized,{draggable:{active:N,nodes:j,translate:C},droppable:{containers:R}}=w,T=N!=null?j.get(N):null,L=m.useRef({initial:null,translated:null}),$=m.useMemo(()=>{var Ve;return N!=null?{id:N,data:(Ve=T==null?void 0:T.data)!=null?Ve:BF,rect:L}:null},[N,T]),E=m.useRef(null),[P,D]=m.useState(null),[F,A]=m.useState(null),I=Li(y,Object.values(y)),z=ta("DndDescribedBy",i),M=m.useMemo(()=>R.getEnabled(),[R]),q=YF(p),{droppableRects:H,measureDroppableContainers:O,measuringScheduled:B}=RF(M,{dragging:k,dependencies:[C.x,C.y],config:q.droppable}),Y=EF(j,N),te=m.useMemo(()=>F?Fg(F):null,[F]),ne=jo(),re=TF(Y,q.draggable.measure);XF({activeNode:N!=null?j.get(N):null,config:ne.layoutShiftCompensation,initialRect:re,measure:q.draggable.measure});const Q=rS(Y,q.draggable.measure,re),ce=rS(Y?Y.parentElement:null),ie=m.useRef({activatorEvent:null,active:null,activeNode:Y,collisionRect:null,collisions:null,droppableRects:H,draggableNodes:j,draggingNode:null,draggingNodeRect:null,droppableContainers:R,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),xe=R.getNodeFor((r=ie.current.over)==null?void 0:r.id),ee=$F({measure:q.dragOverlay.measure}),X=(n=ee.nodeRef.current)!=null?n:Y,fe=k?(s=ee.rect)!=null?s:Q:null,V=!!(ee.nodeRef.current&&ee.rect),K=AF(V?null:Q),oe=PC(X?Tt(X):null),U=PF(k?xe??Y:null),we=zF(U),_e=KF(h,{transform:{x:C.x-K.x,y:C.y-K.y,scaleX:1,scaleY:1},activatorEvent:F,active:$,activeNodeRect:Q,containerNodeRect:ce,draggingNodeRect:fe,over:ie.current.over,overlayNodeRect:ee.rect,scrollableAncestors:U,scrollableAncestorRects:we,windowRect:oe}),ue=te?Qs(te,C):null,Se=DF(U),lt=sS(Se),We=sS(Se,[Q]),rt=Qs(_e,lt),Fe=fe?nF(fe,_e):null,ht=$&&Fe?f({active:$,collisionRect:Fe,droppableRects:H,droppableContainers:M,pointerCoordinates:ue}):null,rr=SC(ht,"id"),[je,nt]=m.useState(null),Xe=V?_e:Qs(_e,We),st=tF(Xe,(o=je==null?void 0:je.rect)!=null?o:null,Q),nr=m.useRef(null),$t=m.useCallback((Ve,qe)=>{let{sensor:mt,options:yr}=qe;if(E.current==null)return;const wt=j.get(E.current);if(!wt)return;const gt=Ve.nativeEvent,Bt=new mt({active:E.current,activeNode:wt,event:gt,options:yr,context:ie,onAbort(Ue){if(!j.get(Ue))return;const{onDragAbort:Ht}=I.current,sr={id:Ue};Ht==null||Ht(sr),x({type:"onDragAbort",event:sr})},onPending(Ue,br,Ht,sr){if(!j.get(Ue))return;const{onDragPending:Wn}=I.current,wr={id:Ue,constraint:br,initialCoordinates:Ht,offset:sr};Wn==null||Wn(wr),x({type:"onDragPending",event:wr})},onStart(Ue){const br=E.current;if(br==null)return;const Ht=j.get(br);if(!Ht)return;const{onDragStart:sr}=I.current,Hn={activatorEvent:gt,active:{id:br,data:Ht.data,rect:L}};$s.unstable_batchedUpdates(()=>{sr==null||sr(Hn),S(gn.Initializing),g({type:Ke.DragStart,initialCoordinates:Ue,active:br}),x({type:"onDragStart",event:Hn}),D(nr.current),A(gt)})},onMove(Ue){g({type:Ke.DragMove,coordinates:Ue})},onEnd:on(Ke.DragEnd),onCancel:on(Ke.DragCancel)});nr.current=Bt;function on(Ue){return async function(){const{active:Ht,collisions:sr,over:Hn,scrollAdjustedTranslate:Wn}=ie.current;let wr=null;if(Ht&&Wn){const{cancelDrop:Vn}=I.current;wr={activatorEvent:gt,active:Ht,collisions:sr,delta:Wn,over:Hn},Ue===Ke.DragEnd&&typeof Vn=="function"&&await Promise.resolve(Vn(wr))&&(Ue=Ke.DragCancel)}E.current=null,$s.unstable_batchedUpdates(()=>{g({type:Ue}),S(gn.Uninitialized),nt(null),D(null),A(null),nr.current=null;const Vn=Ue===Ke.DragEnd?"onDragEnd":"onDragCancel";if(wr){const ko=I.current[Vn];ko==null||ko(wr),x({type:Vn,event:wr})}})}}},[j]),Ft=m.useCallback((Ve,qe)=>(mt,yr)=>{const wt=mt.nativeEvent,gt=j.get(yr);if(E.current!==null||!gt||wt.dndKit||wt.defaultPrevented)return;const Bt={active:gt};Ve(mt,qe.options,Bt)===!0&&(wt.dndKit={capturedBy:qe.sensor},E.current=yr,$t(mt,qe))},[j,$t]),sn=CF(d,Ft);OF(d),Mr(()=>{Q&&_===gn.Initializing&&S(gn.Initialized)},[Q,_]),m.useEffect(()=>{const{onDragMove:Ve}=I.current,{active:qe,activatorEvent:mt,collisions:yr,over:wt}=ie.current;if(!qe||!mt)return;const gt={active:qe,activatorEvent:mt,collisions:yr,delta:{x:rt.x,y:rt.y},over:wt};$s.unstable_batchedUpdates(()=>{Ve==null||Ve(gt),x({type:"onDragMove",event:gt})})},[rt.x,rt.y]),m.useEffect(()=>{const{active:Ve,activatorEvent:qe,collisions:mt,droppableContainers:yr,scrollAdjustedTranslate:wt}=ie.current;if(!Ve||E.current==null||!qe||!wt)return;const{onDragOver:gt}=I.current,Bt=yr.get(rr),on=Bt&&Bt.rect.current?{id:Bt.id,rect:Bt.rect.current,data:Bt.data,disabled:Bt.disabled}:null,Ue={active:Ve,activatorEvent:qe,collisions:mt,delta:{x:wt.x,y:wt.y},over:on};$s.unstable_batchedUpdates(()=>{nt(on),gt==null||gt(Ue),x({type:"onDragOver",event:Ue})})},[rr]),Mr(()=>{ie.current={activatorEvent:F,active:$,activeNode:Y,collisionRect:Fe,collisions:ht,droppableRects:H,draggableNodes:j,draggingNode:X,draggingNodeRect:fe,droppableContainers:R,over:je,scrollableAncestors:U,scrollAdjustedTranslate:rt},L.current={initial:fe,translated:Fe}},[$,Y,ht,Fe,j,X,fe,H,R,je,U,rt]),jF({...ne,delta:C,draggingRect:Fe,pointerCoordinates:ue,scrollableAncestors:U,scrollableAncestorRects:we});const So=m.useMemo(()=>({active:$,activeNode:Y,activeNodeRect:Q,activatorEvent:F,collisions:ht,containerNodeRect:ce,dragOverlay:ee,draggableNodes:j,droppableContainers:R,droppableRects:H,over:je,measureDroppableContainers:O,scrollableAncestors:U,scrollableAncestorRects:we,measuringConfiguration:q,measuringScheduled:B,windowRect:oe}),[$,Y,Q,F,ht,ce,ee,j,R,H,je,O,U,we,q,B,oe]),Bn=m.useMemo(()=>({activatorEvent:F,activators:sn,active:$,activeNodeRect:Q,ariaDescribedById:{draggable:z},dispatch:g,draggableNodes:j,over:je,measureDroppableContainers:O}),[F,sn,$,Q,g,z,j,je,O]);return W.createElement(yC.Provider,{value:b},W.createElement(Fc.Provider,{value:Bn},W.createElement(DC.Provider,{value:So},W.createElement(OC.Provider,{value:st},u)),W.createElement(GF,{disabled:(a==null?void 0:a.restoreFocus)===!1})),W.createElement(X$,{...a,hiddenTextDescribedById:z}));function jo(){const Ve=(P==null?void 0:P.autoScrollEnabled)===!1,qe=typeof c=="object"?c.enabled===!1:c===!1,mt=k&&!Ve&&!qe;return typeof c=="object"?{...c,enabled:mt}:{enabled:mt}}}),QF=m.createContext(null),iS="button",ZF="Draggable";function JF(e){let{id:t,data:r,disabled:n=!1,attributes:s}=e;const o=ta(ZF),{activators:i,activatorEvent:a,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:f,over:p}=m.useContext(Fc),{role:h=iS,roleDescription:y="draggable",tabIndex:v=0}=s??{},w=(c==null?void 0:c.id)===t,g=m.useContext(w?OC:QF),[x,b]=$l(),[_,S]=$l(),k=LF(i,t),N=Li(r);Mr(()=>(f.set(t,{id:t,key:o,node:x,activatorNode:_,data:N}),()=>{const C=f.get(t);C&&C.key===o&&f.delete(t)}),[f,t]);const j=m.useMemo(()=>({role:h,tabIndex:v,"aria-disabled":n,"aria-pressed":w&&h===iS?!0:void 0,"aria-roledescription":y,"aria-describedby":d.draggable}),[n,h,v,w,y,d.draggable]);return{active:c,activatorEvent:a,activeNodeRect:u,attributes:j,isDragging:w,listeners:n?void 0:k,node:x,over:p,setNodeRef:b,setActivatorNodeRef:S,transform:g}}function eB(){return m.useContext(DC)}const tB="Droppable",rB={timeout:25};function nB(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:s}=e;const o=ta(tB),{active:i,dispatch:a,over:c,measureDroppableContainers:u}=m.useContext(Fc),d=m.useRef({disabled:r}),f=m.useRef(!1),p=m.useRef(null),h=m.useRef(null),{disabled:y,updateMeasurementsFor:v,timeout:w}={...rB,...s},g=Li(v??n),x=m.useCallback(()=>{if(!f.current){f.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{u(Array.isArray(g.current)?g.current:[g.current]),h.current=null},w)},[w]),b=$c({callback:x,disabled:y||!i}),_=m.useCallback((j,C)=>{b&&(C&&(b.unobserve(C),f.current=!1),j&&b.observe(j))},[b]),[S,k]=$l(_),N=Li(t);return m.useEffect(()=>{!b||!S.current||(b.disconnect(),f.current=!1,b.observe(S.current))},[S,b]),m.useEffect(()=>(a({type:Ke.RegisterDroppable,element:{id:n,key:o,disabled:r,node:S,rect:p,data:N}}),()=>a({type:Ke.UnregisterDroppable,key:o,id:n})),[n]),m.useEffect(()=>{r!==d.current.disabled&&(a({type:Ke.SetDroppableDisabled,id:n,key:o,disabled:r}),d.current.disabled=r)},[n,o,r,a]),{active:i,rect:p,isOver:(c==null?void 0:c.id)===n,node:S,over:c,setNodeRef:k}}function Bc(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function sB(e,t){return e.reduce((r,n,s)=>{const o=t.get(n);return o&&(r[s]=o),r},Array(e.length))}function Oa(e){return e!==null&&e>=0}function oB(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function iB(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const zC=e=>{let{rects:t,activeIndex:r,overIndex:n,index:s}=e;const o=Bc(t,n,r),i=t[s],a=o[s];return!a||!i?null:{x:a.left-i.left,y:a.top-i.top,scaleX:a.width/i.width,scaleY:a.height/i.height}},La={scaleX:1,scaleY:1},qC=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:s,rects:o,overIndex:i}=e;const a=(t=o[r])!=null?t:n;if(!a)return null;if(s===r){const u=o[i];return u?{x:0,y:r<i?u.top+u.height-(a.top+a.height):u.top-a.top,...La}:null}const c=aB(o,s,r);return s>r&&s<=i?{x:0,y:-a.height-c,...La}:s<r&&s>=i?{x:0,y:a.height+c,...La}:{x:0,y:0,...La}};function aB(e,t,r){const n=e[t],s=e[t-1],o=e[t+1];return n?r<t?s?n.top-(s.top+s.height):o?o.top-(n.top+n.height):0:o?o.top-(n.top+n.height):s?n.top-(s.top+s.height):0:0}const $C="Sortable",FC=W.createContext({activeIndex:-1,containerId:$C,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:zC,disabled:{draggable:!1,droppable:!1}});function BC(e){let{children:t,id:r,items:n,strategy:s=zC,disabled:o=!1}=e;const{active:i,dragOverlay:a,droppableRects:c,over:u,measureDroppableContainers:d}=eB(),f=ta($C,r),p=a.rect!==null,h=m.useMemo(()=>n.map(k=>typeof k=="object"&&"id"in k?k.id:k),[n]),y=i!=null,v=i?h.indexOf(i.id):-1,w=u?h.indexOf(u.id):-1,g=m.useRef(h),x=!oB(h,g.current),b=w!==-1&&v===-1||x,_=iB(o);Mr(()=>{x&&y&&d(h)},[x,h,y,d]),m.useEffect(()=>{g.current=h},[h]);const S=m.useMemo(()=>({activeIndex:v,containerId:f,disabled:_,disableTransforms:b,items:h,overIndex:w,useDragOverlay:p,sortedRects:sB(h,c),strategy:s}),[v,f,_.draggable,_.droppable,b,h,w,c,p,s]);return W.createElement(FC.Provider,{value:S},t)}const lB=e=>{let{id:t,items:r,activeIndex:n,overIndex:s}=e;return Bc(r,n,s).indexOf(t)},cB=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:s,items:o,newIndex:i,previousItems:a,previousContainerId:c,transition:u}=e;return!u||!n||a!==o&&s===i?!1:r?!0:i!==s&&t===c},uB={duration:200,easing:"ease"},HC="transform",dB=co.Transition.toString({property:HC,duration:0,easing:"linear"}),fB={roleDescription:"sortable"};function pB(e){let{disabled:t,index:r,node:n,rect:s}=e;const[o,i]=m.useState(null),a=m.useRef(r);return Mr(()=>{if(!t&&r!==a.current&&n.current){const c=s.current;if(c){const u=_o(n.current,{ignoreTransform:!0}),d={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(d.x||d.y)&&i(d)}}r!==a.current&&(a.current=r)},[t,r,n,s]),m.useEffect(()=>{o&&i(null)},[o]),o}function WC(e){let{animateLayoutChanges:t=cB,attributes:r,disabled:n,data:s,getNewIndex:o=lB,id:i,strategy:a,resizeObserverConfig:c,transition:u=uB}=e;const{items:d,containerId:f,activeIndex:p,disabled:h,disableTransforms:y,sortedRects:v,overIndex:w,useDragOverlay:g,strategy:x}=m.useContext(FC),b=hB(n,h),_=d.indexOf(i),S=m.useMemo(()=>({sortable:{containerId:f,index:_,items:d},...s}),[f,s,_,d]),k=m.useMemo(()=>d.slice(d.indexOf(i)),[d,i]),{rect:N,node:j,isOver:C,setNodeRef:R}=nB({id:i,data:S,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:k,...c}}),{active:T,activatorEvent:L,activeNodeRect:$,attributes:E,setNodeRef:P,listeners:D,isDragging:F,over:A,setActivatorNodeRef:I,transform:z}=JF({id:i,data:S,attributes:{...fB,...r},disabled:b.draggable}),M=L$(R,P),q=!!T,H=q&&!y&&Oa(p)&&Oa(w),O=!g&&F,B=O&&H?z:null,te=H?B??(a??x)({rects:v,activeNodeRect:$,activeIndex:p,overIndex:w,index:_}):null,ne=Oa(p)&&Oa(w)?o({id:i,items:d,activeIndex:p,overIndex:w}):_,re=T==null?void 0:T.id,Q=m.useRef({activeId:re,items:d,newIndex:ne,containerId:f}),ce=d!==Q.current.items,ie=t({active:T,containerId:f,isDragging:F,isSorting:q,id:i,index:_,items:d,newIndex:Q.current.newIndex,previousItems:Q.current.items,previousContainerId:Q.current.containerId,transition:u,wasDragging:Q.current.activeId!=null}),xe=pB({disabled:!ie,index:_,node:j,rect:N});return m.useEffect(()=>{q&&Q.current.newIndex!==ne&&(Q.current.newIndex=ne),f!==Q.current.containerId&&(Q.current.containerId=f),d!==Q.current.items&&(Q.current.items=d)},[q,ne,f,d]),m.useEffect(()=>{if(re===Q.current.activeId)return;if(re!=null&&Q.current.activeId==null){Q.current.activeId=re;return}const X=setTimeout(()=>{Q.current.activeId=re},50);return()=>clearTimeout(X)},[re]),{active:T,activeIndex:p,attributes:E,data:S,rect:N,index:_,newIndex:ne,items:d,isOver:C,isSorting:q,isDragging:F,listeners:D,node:j,overIndex:w,over:A,setNodeRef:M,setActivatorNodeRef:I,setDroppableNodeRef:R,setDraggableNodeRef:P,transform:xe??te,transition:ee()};function ee(){if(xe||ce&&Q.current.newIndex===_)return dB;if(!(O&&!Ex(L)||!u)&&(q||ie))return co.Transition.toString({...u,property:HC})}}function hB(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}function Wl(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const mB=[he.Down,he.Right,he.Up,he.Left],VC=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:s,droppableContainers:o,over:i,scrollableAncestors:a}}=t;if(mB.includes(e.code)){if(e.preventDefault(),!r||!n)return;const c=[];o.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const p=s.get(f.id);if(p)switch(e.code){case he.Down:n.top<p.top&&c.push(f);break;case he.Up:n.top>p.top&&c.push(f);break;case he.Left:n.left>p.left&&c.push(f);break;case he.Right:n.left<p.left&&c.push(f);break}});const u=Z$({collisionRect:n,droppableRects:s,droppableContainers:c});let d=SC(u,"id");if(d===(i==null?void 0:i.id)&&u.length>1&&(d=u[1].id),d!=null){const f=o.get(r.id),p=o.get(d),h=p?s.get(p.id):null,y=p==null?void 0:p.node.current;if(y&&h&&f&&p){const w=Lc(y).some((k,N)=>a[N]!==k),g=UC(f,p),x=gB(f,p),b=w||!g?{x:0,y:0}:{x:x?n.width-h.width:0,y:x?n.height-h.height:0},_={x:h.left,y:h.top};return b.x&&b.y?_:zi(_,b)}}}};function UC(e,t){return!Wl(e)||!Wl(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function gB(e,t){return!Wl(e)||!Wl(t)||!UC(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const vB={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"},jr={width:"100%",padding:"5px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"},Wt={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},GC={step_id:"new_step",produces:"",scope:"",inputs:[]},xB={step_id:"new_iteration",iterate_over:{doc_type:"",collection_field:"",entity_type:""},scope:"",steps:[]};function yB({workspaceId:e,workflow:t,onArtifactSave:r,onDelete:n,onNavigateToWorkflow:s}){const[o,i]=m.useState("steps"),[a,c]=m.useState(""),[u,d]=m.useState(null),f=m.useMemo(()=>t?`workflow:${t.workflow_id}:${t.active_version}:definition`:null,[t]),{workflowJson:p,loading:h,error:y,saving:v,updateWorkflow:w}=gC(e,f,{onSave:j=>{r==null||r(f,j)}}),g=m.useCallback(j=>{j==="json"&&p&&(c(JSON.stringify(p,null,2)),d(null)),i(j)},[p]),x=m.useCallback(j=>{const C=j.target.value;c(C);try{const R=JSON.parse(C);d(null),w(R)}catch(R){d(R.message)}},[w]),b=m.useCallback((j,C)=>{if(!p)return;const R=[...p.steps];R[j]=C,w({...p,steps:R})},[p,w]),_=m.useCallback(j=>{if(!p)return;const C=p.steps.filter((R,T)=>T!==j);w({...p,steps:C})},[p,w]),S=m.useCallback(j=>{var R,T;if(!p)return;const C=j==="iteration"?{...xB,step_id:`new_iteration_${(((R=p.steps)==null?void 0:R.length)||0)+1}`}:{...GC,step_id:`new_step_${(((T=p.steps)==null?void 0:T.length)||0)+1}`};w({...p,steps:[...p.steps||[],C]})},[p,w]),k=m.useCallback((j,C)=>{if(!p)return;const R=Bc(p.steps,j,C);w({...p,steps:R})},[p,w]),N=m.useCallback(()=>{!n||!t||window.confirm(`Delete workflow "${t.workflow_id}"? This cannot be undone until you discard workspace changes.`)&&n(t.workflow_id)},[n,t]);return t?l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:(p==null?void 0:p.name)||t.workflow_id.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())}),((p==null?void 0:p.pow_class)||t.pow_class)&&l.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:((p==null?void 0:p.pow_class)||t.pow_class)==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:((p==null?void 0:p.pow_class)||t.pow_class)==="reference"?"#000":"var(--text-primary)"},children:(p==null?void 0:p.pow_class)||t.pow_class})]}),l.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",t.active_version,(p==null?void 0:p.description)&&`  ${p.description}`]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[v&&l.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),y&&l.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:y}),n&&l.jsx("button",{onClick:N,className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete workflow",children:l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),l.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"steps",label:"Steps"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(j=>l.jsx("button",{onClick:()=>g(j.id),style:{...vB,color:o===j.id?"var(--text-primary)":"var(--text-muted)",borderBottom:o===j.id?"2px solid var(--action-primary)":"2px solid transparent"},children:j.label},j.id))}),h?l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):l.jsxs("div",{className:"flex-1 overflow-hidden",children:[o==="steps"&&l.jsxs("div",{className:"h-full overflow-y-auto p-4",children:[l.jsx(bB,{steps:(p==null?void 0:p.steps)||[],onStepChange:b,onStepDelete:_,onReorder:k}),l.jsxs("div",{className:"flex gap-2 mt-3",children:[l.jsx("button",{onClick:()=>S("production"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600},children:"+ Production Step"}),l.jsx("button",{onClick:()=>S("iteration"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--action-primary)",border:"1px solid var(--action-primary)",fontWeight:600},children:"+ Iteration Step"})]})]}),o==="json"&&l.jsxs("div",{className:"h-full flex flex-col p-4",children:[l.jsx("textarea",{value:a,onChange:x,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:u?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),u&&l.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",u]})]}),o==="metadata"&&l.jsx("div",{className:"h-full overflow-y-auto p-4",children:p?l.jsx(jB,{workflow:p,onUpdateWorkflow:w,onNavigateToWorkflow:s}):l.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]})]}):l.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[l.jsx("div",{className:"text-lg mb-1",children:"Workflow Editor"}),l.jsx("div",{className:"text-sm",children:"Select a workflow from the sidebar to begin editing"})]})})}function bB({steps:e,onStepChange:t,onStepDelete:r,onReorder:n}){const s=bC(Bl(qc,{activationConstraint:{distance:5}}),Bl(zc,{coordinateGetter:VC})),o=m.useMemo(()=>e.map(a=>a.step_id),[e]),i=m.useCallback(a=>{const{active:c,over:u}=a;if(!u||c.id===u.id)return;const d=e.findIndex(p=>p.step_id===c.id),f=e.findIndex(p=>p.step_id===u.id);d!==-1&&f!==-1&&n(d,f)},[e,n]);return e.length===0?l.jsx("div",{className:"text-sm py-4",style:{color:"var(--text-muted)"},children:"No steps defined. Add a step to get started."}):l.jsx(LC,{sensors:s,collisionDetection:jC,onDragEnd:i,children:l.jsx(BC,{items:o,strategy:qC,children:e.map((a,c)=>l.jsx(wB,{step:a,index:c,onChange:t,onDelete:r},a.step_id))})})}function wB({step:e,index:t,onChange:r,onDelete:n}){const{attributes:s,listeners:o,setNodeRef:i,transform:a,transition:c,isDragging:u}=WC({id:e.step_id}),d={transform:co.Transform.toString(a),transition:c,opacity:u?.5:1};return l.jsx("div",{ref:i,style:d,children:l.jsx(KC,{step:e,index:t,onChange:r,onDelete:n,dragHandleProps:{...s,...o}})})}function KC({step:e,index:t,onChange:r,onDelete:n,dragHandleProps:s,depth:o=0}){var S,k,N;const[i,a]=m.useState(e),[c,u]=m.useState(!0);m.useEffect(()=>{a(e)},[e]);const d=!!i.iterate_over,f=(j,C)=>{const R={...i,[j]:C};a(R),r(t,R)},p=(j,C)=>{const R={...i.iterate_over,[j]:C},T={...i,iterate_over:R};a(T),r(t,T)},h=()=>{const j=[...i.inputs||[],{doc_type:"",scope:""}],C={...i,inputs:j};a(C),r(t,C)},y=(j,C,R)=>{const T=[...i.inputs||[]];T[j]={...T[j],[C]:R};const L={...i,inputs:T};a(L),r(t,L)},v=j=>{const C=(i.inputs||[]).filter((T,L)=>L!==j),R={...i,inputs:C};a(R),r(t,R)},w=m.useCallback((j,C)=>{const R=[...i.steps||[]];R[j]=C;const T={...i,steps:R};a(T),r(t,T)},[i,t,r]),g=m.useCallback(j=>{const C=(i.steps||[]).filter((T,L)=>L!==j),R={...i,steps:C};a(R),r(t,R)},[i,t,r]),x=m.useCallback(()=>{var R;const j=[...i.steps||[],{...GC,step_id:`nested_step_${(((R=i.steps)==null?void 0:R.length)||0)+1}`}],C={...i,steps:j};a(C),r(t,C)},[i,t,r]),b=m.useCallback((j,C)=>{const R=Bc(i.steps||[],j,C),T={...i,steps:R};a(T),r(t,T)},[i,t,r]),_={background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",borderRadius:6,marginBottom:8,marginLeft:o*20,borderLeft:d?"3px solid var(--action-primary)":"3px solid var(--border-panel)"};return l.jsxs("div",{style:_,children:[l.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",style:{borderBottom:c?"1px solid var(--border-panel)":"none",background:"var(--bg-panel)",borderRadius:c?"6px 6px 0 0":6},children:[s&&l.jsx("span",{...s,style:{cursor:"grab",color:"var(--text-muted)",lineHeight:1},title:"Drag to reorder",children:l.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[l.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),l.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),l.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),l.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),l.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),l.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),l.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:d?"var(--action-primary)":"var(--bg-canvas)",color:d?"#000":"var(--action-primary)",border:"1px solid var(--border-panel)",fontSize:10,fontWeight:700},children:d?"ITER":"STEP"}),l.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-primary)",fontWeight:600},children:i.step_id}),l.jsx("span",{style:{flex:1}}),l.jsx("button",{onClick:()=>u(!c),className:"p-0.5 rounded hover:opacity-80",style:{color:"var(--text-muted)",background:"transparent",border:"none",cursor:"pointer"},title:c?"Collapse":"Expand",children:l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:c?l.jsx("path",{d:"M18 15l-6-6-6 6"}):l.jsx("path",{d:"M6 9l6 6 6-6"})})}),l.jsx("button",{onClick:()=>n(t),className:"p-0.5 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer"},title:"Delete step",children:l.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),c&&l.jsxs("div",{className:"p-3 space-y-2",children:[l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Step ID"}),l.jsx("input",{type:"text",value:i.step_id||"",onChange:j=>f("step_id",j.target.value),style:jr})]}),d?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Doc Type"}),l.jsx("input",{type:"text",value:((S=i.iterate_over)==null?void 0:S.doc_type)||"",onChange:j=>p("doc_type",j.target.value),style:jr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Collection Field"}),l.jsx("input",{type:"text",value:((k=i.iterate_over)==null?void 0:k.collection_field)||"",onChange:j=>p("collection_field",j.target.value),style:jr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Entity Type"}),l.jsx("input",{type:"text",value:((N=i.iterate_over)==null?void 0:N.entity_type)||"",onChange:j=>p("entity_type",j.target.value),style:jr})]})]}),l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Scope"}),l.jsx("input",{type:"text",value:i.scope||"",onChange:j=>f("scope",j.target.value),style:jr})]}),l.jsxs("div",{className:"mt-3",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("label",{style:Wt,children:"Nested Steps"}),l.jsx("button",{onClick:x,className:"text-xs px-2 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),l.jsx(_B,{steps:i.steps||[],onStepChange:w,onStepDelete:g,onReorder:b})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Produces"}),l.jsx("input",{type:"text",value:i.produces||"",onChange:j=>f("produces",j.target.value),placeholder:"document_type (e.g., project_discovery)",style:jr})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Scope"}),l.jsx("input",{type:"text",value:i.scope||"",onChange:j=>f("scope",j.target.value),placeholder:"project",style:jr})]}),l.jsxs("div",{children:[l.jsx("label",{style:Wt,children:"Creates Entities"}),l.jsx("input",{type:"text",value:i.creates_entities||"",onChange:j=>f("creates_entities",j.target.value||void 0),placeholder:"e.g., epic",style:jr})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("label",{style:Wt,children:"Inputs"}),l.jsx("button",{onClick:h,className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),(i.inputs||[]).length===0?l.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No inputs"}):l.jsx("div",{className:"space-y-1",children:(i.inputs||[]).map((j,C)=>l.jsxs("div",{className:"flex gap-1 items-end",children:[l.jsxs("div",{style:{flex:1},children:[C===0&&l.jsx("label",{style:{...Wt,fontSize:9},children:"Doc/Entity Type"}),l.jsx("input",{type:"text",value:j.doc_type||j.entity_type||"",onChange:R=>{const T=R.target.value;j.entity_type!==void 0?y(C,"entity_type",T):y(C,"doc_type",T)},placeholder:"doc_type",style:{...jr,fontSize:11}})]}),l.jsxs("div",{style:{width:"30%"},children:[C===0&&l.jsx("label",{style:{...Wt,fontSize:9},children:"Scope"}),l.jsx("input",{type:"text",value:j.scope||"",onChange:R=>y(C,"scope",R.target.value),placeholder:"scope",style:{...jr,fontSize:11}})]}),l.jsxs("label",{className:"flex items-center gap-1 text-xs pb-0.5",style:{color:"var(--text-muted)",whiteSpace:"nowrap"},children:[l.jsx("input",{type:"checkbox",checked:j.context||!1,onChange:R=>y(C,"context",R.target.checked||void 0)}),"ctx"]}),l.jsx("button",{onClick:()=>v(C),className:"pb-0.5",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer",fontSize:12,fontWeight:700},children:"x"})]},C))})]})]})]})]})}function _B({steps:e,onStepChange:t,onStepDelete:r,onReorder:n}){const s=bC(Bl(qc,{activationConstraint:{distance:5}}),Bl(zc,{coordinateGetter:VC})),o=m.useMemo(()=>e.map(a=>a.step_id),[e]),i=m.useCallback(a=>{const{active:c,over:u}=a;if(!u||c.id===u.id)return;const d=e.findIndex(p=>p.step_id===c.id),f=e.findIndex(p=>p.step_id===u.id);d!==-1&&f!==-1&&n(d,f)},[e,n]);return e.length===0?l.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No nested steps"}):l.jsx(LC,{sensors:s,collisionDetection:jC,onDragEnd:i,children:l.jsx(BC,{items:o,strategy:qC,children:e.map((a,c)=>l.jsx(SB,{step:a,index:c,onChange:t,onDelete:r},a.step_id))})})}function SB({step:e,index:t,onChange:r,onDelete:n}){const{attributes:s,listeners:o,setNodeRef:i,transform:a,transition:c,isDragging:u}=WC({id:e.step_id}),d={transform:co.Transform.toString(a),transition:c,opacity:u?.5:1};return l.jsx("div",{ref:i,style:d,children:l.jsx(KC,{step:e,index:t,onChange:r,onDelete:n,dragHandleProps:{...s,...o},depth:1})})}function jB({workflow:e,onUpdateWorkflow:t,onNavigateToWorkflow:r}){const[n,s]=m.useState(""),o={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},i={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},a=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"schema_version",label:"Schema Version"},{key:"revision",label:"Revision"},{key:"effective_date",label:"Effective Date"},{key:"description",label:"Description"}],c=e.scopes||{},u=Object.entries(c),d=e.document_types||{},f=Object.entries(d),p=e.pow_class||"reference",h=e.derived_from,y=e.source_version,v=e.tags||[],w=()=>{const b=n.trim().toLowerCase().replace(/\s+/g,"_");!b||v.includes(b)||(t==null||t({...e,tags:[...v,b]}),s(""))},g=b=>{t==null||t({...e,tags:v.filter(_=>_!==b)})},x=()=>{h!=null&&h.workflow_id&&r&&r(h.workflow_id)};return l.jsxs("div",{className:"space-y-4 max-w-lg",children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Classification"}),l.jsxs("div",{children:[l.jsx("label",{style:i,children:"POW Class"}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsx("span",{className:"text-xs px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,letterSpacing:"0.05em",background:p==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:p==="reference"?"#000":"var(--text-primary)"},children:p})})]}),h&&l.jsxs("div",{children:[l.jsx("label",{style:i,children:"Derived From"}),l.jsx("div",{style:o,children:r?l.jsxs("button",{onClick:x,className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--action-primary)",textDecoration:"underline",fontSize:12},children:[h.workflow_id," v",h.version]}):l.jsxs("span",{children:[h.workflow_id," v",h.version]})})]}),y&&l.jsxs("div",{children:[l.jsx("label",{style:i,children:"Source Version"}),l.jsx("div",{style:o,children:y})]}),l.jsxs("div",{children:[l.jsx("label",{style:i,children:"Tags"}),l.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[v.length===0&&l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No tags"}),v.map(b=>l.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-primary)",fontSize:11},children:[b,t&&l.jsx("button",{onClick:()=>g(b),className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--text-muted)",fontSize:11,lineHeight:1},title:`Remove tag "${b}"`,children:"x"})]},b))]}),t&&l.jsxs("div",{className:"flex gap-1",children:[l.jsx("input",{type:"text",value:n,onChange:b=>s(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),w())},placeholder:"Add tag...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none",flex:1}}),l.jsx("button",{onClick:w,disabled:!n.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:n.trim()?"pointer":"default",opacity:n.trim()?1:.5},children:"Add"})]})]}),l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),a.map(b=>l.jsxs("div",{children:[l.jsx("label",{style:i,children:b.label}),l.jsx("div",{style:o,children:e[b.key]||"-"})]},b.key)),u.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Scopes"}),u.map(([b,_])=>l.jsxs("div",{children:[l.jsx("label",{style:i,children:b}),l.jsxs("div",{style:o,children:["parent: ",_.parent||"none"]})]},b))]}),f.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Document Types"}),f.map(([b,_])=>l.jsxs("div",{children:[l.jsx("label",{style:i,children:b}),l.jsxs("div",{style:o,children:[_.name,_.scope&&` (${_.scope})`,_.acceptance_required&&" [acceptance required]"]})]},b))]})]})}function aS({results:e,compact:t=!1}){if(!e||e.length===0)return null;const r=e.filter(s=>s.status==="fail"),n=e.filter(s=>s.status==="pass");return t?l.jsx("div",{className:"flex items-center gap-2",children:r.length>0?l.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-error-bg)",color:"var(--state-error-text)"},children:[r.length," error",r.length!==1?"s":""]}):l.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-success-bg)",color:"var(--state-success-text)"},children:"Valid"})}):l.jsxs("div",{className:"space-y-2",children:[r.map((s,o)=>l.jsxs("div",{className:"text-xs p-2 rounded border",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"var(--state-error-bg)",color:"var(--text-primary)"},children:[l.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[l.jsx("span",{className:"text-red-400",children:"FAIL"}),l.jsx("span",{className:"font-mono",children:s.rule_id})]}),s.message&&l.jsx("div",{className:"mt-1 opacity-80",children:s.message}),s.artifact_id&&l.jsx("div",{className:"mt-1 font-mono text-xs opacity-60",children:s.artifact_id})]},o)),n.length>0&&r.length>0&&l.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--text-muted)"},children:[n.length," rule",n.length!==1?"s":""," passed"]})]})}function kB(e,t){const r=(e||"").split(`
`),n=(t||"").split(`
`),s=[];let o=0,i=0;for(;o<r.length||i<n.length;)if(o>=r.length)s.push({type:"added",line:n[i],lineNum:i+1}),i++;else if(i>=n.length)s.push({type:"removed",line:r[o],lineNum:o+1}),o++;else if(r[o]===n[i])s.push({type:"same",line:r[o],oldLineNum:o+1,newLineNum:i+1}),o++,i++;else{let a=n.slice(i,i+5).indexOf(r[o]),c=r.slice(o,o+5).indexOf(n[i]);if(a!==-1&&(c===-1||a<=c)){for(let u=0;u<a;u++)s.push({type:"added",line:n[i+u],lineNum:i+u+1});i+=a}else if(c!==-1){for(let u=0;u<c;u++)s.push({type:"removed",line:r[o+u],lineNum:o+u+1});o+=c}else s.push({type:"removed",line:r[o],lineNum:o+1}),s.push({type:"added",line:n[i],lineNum:i+1}),o++,i++}return s}function NB({diff:e}){const[t,r]=m.useState(!0),n=kB(e.old_content,e.new_content),s={M:{bg:"rgba(245, 158, 11, 0.2)",color:"#f59e0b"},A:{bg:"rgba(34, 197, 94, 0.2)",color:"#22c55e"},D:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444"}};return l.jsxs("div",{className:"border rounded mb-3",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{background:"var(--bg-panel)"},onClick:()=>r(!t),children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:s[e.status]||s.M,children:e.status}),l.jsx("span",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},children:e.file_path})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("span",{className:"text-xs",style:{color:"var(--action-success)"},children:["+",e.additions]}),l.jsxs("span",{className:"text-xs",style:{color:"var(--state-error-text)"},children:["-",e.deletions]}),l.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:t?"":"+"})]})]}),t&&l.jsx("div",{className:"overflow-x-auto",style:{background:"var(--bg-canvas)"},children:l.jsx("pre",{className:"text-xs font-mono m-0 p-0",children:n.map((o,i)=>l.jsxs("div",{className:"flex",style:{background:o.type==="added"?"rgba(34, 197, 94, 0.1)":o.type==="removed"?"rgba(239, 68, 68, 0.1)":"transparent",borderLeft:o.type==="added"?"3px solid #22c55e":o.type==="removed"?"3px solid #ef4444":"3px solid transparent"},children:[l.jsx("span",{className:"select-none px-2 text-right",style:{color:"var(--text-muted)",minWidth:"40px",background:"rgba(0,0,0,0.1)"},children:o.type==="same"?o.oldLineNum:o.lineNum||""}),l.jsx("span",{className:"select-none px-1",style:{color:o.type==="added"?"#22c55e":o.type==="removed"?"#ef4444":"var(--text-muted)",minWidth:"16px"},children:o.type==="added"?"+":o.type==="removed"?"-":" "}),l.jsx("span",{className:"flex-1 px-2 whitespace-pre",style:{color:"var(--text-primary)"},children:o.line})]},i))})})]})}function EB({workspaceId:e,artifactId:t=null,onClose:r}){const[n,s]=m.useState([]),[o,i]=m.useState(!0),[a,c]=m.useState(null);m.useEffect(()=>{e&&(i(!0),c(null),Ne.getDiff(e,t).then(d=>{s(d.diffs||[])}).catch(d=>{c(d.message)}).finally(()=>{i(!1)}))},[e,t]);const u=d=>{d.key==="Escape"&&(r==null||r())};return l.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:d=>d.target===d.currentTarget&&(r==null?void 0:r()),onKeyDown:u,tabIndex:0,children:l.jsxs("div",{className:"w-full max-w-4xl max-h-[80vh] flex flex-col rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:t?"Artifact Changes":"All Changes"}),l.jsx("button",{onClick:r,className:"p-1 rounded hover:opacity-80",style:{color:"var(--text-muted)"},children:l.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:l.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o?l.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"Loading diff..."}):a?l.jsxs("div",{className:"text-center py-8",style:{color:"var(--state-error-text)"},children:["Error: ",a]}):n.length===0?l.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"No changes to display"}):n.map((d,f)=>l.jsx(NB,{diff:d},d.artifact_id||f))}),l.jsx("div",{className:"flex justify-end px-4 py-3 border-t",style:{borderColor:"var(--border-panel)"},children:l.jsx("button",{onClick:r,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Close"})})]})})}function CB(e){const t=e.split(":");if(t.length!==4)return{display:e,scope:"unknown"};const[r,n,s,o]=t,i=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),a=o.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,version:s,kind:o,displayName:i,kindLabel:a,display:`${i} - ${a}`}}function RB(e){const t={doctype:{label:"Document Types",items:[]},role:{label:"Roles",items:[]},template:{label:"Templates",items:[]}};return e.forEach(r=>{const n=CB(r);t[n.scope]&&t[n.scope].items.push(n)}),Object.entries(t).filter(([r,n])=>n.items.length>0).map(([r,n])=>({scope:r,...n}))}function TB({workspaceId:e,onCommit:t,onCancel:r,loading:n=!1,modifiedArtifacts:s=[],modifiedFiles:o=[]}){const[i,a]=m.useState(""),[c,u]=m.useState(!1),d=RB(s),f=s.length,p=y=>{y.preventDefault(),i.trim()&&!n&&t(i.trim())},h=y=>{y.key==="Escape"&&!n&&r()};return l.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:y=>y.target===y.currentTarget&&!n&&r(),onKeyDown:h,children:[l.jsxs("div",{className:"w-full max-w-lg p-6 rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Commit Changes"}),f>0&&l.jsxs("div",{className:"mb-4 p-3 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[l.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:[f," ",f===1?"change":"changes"," to be committed"]}),l.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:d.map(y=>l.jsxs("div",{children:[l.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:y.label}),l.jsx("div",{className:"space-y-1",children:y.items.map((v,w)=>l.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[l.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:"var(--state-warning-bg, rgba(245, 158, 11, 0.2))",color:"var(--state-warning-text, #f59e0b)"},children:"M"}),l.jsx("span",{style:{color:"var(--text-primary)"},children:v.displayName}),l.jsx("span",{style:{color:"var(--text-muted)"},children:v.kindLabel}),l.jsxs("span",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:["v",v.version]})]},w))})]},y.scope))}),l.jsx("button",{type:"button",onClick:()=>u(!0),className:"mt-3 text-xs hover:underline",style:{color:"var(--action-primary)"},children:"View detailed changes..."})]}),l.jsxs("form",{onSubmit:p,children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm mb-2",style:{color:"var(--text-muted)"},children:"Commit Message"}),l.jsx("textarea",{value:i,onChange:y=>a(y.target.value),placeholder:"Describe your changes...",className:"w-full p-3 rounded text-sm resize-none",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:"80px"},autoFocus:!0,disabled:n}),l.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:'Keep it concise - describe the "why" not the "what"'})]}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{type:"button",onClick:r,disabled:n,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Cancel"}),l.jsx("button",{type:"submit",disabled:!i.trim()||n,className:"px-4 py-2 rounded text-sm font-medium",style:{background:i.trim()&&!n?"var(--action-success)":"var(--border-panel)",color:i.trim()&&!n?"#000":"var(--text-muted)",cursor:i.trim()&&!n?"pointer":"not-allowed"},children:n?"Committing...":"Commit"})]})]})]}),c&&e&&l.jsx(EB,{workspaceId:e,onClose:()=>u(!1)})]})}function IB(e){const t=e.split(":");if(t.length!==4)return{display:e};const[r,n,s,o]=t,i=n.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),a=o.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:r,name:n,displayName:i,kind:o,kindLabel:a,version:s,display:`${i} - ${a}`}}function MB({workspaceId:e,state:t,loading:r,onCommit:n,onDiscard:s,onClose:o,onRefresh:i}){var C,R;const[a,c]=m.useState(!1),[u,d]=m.useState(!1),[f,p]=m.useState(!1),[h,y]=m.useState(null),v=(t==null?void 0:t.is_dirty)??!1,w=(t==null?void 0:t.modified_artifacts)??[],g=((C=t==null?void 0:t.tier1)==null?void 0:C.passed)??!0,x=((R=t==null?void 0:t.tier1)==null?void 0:R.results)??[],b=(t==null?void 0:t.branch)??"",_=t!=null&&t.expires_at?new Date(t.expires_at):null,S=async T=>{d(!0),y(null);try{const L=await Ne.commit(e,T);c(!1),n==null||n(L),i==null||i()}catch(L){y(L.message)}finally{d(!1)}},k=async()=>{if(confirm("Discard all uncommitted changes? This cannot be undone.")){p(!0);try{await Ne.discard(e),s==null||s(),i==null||i()}catch(T){console.error("Discard failed:",T),alert("Failed to discard changes: "+T.message)}finally{p(!1)}}},N=async()=>{if(v){alert("Cannot close workspace with uncommitted changes. Commit or discard first.");return}if(confirm("Close this workspace? You can open a new one later."))try{await Ne.closeWorkspace(e),o==null||o()}catch(T){console.error("Close failed:",T),alert("Failed to close workspace: "+T.message)}},j=T=>{if(!T)return null;const $=T-new Date;if($<=0)return"Expired";const E=Math.floor($/(1e3*60*60)),P=Math.floor($%(1e3*60*60)/(1e3*60));return E>0?`${E}h ${P}m remaining`:`${P}m remaining`};return l.jsxs("div",{className:"w-80 flex flex-col border-l h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[l.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:l.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workspace Status"})}),r?l.jsx("div",{className:"p-4 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):l.jsxs("div",{className:"flex-1 overflow-y-auto",children:[l.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Branch"}),l.jsx("div",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},title:b,children:b||"-"}),_&&l.jsx("div",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:j(_)})]}),l.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status"}),l.jsx("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:v?"var(--state-warning-bg, rgba(245, 158, 11, 0.2))":"var(--state-success-bg)",color:v?"var(--state-warning-text, #f59e0b)":"var(--state-success-text)"},children:v?"Modified":"Clean"})]}),w.length>0&&l.jsxs("div",{className:"mt-2",children:[l.jsxs("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:["Changed (",w.length,")"]}),l.jsx("div",{className:"space-y-1",children:w.map(T=>{const L=IB(T);return l.jsxs("div",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},title:T,children:[l.jsx("span",{style:{color:"var(--text-primary)"},children:L.displayName||T}),L.kindLabel&&l.jsxs("span",{style:{color:"var(--text-muted)"},children:[" ","- ",L.kindLabel]})]},T)})})]})]}),l.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tier 1 Validation"}),l.jsx(aS,{results:x,compact:!0})]}),x.length>0&&!g&&l.jsx("div",{className:"mt-3",children:l.jsx(aS,{results:x})})]})]}),l.jsxs("div",{className:"px-4 py-3 border-t space-y-2",style:{borderColor:"var(--border-panel)"},children:[l.jsx("button",{onClick:()=>c(!0),disabled:!v||!g||r,className:"w-full px-4 py-2 rounded text-sm font-medium transition-opacity",style:{background:v&&g?"var(--action-success)":"var(--border-panel)",color:v&&g?"#000":"var(--text-muted)",cursor:v&&g&&!r?"pointer":"not-allowed",opacity:r?.5:1},children:"Commit Changes"}),!g&&v&&l.jsx("div",{className:"text-xs text-center",style:{color:"var(--state-error-text)"},children:"Fix validation errors to commit"}),v&&l.jsx("button",{onClick:k,disabled:f||r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:f||r?.5:1},children:f?"Discarding...":"Discard Changes"}),!v&&l.jsx("button",{onClick:N,disabled:r,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:r?.5:1},children:"Close Workspace"})]}),a&&l.jsx(TB,{workspaceId:e,onCommit:S,onCancel:()=>{c(!1),y(null)},loading:u,modifiedArtifacts:w,modifiedFiles:(t==null?void 0:t.modified_files)??[]}),h&&l.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff"},children:h})]})}function AB(){const{isAdmin:e,loading:t}=yo(),[r,n]=m.useState(null),[s,o]=m.useState(null),[i,a]=m.useState(!1),[c,u]=m.useState(null),[d,f]=m.useState(null),[p,h]=m.useState(null),[y,v]=m.useState(null),[w,g]=m.useState(null),{workspaceId:x,loading:b,error:_,reinitialize:S}=Oq(),{state:k,loading:N,refresh:j}=Lq(x),{documentTypes:C,loading:R}=zq(),{roles:T,loading:L}=qq(),{templates:$,loading:E}=c$(),{workflows:P,loading:D,refresh:F}=u$(),A=m.useCallback(async(ee,X=null,fe="docworkflow")=>{if(n(ee),u(null),f(null),h(null),o(null),v(X),g(fe),!!ee){a(!0);try{const V=await Ne.getDocumentType(ee.doc_type_id);o(V)}catch(V){console.error("Failed to load doc type details:",V),o(ee)}finally{a(!1)}}},[]),I=m.useCallback(ee=>{A(ee,"task_prompt","task")},[A]),z=m.useCallback(ee=>{A(ee,"schema","schema")},[A]),M=m.useCallback(ee=>{u(ee),n(null),o(null),f(null),h(null)},[]),q=m.useCallback(ee=>{f(ee),n(null),o(null),u(null),h(null)},[]),H=m.useCallback(ee=>{h(ee),n(null),o(null),u(null),f(null)},[]),O=m.useCallback(ee=>{const X=P.find(fe=>fe.workflow_id===ee);X&&H(X)},[P,H]),B=m.useCallback((ee,X)=>{j()},[j]),Y=m.useCallback(ee=>{console.log("Committed:",ee.commit_hash)},[]),te=m.useCallback(()=>{n(null),o(null),u(null),f(null),h(null)},[]),ne=m.useCallback(async ee=>{if(x)try{const X=await Ne.createOrchestrationWorkflow(x,ee);await F(),j(),h({workflow_id:X.workflow_id,active_version:X.version,name:ee.name||X.workflow_id.replace(/_/g," ").replace(/\b\w/g,fe=>fe.toUpperCase())}),n(null),o(null),u(null),f(null)}catch(X){console.error("Failed to create workflow:",X),alert(`Failed to create workflow: ${X.message}`)}},[x,F,j]),re=m.useCallback(async ee=>{if(x)try{await Ne.deleteOrchestrationWorkflow(x,ee),await F(),j(),h(null)}catch(X){console.error("Failed to delete workflow:",X),alert(`Failed to delete workflow: ${X.message}`)}},[x,F,j]),Q=m.useCallback(()=>{S(),n(null),o(null),u(null),f(null),h(null)},[S]);if(t)return l.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:l.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return l.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8 rounded-lg",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Access Denied"}),l.jsx("div",{style:{color:"var(--text-muted)"},children:"Admin access required for the Workbench."})]})});if(b)return l.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-lg mb-2",style:{color:"var(--text-primary)"},children:"Initializing Workspace"}),l.jsx("div",{style:{color:"var(--text-muted)"},children:"Setting up your editing environment..."})]})});if(_)return l.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[l.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Workspace Error"}),l.jsx("div",{className:"mb-4",style:{color:"var(--text-muted)"},children:_}),l.jsx("button",{onClick:S,className:"px-4 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000"},children:"Retry"})]})});const ce=c&&!r&&!d&&!p,ie=d&&!r&&!c&&!p,xe=p&&!r&&!c&&!d;return l.jsxs("div",{className:"flex h-screen overflow-hidden",style:{background:"var(--bg-canvas)"},children:[l.jsx(d$,{documentTypes:C,roles:T,templates:$,workflows:P,loading:R,rolesLoading:L,templatesLoading:E,workflowsLoading:D,selectedDocType:r,docTypeSource:w,selectedRole:c,selectedTemplate:d,selectedWorkflow:p,onSelectDocType:A,onSelectRole:M,onSelectTemplate:q,onSelectWorkflow:H,onCreateWorkflow:ne,onSelectTask:I,onSelectSchema:z}),ce?l.jsx(D$,{workspaceId:x,role:c,onArtifactSave:B}):ie?l.jsx(O$,{workspaceId:x,template:d,onArtifactSave:B}):xe?l.jsx(yB,{workspaceId:x,workflow:p,onArtifactSave:B,onDelete:re,onNavigateToWorkflow:O}):l.jsx(P$,{workspaceId:x,docType:s,loading:i,roles:T,onArtifactSave:B,initialTab:y}),l.jsx(MB,{workspaceId:x,state:k,loading:N,onCommit:Y,onDiscard:te,onClose:Q,onRefresh:j})]})}function PB({user:e,onClick:t}){return l.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:l.jsxs("button",{onClick:t,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-primary)"},children:[e!=null&&e.avatar_url?l.jsx("img",{src:e.avatar_url,alt:e.name,className:"w-8 h-8 rounded-full"}):l.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),l.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[l.jsx("div",{className:"text-sm font-medium truncate",children:(e==null?void 0:e.name)||"User"}),l.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(e==null?void 0:e.email)||""})]})]})})}function DB(){var T,L,$;const{user:e}=yo(),[t,r]=m.useState(!1),{projects:n,loading:s,error:o,refresh:i}=Mq({includeArchived:t}),[a,c]=m.useState(null),[u,d]=m.useState(null),[f,p]=m.useState(!1),[h,y]=m.useState(!1),{theme:v,setTheme:w}=pC(),g=Object.keys(n),x=a&&n[a]?a:g[0]||null;m.useEffect(()=>{if(x&&n[x]){const E=n[x];document.title=`${E.projectId} - The Combine`}else document.title="The Combine"},[x,n]);const b=E=>{c(E),d(null)},_=()=>{p(!0)},S=async E=>{await i(),E&&E.id&&(c(E.id),d("concierge_intake")),p(!1)},k=()=>{p(!1)},N=async(E,P)=>{try{await Ie.updateProject(E,P),await i()}catch(D){throw console.error("Failed to update project:",D),D}},j=async E=>{try{if(await Ie.archiveProject(E),!t){const P=Object.values(n).sort((A,I)=>{const z=(A.name||"").localeCompare(I.name||"");return z!==0?z:(A.projectId||"").localeCompare(I.projectId||"")}),D=P.findIndex(A=>A.id===E),F=P[D+1]||P[D-1]||null;c((F==null?void 0:F.id)||null)}await i()}catch(P){throw console.error("Failed to archive project:",P),P}},C=async E=>{try{await Ie.unarchiveProject(E),await i()}catch(P){throw console.error("Failed to unarchive project:",P),P}},R=async E=>{try{await Ie.deleteProject(E);const P=Object.values(n).sort((A,I)=>{const z=(A.name||"").localeCompare(I.name||"");return z!==0?z:(A.projectId||"").localeCompare(I.projectId||"")}),D=P.findIndex(A=>A.id===E),F=P[D+1]||P[D-1]||null;c((F==null?void 0:F.id)||null),await i()}catch(P){throw console.error("Failed to delete project:",P),P}};return s?l.jsx("div",{className:`flex h-screen items-center justify-center theme-${v}`,style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",children:[l.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),l.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading projects..."})]})}):o?l.jsx("div",{className:`flex h-screen items-center justify-center theme-${v}`,style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[l.jsxs("p",{className:"text-red-500 mb-4",children:["Failed to load projects: ",o]}),l.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-emerald-500 text-white rounded hover:bg-emerald-600",children:"Retry"})]})}):l.jsxs("div",{className:`flex flex-col h-screen theme-${v}`,children:[l.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),l.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),l.jsx("button",{className:"p-2 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Help",children:l.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[l.jsx("circle",{cx:"12",cy:"12",r:"10"}),l.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),l.jsx("path",{d:"M12 17h.01"})]})})]}),l.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[l.jsx(BP,{projects:n,selectedId:x,onSelectProject:b,onNewProject:_,showArchived:t,onToggleShowArchived:()=>r(E=>!E),userSection:l.jsx(PB,{user:e,onClick:()=>y(!0)})}),l.jsx("div",{className:"flex-1",children:x?l.jsx(gc,{children:l.jsx(Bq,{projectId:x,projectCode:(T=n[x])==null?void 0:T.projectId,projectName:(L=n[x])==null?void 0:L.name,isArchived:($=n[x])==null?void 0:$.isArchived,autoExpandNodeId:u,theme:v,onThemeChange:w,onProjectUpdate:N,onProjectArchive:j,onProjectUnarchive:C,onProjectDelete:R})},x):l.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:l.jsx("div",{className:"text-center",children:l.jsx("p",{style:{color:"var(--text-muted)"},children:"No projects yet. Create one to get started."})})})}),f&&l.jsx(Xq,{onClose:k,onComplete:S}),h&&l.jsx(Qq,{onClose:()=>y(!1)})]})]})}function OB(){const{isAuthenticated:e,loading:t}=yo(),{theme:r}=pC(),[n,s]=m.useState(window.location.pathname);return m.useEffect(()=>{const o=()=>s(window.location.pathname);return window.addEventListener("popstate",o),()=>window.removeEventListener("popstate",o)},[]),t?l.jsx("div",{className:`flex h-screen items-center justify-center theme-${r}`,style:{background:"var(--bg-canvas)"},children:l.jsxs("div",{className:"text-center",children:[l.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),l.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})]})}):e?n==="/admin/workbench"?l.jsx("div",{className:`h-screen theme-${r}`,children:l.jsx(AB,{})}):l.jsx(DB,{}):n==="/learn"?l.jsx(l$,{}):l.jsx(s$,{})}function LB(){return l.jsx(Dq,{children:l.jsx(OB,{})})}Cm.createRoot(document.getElementById("root")).render(l.jsx(W.StrictMode,{children:l.jsx(LB,{})}));
//# sourceMappingURL=index-G9Yeg3Q_.js.map
