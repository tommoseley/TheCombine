(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Ia=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var HS={exports:{}},Oc={},VS={exports:{}},Ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ha=Symbol.for("react.element"),qT=Symbol.for("react.portal"),BT=Symbol.for("react.fragment"),WT=Symbol.for("react.strict_mode"),HT=Symbol.for("react.profiler"),VT=Symbol.for("react.provider"),UT=Symbol.for("react.context"),GT=Symbol.for("react.forward_ref"),KT=Symbol.for("react.suspense"),YT=Symbol.for("react.memo"),XT=Symbol.for("react.lazy"),Yy=Symbol.iterator;function QT(e){return e===null||typeof e!="object"?null:(e=Yy&&e[Yy]||e["@@iterator"],typeof e=="function"?e:null)}var US={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},GS=Object.assign,KS={};function Ti(e,t,n){this.props=e,this.context=t,this.refs=KS,this.updater=n||US}Ti.prototype.isReactComponent={};Ti.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ti.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function YS(){}YS.prototype=Ti.prototype;function rv(e,t,n){this.props=e,this.context=t,this.refs=KS,this.updater=n||US}var sv=rv.prototype=new YS;sv.constructor=rv;GS(sv,Ti.prototype);sv.isPureReactComponent=!0;var Xy=Array.isArray,XS=Object.prototype.hasOwnProperty,iv={current:null},QS={key:!0,ref:!0,__self:!0,__source:!0};function ZS(e,t,n){var r,s={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)XS.call(t,r)&&!QS.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:ha,type:e,key:i,ref:a,props:s,_owner:iv.current}}function ZT(e,t){return{$$typeof:ha,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ov(e){return typeof e=="object"&&e!==null&&e.$$typeof===ha}function JT(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Qy=/\/+/g;function Ou(e,t){return typeof e=="object"&&e!==null&&e.key!=null?JT(""+e.key):t.toString(36)}function yl(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case ha:case qT:a=!0}}if(a)return a=e,s=s(a),e=r===""?"."+Ou(a,0):r,Xy(s)?(n="",e!=null&&(n=e.replace(Qy,"$&/")+"/"),yl(s,t,n,"",function(d){return d})):s!=null&&(ov(s)&&(s=ZT(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(Qy,"$&/")+"/")+e)),t.push(s)),1;if(a=0,r=r===""?".":r+":",Xy(e))for(var l=0;l<e.length;l++){i=e[l];var c=r+Ou(i,l);a+=yl(i,t,n,c,s)}else if(c=QT(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=r+Ou(i,l++),a+=yl(i,t,n,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Pa(e,t,n){if(e==null)return e;var r=[],s=0;return yl(e,r,"","",function(i){return t.call(n,i,s++)}),r}function e5(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ft={current:null},bl={transition:null},t5={ReactCurrentDispatcher:Ft,ReactCurrentBatchConfig:bl,ReactCurrentOwner:iv};function JS(){throw Error("act(...) is not supported in production builds of React.")}Ae.Children={map:Pa,forEach:function(e,t,n){Pa(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Pa(e,function(){t++}),t},toArray:function(e){return Pa(e,function(t){return t})||[]},only:function(e){if(!ov(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ae.Component=Ti;Ae.Fragment=BT;Ae.Profiler=HT;Ae.PureComponent=rv;Ae.StrictMode=WT;Ae.Suspense=KT;Ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=t5;Ae.act=JS;Ae.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=GS({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=iv.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)XS.call(t,c)&&!QS.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:ha,type:e.type,key:s,ref:i,props:r,_owner:a}};Ae.createContext=function(e){return e={$$typeof:UT,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:VT,_context:e},e.Consumer=e};Ae.createElement=ZS;Ae.createFactory=function(e){var t=ZS.bind(null,e);return t.type=e,t};Ae.createRef=function(){return{current:null}};Ae.forwardRef=function(e){return{$$typeof:GT,render:e}};Ae.isValidElement=ov;Ae.lazy=function(e){return{$$typeof:XT,_payload:{_status:-1,_result:e},_init:e5}};Ae.memo=function(e,t){return{$$typeof:YT,type:e,compare:t===void 0?null:t}};Ae.startTransition=function(e){var t=bl.transition;bl.transition={};try{e()}finally{bl.transition=t}};Ae.unstable_act=JS;Ae.useCallback=function(e,t){return Ft.current.useCallback(e,t)};Ae.useContext=function(e){return Ft.current.useContext(e)};Ae.useDebugValue=function(){};Ae.useDeferredValue=function(e){return Ft.current.useDeferredValue(e)};Ae.useEffect=function(e,t){return Ft.current.useEffect(e,t)};Ae.useId=function(){return Ft.current.useId()};Ae.useImperativeHandle=function(e,t,n){return Ft.current.useImperativeHandle(e,t,n)};Ae.useInsertionEffect=function(e,t){return Ft.current.useInsertionEffect(e,t)};Ae.useLayoutEffect=function(e,t){return Ft.current.useLayoutEffect(e,t)};Ae.useMemo=function(e,t){return Ft.current.useMemo(e,t)};Ae.useReducer=function(e,t,n){return Ft.current.useReducer(e,t,n)};Ae.useRef=function(e){return Ft.current.useRef(e)};Ae.useState=function(e){return Ft.current.useState(e)};Ae.useSyncExternalStore=function(e,t,n){return Ft.current.useSyncExternalStore(e,t,n)};Ae.useTransition=function(){return Ft.current.useTransition()};Ae.version="18.3.1";VS.exports=Ae;var m=VS.exports;const X=nv(m);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n5=m,r5=Symbol.for("react.element"),s5=Symbol.for("react.fragment"),i5=Object.prototype.hasOwnProperty,o5=n5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a5={key:!0,ref:!0,__self:!0,__source:!0};function ek(e,t,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)i5.call(t,r)&&!a5.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:r5,type:e,key:i,ref:a,props:s,_owner:o5.current}}Oc.Fragment=s5;Oc.jsx=ek;Oc.jsxs=ek;HS.exports=Oc;var o=HS.exports,Mg={},tk={exports:{}},on={},nk={exports:{}},rk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(O,A){var z=O.length;O.push(A);e:for(;0<z;){var $=z-1>>>1,B=O[$];if(0<s(B,A))O[$]=A,O[z]=B,z=$;else break e}}function n(O){return O.length===0?null:O[0]}function r(O){if(O.length===0)return null;var A=O[0],z=O.pop();if(z!==A){O[0]=z;e:for(var $=0,B=O.length,U=B>>>1;$<U;){var G=2*($+1)-1,H=O[G],q=G+1,Q=O[q];if(0>s(H,z))q<B&&0>s(Q,H)?(O[$]=Q,O[q]=z,$=q):(O[$]=H,O[G]=z,$=G);else if(q<B&&0>s(Q,z))O[$]=Q,O[q]=z,$=q;else break e}}return A}function s(O,A){var z=O.sortIndex-A.sortIndex;return z!==0?z:O.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var c=[],d=[],u=1,f=null,p=3,h=!1,v=!1,g=!1,_=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(O){for(var A=n(d);A!==null;){if(A.callback===null)r(d);else if(A.startTime<=O)r(d),A.sortIndex=A.expirationTime,t(c,A);else break;A=n(d)}}function j(O){if(g=!1,b(O),!v)if(n(c)!==null)v=!0,P(N);else{var A=n(d);A!==null&&F(j,A.startTime-O)}}function N(O,A){v=!1,g&&(g=!1,x(k),k=-1),h=!0;var z=p;try{for(b(A),f=n(c);f!==null&&(!(f.expirationTime>A)||O&&!T());){var $=f.callback;if(typeof $=="function"){f.callback=null,p=f.priorityLevel;var B=$(f.expirationTime<=A);A=e.unstable_now(),typeof B=="function"?f.callback=B:f===n(c)&&r(c),b(A)}else r(c);f=n(c)}if(f!==null)var U=!0;else{var G=n(d);G!==null&&F(j,G.startTime-A),U=!1}return U}finally{f=null,p=z,h=!1}}var E=!1,S=null,k=-1,w=5,R=-1;function T(){return!(e.unstable_now()-R<w)}function I(){if(S!==null){var O=e.unstable_now();R=O;var A=!0;try{A=S(!0,O)}finally{A?D():(E=!1,S=null)}}else E=!1}var D;if(typeof y=="function")D=function(){y(I)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,M=C.port2;C.port1.onmessage=I,D=function(){M.postMessage(null)}}else D=function(){_(I,0)};function P(O){S=O,E||(E=!0,D())}function F(O,A){k=_(function(){O(e.unstable_now())},A)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,P(N))},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(O){switch(p){case 1:case 2:case 3:var A=3;break;default:A=p}var z=p;p=A;try{return O()}finally{p=z}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(O,A){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var z=p;p=O;try{return A()}finally{p=z}},e.unstable_scheduleCallback=function(O,A,z){var $=e.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?$+z:$):z=$,O){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=z+B,O={id:u++,callback:A,priorityLevel:O,startTime:z,expirationTime:B,sortIndex:-1},z>$?(O.sortIndex=z,t(d,O),n(c)===null&&O===n(d)&&(g?(x(k),k=-1):g=!0,F(j,z-$))):(O.sortIndex=B,t(c,O),v||h||(v=!0,P(N))),O},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(O){var A=p;return function(){var z=p;p=A;try{return O.apply(this,arguments)}finally{p=z}}}})(rk);nk.exports=rk;var l5=nk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c5=m,rn=l5;function J(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var sk=new Set,Oo={};function Cs(e,t){gi(e,t),gi(e+"Capture",t)}function gi(e,t){for(Oo[e]=t,e=0;e<t.length;e++)sk.add(t[e])}var ur=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Og=Object.prototype.hasOwnProperty,u5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Zy={},Jy={};function d5(e){return Og.call(Jy,e)?!0:Og.call(Zy,e)?!1:u5.test(e)?Jy[e]=!0:(Zy[e]=!0,!1)}function f5(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function p5(e,t,n,r){if(t===null||typeof t>"u"||f5(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function $t(e,t,n,r,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var Et={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Et[e]=new $t(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Et[t]=new $t(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Et[e]=new $t(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Et[e]=new $t(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Et[e]=new $t(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Et[e]=new $t(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Et[e]=new $t(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Et[e]=new $t(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Et[e]=new $t(e,5,!1,e.toLowerCase(),null,!1,!1)});var av=/[\-:]([a-z])/g;function lv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(av,lv);Et[t]=new $t(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(av,lv);Et[t]=new $t(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(av,lv);Et[t]=new $t(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Et[e]=new $t(e,1,!1,e.toLowerCase(),null,!1,!1)});Et.xlinkHref=new $t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Et[e]=new $t(e,1,!1,e.toLowerCase(),null,!0,!0)});function cv(e,t,n,r){var s=Et.hasOwnProperty(t)?Et[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(p5(t,n,s,r)&&(n=null),r||s===null?d5(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var vr=c5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ma=Symbol.for("react.element"),Hs=Symbol.for("react.portal"),Vs=Symbol.for("react.fragment"),uv=Symbol.for("react.strict_mode"),Dg=Symbol.for("react.profiler"),ik=Symbol.for("react.provider"),ok=Symbol.for("react.context"),dv=Symbol.for("react.forward_ref"),Lg=Symbol.for("react.suspense"),zg=Symbol.for("react.suspense_list"),fv=Symbol.for("react.memo"),Sr=Symbol.for("react.lazy"),ak=Symbol.for("react.offscreen"),e0=Symbol.iterator;function Wi(e){return e===null||typeof e!="object"?null:(e=e0&&e[e0]||e["@@iterator"],typeof e=="function"?e:null)}var rt=Object.assign,Du;function co(e){if(Du===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Du=t&&t[1]||""}return`
`+Du+e}var Lu=!1;function zu(e,t){if(!e||Lu)return"";Lu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var c=`
`+s[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=l);break}}}finally{Lu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?co(e):""}function h5(e){switch(e.tag){case 5:return co(e.type);case 16:return co("Lazy");case 13:return co("Suspense");case 19:return co("SuspenseList");case 0:case 2:case 15:return e=zu(e.type,!1),e;case 11:return e=zu(e.type.render,!1),e;case 1:return e=zu(e.type,!0),e;default:return""}}function Fg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Vs:return"Fragment";case Hs:return"Portal";case Dg:return"Profiler";case uv:return"StrictMode";case Lg:return"Suspense";case zg:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ok:return(e.displayName||"Context")+".Consumer";case ik:return(e._context.displayName||"Context")+".Provider";case dv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case fv:return t=e.displayName||null,t!==null?t:Fg(e.type)||"Memo";case Sr:t=e._payload,e=e._init;try{return Fg(e(t))}catch{}}return null}function m5(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fg(t);case 8:return t===uv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Kr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function lk(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function g5(e){var t=lk(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Oa(e){e._valueTracker||(e._valueTracker=g5(e))}function ck(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=lk(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Dl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function $g(e,t){var n=t.checked;return rt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function t0(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Kr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function uk(e,t){t=t.checked,t!=null&&cv(e,"checked",t,!1)}function qg(e,t){uk(e,t);var n=Kr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Bg(e,t.type,n):t.hasOwnProperty("defaultValue")&&Bg(e,t.type,Kr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function n0(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Bg(e,t,n){(t!=="number"||Dl(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var uo=Array.isArray;function oi(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Kr(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Wg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(J(91));return rt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function r0(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(J(92));if(uo(n)){if(1<n.length)throw Error(J(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Kr(n)}}function dk(e,t){var n=Kr(t.value),r=Kr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function s0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function fk(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hg(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?fk(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Da,pk=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Da=Da||document.createElement("div"),Da.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Da.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Do(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var jo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},x5=["Webkit","ms","Moz","O"];Object.keys(jo).forEach(function(e){x5.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),jo[t]=jo[e]})});function hk(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||jo.hasOwnProperty(e)&&jo[e]?(""+t).trim():t+"px"}function mk(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=hk(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var v5=rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vg(e,t){if(t){if(v5[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(J(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(J(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(J(61))}if(t.style!=null&&typeof t.style!="object")throw Error(J(62))}}function Ug(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gg=null;function pv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Kg=null,ai=null,li=null;function i0(e){if(e=xa(e)){if(typeof Kg!="function")throw Error(J(280));var t=e.stateNode;t&&(t=$c(t),Kg(e.stateNode,e.type,t))}}function gk(e){ai?li?li.push(e):li=[e]:ai=e}function xk(){if(ai){var e=ai,t=li;if(li=ai=null,i0(e),t)for(e=0;e<t.length;e++)i0(t[e])}}function vk(e,t){return e(t)}function yk(){}var Fu=!1;function bk(e,t,n){if(Fu)return e(t,n);Fu=!0;try{return vk(e,t,n)}finally{Fu=!1,(ai!==null||li!==null)&&(yk(),xk())}}function Lo(e,t){var n=e.stateNode;if(n===null)return null;var r=$c(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(J(231,t,typeof n));return n}var Yg=!1;if(ur)try{var Hi={};Object.defineProperty(Hi,"passive",{get:function(){Yg=!0}}),window.addEventListener("test",Hi,Hi),window.removeEventListener("test",Hi,Hi)}catch{Yg=!1}function y5(e,t,n,r,s,i,a,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(u){this.onError(u)}}var So=!1,Ll=null,zl=!1,Xg=null,b5={onError:function(e){So=!0,Ll=e}};function _5(e,t,n,r,s,i,a,l,c){So=!1,Ll=null,y5.apply(b5,arguments)}function w5(e,t,n,r,s,i,a,l,c){if(_5.apply(this,arguments),So){if(So){var d=Ll;So=!1,Ll=null}else throw Error(J(198));zl||(zl=!0,Xg=d)}}function Es(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function _k(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function o0(e){if(Es(e)!==e)throw Error(J(188))}function j5(e){var t=e.alternate;if(!t){if(t=Es(e),t===null)throw Error(J(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return o0(s),e;if(i===r)return o0(s),t;i=i.sibling}throw Error(J(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,r=i;break}if(l===r){a=!0,r=s,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=s;break}if(l===r){a=!0,r=i,n=s;break}l=l.sibling}if(!a)throw Error(J(189))}}if(n.alternate!==r)throw Error(J(190))}if(n.tag!==3)throw Error(J(188));return n.stateNode.current===n?e:t}function wk(e){return e=j5(e),e!==null?jk(e):null}function jk(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=jk(e);if(t!==null)return t;e=e.sibling}return null}var Sk=rn.unstable_scheduleCallback,a0=rn.unstable_cancelCallback,S5=rn.unstable_shouldYield,k5=rn.unstable_requestPaint,lt=rn.unstable_now,N5=rn.unstable_getCurrentPriorityLevel,hv=rn.unstable_ImmediatePriority,kk=rn.unstable_UserBlockingPriority,Fl=rn.unstable_NormalPriority,C5=rn.unstable_LowPriority,Nk=rn.unstable_IdlePriority,Dc=null,Hn=null;function E5(e){if(Hn&&typeof Hn.onCommitFiberRoot=="function")try{Hn.onCommitFiberRoot(Dc,e,void 0,(e.current.flags&128)===128)}catch{}}var Rn=Math.clz32?Math.clz32:A5,T5=Math.log,R5=Math.LN2;function A5(e){return e>>>=0,e===0?32:31-(T5(e)/R5|0)|0}var La=64,za=4194304;function fo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function $l(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var l=a&~s;l!==0?r=fo(l):(i&=a,i!==0&&(r=fo(i)))}else a=n&~s,a!==0?r=fo(a):i!==0&&(r=fo(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Rn(t),s=1<<n,r|=e[n],t&=~s;return r}function I5(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function P5(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Rn(i),l=1<<a,c=s[a];c===-1?(!(l&n)||l&r)&&(s[a]=I5(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function Qg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ck(){var e=La;return La<<=1,!(La&4194240)&&(La=64),e}function $u(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ma(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Rn(t),e[t]=n}function M5(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Rn(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function mv(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Rn(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var He=0;function Ek(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Tk,gv,Rk,Ak,Ik,Zg=!1,Fa=[],Dr=null,Lr=null,zr=null,zo=new Map,Fo=new Map,Tr=[],O5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function l0(e,t){switch(e){case"focusin":case"focusout":Dr=null;break;case"dragenter":case"dragleave":Lr=null;break;case"mouseover":case"mouseout":zr=null;break;case"pointerover":case"pointerout":zo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fo.delete(t.pointerId)}}function Vi(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=xa(t),t!==null&&gv(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function D5(e,t,n,r,s){switch(t){case"focusin":return Dr=Vi(Dr,e,t,n,r,s),!0;case"dragenter":return Lr=Vi(Lr,e,t,n,r,s),!0;case"mouseover":return zr=Vi(zr,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return zo.set(i,Vi(zo.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Fo.set(i,Vi(Fo.get(i)||null,e,t,n,r,s)),!0}return!1}function Pk(e){var t=cs(e.target);if(t!==null){var n=Es(t);if(n!==null){if(t=n.tag,t===13){if(t=_k(n),t!==null){e.blockedOn=t,Ik(e.priority,function(){Rk(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function _l(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jg(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Gg=r,n.target.dispatchEvent(r),Gg=null}else return t=xa(n),t!==null&&gv(t),e.blockedOn=n,!1;t.shift()}return!0}function c0(e,t,n){_l(e)&&n.delete(t)}function L5(){Zg=!1,Dr!==null&&_l(Dr)&&(Dr=null),Lr!==null&&_l(Lr)&&(Lr=null),zr!==null&&_l(zr)&&(zr=null),zo.forEach(c0),Fo.forEach(c0)}function Ui(e,t){e.blockedOn===t&&(e.blockedOn=null,Zg||(Zg=!0,rn.unstable_scheduleCallback(rn.unstable_NormalPriority,L5)))}function $o(e){function t(s){return Ui(s,e)}if(0<Fa.length){Ui(Fa[0],e);for(var n=1;n<Fa.length;n++){var r=Fa[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Dr!==null&&Ui(Dr,e),Lr!==null&&Ui(Lr,e),zr!==null&&Ui(zr,e),zo.forEach(t),Fo.forEach(t),n=0;n<Tr.length;n++)r=Tr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Tr.length&&(n=Tr[0],n.blockedOn===null);)Pk(n),n.blockedOn===null&&Tr.shift()}var ci=vr.ReactCurrentBatchConfig,ql=!0;function z5(e,t,n,r){var s=He,i=ci.transition;ci.transition=null;try{He=1,xv(e,t,n,r)}finally{He=s,ci.transition=i}}function F5(e,t,n,r){var s=He,i=ci.transition;ci.transition=null;try{He=4,xv(e,t,n,r)}finally{He=s,ci.transition=i}}function xv(e,t,n,r){if(ql){var s=Jg(e,t,n,r);if(s===null)Xu(e,t,r,Bl,n),l0(e,r);else if(D5(s,e,t,n,r))r.stopPropagation();else if(l0(e,r),t&4&&-1<O5.indexOf(e)){for(;s!==null;){var i=xa(s);if(i!==null&&Tk(i),i=Jg(e,t,n,r),i===null&&Xu(e,t,r,Bl,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Xu(e,t,r,null,n)}}var Bl=null;function Jg(e,t,n,r){if(Bl=null,e=pv(r),e=cs(e),e!==null)if(t=Es(e),t===null)e=null;else if(n=t.tag,n===13){if(e=_k(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Bl=e,null}function Mk(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(N5()){case hv:return 1;case kk:return 4;case Fl:case C5:return 16;case Nk:return 536870912;default:return 16}default:return 16}}var Mr=null,vv=null,wl=null;function Ok(){if(wl)return wl;var e,t=vv,n=t.length,r,s="value"in Mr?Mr.value:Mr.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===s[i-r];r++);return wl=s.slice(e,1<r?1-r:void 0)}function jl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function $a(){return!0}function u0(){return!1}function an(e){function t(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?$a:u0,this.isPropagationStopped=u0,this}return rt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=$a)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=$a)},persist:function(){},isPersistent:$a}),t}var Ri={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yv=an(Ri),ga=rt({},Ri,{view:0,detail:0}),$5=an(ga),qu,Bu,Gi,Lc=rt({},ga,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Gi&&(Gi&&e.type==="mousemove"?(qu=e.screenX-Gi.screenX,Bu=e.screenY-Gi.screenY):Bu=qu=0,Gi=e),qu)},movementY:function(e){return"movementY"in e?e.movementY:Bu}}),d0=an(Lc),q5=rt({},Lc,{dataTransfer:0}),B5=an(q5),W5=rt({},ga,{relatedTarget:0}),Wu=an(W5),H5=rt({},Ri,{animationName:0,elapsedTime:0,pseudoElement:0}),V5=an(H5),U5=rt({},Ri,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),G5=an(U5),K5=rt({},Ri,{data:0}),f0=an(K5),Y5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Q5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Z5(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Q5[e])?!!t[e]:!1}function bv(){return Z5}var J5=rt({},ga,{key:function(e){if(e.key){var t=Y5[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=jl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?X5[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bv,charCode:function(e){return e.type==="keypress"?jl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?jl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),eR=an(J5),tR=rt({},Lc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),p0=an(tR),nR=rt({},ga,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bv}),rR=an(nR),sR=rt({},Ri,{propertyName:0,elapsedTime:0,pseudoElement:0}),iR=an(sR),oR=rt({},Lc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),aR=an(oR),lR=[9,13,27,32],_v=ur&&"CompositionEvent"in window,ko=null;ur&&"documentMode"in document&&(ko=document.documentMode);var cR=ur&&"TextEvent"in window&&!ko,Dk=ur&&(!_v||ko&&8<ko&&11>=ko),h0=" ",m0=!1;function Lk(e,t){switch(e){case"keyup":return lR.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zk(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Us=!1;function uR(e,t){switch(e){case"compositionend":return zk(t);case"keypress":return t.which!==32?null:(m0=!0,h0);case"textInput":return e=t.data,e===h0&&m0?null:e;default:return null}}function dR(e,t){if(Us)return e==="compositionend"||!_v&&Lk(e,t)?(e=Ok(),wl=vv=Mr=null,Us=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dk&&t.locale!=="ko"?null:t.data;default:return null}}var fR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function g0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!fR[e.type]:t==="textarea"}function Fk(e,t,n,r){gk(r),t=Wl(t,"onChange"),0<t.length&&(n=new yv("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var No=null,qo=null;function pR(e){Xk(e,0)}function zc(e){var t=Ys(e);if(ck(t))return e}function hR(e,t){if(e==="change")return t}var $k=!1;if(ur){var Hu;if(ur){var Vu="oninput"in document;if(!Vu){var x0=document.createElement("div");x0.setAttribute("oninput","return;"),Vu=typeof x0.oninput=="function"}Hu=Vu}else Hu=!1;$k=Hu&&(!document.documentMode||9<document.documentMode)}function v0(){No&&(No.detachEvent("onpropertychange",qk),qo=No=null)}function qk(e){if(e.propertyName==="value"&&zc(qo)){var t=[];Fk(t,qo,e,pv(e)),bk(pR,t)}}function mR(e,t,n){e==="focusin"?(v0(),No=t,qo=n,No.attachEvent("onpropertychange",qk)):e==="focusout"&&v0()}function gR(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return zc(qo)}function xR(e,t){if(e==="click")return zc(t)}function vR(e,t){if(e==="input"||e==="change")return zc(t)}function yR(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var In=typeof Object.is=="function"?Object.is:yR;function Bo(e,t){if(In(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Og.call(t,s)||!In(e[s],t[s]))return!1}return!0}function y0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function b0(e,t){var n=y0(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=y0(n)}}function Bk(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Bk(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Wk(){for(var e=window,t=Dl();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Dl(e.document)}return t}function wv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function bR(e){var t=Wk(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Bk(n.ownerDocument.documentElement,n)){if(r!==null&&wv(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=b0(n,i);var a=b0(n,r);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var _R=ur&&"documentMode"in document&&11>=document.documentMode,Gs=null,ex=null,Co=null,tx=!1;function _0(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;tx||Gs==null||Gs!==Dl(r)||(r=Gs,"selectionStart"in r&&wv(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Co&&Bo(Co,r)||(Co=r,r=Wl(ex,"onSelect"),0<r.length&&(t=new yv("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Gs)))}function qa(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ks={animationend:qa("Animation","AnimationEnd"),animationiteration:qa("Animation","AnimationIteration"),animationstart:qa("Animation","AnimationStart"),transitionend:qa("Transition","TransitionEnd")},Uu={},Hk={};ur&&(Hk=document.createElement("div").style,"AnimationEvent"in window||(delete Ks.animationend.animation,delete Ks.animationiteration.animation,delete Ks.animationstart.animation),"TransitionEvent"in window||delete Ks.transitionend.transition);function Fc(e){if(Uu[e])return Uu[e];if(!Ks[e])return e;var t=Ks[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Hk)return Uu[e]=t[n];return e}var Vk=Fc("animationend"),Uk=Fc("animationiteration"),Gk=Fc("animationstart"),Kk=Fc("transitionend"),Yk=new Map,w0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zr(e,t){Yk.set(e,t),Cs(t,[e])}for(var Gu=0;Gu<w0.length;Gu++){var Ku=w0[Gu],wR=Ku.toLowerCase(),jR=Ku[0].toUpperCase()+Ku.slice(1);Zr(wR,"on"+jR)}Zr(Vk,"onAnimationEnd");Zr(Uk,"onAnimationIteration");Zr(Gk,"onAnimationStart");Zr("dblclick","onDoubleClick");Zr("focusin","onFocus");Zr("focusout","onBlur");Zr(Kk,"onTransitionEnd");gi("onMouseEnter",["mouseout","mouseover"]);gi("onMouseLeave",["mouseout","mouseover"]);gi("onPointerEnter",["pointerout","pointerover"]);gi("onPointerLeave",["pointerout","pointerover"]);Cs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Cs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Cs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Cs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Cs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Cs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var po="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),SR=new Set("cancel close invalid load scroll toggle".split(" ").concat(po));function j0(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,w5(r,t,void 0,e),e.currentTarget=null}function Xk(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var l=r[a],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;j0(s,l,d),i=c}else for(a=0;a<r.length;a++){if(l=r[a],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;j0(s,l,d),i=c}}}if(zl)throw e=Xg,zl=!1,Xg=null,e}function Xe(e,t){var n=t[ox];n===void 0&&(n=t[ox]=new Set);var r=e+"__bubble";n.has(r)||(Qk(t,e,2,!1),n.add(r))}function Yu(e,t,n){var r=0;t&&(r|=4),Qk(n,e,r,t)}var Ba="_reactListening"+Math.random().toString(36).slice(2);function Wo(e){if(!e[Ba]){e[Ba]=!0,sk.forEach(function(n){n!=="selectionchange"&&(SR.has(n)||Yu(n,!1,e),Yu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ba]||(t[Ba]=!0,Yu("selectionchange",!1,t))}}function Qk(e,t,n,r){switch(Mk(t)){case 1:var s=z5;break;case 4:s=F5;break;default:s=xv}n=s.bind(null,t,n,e),s=void 0,!Yg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Xu(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;a=a.return}for(;l!==null;){if(a=cs(l),a===null)return;if(c=a.tag,c===5||c===6){r=i=a;continue e}l=l.parentNode}}r=r.return}bk(function(){var d=i,u=pv(n),f=[];e:{var p=Yk.get(e);if(p!==void 0){var h=yv,v=e;switch(e){case"keypress":if(jl(n)===0)break e;case"keydown":case"keyup":h=eR;break;case"focusin":v="focus",h=Wu;break;case"focusout":v="blur",h=Wu;break;case"beforeblur":case"afterblur":h=Wu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=d0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=B5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=rR;break;case Vk:case Uk:case Gk:h=V5;break;case Kk:h=iR;break;case"scroll":h=$5;break;case"wheel":h=aR;break;case"copy":case"cut":case"paste":h=G5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=p0}var g=(t&4)!==0,_=!g&&e==="scroll",x=g?p!==null?p+"Capture":null:p;g=[];for(var y=d,b;y!==null;){b=y;var j=b.stateNode;if(b.tag===5&&j!==null&&(b=j,x!==null&&(j=Lo(y,x),j!=null&&g.push(Ho(y,j,b)))),_)break;y=y.return}0<g.length&&(p=new h(p,v,null,n,u),f.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&n!==Gg&&(v=n.relatedTarget||n.fromElement)&&(cs(v)||v[dr]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(v=n.relatedTarget||n.toElement,h=d,v=v?cs(v):null,v!==null&&(_=Es(v),v!==_||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=d),h!==v)){if(g=d0,j="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=p0,j="onPointerLeave",x="onPointerEnter",y="pointer"),_=h==null?p:Ys(h),b=v==null?p:Ys(v),p=new g(j,y+"leave",h,n,u),p.target=_,p.relatedTarget=b,j=null,cs(u)===d&&(g=new g(x,y+"enter",v,n,u),g.target=b,g.relatedTarget=_,j=g),_=j,h&&v)t:{for(g=h,x=v,y=0,b=g;b;b=Ms(b))y++;for(b=0,j=x;j;j=Ms(j))b++;for(;0<y-b;)g=Ms(g),y--;for(;0<b-y;)x=Ms(x),b--;for(;y--;){if(g===x||x!==null&&g===x.alternate)break t;g=Ms(g),x=Ms(x)}g=null}else g=null;h!==null&&S0(f,p,h,g,!1),v!==null&&_!==null&&S0(f,_,v,g,!0)}}e:{if(p=d?Ys(d):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var N=hR;else if(g0(p))if($k)N=vR;else{N=gR;var E=mR}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(N=xR);if(N&&(N=N(e,d))){Fk(f,N,n,u);break e}E&&E(e,p,d),e==="focusout"&&(E=p._wrapperState)&&E.controlled&&p.type==="number"&&Bg(p,"number",p.value)}switch(E=d?Ys(d):window,e){case"focusin":(g0(E)||E.contentEditable==="true")&&(Gs=E,ex=d,Co=null);break;case"focusout":Co=ex=Gs=null;break;case"mousedown":tx=!0;break;case"contextmenu":case"mouseup":case"dragend":tx=!1,_0(f,n,u);break;case"selectionchange":if(_R)break;case"keydown":case"keyup":_0(f,n,u)}var S;if(_v)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Us?Lk(e,n)&&(k="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(Dk&&n.locale!=="ko"&&(Us||k!=="onCompositionStart"?k==="onCompositionEnd"&&Us&&(S=Ok()):(Mr=u,vv="value"in Mr?Mr.value:Mr.textContent,Us=!0)),E=Wl(d,k),0<E.length&&(k=new f0(k,e,null,n,u),f.push({event:k,listeners:E}),S?k.data=S:(S=zk(n),S!==null&&(k.data=S)))),(S=cR?uR(e,n):dR(e,n))&&(d=Wl(d,"onBeforeInput"),0<d.length&&(u=new f0("onBeforeInput","beforeinput",null,n,u),f.push({event:u,listeners:d}),u.data=S))}Xk(f,t)})}function Ho(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wl(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Lo(e,n),i!=null&&r.unshift(Ho(e,i,s)),i=Lo(e,t),i!=null&&r.push(Ho(e,i,s))),e=e.return}return r}function Ms(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function S0(e,t,n,r,s){for(var i=t._reactName,a=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,s?(c=Lo(n,i),c!=null&&a.unshift(Ho(n,c,l))):s||(c=Lo(n,i),c!=null&&a.push(Ho(n,c,l)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var kR=/\r\n?/g,NR=/\u0000|\uFFFD/g;function k0(e){return(typeof e=="string"?e:""+e).replace(kR,`
`).replace(NR,"")}function Wa(e,t,n){if(t=k0(t),k0(e)!==t&&n)throw Error(J(425))}function Hl(){}var nx=null,rx=null;function sx(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ix=typeof setTimeout=="function"?setTimeout:void 0,CR=typeof clearTimeout=="function"?clearTimeout:void 0,N0=typeof Promise=="function"?Promise:void 0,ER=typeof queueMicrotask=="function"?queueMicrotask:typeof N0<"u"?function(e){return N0.resolve(null).then(e).catch(TR)}:ix;function TR(e){setTimeout(function(){throw e})}function Qu(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),$o(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);$o(t)}function Fr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function C0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Ai=Math.random().toString(36).slice(2),Bn="__reactFiber$"+Ai,Vo="__reactProps$"+Ai,dr="__reactContainer$"+Ai,ox="__reactEvents$"+Ai,RR="__reactListeners$"+Ai,AR="__reactHandles$"+Ai;function cs(e){var t=e[Bn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[dr]||n[Bn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=C0(e);e!==null;){if(n=e[Bn])return n;e=C0(e)}return t}e=n,n=e.parentNode}return null}function xa(e){return e=e[Bn]||e[dr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ys(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(J(33))}function $c(e){return e[Vo]||null}var ax=[],Xs=-1;function Jr(e){return{current:e}}function Qe(e){0>Xs||(e.current=ax[Xs],ax[Xs]=null,Xs--)}function Ge(e,t){Xs++,ax[Xs]=e.current,e.current=t}var Yr={},Pt=Jr(Yr),Ut=Jr(!1),bs=Yr;function xi(e,t){var n=e.type.contextTypes;if(!n)return Yr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Gt(e){return e=e.childContextTypes,e!=null}function Vl(){Qe(Ut),Qe(Pt)}function E0(e,t,n){if(Pt.current!==Yr)throw Error(J(168));Ge(Pt,t),Ge(Ut,n)}function Zk(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(J(108,m5(e)||"Unknown",s));return rt({},n,r)}function Ul(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Yr,bs=Pt.current,Ge(Pt,e),Ge(Ut,Ut.current),!0}function T0(e,t,n){var r=e.stateNode;if(!r)throw Error(J(169));n?(e=Zk(e,t,bs),r.__reactInternalMemoizedMergedChildContext=e,Qe(Ut),Qe(Pt),Ge(Pt,e)):Qe(Ut),Ge(Ut,n)}var tr=null,qc=!1,Zu=!1;function Jk(e){tr===null?tr=[e]:tr.push(e)}function IR(e){qc=!0,Jk(e)}function es(){if(!Zu&&tr!==null){Zu=!0;var e=0,t=He;try{var n=tr;for(He=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}tr=null,qc=!1}catch(s){throw tr!==null&&(tr=tr.slice(e+1)),Sk(hv,es),s}finally{He=t,Zu=!1}}return null}var Qs=[],Zs=0,Gl=null,Kl=0,dn=[],fn=0,_s=null,rr=1,sr="";function os(e,t){Qs[Zs++]=Kl,Qs[Zs++]=Gl,Gl=e,Kl=t}function eN(e,t,n){dn[fn++]=rr,dn[fn++]=sr,dn[fn++]=_s,_s=e;var r=rr;e=sr;var s=32-Rn(r)-1;r&=~(1<<s),n+=1;var i=32-Rn(t)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,rr=1<<32-Rn(t)+s|n<<s|r,sr=i+e}else rr=1<<i|n<<s|r,sr=e}function jv(e){e.return!==null&&(os(e,1),eN(e,1,0))}function Sv(e){for(;e===Gl;)Gl=Qs[--Zs],Qs[Zs]=null,Kl=Qs[--Zs],Qs[Zs]=null;for(;e===_s;)_s=dn[--fn],dn[fn]=null,sr=dn[--fn],dn[fn]=null,rr=dn[--fn],dn[fn]=null}var nn=null,tn=null,Ze=!1,En=null;function tN(e,t){var n=hn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function R0(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,nn=e,tn=Fr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,nn=e,tn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=_s!==null?{id:rr,overflow:sr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=hn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,nn=e,tn=null,!0):!1;default:return!1}}function lx(e){return(e.mode&1)!==0&&(e.flags&128)===0}function cx(e){if(Ze){var t=tn;if(t){var n=t;if(!R0(e,t)){if(lx(e))throw Error(J(418));t=Fr(n.nextSibling);var r=nn;t&&R0(e,t)?tN(r,n):(e.flags=e.flags&-4097|2,Ze=!1,nn=e)}}else{if(lx(e))throw Error(J(418));e.flags=e.flags&-4097|2,Ze=!1,nn=e}}}function A0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;nn=e}function Ha(e){if(e!==nn)return!1;if(!Ze)return A0(e),Ze=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!sx(e.type,e.memoizedProps)),t&&(t=tn)){if(lx(e))throw nN(),Error(J(418));for(;t;)tN(e,t),t=Fr(t.nextSibling)}if(A0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(J(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){tn=Fr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}tn=null}}else tn=nn?Fr(e.stateNode.nextSibling):null;return!0}function nN(){for(var e=tn;e;)e=Fr(e.nextSibling)}function vi(){tn=nn=null,Ze=!1}function kv(e){En===null?En=[e]:En.push(e)}var PR=vr.ReactCurrentBatchConfig;function Ki(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(J(309));var r=n.stateNode}if(!r)throw Error(J(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(J(284));if(!n._owner)throw Error(J(290,e))}return e}function Va(e,t){throw e=Object.prototype.toString.call(t),Error(J(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function I0(e){var t=e._init;return t(e._payload)}function rN(e){function t(x,y){if(e){var b=x.deletions;b===null?(x.deletions=[y],x.flags|=16):b.push(y)}}function n(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function r(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function s(x,y){return x=Wr(x,y),x.index=0,x.sibling=null,x}function i(x,y,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<y?(x.flags|=2,y):b):(x.flags|=2,y)):(x.flags|=1048576,y)}function a(x){return e&&x.alternate===null&&(x.flags|=2),x}function l(x,y,b,j){return y===null||y.tag!==6?(y=id(b,x.mode,j),y.return=x,y):(y=s(y,b),y.return=x,y)}function c(x,y,b,j){var N=b.type;return N===Vs?u(x,y,b.props.children,j,b.key):y!==null&&(y.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Sr&&I0(N)===y.type)?(j=s(y,b.props),j.ref=Ki(x,y,b),j.return=x,j):(j=Rl(b.type,b.key,b.props,null,x.mode,j),j.ref=Ki(x,y,b),j.return=x,j)}function d(x,y,b,j){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=od(b,x.mode,j),y.return=x,y):(y=s(y,b.children||[]),y.return=x,y)}function u(x,y,b,j,N){return y===null||y.tag!==7?(y=gs(b,x.mode,j,N),y.return=x,y):(y=s(y,b),y.return=x,y)}function f(x,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=id(""+y,x.mode,b),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ma:return b=Rl(y.type,y.key,y.props,null,x.mode,b),b.ref=Ki(x,null,y),b.return=x,b;case Hs:return y=od(y,x.mode,b),y.return=x,y;case Sr:var j=y._init;return f(x,j(y._payload),b)}if(uo(y)||Wi(y))return y=gs(y,x.mode,b,null),y.return=x,y;Va(x,y)}return null}function p(x,y,b,j){var N=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return N!==null?null:l(x,y,""+b,j);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ma:return b.key===N?c(x,y,b,j):null;case Hs:return b.key===N?d(x,y,b,j):null;case Sr:return N=b._init,p(x,y,N(b._payload),j)}if(uo(b)||Wi(b))return N!==null?null:u(x,y,b,j,null);Va(x,b)}return null}function h(x,y,b,j,N){if(typeof j=="string"&&j!==""||typeof j=="number")return x=x.get(b)||null,l(y,x,""+j,N);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Ma:return x=x.get(j.key===null?b:j.key)||null,c(y,x,j,N);case Hs:return x=x.get(j.key===null?b:j.key)||null,d(y,x,j,N);case Sr:var E=j._init;return h(x,y,b,E(j._payload),N)}if(uo(j)||Wi(j))return x=x.get(b)||null,u(y,x,j,N,null);Va(y,j)}return null}function v(x,y,b,j){for(var N=null,E=null,S=y,k=y=0,w=null;S!==null&&k<b.length;k++){S.index>k?(w=S,S=null):w=S.sibling;var R=p(x,S,b[k],j);if(R===null){S===null&&(S=w);break}e&&S&&R.alternate===null&&t(x,S),y=i(R,y,k),E===null?N=R:E.sibling=R,E=R,S=w}if(k===b.length)return n(x,S),Ze&&os(x,k),N;if(S===null){for(;k<b.length;k++)S=f(x,b[k],j),S!==null&&(y=i(S,y,k),E===null?N=S:E.sibling=S,E=S);return Ze&&os(x,k),N}for(S=r(x,S);k<b.length;k++)w=h(S,x,k,b[k],j),w!==null&&(e&&w.alternate!==null&&S.delete(w.key===null?k:w.key),y=i(w,y,k),E===null?N=w:E.sibling=w,E=w);return e&&S.forEach(function(T){return t(x,T)}),Ze&&os(x,k),N}function g(x,y,b,j){var N=Wi(b);if(typeof N!="function")throw Error(J(150));if(b=N.call(b),b==null)throw Error(J(151));for(var E=N=null,S=y,k=y=0,w=null,R=b.next();S!==null&&!R.done;k++,R=b.next()){S.index>k?(w=S,S=null):w=S.sibling;var T=p(x,S,R.value,j);if(T===null){S===null&&(S=w);break}e&&S&&T.alternate===null&&t(x,S),y=i(T,y,k),E===null?N=T:E.sibling=T,E=T,S=w}if(R.done)return n(x,S),Ze&&os(x,k),N;if(S===null){for(;!R.done;k++,R=b.next())R=f(x,R.value,j),R!==null&&(y=i(R,y,k),E===null?N=R:E.sibling=R,E=R);return Ze&&os(x,k),N}for(S=r(x,S);!R.done;k++,R=b.next())R=h(S,x,k,R.value,j),R!==null&&(e&&R.alternate!==null&&S.delete(R.key===null?k:R.key),y=i(R,y,k),E===null?N=R:E.sibling=R,E=R);return e&&S.forEach(function(I){return t(x,I)}),Ze&&os(x,k),N}function _(x,y,b,j){if(typeof b=="object"&&b!==null&&b.type===Vs&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ma:e:{for(var N=b.key,E=y;E!==null;){if(E.key===N){if(N=b.type,N===Vs){if(E.tag===7){n(x,E.sibling),y=s(E,b.props.children),y.return=x,x=y;break e}}else if(E.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Sr&&I0(N)===E.type){n(x,E.sibling),y=s(E,b.props),y.ref=Ki(x,E,b),y.return=x,x=y;break e}n(x,E);break}else t(x,E);E=E.sibling}b.type===Vs?(y=gs(b.props.children,x.mode,j,b.key),y.return=x,x=y):(j=Rl(b.type,b.key,b.props,null,x.mode,j),j.ref=Ki(x,y,b),j.return=x,x=j)}return a(x);case Hs:e:{for(E=b.key;y!==null;){if(y.key===E)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(x,y.sibling),y=s(y,b.children||[]),y.return=x,x=y;break e}else{n(x,y);break}else t(x,y);y=y.sibling}y=od(b,x.mode,j),y.return=x,x=y}return a(x);case Sr:return E=b._init,_(x,y,E(b._payload),j)}if(uo(b))return v(x,y,b,j);if(Wi(b))return g(x,y,b,j);Va(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(x,y.sibling),y=s(y,b),y.return=x,x=y):(n(x,y),y=id(b,x.mode,j),y.return=x,x=y),a(x)):n(x,y)}return _}var yi=rN(!0),sN=rN(!1),Yl=Jr(null),Xl=null,Js=null,Nv=null;function Cv(){Nv=Js=Xl=null}function Ev(e){var t=Yl.current;Qe(Yl),e._currentValue=t}function ux(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ui(e,t){Xl=e,Nv=Js=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Wt=!0),e.firstContext=null)}function xn(e){var t=e._currentValue;if(Nv!==e)if(e={context:e,memoizedValue:t,next:null},Js===null){if(Xl===null)throw Error(J(308));Js=e,Xl.dependencies={lanes:0,firstContext:e}}else Js=Js.next=e;return t}var us=null;function Tv(e){us===null?us=[e]:us.push(e)}function iN(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Tv(t)):(n.next=s.next,s.next=n),t.interleaved=n,fr(e,r)}function fr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var kr=!1;function Rv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oN(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function lr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function $r(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Le&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,fr(e,n)}return s=r.interleaved,s===null?(t.next=t,Tv(r)):(t.next=s.next,s.next=t),r.interleaved=t,fr(e,n)}function Sl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,mv(e,n)}}function P0(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ql(e,t,n,r){var s=e.updateQueue;kr=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,a===null?i=d:a.next=d,a=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==a&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;a=0,u=d=c=null,l=i;do{var p=l.lane,h=l.eventTime;if((r&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,g=l;switch(p=t,h=n,g.tag){case 1:if(v=g.payload,typeof v=="function"){f=v.call(h,f,p);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,p=typeof v=="function"?v.call(h,f,p):v,p==null)break e;f=rt({},f,p);break e;case 2:kr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=h,c=f):u=u.next=h,a|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(u===null&&(c=f),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);js|=a,e.lanes=a,e.memoizedState=f}}function M0(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(J(191,s));s.call(r)}}}var va={},Vn=Jr(va),Uo=Jr(va),Go=Jr(va);function ds(e){if(e===va)throw Error(J(174));return e}function Av(e,t){switch(Ge(Go,t),Ge(Uo,e),Ge(Vn,va),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Hg(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Hg(t,e)}Qe(Vn),Ge(Vn,t)}function bi(){Qe(Vn),Qe(Uo),Qe(Go)}function aN(e){ds(Go.current);var t=ds(Vn.current),n=Hg(t,e.type);t!==n&&(Ge(Uo,e),Ge(Vn,n))}function Iv(e){Uo.current===e&&(Qe(Vn),Qe(Uo))}var tt=Jr(0);function Zl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ju=[];function Pv(){for(var e=0;e<Ju.length;e++)Ju[e]._workInProgressVersionPrimary=null;Ju.length=0}var kl=vr.ReactCurrentDispatcher,ed=vr.ReactCurrentBatchConfig,ws=0,nt=null,ht=null,yt=null,Jl=!1,Eo=!1,Ko=0,MR=0;function Rt(){throw Error(J(321))}function Mv(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!In(e[n],t[n]))return!1;return!0}function Ov(e,t,n,r,s,i){if(ws=i,nt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,kl.current=e===null||e.memoizedState===null?zR:FR,e=n(r,s),Eo){i=0;do{if(Eo=!1,Ko=0,25<=i)throw Error(J(301));i+=1,yt=ht=null,t.updateQueue=null,kl.current=$R,e=n(r,s)}while(Eo)}if(kl.current=ec,t=ht!==null&&ht.next!==null,ws=0,yt=ht=nt=null,Jl=!1,t)throw Error(J(300));return e}function Dv(){var e=Ko!==0;return Ko=0,e}function qn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yt===null?nt.memoizedState=yt=e:yt=yt.next=e,yt}function vn(){if(ht===null){var e=nt.alternate;e=e!==null?e.memoizedState:null}else e=ht.next;var t=yt===null?nt.memoizedState:yt.next;if(t!==null)yt=t,ht=e;else{if(e===null)throw Error(J(310));ht=e,e={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},yt===null?nt.memoizedState=yt=e:yt=yt.next=e}return yt}function Yo(e,t){return typeof t=="function"?t(e):t}function td(e){var t=vn(),n=t.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=e;var r=ht,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=a=null,c=null,d=i;do{var u=d.lane;if((ws&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,a=r):c=c.next=f,nt.lanes|=u,js|=u}d=d.next}while(d!==null&&d!==i);c===null?a=r:c.next=l,In(r,t.memoizedState)||(Wt=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,nt.lanes|=i,js|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function nd(e){var t=vn(),n=t.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);In(i,t.memoizedState)||(Wt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function lN(){}function cN(e,t){var n=nt,r=vn(),s=t(),i=!In(r.memoizedState,s);if(i&&(r.memoizedState=s,Wt=!0),r=r.queue,Lv(fN.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||yt!==null&&yt.memoizedState.tag&1){if(n.flags|=2048,Xo(9,dN.bind(null,n,r,s,t),void 0,null),_t===null)throw Error(J(349));ws&30||uN(n,t,s)}return s}function uN(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=nt.updateQueue,t===null?(t={lastEffect:null,stores:null},nt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function dN(e,t,n,r){t.value=n,t.getSnapshot=r,pN(t)&&hN(e)}function fN(e,t,n){return n(function(){pN(t)&&hN(e)})}function pN(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!In(e,n)}catch{return!0}}function hN(e){var t=fr(e,1);t!==null&&An(t,e,1,-1)}function O0(e){var t=qn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yo,lastRenderedState:e},t.queue=e,e=e.dispatch=LR.bind(null,nt,e),[t.memoizedState,e]}function Xo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=nt.updateQueue,t===null?(t={lastEffect:null,stores:null},nt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function mN(){return vn().memoizedState}function Nl(e,t,n,r){var s=qn();nt.flags|=e,s.memoizedState=Xo(1|t,n,void 0,r===void 0?null:r)}function Bc(e,t,n,r){var s=vn();r=r===void 0?null:r;var i=void 0;if(ht!==null){var a=ht.memoizedState;if(i=a.destroy,r!==null&&Mv(r,a.deps)){s.memoizedState=Xo(t,n,i,r);return}}nt.flags|=e,s.memoizedState=Xo(1|t,n,i,r)}function D0(e,t){return Nl(8390656,8,e,t)}function Lv(e,t){return Bc(2048,8,e,t)}function gN(e,t){return Bc(4,2,e,t)}function xN(e,t){return Bc(4,4,e,t)}function vN(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function yN(e,t,n){return n=n!=null?n.concat([e]):null,Bc(4,4,vN.bind(null,t,e),n)}function zv(){}function bN(e,t){var n=vn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Mv(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function _N(e,t){var n=vn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Mv(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function wN(e,t,n){return ws&21?(In(n,t)||(n=Ck(),nt.lanes|=n,js|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Wt=!0),e.memoizedState=n)}function OR(e,t){var n=He;He=n!==0&&4>n?n:4,e(!0);var r=ed.transition;ed.transition={};try{e(!1),t()}finally{He=n,ed.transition=r}}function jN(){return vn().memoizedState}function DR(e,t,n){var r=Br(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},SN(e))kN(t,n);else if(n=iN(e,t,n,r),n!==null){var s=zt();An(n,e,r,s),NN(n,t,r)}}function LR(e,t,n){var r=Br(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(SN(e))kN(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,l=i(a,n);if(s.hasEagerState=!0,s.eagerState=l,In(l,a)){var c=t.interleaved;c===null?(s.next=s,Tv(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=iN(e,t,s,r),n!==null&&(s=zt(),An(n,e,r,s),NN(n,t,r))}}function SN(e){var t=e.alternate;return e===nt||t!==null&&t===nt}function kN(e,t){Eo=Jl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function NN(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,mv(e,n)}}var ec={readContext:xn,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useInsertionEffect:Rt,useLayoutEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useMutableSource:Rt,useSyncExternalStore:Rt,useId:Rt,unstable_isNewReconciler:!1},zR={readContext:xn,useCallback:function(e,t){return qn().memoizedState=[e,t===void 0?null:t],e},useContext:xn,useEffect:D0,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Nl(4194308,4,vN.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Nl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Nl(4,2,e,t)},useMemo:function(e,t){var n=qn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=qn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=DR.bind(null,nt,e),[r.memoizedState,e]},useRef:function(e){var t=qn();return e={current:e},t.memoizedState=e},useState:O0,useDebugValue:zv,useDeferredValue:function(e){return qn().memoizedState=e},useTransition:function(){var e=O0(!1),t=e[0];return e=OR.bind(null,e[1]),qn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=nt,s=qn();if(Ze){if(n===void 0)throw Error(J(407));n=n()}else{if(n=t(),_t===null)throw Error(J(349));ws&30||uN(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,D0(fN.bind(null,r,i,e),[e]),r.flags|=2048,Xo(9,dN.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=qn(),t=_t.identifierPrefix;if(Ze){var n=sr,r=rr;n=(r&~(1<<32-Rn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ko++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=MR++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},FR={readContext:xn,useCallback:bN,useContext:xn,useEffect:Lv,useImperativeHandle:yN,useInsertionEffect:gN,useLayoutEffect:xN,useMemo:_N,useReducer:td,useRef:mN,useState:function(){return td(Yo)},useDebugValue:zv,useDeferredValue:function(e){var t=vn();return wN(t,ht.memoizedState,e)},useTransition:function(){var e=td(Yo)[0],t=vn().memoizedState;return[e,t]},useMutableSource:lN,useSyncExternalStore:cN,useId:jN,unstable_isNewReconciler:!1},$R={readContext:xn,useCallback:bN,useContext:xn,useEffect:Lv,useImperativeHandle:yN,useInsertionEffect:gN,useLayoutEffect:xN,useMemo:_N,useReducer:nd,useRef:mN,useState:function(){return nd(Yo)},useDebugValue:zv,useDeferredValue:function(e){var t=vn();return ht===null?t.memoizedState=e:wN(t,ht.memoizedState,e)},useTransition:function(){var e=nd(Yo)[0],t=vn().memoizedState;return[e,t]},useMutableSource:lN,useSyncExternalStore:cN,useId:jN,unstable_isNewReconciler:!1};function kn(e,t){if(e&&e.defaultProps){t=rt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function dx(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:rt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Wc={isMounted:function(e){return(e=e._reactInternals)?Es(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=zt(),s=Br(e),i=lr(r,s);i.payload=t,n!=null&&(i.callback=n),t=$r(e,i,s),t!==null&&(An(t,e,s,r),Sl(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=zt(),s=Br(e),i=lr(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=$r(e,i,s),t!==null&&(An(t,e,s,r),Sl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=zt(),r=Br(e),s=lr(n,r);s.tag=2,t!=null&&(s.callback=t),t=$r(e,s,r),t!==null&&(An(t,e,r,n),Sl(t,e,r))}};function L0(e,t,n,r,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!Bo(n,r)||!Bo(s,i):!0}function CN(e,t,n){var r=!1,s=Yr,i=t.contextType;return typeof i=="object"&&i!==null?i=xn(i):(s=Gt(t)?bs:Pt.current,r=t.contextTypes,i=(r=r!=null)?xi(e,s):Yr),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Wc,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function z0(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Wc.enqueueReplaceState(t,t.state,null)}function fx(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Rv(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=xn(i):(i=Gt(t)?bs:Pt.current,s.context=xi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(dx(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Wc.enqueueReplaceState(s,s.state,null),Ql(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function _i(e,t){try{var n="",r=t;do n+=h5(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function rd(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function px(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var qR=typeof WeakMap=="function"?WeakMap:Map;function EN(e,t,n){n=lr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){nc||(nc=!0,jx=r),px(e,t)},n}function TN(e,t,n){n=lr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){px(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){px(e,t),typeof r!="function"&&(qr===null?qr=new Set([this]):qr.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function F0(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new qR;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=tA.bind(null,e,t,n),t.then(e,e))}function $0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function q0(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=lr(-1,1),t.tag=2,$r(n,t,1))),n.lanes|=1),e)}var BR=vr.ReactCurrentOwner,Wt=!1;function Dt(e,t,n,r){t.child=e===null?sN(t,null,n,r):yi(t,e.child,n,r)}function B0(e,t,n,r,s){n=n.render;var i=t.ref;return ui(t,s),r=Ov(e,t,n,r,i,s),n=Dv(),e!==null&&!Wt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,pr(e,t,s)):(Ze&&n&&jv(t),t.flags|=1,Dt(e,t,r,s),t.child)}function W0(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!Uv(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,RN(e,t,i,r,s)):(e=Rl(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Bo,n(a,r)&&e.ref===t.ref)return pr(e,t,s)}return t.flags|=1,e=Wr(i,r),e.ref=t.ref,e.return=t,t.child=e}function RN(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(Bo(i,r)&&e.ref===t.ref)if(Wt=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Wt=!0);else return t.lanes=e.lanes,pr(e,t,s)}return hx(e,t,n,r,s)}function AN(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ge(ti,Jt),Jt|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ge(ti,Jt),Jt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ge(ti,Jt),Jt|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ge(ti,Jt),Jt|=r;return Dt(e,t,s,n),t.child}function IN(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function hx(e,t,n,r,s){var i=Gt(n)?bs:Pt.current;return i=xi(t,i),ui(t,s),n=Ov(e,t,n,r,i,s),r=Dv(),e!==null&&!Wt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,pr(e,t,s)):(Ze&&r&&jv(t),t.flags|=1,Dt(e,t,n,s),t.child)}function H0(e,t,n,r,s){if(Gt(n)){var i=!0;Ul(t)}else i=!1;if(ui(t,s),t.stateNode===null)Cl(e,t),CN(t,n,r),fx(t,n,r,s),r=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var c=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=xn(d):(d=Gt(n)?bs:Pt.current,d=xi(t,d));var u=n.getDerivedStateFromProps,f=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==r||c!==d)&&z0(t,a,r,d),kr=!1;var p=t.memoizedState;a.state=p,Ql(t,r,a,s),c=t.memoizedState,l!==r||p!==c||Ut.current||kr?(typeof u=="function"&&(dx(t,n,u,r),c=t.memoizedState),(l=kr||L0(t,n,l,r,p,c,d))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),a.props=r,a.state=c,a.context=d,r=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,oN(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:kn(t.type,l),a.props=d,f=t.pendingProps,p=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=xn(c):(c=Gt(n)?bs:Pt.current,c=xi(t,c));var h=n.getDerivedStateFromProps;(u=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==f||p!==c)&&z0(t,a,r,c),kr=!1,p=t.memoizedState,a.state=p,Ql(t,r,a,s);var v=t.memoizedState;l!==f||p!==v||Ut.current||kr?(typeof h=="function"&&(dx(t,n,h,r),v=t.memoizedState),(d=kr||L0(t,n,d,r,p,v,c)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,v,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,v,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=v),a.props=r,a.state=v,a.context=c,r=d):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return mx(e,t,n,r,i,s)}function mx(e,t,n,r,s,i){IN(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return s&&T0(t,n,!1),pr(e,t,i);r=t.stateNode,BR.current=t;var l=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=yi(t,e.child,null,i),t.child=yi(t,null,l,i)):Dt(e,t,l,i),t.memoizedState=r.state,s&&T0(t,n,!0),t.child}function PN(e){var t=e.stateNode;t.pendingContext?E0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&E0(e,t.context,!1),Av(e,t.containerInfo)}function V0(e,t,n,r,s){return vi(),kv(s),t.flags|=256,Dt(e,t,n,r),t.child}var gx={dehydrated:null,treeContext:null,retryLane:0};function xx(e){return{baseLanes:e,cachePool:null,transitions:null}}function MN(e,t,n){var r=t.pendingProps,s=tt.current,i=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ge(tt,s&1),e===null)return cx(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Uc(a,r,0,null),e=gs(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=xx(n),t.memoizedState=gx,e):Fv(t,a));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return WR(e,t,a,r,l,s,n);if(i){i=r.fallback,a=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Wr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Wr(l,i):(i=gs(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?xx(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=gx,r}return i=e.child,e=i.sibling,r=Wr(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Fv(e,t){return t=Uc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ua(e,t,n,r){return r!==null&&kv(r),yi(t,e.child,null,n),e=Fv(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function WR(e,t,n,r,s,i,a){if(n)return t.flags&256?(t.flags&=-257,r=rd(Error(J(422))),Ua(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Uc({mode:"visible",children:r.children},s,0,null),i=gs(i,s,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&yi(t,e.child,null,a),t.child.memoizedState=xx(a),t.memoizedState=gx,i);if(!(t.mode&1))return Ua(e,t,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(J(419)),r=rd(i,r,void 0),Ua(e,t,a,r)}if(l=(a&e.childLanes)!==0,Wt||l){if(r=_t,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,fr(e,s),An(r,e,s,-1))}return Vv(),r=rd(Error(J(421))),Ua(e,t,a,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=nA.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,tn=Fr(s.nextSibling),nn=t,Ze=!0,En=null,e!==null&&(dn[fn++]=rr,dn[fn++]=sr,dn[fn++]=_s,rr=e.id,sr=e.overflow,_s=t),t=Fv(t,r.children),t.flags|=4096,t)}function U0(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ux(e.return,t,n)}function sd(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function ON(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(Dt(e,t,r.children,n),r=tt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&U0(e,n,t);else if(e.tag===19)U0(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ge(tt,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Zl(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),sd(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Zl(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}sd(t,!0,n,null,i);break;case"together":sd(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Cl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function pr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),js|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(J(153));if(t.child!==null){for(e=t.child,n=Wr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Wr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function HR(e,t,n){switch(t.tag){case 3:PN(t),vi();break;case 5:aN(t);break;case 1:Gt(t.type)&&Ul(t);break;case 4:Av(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Ge(Yl,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ge(tt,tt.current&1),t.flags|=128,null):n&t.child.childLanes?MN(e,t,n):(Ge(tt,tt.current&1),e=pr(e,t,n),e!==null?e.sibling:null);Ge(tt,tt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return ON(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ge(tt,tt.current),r)break;return null;case 22:case 23:return t.lanes=0,AN(e,t,n)}return pr(e,t,n)}var DN,vx,LN,zN;DN=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};vx=function(){};LN=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,ds(Vn.current);var i=null;switch(n){case"input":s=$g(e,s),r=$g(e,r),i=[];break;case"select":s=rt({},s,{value:void 0}),r=rt({},r,{value:void 0}),i=[];break;case"textarea":s=Wg(e,s),r=Wg(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Hl)}Vg(n,r);var a;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Oo.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Oo.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Xe("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};zN=function(e,t,n,r){n!==r&&(t.flags|=4)};function Yi(e,t){if(!Ze)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function At(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function VR(e,t,n){var r=t.pendingProps;switch(Sv(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(t),null;case 1:return Gt(t.type)&&Vl(),At(t),null;case 3:return r=t.stateNode,bi(),Qe(Ut),Qe(Pt),Pv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ha(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,En!==null&&(Nx(En),En=null))),vx(e,t),At(t),null;case 5:Iv(t);var s=ds(Go.current);if(n=t.type,e!==null&&t.stateNode!=null)LN(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(J(166));return At(t),null}if(e=ds(Vn.current),Ha(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Bn]=t,r[Vo]=i,e=(t.mode&1)!==0,n){case"dialog":Xe("cancel",r),Xe("close",r);break;case"iframe":case"object":case"embed":Xe("load",r);break;case"video":case"audio":for(s=0;s<po.length;s++)Xe(po[s],r);break;case"source":Xe("error",r);break;case"img":case"image":case"link":Xe("error",r),Xe("load",r);break;case"details":Xe("toggle",r);break;case"input":t0(r,i),Xe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Xe("invalid",r);break;case"textarea":r0(r,i),Xe("invalid",r)}Vg(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Wa(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Wa(r.textContent,l,e),s=["children",""+l]):Oo.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Xe("scroll",r)}switch(n){case"input":Oa(r),n0(r,i,!0);break;case"textarea":Oa(r),s0(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Hl)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=fk(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Bn]=t,e[Vo]=r,DN(e,t,!1,!1),t.stateNode=e;e:{switch(a=Ug(n,r),n){case"dialog":Xe("cancel",e),Xe("close",e),s=r;break;case"iframe":case"object":case"embed":Xe("load",e),s=r;break;case"video":case"audio":for(s=0;s<po.length;s++)Xe(po[s],e);s=r;break;case"source":Xe("error",e),s=r;break;case"img":case"image":case"link":Xe("error",e),Xe("load",e),s=r;break;case"details":Xe("toggle",e),s=r;break;case"input":t0(e,r),s=$g(e,r),Xe("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=rt({},r,{value:void 0}),Xe("invalid",e);break;case"textarea":r0(e,r),s=Wg(e,r),Xe("invalid",e);break;default:s=r}Vg(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?mk(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&pk(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Do(e,c):typeof c=="number"&&Do(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Oo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Xe("scroll",e):c!=null&&cv(e,i,c,a))}switch(n){case"input":Oa(e),n0(e,r,!1);break;case"textarea":Oa(e),s0(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Kr(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?oi(e,!!r.multiple,i,!1):r.defaultValue!=null&&oi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Hl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return At(t),null;case 6:if(e&&t.stateNode!=null)zN(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(J(166));if(n=ds(Go.current),ds(Vn.current),Ha(t)){if(r=t.stateNode,n=t.memoizedProps,r[Bn]=t,(i=r.nodeValue!==n)&&(e=nn,e!==null))switch(e.tag){case 3:Wa(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Wa(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Bn]=t,t.stateNode=r}return At(t),null;case 13:if(Qe(tt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ze&&tn!==null&&t.mode&1&&!(t.flags&128))nN(),vi(),t.flags|=98560,i=!1;else if(i=Ha(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(J(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(J(317));i[Bn]=t}else vi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;At(t),i=!1}else En!==null&&(Nx(En),En=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||tt.current&1?xt===0&&(xt=3):Vv())),t.updateQueue!==null&&(t.flags|=4),At(t),null);case 4:return bi(),vx(e,t),e===null&&Wo(t.stateNode.containerInfo),At(t),null;case 10:return Ev(t.type._context),At(t),null;case 17:return Gt(t.type)&&Vl(),At(t),null;case 19:if(Qe(tt),i=t.memoizedState,i===null)return At(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)Yi(i,!1);else{if(xt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Zl(e),a!==null){for(t.flags|=128,Yi(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ge(tt,tt.current&1|2),t.child}e=e.sibling}i.tail!==null&&lt()>wi&&(t.flags|=128,r=!0,Yi(i,!1),t.lanes=4194304)}else{if(!r)if(e=Zl(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Yi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Ze)return At(t),null}else 2*lt()-i.renderingStartTime>wi&&n!==1073741824&&(t.flags|=128,r=!0,Yi(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=lt(),t.sibling=null,n=tt.current,Ge(tt,r?n&1|2:n&1),t):(At(t),null);case 22:case 23:return Hv(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Jt&1073741824&&(At(t),t.subtreeFlags&6&&(t.flags|=8192)):At(t),null;case 24:return null;case 25:return null}throw Error(J(156,t.tag))}function UR(e,t){switch(Sv(t),t.tag){case 1:return Gt(t.type)&&Vl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return bi(),Qe(Ut),Qe(Pt),Pv(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Iv(t),null;case 13:if(Qe(tt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(J(340));vi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Qe(tt),null;case 4:return bi(),null;case 10:return Ev(t.type._context),null;case 22:case 23:return Hv(),null;case 24:return null;default:return null}}var Ga=!1,It=!1,GR=typeof WeakSet=="function"?WeakSet:Set,le=null;function ei(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){it(e,t,r)}else n.current=null}function yx(e,t,n){try{n()}catch(r){it(e,t,r)}}var G0=!1;function KR(e,t){if(nx=ql,e=Wk(),wv(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,l=-1,c=-1,d=0,u=0,f=e,p=null;t:for(;;){for(var h;f!==n||s!==0&&f.nodeType!==3||(l=a+s),f!==i||r!==0&&f.nodeType!==3||(c=a+r),f.nodeType===3&&(a+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===n&&++d===s&&(l=a),p===i&&++u===r&&(c=a),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(rx={focusedElem:e,selectionRange:n},ql=!1,le=t;le!==null;)if(t=le,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,le=e;else for(;le!==null;){t=le;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,_=v.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:kn(t.type,g),_);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(j){it(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,le=e;break}le=t.return}return v=G0,G0=!1,v}function To(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&yx(t,n,i)}s=s.next}while(s!==r)}}function Hc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function bx(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function FN(e){var t=e.alternate;t!==null&&(e.alternate=null,FN(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Bn],delete t[Vo],delete t[ox],delete t[RR],delete t[AR])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function $N(e){return e.tag===5||e.tag===3||e.tag===4}function K0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||$N(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function _x(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Hl));else if(r!==4&&(e=e.child,e!==null))for(_x(e,t,n),e=e.sibling;e!==null;)_x(e,t,n),e=e.sibling}function wx(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(wx(e,t,n),e=e.sibling;e!==null;)wx(e,t,n),e=e.sibling}var kt=null,Nn=!1;function _r(e,t,n){for(n=n.child;n!==null;)qN(e,t,n),n=n.sibling}function qN(e,t,n){if(Hn&&typeof Hn.onCommitFiberUnmount=="function")try{Hn.onCommitFiberUnmount(Dc,n)}catch{}switch(n.tag){case 5:It||ei(n,t);case 6:var r=kt,s=Nn;kt=null,_r(e,t,n),kt=r,Nn=s,kt!==null&&(Nn?(e=kt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):kt.removeChild(n.stateNode));break;case 18:kt!==null&&(Nn?(e=kt,n=n.stateNode,e.nodeType===8?Qu(e.parentNode,n):e.nodeType===1&&Qu(e,n),$o(e)):Qu(kt,n.stateNode));break;case 4:r=kt,s=Nn,kt=n.stateNode.containerInfo,Nn=!0,_r(e,t,n),kt=r,Nn=s;break;case 0:case 11:case 14:case 15:if(!It&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&yx(n,t,a),s=s.next}while(s!==r)}_r(e,t,n);break;case 1:if(!It&&(ei(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){it(n,t,l)}_r(e,t,n);break;case 21:_r(e,t,n);break;case 22:n.mode&1?(It=(r=It)||n.memoizedState!==null,_r(e,t,n),It=r):_r(e,t,n);break;default:_r(e,t,n)}}function Y0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new GR),t.forEach(function(r){var s=rA.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function jn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:kt=l.stateNode,Nn=!1;break e;case 3:kt=l.stateNode.containerInfo,Nn=!0;break e;case 4:kt=l.stateNode.containerInfo,Nn=!0;break e}l=l.return}if(kt===null)throw Error(J(160));qN(i,a,s),kt=null,Nn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){it(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)BN(t,e),t=t.sibling}function BN(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(jn(t,e),Fn(e),r&4){try{To(3,e,e.return),Hc(3,e)}catch(g){it(e,e.return,g)}try{To(5,e,e.return)}catch(g){it(e,e.return,g)}}break;case 1:jn(t,e),Fn(e),r&512&&n!==null&&ei(n,n.return);break;case 5:if(jn(t,e),Fn(e),r&512&&n!==null&&ei(n,n.return),e.flags&32){var s=e.stateNode;try{Do(s,"")}catch(g){it(e,e.return,g)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&uk(s,i),Ug(l,a);var d=Ug(l,i);for(a=0;a<c.length;a+=2){var u=c[a],f=c[a+1];u==="style"?mk(s,f):u==="dangerouslySetInnerHTML"?pk(s,f):u==="children"?Do(s,f):cv(s,u,f,d)}switch(l){case"input":qg(s,i);break;case"textarea":dk(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?oi(s,!!i.multiple,h,!1):p!==!!i.multiple&&(i.defaultValue!=null?oi(s,!!i.multiple,i.defaultValue,!0):oi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Vo]=i}catch(g){it(e,e.return,g)}}break;case 6:if(jn(t,e),Fn(e),r&4){if(e.stateNode===null)throw Error(J(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(g){it(e,e.return,g)}}break;case 3:if(jn(t,e),Fn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{$o(t.containerInfo)}catch(g){it(e,e.return,g)}break;case 4:jn(t,e),Fn(e);break;case 13:jn(t,e),Fn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Bv=lt())),r&4&&Y0(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(It=(d=It)||u,jn(t,e),It=d):jn(t,e),Fn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(le=e,u=e.child;u!==null;){for(f=le=u;le!==null;){switch(p=le,h=p.child,p.tag){case 0:case 11:case 14:case 15:To(4,p,p.return);break;case 1:ei(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){it(r,n,g)}}break;case 5:ei(p,p.return);break;case 22:if(p.memoizedState!==null){Q0(f);continue}}h!==null?(h.return=p,le=h):Q0(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=hk("display",a))}catch(g){it(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(g){it(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:jn(t,e),Fn(e),r&4&&Y0(e);break;case 21:break;default:jn(t,e),Fn(e)}}function Fn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if($N(n)){var r=n;break e}n=n.return}throw Error(J(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Do(s,""),r.flags&=-33);var i=K0(e);wx(e,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,l=K0(e);_x(e,l,a);break;default:throw Error(J(161))}}catch(c){it(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function YR(e,t,n){le=e,WN(e)}function WN(e,t,n){for(var r=(e.mode&1)!==0;le!==null;){var s=le,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Ga;if(!a){var l=s.alternate,c=l!==null&&l.memoizedState!==null||It;l=Ga;var d=It;if(Ga=a,(It=c)&&!d)for(le=s;le!==null;)a=le,c=a.child,a.tag===22&&a.memoizedState!==null?Z0(s):c!==null?(c.return=a,le=c):Z0(s);for(;i!==null;)le=i,WN(i),i=i.sibling;le=s,Ga=l,It=d}X0(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,le=i):X0(e)}}function X0(e){for(;le!==null;){var t=le;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:It||Hc(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!It)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:kn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&M0(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}M0(t,a,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&$o(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}It||t.flags&512&&bx(t)}catch(p){it(t,t.return,p)}}if(t===e){le=null;break}if(n=t.sibling,n!==null){n.return=t.return,le=n;break}le=t.return}}function Q0(e){for(;le!==null;){var t=le;if(t===e){le=null;break}var n=t.sibling;if(n!==null){n.return=t.return,le=n;break}le=t.return}}function Z0(e){for(;le!==null;){var t=le;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Hc(4,t)}catch(c){it(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){it(t,s,c)}}var i=t.return;try{bx(t)}catch(c){it(t,i,c)}break;case 5:var a=t.return;try{bx(t)}catch(c){it(t,a,c)}}}catch(c){it(t,t.return,c)}if(t===e){le=null;break}var l=t.sibling;if(l!==null){l.return=t.return,le=l;break}le=t.return}}var XR=Math.ceil,tc=vr.ReactCurrentDispatcher,$v=vr.ReactCurrentOwner,gn=vr.ReactCurrentBatchConfig,Le=0,_t=null,ut=null,Nt=0,Jt=0,ti=Jr(0),xt=0,Qo=null,js=0,Vc=0,qv=0,Ro=null,Bt=null,Bv=0,wi=1/0,er=null,nc=!1,jx=null,qr=null,Ka=!1,Or=null,rc=0,Ao=0,Sx=null,El=-1,Tl=0;function zt(){return Le&6?lt():El!==-1?El:El=lt()}function Br(e){return e.mode&1?Le&2&&Nt!==0?Nt&-Nt:PR.transition!==null?(Tl===0&&(Tl=Ck()),Tl):(e=He,e!==0||(e=window.event,e=e===void 0?16:Mk(e.type)),e):1}function An(e,t,n,r){if(50<Ao)throw Ao=0,Sx=null,Error(J(185));ma(e,n,r),(!(Le&2)||e!==_t)&&(e===_t&&(!(Le&2)&&(Vc|=n),xt===4&&Rr(e,Nt)),Kt(e,r),n===1&&Le===0&&!(t.mode&1)&&(wi=lt()+500,qc&&es()))}function Kt(e,t){var n=e.callbackNode;P5(e,t);var r=$l(e,e===_t?Nt:0);if(r===0)n!==null&&a0(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&a0(n),t===1)e.tag===0?IR(J0.bind(null,e)):Jk(J0.bind(null,e)),ER(function(){!(Le&6)&&es()}),n=null;else{switch(Ek(r)){case 1:n=hv;break;case 4:n=kk;break;case 16:n=Fl;break;case 536870912:n=Nk;break;default:n=Fl}n=QN(n,HN.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function HN(e,t){if(El=-1,Tl=0,Le&6)throw Error(J(327));var n=e.callbackNode;if(di()&&e.callbackNode!==n)return null;var r=$l(e,e===_t?Nt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=sc(e,r);else{t=r;var s=Le;Le|=2;var i=UN();(_t!==e||Nt!==t)&&(er=null,wi=lt()+500,ms(e,t));do try{JR();break}catch(l){VN(e,l)}while(!0);Cv(),tc.current=i,Le=s,ut!==null?t=0:(_t=null,Nt=0,t=xt)}if(t!==0){if(t===2&&(s=Qg(e),s!==0&&(r=s,t=kx(e,s))),t===1)throw n=Qo,ms(e,0),Rr(e,r),Kt(e,lt()),n;if(t===6)Rr(e,r);else{if(s=e.current.alternate,!(r&30)&&!QR(s)&&(t=sc(e,r),t===2&&(i=Qg(e),i!==0&&(r=i,t=kx(e,i))),t===1))throw n=Qo,ms(e,0),Rr(e,r),Kt(e,lt()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(J(345));case 2:as(e,Bt,er);break;case 3:if(Rr(e,r),(r&130023424)===r&&(t=Bv+500-lt(),10<t)){if($l(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){zt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=ix(as.bind(null,e,Bt,er),t);break}as(e,Bt,er);break;case 4:if(Rr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var a=31-Rn(r);i=1<<a,a=t[a],a>s&&(s=a),r&=~i}if(r=s,r=lt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*XR(r/1960))-r,10<r){e.timeoutHandle=ix(as.bind(null,e,Bt,er),r);break}as(e,Bt,er);break;case 5:as(e,Bt,er);break;default:throw Error(J(329))}}}return Kt(e,lt()),e.callbackNode===n?HN.bind(null,e):null}function kx(e,t){var n=Ro;return e.current.memoizedState.isDehydrated&&(ms(e,t).flags|=256),e=sc(e,t),e!==2&&(t=Bt,Bt=n,t!==null&&Nx(t)),e}function Nx(e){Bt===null?Bt=e:Bt.push.apply(Bt,e)}function QR(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!In(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Rr(e,t){for(t&=~qv,t&=~Vc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Rn(t),r=1<<n;e[n]=-1,t&=~r}}function J0(e){if(Le&6)throw Error(J(327));di();var t=$l(e,0);if(!(t&1))return Kt(e,lt()),null;var n=sc(e,t);if(e.tag!==0&&n===2){var r=Qg(e);r!==0&&(t=r,n=kx(e,r))}if(n===1)throw n=Qo,ms(e,0),Rr(e,t),Kt(e,lt()),n;if(n===6)throw Error(J(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,as(e,Bt,er),Kt(e,lt()),null}function Wv(e,t){var n=Le;Le|=1;try{return e(t)}finally{Le=n,Le===0&&(wi=lt()+500,qc&&es())}}function Ss(e){Or!==null&&Or.tag===0&&!(Le&6)&&di();var t=Le;Le|=1;var n=gn.transition,r=He;try{if(gn.transition=null,He=1,e)return e()}finally{He=r,gn.transition=n,Le=t,!(Le&6)&&es()}}function Hv(){Jt=ti.current,Qe(ti)}function ms(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,CR(n)),ut!==null)for(n=ut.return;n!==null;){var r=n;switch(Sv(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Vl();break;case 3:bi(),Qe(Ut),Qe(Pt),Pv();break;case 5:Iv(r);break;case 4:bi();break;case 13:Qe(tt);break;case 19:Qe(tt);break;case 10:Ev(r.type._context);break;case 22:case 23:Hv()}n=n.return}if(_t=e,ut=e=Wr(e.current,null),Nt=Jt=t,xt=0,Qo=null,qv=Vc=js=0,Bt=Ro=null,us!==null){for(t=0;t<us.length;t++)if(n=us[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}us=null}return e}function VN(e,t){do{var n=ut;try{if(Cv(),kl.current=ec,Jl){for(var r=nt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Jl=!1}if(ws=0,yt=ht=nt=null,Eo=!1,Ko=0,$v.current=null,n===null||n.return===null){xt=1,Qo=t,ut=null;break}e:{var i=e,a=n.return,l=n,c=t;if(t=Nt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=$0(a);if(h!==null){h.flags&=-257,q0(h,a,l,i,t),h.mode&1&&F0(i,d,t),t=h,c=d;var v=t.updateQueue;if(v===null){var g=new Set;g.add(c),t.updateQueue=g}else v.add(c);break e}else{if(!(t&1)){F0(i,d,t),Vv();break e}c=Error(J(426))}}else if(Ze&&l.mode&1){var _=$0(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),q0(_,a,l,i,t),kv(_i(c,l));break e}}i=c=_i(c,l),xt!==4&&(xt=2),Ro===null?Ro=[i]:Ro.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=EN(i,c,t);P0(i,x);break e;case 1:l=c;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(qr===null||!qr.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var j=TN(i,l,t);P0(i,j);break e}}i=i.return}while(i!==null)}KN(n)}catch(N){t=N,ut===n&&n!==null&&(ut=n=n.return);continue}break}while(!0)}function UN(){var e=tc.current;return tc.current=ec,e===null?ec:e}function Vv(){(xt===0||xt===3||xt===2)&&(xt=4),_t===null||!(js&268435455)&&!(Vc&268435455)||Rr(_t,Nt)}function sc(e,t){var n=Le;Le|=2;var r=UN();(_t!==e||Nt!==t)&&(er=null,ms(e,t));do try{ZR();break}catch(s){VN(e,s)}while(!0);if(Cv(),Le=n,tc.current=r,ut!==null)throw Error(J(261));return _t=null,Nt=0,xt}function ZR(){for(;ut!==null;)GN(ut)}function JR(){for(;ut!==null&&!S5();)GN(ut)}function GN(e){var t=XN(e.alternate,e,Jt);e.memoizedProps=e.pendingProps,t===null?KN(e):ut=t,$v.current=null}function KN(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=UR(n,t),n!==null){n.flags&=32767,ut=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{xt=6,ut=null;return}}else if(n=VR(n,t,Jt),n!==null){ut=n;return}if(t=t.sibling,t!==null){ut=t;return}ut=t=e}while(t!==null);xt===0&&(xt=5)}function as(e,t,n){var r=He,s=gn.transition;try{gn.transition=null,He=1,eA(e,t,n,r)}finally{gn.transition=s,He=r}return null}function eA(e,t,n,r){do di();while(Or!==null);if(Le&6)throw Error(J(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(J(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(M5(e,i),e===_t&&(ut=_t=null,Nt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ka||(Ka=!0,QN(Fl,function(){return di(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=gn.transition,gn.transition=null;var a=He;He=1;var l=Le;Le|=4,$v.current=null,KR(e,n),BN(n,e),bR(rx),ql=!!nx,rx=nx=null,e.current=n,YR(n),k5(),Le=l,He=a,gn.transition=i}else e.current=n;if(Ka&&(Ka=!1,Or=e,rc=s),i=e.pendingLanes,i===0&&(qr=null),E5(n.stateNode),Kt(e,lt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(nc)throw nc=!1,e=jx,jx=null,e;return rc&1&&e.tag!==0&&di(),i=e.pendingLanes,i&1?e===Sx?Ao++:(Ao=0,Sx=e):Ao=0,es(),null}function di(){if(Or!==null){var e=Ek(rc),t=gn.transition,n=He;try{if(gn.transition=null,He=16>e?16:e,Or===null)var r=!1;else{if(e=Or,Or=null,rc=0,Le&6)throw Error(J(331));var s=Le;for(Le|=4,le=e.current;le!==null;){var i=le,a=i.child;if(le.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(le=d;le!==null;){var u=le;switch(u.tag){case 0:case 11:case 15:To(8,u,i)}var f=u.child;if(f!==null)f.return=u,le=f;else for(;le!==null;){u=le;var p=u.sibling,h=u.return;if(FN(u),u===d){le=null;break}if(p!==null){p.return=h,le=p;break}le=h}}}var v=i.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var _=g.sibling;g.sibling=null,g=_}while(g!==null)}}le=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,le=a;else e:for(;le!==null;){if(i=le,i.flags&2048)switch(i.tag){case 0:case 11:case 15:To(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,le=x;break e}le=i.return}}var y=e.current;for(le=y;le!==null;){a=le;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,le=b;else e:for(a=y;le!==null;){if(l=le,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Hc(9,l)}}catch(N){it(l,l.return,N)}if(l===a){le=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,le=j;break e}le=l.return}}if(Le=s,es(),Hn&&typeof Hn.onPostCommitFiberRoot=="function")try{Hn.onPostCommitFiberRoot(Dc,e)}catch{}r=!0}return r}finally{He=n,gn.transition=t}}return!1}function eb(e,t,n){t=_i(n,t),t=EN(e,t,1),e=$r(e,t,1),t=zt(),e!==null&&(ma(e,1,t),Kt(e,t))}function it(e,t,n){if(e.tag===3)eb(e,e,n);else for(;t!==null;){if(t.tag===3){eb(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(qr===null||!qr.has(r))){e=_i(n,e),e=TN(t,e,1),t=$r(t,e,1),e=zt(),t!==null&&(ma(t,1,e),Kt(t,e));break}}t=t.return}}function tA(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=zt(),e.pingedLanes|=e.suspendedLanes&n,_t===e&&(Nt&n)===n&&(xt===4||xt===3&&(Nt&130023424)===Nt&&500>lt()-Bv?ms(e,0):qv|=n),Kt(e,t)}function YN(e,t){t===0&&(e.mode&1?(t=za,za<<=1,!(za&130023424)&&(za=4194304)):t=1);var n=zt();e=fr(e,t),e!==null&&(ma(e,t,n),Kt(e,n))}function nA(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),YN(e,n)}function rA(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(J(314))}r!==null&&r.delete(t),YN(e,n)}var XN;XN=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ut.current)Wt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Wt=!1,HR(e,t,n);Wt=!!(e.flags&131072)}else Wt=!1,Ze&&t.flags&1048576&&eN(t,Kl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Cl(e,t),e=t.pendingProps;var s=xi(t,Pt.current);ui(t,n),s=Ov(null,t,r,e,s,n);var i=Dv();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Gt(r)?(i=!0,Ul(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Rv(t),s.updater=Wc,t.stateNode=s,s._reactInternals=t,fx(t,r,e,n),t=mx(null,t,r,!0,i,n)):(t.tag=0,Ze&&i&&jv(t),Dt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Cl(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=iA(r),e=kn(r,e),s){case 0:t=hx(null,t,r,e,n);break e;case 1:t=H0(null,t,r,e,n);break e;case 11:t=B0(null,t,r,e,n);break e;case 14:t=W0(null,t,r,kn(r.type,e),n);break e}throw Error(J(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:kn(r,s),hx(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:kn(r,s),H0(e,t,r,s,n);case 3:e:{if(PN(t),e===null)throw Error(J(387));r=t.pendingProps,i=t.memoizedState,s=i.element,oN(e,t),Ql(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=_i(Error(J(423)),t),t=V0(e,t,r,n,s);break e}else if(r!==s){s=_i(Error(J(424)),t),t=V0(e,t,r,n,s);break e}else for(tn=Fr(t.stateNode.containerInfo.firstChild),nn=t,Ze=!0,En=null,n=sN(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(vi(),r===s){t=pr(e,t,n);break e}Dt(e,t,r,n)}t=t.child}return t;case 5:return aN(t),e===null&&cx(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,sx(r,s)?a=null:i!==null&&sx(r,i)&&(t.flags|=32),IN(e,t),Dt(e,t,a,n),t.child;case 6:return e===null&&cx(t),null;case 13:return MN(e,t,n);case 4:return Av(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=yi(t,null,r,n):Dt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:kn(r,s),B0(e,t,r,s,n);case 7:return Dt(e,t,t.pendingProps,n),t.child;case 8:return Dt(e,t,t.pendingProps.children,n),t.child;case 12:return Dt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,Ge(Yl,r._currentValue),r._currentValue=a,i!==null)if(In(i.value,a)){if(i.children===s.children&&!Ut.current){t=pr(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=lr(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),ux(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(J(341));a.lanes|=n,l=a.alternate,l!==null&&(l.lanes|=n),ux(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Dt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,ui(t,n),s=xn(s),r=r(s),t.flags|=1,Dt(e,t,r,n),t.child;case 14:return r=t.type,s=kn(r,t.pendingProps),s=kn(r.type,s),W0(e,t,r,s,n);case 15:return RN(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:kn(r,s),Cl(e,t),t.tag=1,Gt(r)?(e=!0,Ul(t)):e=!1,ui(t,n),CN(t,r,s),fx(t,r,s,n),mx(null,t,r,!0,e,n);case 19:return ON(e,t,n);case 22:return AN(e,t,n)}throw Error(J(156,t.tag))};function QN(e,t){return Sk(e,t)}function sA(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hn(e,t,n,r){return new sA(e,t,n,r)}function Uv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function iA(e){if(typeof e=="function")return Uv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===dv)return 11;if(e===fv)return 14}return 2}function Wr(e,t){var n=e.alternate;return n===null?(n=hn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rl(e,t,n,r,s,i){var a=2;if(r=e,typeof e=="function")Uv(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Vs:return gs(n.children,s,i,t);case uv:a=8,s|=8;break;case Dg:return e=hn(12,n,t,s|2),e.elementType=Dg,e.lanes=i,e;case Lg:return e=hn(13,n,t,s),e.elementType=Lg,e.lanes=i,e;case zg:return e=hn(19,n,t,s),e.elementType=zg,e.lanes=i,e;case ak:return Uc(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ik:a=10;break e;case ok:a=9;break e;case dv:a=11;break e;case fv:a=14;break e;case Sr:a=16,r=null;break e}throw Error(J(130,e==null?e:typeof e,""))}return t=hn(a,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function gs(e,t,n,r){return e=hn(7,e,r,t),e.lanes=n,e}function Uc(e,t,n,r){return e=hn(22,e,r,t),e.elementType=ak,e.lanes=n,e.stateNode={isHidden:!1},e}function id(e,t,n){return e=hn(6,e,null,t),e.lanes=n,e}function od(e,t,n){return t=hn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function oA(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$u(0),this.expirationTimes=$u(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$u(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Gv(e,t,n,r,s,i,a,l,c){return e=new oA(e,t,n,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=hn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rv(i),e}function aA(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hs,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function ZN(e){if(!e)return Yr;e=e._reactInternals;e:{if(Es(e)!==e||e.tag!==1)throw Error(J(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Gt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(J(171))}if(e.tag===1){var n=e.type;if(Gt(n))return Zk(e,n,t)}return t}function JN(e,t,n,r,s,i,a,l,c){return e=Gv(n,r,!0,e,s,i,a,l,c),e.context=ZN(null),n=e.current,r=zt(),s=Br(n),i=lr(r,s),i.callback=t??null,$r(n,i,s),e.current.lanes=s,ma(e,s,r),Kt(e,r),e}function Gc(e,t,n,r){var s=t.current,i=zt(),a=Br(s);return n=ZN(n),t.context===null?t.context=n:t.pendingContext=n,t=lr(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=$r(s,t,a),e!==null&&(An(e,s,a,i),Sl(e,s,a)),a}function ic(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function tb(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Kv(e,t){tb(e,t),(e=e.alternate)&&tb(e,t)}function lA(){return null}var eC=typeof reportError=="function"?reportError:function(e){console.error(e)};function Yv(e){this._internalRoot=e}Kc.prototype.render=Yv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(J(409));Gc(e,t,null,null)};Kc.prototype.unmount=Yv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ss(function(){Gc(null,e,null,null)}),t[dr]=null}};function Kc(e){this._internalRoot=e}Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ak();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Tr.length&&t!==0&&t<Tr[n].priority;n++);Tr.splice(n,0,e),n===0&&Pk(e)}};function Xv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Yc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function nb(){}function cA(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=ic(a);i.call(d)}}var a=JN(t,r,e,0,null,!1,!1,"",nb);return e._reactRootContainer=a,e[dr]=a.current,Wo(e.nodeType===8?e.parentNode:e),Ss(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=ic(c);l.call(d)}}var c=Gv(e,0,!1,null,null,!1,!1,"",nb);return e._reactRootContainer=c,e[dr]=c.current,Wo(e.nodeType===8?e.parentNode:e),Ss(function(){Gc(t,c,n,r)}),c}function Xc(e,t,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var c=ic(a);l.call(c)}}Gc(t,a,e,s)}else a=cA(n,t,e,s,r);return ic(a)}Tk=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=fo(t.pendingLanes);n!==0&&(mv(t,n|1),Kt(t,lt()),!(Le&6)&&(wi=lt()+500,es()))}break;case 13:Ss(function(){var r=fr(e,1);if(r!==null){var s=zt();An(r,e,1,s)}}),Kv(e,1)}};gv=function(e){if(e.tag===13){var t=fr(e,134217728);if(t!==null){var n=zt();An(t,e,134217728,n)}Kv(e,134217728)}};Rk=function(e){if(e.tag===13){var t=Br(e),n=fr(e,t);if(n!==null){var r=zt();An(n,e,t,r)}Kv(e,t)}};Ak=function(){return He};Ik=function(e,t){var n=He;try{return He=e,t()}finally{He=n}};Kg=function(e,t,n){switch(t){case"input":if(qg(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=$c(r);if(!s)throw Error(J(90));ck(r),qg(r,s)}}}break;case"textarea":dk(e,n);break;case"select":t=n.value,t!=null&&oi(e,!!n.multiple,t,!1)}};vk=Wv;yk=Ss;var uA={usingClientEntryPoint:!1,Events:[xa,Ys,$c,gk,xk,Wv]},Xi={findFiberByHostInstance:cs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dA={bundleType:Xi.bundleType,version:Xi.version,rendererPackageName:Xi.rendererPackageName,rendererConfig:Xi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=wk(e),e===null?null:e.stateNode},findFiberByHostInstance:Xi.findFiberByHostInstance||lA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ya=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ya.isDisabled&&Ya.supportsFiber)try{Dc=Ya.inject(dA),Hn=Ya}catch{}}on.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uA;on.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xv(t))throw Error(J(200));return aA(e,t,null,n)};on.createRoot=function(e,t){if(!Xv(e))throw Error(J(299));var n=!1,r="",s=eC;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Gv(e,1,!1,null,null,n,!1,r,s),e[dr]=t.current,Wo(e.nodeType===8?e.parentNode:e),new Yv(t)};on.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(J(188)):(e=Object.keys(e).join(","),Error(J(268,e)));return e=wk(t),e=e===null?null:e.stateNode,e};on.flushSync=function(e){return Ss(e)};on.hydrate=function(e,t,n){if(!Yc(t))throw Error(J(200));return Xc(null,e,t,!0,n)};on.hydrateRoot=function(e,t,n){if(!Xv(e))throw Error(J(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=eC;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=JN(t,null,e,1,n??null,s,!1,i,a),e[dr]=t.current,Wo(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Kc(t)};on.render=function(e,t,n){if(!Yc(t))throw Error(J(200));return Xc(null,e,t,!1,n)};on.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(J(40));return e._reactRootContainer?(Ss(function(){Xc(null,null,e,!1,function(){e._reactRootContainer=null,e[dr]=null})}),!0):!1};on.unstable_batchedUpdates=Wv;on.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Yc(n))throw Error(J(200));if(e==null||e._reactInternals===void 0)throw Error(J(38));return Xc(e,t,n,!1,r)};on.version="18.3.1-next-f1338f8080-20240426";function tC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tC)}catch(e){console.error(e)}}tC(),tk.exports=on;var ni=tk.exports,rb=ni;Mg.createRoot=rb.createRoot,Mg.hydrateRoot=rb.hydrateRoot;function Xt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=Xt(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var nC={exports:{}},rC={},sC={exports:{}},iC={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ji=m;function fA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var pA=typeof Object.is=="function"?Object.is:fA,hA=ji.useState,mA=ji.useEffect,gA=ji.useLayoutEffect,xA=ji.useDebugValue;function vA(e,t){var n=t(),r=hA({inst:{value:n,getSnapshot:t}}),s=r[0].inst,i=r[1];return gA(function(){s.value=n,s.getSnapshot=t,ad(s)&&i({inst:s})},[e,n,t]),mA(function(){return ad(s)&&i({inst:s}),e(function(){ad(s)&&i({inst:s})})},[e]),xA(n),n}function ad(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!pA(e,n)}catch{return!0}}function yA(e,t){return t()}var bA=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?yA:vA;iC.useSyncExternalStore=ji.useSyncExternalStore!==void 0?ji.useSyncExternalStore:bA;sC.exports=iC;var _A=sC.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qc=m,wA=_A;function jA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var SA=typeof Object.is=="function"?Object.is:jA,kA=wA.useSyncExternalStore,NA=Qc.useRef,CA=Qc.useEffect,EA=Qc.useMemo,TA=Qc.useDebugValue;rC.useSyncExternalStoreWithSelector=function(e,t,n,r,s){var i=NA(null);if(i.current===null){var a={hasValue:!1,value:null};i.current=a}else a=i.current;i=EA(function(){function c(h){if(!d){if(d=!0,u=h,h=r(h),s!==void 0&&a.hasValue){var v=a.value;if(s(v,h))return f=v}return f=h}if(v=f,SA(u,h))return v;var g=r(h);return s!==void 0&&s(v,g)?(u=h,v):(u=h,f=g)}var d=!1,u,f,p=n===void 0?null:n;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,n,r,s]);var l=kA(e,i[0],i[1]);return CA(function(){a.hasValue=!0,a.value=l},[l]),TA(l),l};nC.exports=rC;var RA=nC.exports;const AA=nv(RA),IA={},sb=e=>{let t;const n=new Set,r=(u,f)=>{const p=typeof u=="function"?u(t):u;if(!Object.is(p,t)){const h=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),n.forEach(v=>v(t,h))}},s=()=>t,c={setState:r,getState:s,getInitialState:()=>d,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(IA?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=t=e(r,s,c);return c},PA=e=>e?sb(e):sb,{useDebugValue:MA}=X,{useSyncExternalStoreWithSelector:OA}=AA,DA=e=>e;function oC(e,t=DA,n){const r=OA(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return MA(r),r}const ib=(e,t)=>{const n=PA(e),r=(s,i=t)=>oC(n,s,i);return Object.assign(r,n),r},LA=(e,t)=>e?ib(e,t):ib;function Mt(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var zA={value:()=>{}};function Zc(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Al(n)}function Al(e){this._=e}function FA(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Al.prototype=Zc.prototype={constructor:Al,on:function(e,t){var n=this._,r=FA(e+"",n),s,i=-1,a=r.length;if(arguments.length<2){for(;++i<a;)if((s=(e=r[i]).type)&&(s=$A(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(s=(e=r[i]).type)n[s]=ob(n[s],e.name,t);else if(t==null)for(s in n)n[s]=ob(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Al(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,i;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],s=0,i=r.length;s<i;++s)r[s].value.apply(t,n)}};function $A(e,t){for(var n=0,r=e.length,s;n<r;++n)if((s=e[n]).name===t)return s.value}function ob(e,t,n){for(var r=0,s=e.length;r<s;++r)if(e[r].name===t){e[r]=zA,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Cx="http://www.w3.org/1999/xhtml";const ab={svg:"http://www.w3.org/2000/svg",xhtml:Cx,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Jc(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),ab.hasOwnProperty(t)?{space:ab[t],local:e}:e}function qA(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Cx&&t.documentElement.namespaceURI===Cx?t.createElement(e):t.createElementNS(n,e)}}function BA(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function aC(e){var t=Jc(e);return(t.local?BA:qA)(t)}function WA(){}function Qv(e){return e==null?WA:function(){return this.querySelector(e)}}function HA(e){typeof e!="function"&&(e=Qv(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,l=r[s]=new Array(a),c,d,u=0;u<a;++u)(c=i[u])&&(d=e.call(c,c.__data__,u,i))&&("__data__"in c&&(d.__data__=c.__data__),l[u]=d);return new sn(r,this._parents)}function VA(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function UA(){return[]}function lC(e){return e==null?UA:function(){return this.querySelectorAll(e)}}function GA(e){return function(){return VA(e.apply(this,arguments))}}function KA(e){typeof e=="function"?e=GA(e):e=lC(e);for(var t=this._groups,n=t.length,r=[],s=[],i=0;i<n;++i)for(var a=t[i],l=a.length,c,d=0;d<l;++d)(c=a[d])&&(r.push(e.call(c,c.__data__,d,a)),s.push(c));return new sn(r,s)}function cC(e){return function(){return this.matches(e)}}function uC(e){return function(t){return t.matches(e)}}var YA=Array.prototype.find;function XA(e){return function(){return YA.call(this.children,e)}}function QA(){return this.firstElementChild}function ZA(e){return this.select(e==null?QA:XA(typeof e=="function"?e:uC(e)))}var JA=Array.prototype.filter;function eI(){return Array.from(this.children)}function tI(e){return function(){return JA.call(this.children,e)}}function nI(e){return this.selectAll(e==null?eI:tI(typeof e=="function"?e:uC(e)))}function rI(e){typeof e!="function"&&(e=cC(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,l=r[s]=[],c,d=0;d<a;++d)(c=i[d])&&e.call(c,c.__data__,d,i)&&l.push(c);return new sn(r,this._parents)}function dC(e){return new Array(e.length)}function sI(){return new sn(this._enter||this._groups.map(dC),this._parents)}function oc(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}oc.prototype={constructor:oc,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function iI(e){return function(){return e}}function oI(e,t,n,r,s,i){for(var a=0,l,c=t.length,d=i.length;a<d;++a)(l=t[a])?(l.__data__=i[a],r[a]=l):n[a]=new oc(e,i[a]);for(;a<c;++a)(l=t[a])&&(s[a]=l)}function aI(e,t,n,r,s,i,a){var l,c,d=new Map,u=t.length,f=i.length,p=new Array(u),h;for(l=0;l<u;++l)(c=t[l])&&(p[l]=h=a.call(c,c.__data__,l,t)+"",d.has(h)?s[l]=c:d.set(h,c));for(l=0;l<f;++l)h=a.call(e,i[l],l,i)+"",(c=d.get(h))?(r[l]=c,c.__data__=i[l],d.delete(h)):n[l]=new oc(e,i[l]);for(l=0;l<u;++l)(c=t[l])&&d.get(p[l])===c&&(s[l]=c)}function lI(e){return e.__data__}function cI(e,t){if(!arguments.length)return Array.from(this,lI);var n=t?aI:oI,r=this._parents,s=this._groups;typeof e!="function"&&(e=iI(e));for(var i=s.length,a=new Array(i),l=new Array(i),c=new Array(i),d=0;d<i;++d){var u=r[d],f=s[d],p=f.length,h=uI(e.call(u,u&&u.__data__,d,r)),v=h.length,g=l[d]=new Array(v),_=a[d]=new Array(v),x=c[d]=new Array(p);n(u,f,g,_,x,h,t);for(var y=0,b=0,j,N;y<v;++y)if(j=g[y]){for(y>=b&&(b=y+1);!(N=_[b])&&++b<v;);j._next=N||null}}return a=new sn(a,r),a._enter=l,a._exit=c,a}function uI(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function dI(){return new sn(this._exit||this._groups.map(dC),this._parents)}function fI(e,t,n){var r=this.enter(),s=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function pI(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,s=n.length,i=r.length,a=Math.min(s,i),l=new Array(s),c=0;c<a;++c)for(var d=n[c],u=r[c],f=d.length,p=l[c]=new Array(f),h,v=0;v<f;++v)(h=d[v]||u[v])&&(p[v]=h);for(;c<s;++c)l[c]=n[c];return new sn(l,this._parents)}function hI(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],s=r.length-1,i=r[s],a;--s>=0;)(a=r[s])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function mI(e){e||(e=gI);function t(f,p){return f&&p?e(f.__data__,p.__data__):!f-!p}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var a=n[i],l=a.length,c=s[i]=new Array(l),d,u=0;u<l;++u)(d=a[u])&&(c[u]=d);c.sort(t)}return new sn(s,this._parents).order()}function gI(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function xI(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function vI(){return Array.from(this)}function yI(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length;s<i;++s){var a=r[s];if(a)return a}return null}function bI(){let e=0;for(const t of this)++e;return e}function _I(){return!this.node()}function wI(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var s=t[n],i=0,a=s.length,l;i<a;++i)(l=s[i])&&e.call(l,l.__data__,i,s);return this}function jI(e){return function(){this.removeAttribute(e)}}function SI(e){return function(){this.removeAttributeNS(e.space,e.local)}}function kI(e,t){return function(){this.setAttribute(e,t)}}function NI(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function CI(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function EI(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function TI(e,t){var n=Jc(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?SI:jI:typeof t=="function"?n.local?EI:CI:n.local?NI:kI)(n,t))}function fC(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function RI(e){return function(){this.style.removeProperty(e)}}function AI(e,t,n){return function(){this.style.setProperty(e,t,n)}}function II(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function PI(e,t,n){return arguments.length>1?this.each((t==null?RI:typeof t=="function"?II:AI)(e,t,n??"")):Si(this.node(),e)}function Si(e,t){return e.style.getPropertyValue(t)||fC(e).getComputedStyle(e,null).getPropertyValue(t)}function MI(e){return function(){delete this[e]}}function OI(e,t){return function(){this[e]=t}}function DI(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function LI(e,t){return arguments.length>1?this.each((t==null?MI:typeof t=="function"?DI:OI)(e,t)):this.node()[e]}function pC(e){return e.trim().split(/^|\s+/)}function Zv(e){return e.classList||new hC(e)}function hC(e){this._node=e,this._names=pC(e.getAttribute("class")||"")}hC.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function mC(e,t){for(var n=Zv(e),r=-1,s=t.length;++r<s;)n.add(t[r])}function gC(e,t){for(var n=Zv(e),r=-1,s=t.length;++r<s;)n.remove(t[r])}function zI(e){return function(){mC(this,e)}}function FI(e){return function(){gC(this,e)}}function $I(e,t){return function(){(t.apply(this,arguments)?mC:gC)(this,e)}}function qI(e,t){var n=pC(e+"");if(arguments.length<2){for(var r=Zv(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?$I:t?zI:FI)(n,t))}function BI(){this.textContent=""}function WI(e){return function(){this.textContent=e}}function HI(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function VI(e){return arguments.length?this.each(e==null?BI:(typeof e=="function"?HI:WI)(e)):this.node().textContent}function UI(){this.innerHTML=""}function GI(e){return function(){this.innerHTML=e}}function KI(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function YI(e){return arguments.length?this.each(e==null?UI:(typeof e=="function"?KI:GI)(e)):this.node().innerHTML}function XI(){this.nextSibling&&this.parentNode.appendChild(this)}function QI(){return this.each(XI)}function ZI(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function JI(){return this.each(ZI)}function e6(e){var t=typeof e=="function"?e:aC(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function t6(){return null}function n6(e,t){var n=typeof e=="function"?e:aC(e),r=t==null?t6:typeof t=="function"?t:Qv(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function r6(){var e=this.parentNode;e&&e.removeChild(this)}function s6(){return this.each(r6)}function i6(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function o6(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function a6(e){return this.select(e?o6:i6)}function l6(e){return arguments.length?this.property("__data__",e):this.node().__data__}function c6(e){return function(t){e.call(this,t,this.__data__)}}function u6(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function d6(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,s=t.length,i;n<s;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function f6(e,t,n){return function(){var r=this.__on,s,i=c6(t);if(r){for(var a=0,l=r.length;a<l;++a)if((s=r[a]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=t;return}}this.addEventListener(e.type,i,n),s={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(s):this.__on=[s]}}function p6(e,t,n){var r=u6(e+""),s,i=r.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,d=l.length,u;c<d;++c)for(s=0,u=l[c];s<i;++s)if((a=r[s]).type===u.type&&a.name===u.name)return u.value}return}for(l=t?f6:d6,s=0;s<i;++s)this.each(l(r[s],t,n));return this}function xC(e,t,n){var r=fC(e),s=r.CustomEvent;typeof s=="function"?s=new s(t,n):(s=r.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function h6(e,t){return function(){return xC(this,e,t)}}function m6(e,t){return function(){return xC(this,e,t.apply(this,arguments))}}function g6(e,t){return this.each((typeof t=="function"?m6:h6)(e,t))}function*x6(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length,a;s<i;++s)(a=r[s])&&(yield a)}var vC=[null];function sn(e,t){this._groups=e,this._parents=t}function ya(){return new sn([[document.documentElement]],vC)}function v6(){return this}sn.prototype=ya.prototype={constructor:sn,select:HA,selectAll:KA,selectChild:ZA,selectChildren:nI,filter:rI,data:cI,enter:sI,exit:dI,join:fI,merge:pI,selection:v6,order:hI,sort:mI,call:xI,nodes:vI,node:yI,size:bI,empty:_I,each:wI,attr:TI,style:PI,property:LI,classed:qI,text:VI,html:YI,raise:QI,lower:JI,append:e6,insert:n6,remove:s6,clone:a6,datum:l6,on:p6,dispatch:g6,[Symbol.iterator]:x6};function pn(e){return typeof e=="string"?new sn([[document.querySelector(e)]],[document.documentElement]):new sn([[e]],vC)}function y6(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Cn(e,t){if(e=y6(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const b6={passive:!1},Zo={capture:!0,passive:!1};function ld(e){e.stopImmediatePropagation()}function fi(e){e.preventDefault(),e.stopImmediatePropagation()}function yC(e){var t=e.document.documentElement,n=pn(e).on("dragstart.drag",fi,Zo);"onselectstart"in t?n.on("selectstart.drag",fi,Zo):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function bC(e,t){var n=e.document.documentElement,r=pn(e).on("dragstart.drag",null);t&&(r.on("click.drag",fi,Zo),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Xa=e=>()=>e;function Ex(e,{sourceEvent:t,subject:n,target:r,identifier:s,active:i,x:a,y:l,dx:c,dy:d,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:u}})}Ex.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function _6(e){return!e.ctrlKey&&!e.button}function w6(){return this.parentNode}function j6(e,t){return t??{x:e.x,y:e.y}}function S6(){return navigator.maxTouchPoints||"ontouchstart"in this}function k6(){var e=_6,t=w6,n=j6,r=S6,s={},i=Zc("start","drag","end"),a=0,l,c,d,u,f=0;function p(j){j.on("mousedown.drag",h).filter(r).on("touchstart.drag",_).on("touchmove.drag",x,b6).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(j,N){if(!(u||!e.call(this,j,N))){var E=b(this,t.call(this,j,N),j,N,"mouse");E&&(pn(j.view).on("mousemove.drag",v,Zo).on("mouseup.drag",g,Zo),yC(j.view),ld(j),d=!1,l=j.clientX,c=j.clientY,E("start",j))}}function v(j){if(fi(j),!d){var N=j.clientX-l,E=j.clientY-c;d=N*N+E*E>f}s.mouse("drag",j)}function g(j){pn(j.view).on("mousemove.drag mouseup.drag",null),bC(j.view,d),fi(j),s.mouse("end",j)}function _(j,N){if(e.call(this,j,N)){var E=j.changedTouches,S=t.call(this,j,N),k=E.length,w,R;for(w=0;w<k;++w)(R=b(this,S,j,N,E[w].identifier,E[w]))&&(ld(j),R("start",j,E[w]))}}function x(j){var N=j.changedTouches,E=N.length,S,k;for(S=0;S<E;++S)(k=s[N[S].identifier])&&(fi(j),k("drag",j,N[S]))}function y(j){var N=j.changedTouches,E=N.length,S,k;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),S=0;S<E;++S)(k=s[N[S].identifier])&&(ld(j),k("end",j,N[S]))}function b(j,N,E,S,k,w){var R=i.copy(),T=Cn(w||E,N),I,D,C;if((C=n.call(j,new Ex("beforestart",{sourceEvent:E,target:p,identifier:k,active:a,x:T[0],y:T[1],dx:0,dy:0,dispatch:R}),S))!=null)return I=C.x-T[0]||0,D=C.y-T[1]||0,function M(P,F,O){var A=T,z;switch(P){case"start":s[k]=M,z=a++;break;case"end":delete s[k],--a;case"drag":T=Cn(O||F,N),z=a;break}R.call(P,j,new Ex(P,{sourceEvent:F,subject:C,target:p,identifier:k,active:z,x:T[0]+I,y:T[1]+D,dx:T[0]-A[0],dy:T[1]-A[1],dispatch:R}),S)}}return p.filter=function(j){return arguments.length?(e=typeof j=="function"?j:Xa(!!j),p):e},p.container=function(j){return arguments.length?(t=typeof j=="function"?j:Xa(j),p):t},p.subject=function(j){return arguments.length?(n=typeof j=="function"?j:Xa(j),p):n},p.touchable=function(j){return arguments.length?(r=typeof j=="function"?j:Xa(!!j),p):r},p.on=function(){var j=i.on.apply(i,arguments);return j===i?p:j},p.clickDistance=function(j){return arguments.length?(f=(j=+j)*j,p):Math.sqrt(f)},p}function Jv(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function _C(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ba(){}var Jo=.7,ac=1/Jo,pi="\\s*([+-]?\\d+)\\s*",ea="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Un="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",N6=/^#([0-9a-f]{3,8})$/,C6=new RegExp(`^rgb\\(${pi},${pi},${pi}\\)$`),E6=new RegExp(`^rgb\\(${Un},${Un},${Un}\\)$`),T6=new RegExp(`^rgba\\(${pi},${pi},${pi},${ea}\\)$`),R6=new RegExp(`^rgba\\(${Un},${Un},${Un},${ea}\\)$`),A6=new RegExp(`^hsl\\(${ea},${Un},${Un}\\)$`),I6=new RegExp(`^hsla\\(${ea},${Un},${Un},${ea}\\)$`),lb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Jv(ba,ta,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:cb,formatHex:cb,formatHex8:P6,formatHsl:M6,formatRgb:ub,toString:ub});function cb(){return this.rgb().formatHex()}function P6(){return this.rgb().formatHex8()}function M6(){return wC(this).formatHsl()}function ub(){return this.rgb().formatRgb()}function ta(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=N6.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?db(t):n===3?new Ht(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Qa(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Qa(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=C6.exec(e))?new Ht(t[1],t[2],t[3],1):(t=E6.exec(e))?new Ht(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=T6.exec(e))?Qa(t[1],t[2],t[3],t[4]):(t=R6.exec(e))?Qa(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=A6.exec(e))?hb(t[1],t[2]/100,t[3]/100,1):(t=I6.exec(e))?hb(t[1],t[2]/100,t[3]/100,t[4]):lb.hasOwnProperty(e)?db(lb[e]):e==="transparent"?new Ht(NaN,NaN,NaN,0):null}function db(e){return new Ht(e>>16&255,e>>8&255,e&255,1)}function Qa(e,t,n,r){return r<=0&&(e=t=n=NaN),new Ht(e,t,n,r)}function O6(e){return e instanceof ba||(e=ta(e)),e?(e=e.rgb(),new Ht(e.r,e.g,e.b,e.opacity)):new Ht}function Tx(e,t,n,r){return arguments.length===1?O6(e):new Ht(e,t,n,r??1)}function Ht(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Jv(Ht,Tx,_C(ba,{brighter(e){return e=e==null?ac:Math.pow(ac,e),new Ht(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Jo:Math.pow(Jo,e),new Ht(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ht(xs(this.r),xs(this.g),xs(this.b),lc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fb,formatHex:fb,formatHex8:D6,formatRgb:pb,toString:pb}));function fb(){return`#${fs(this.r)}${fs(this.g)}${fs(this.b)}`}function D6(){return`#${fs(this.r)}${fs(this.g)}${fs(this.b)}${fs((isNaN(this.opacity)?1:this.opacity)*255)}`}function pb(){const e=lc(this.opacity);return`${e===1?"rgb(":"rgba("}${xs(this.r)}, ${xs(this.g)}, ${xs(this.b)}${e===1?")":`, ${e})`}`}function lc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function xs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function fs(e){return e=xs(e),(e<16?"0":"")+e.toString(16)}function hb(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Tn(e,t,n,r)}function wC(e){if(e instanceof Tn)return new Tn(e.h,e.s,e.l,e.opacity);if(e instanceof ba||(e=ta(e)),!e)return new Tn;if(e instanceof Tn)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),i=Math.max(t,n,r),a=NaN,l=i-s,c=(i+s)/2;return l?(t===i?a=(n-r)/l+(n<r)*6:n===i?a=(r-t)/l+2:a=(t-n)/l+4,l/=c<.5?i+s:2-i-s,a*=60):l=c>0&&c<1?0:a,new Tn(a,l,c,e.opacity)}function L6(e,t,n,r){return arguments.length===1?wC(e):new Tn(e,t,n,r??1)}function Tn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Jv(Tn,L6,_C(ba,{brighter(e){return e=e==null?ac:Math.pow(ac,e),new Tn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Jo:Math.pow(Jo,e),new Tn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new Ht(cd(e>=240?e-240:e+120,s,r),cd(e,s,r),cd(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new Tn(mb(this.h),Za(this.s),Za(this.l),lc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=lc(this.opacity);return`${e===1?"hsl(":"hsla("}${mb(this.h)}, ${Za(this.s)*100}%, ${Za(this.l)*100}%${e===1?")":`, ${e})`}`}}));function mb(e){return e=(e||0)%360,e<0?e+360:e}function Za(e){return Math.max(0,Math.min(1,e||0))}function cd(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const jC=e=>()=>e;function z6(e,t){return function(n){return e+n*t}}function F6(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function $6(e){return(e=+e)==1?SC:function(t,n){return n-t?F6(t,n,e):jC(isNaN(t)?n:t)}}function SC(e,t){var n=t-e;return n?z6(e,n):jC(isNaN(e)?t:e)}const gb=function e(t){var n=$6(t);function r(s,i){var a=n((s=Tx(s)).r,(i=Tx(i)).r),l=n(s.g,i.g),c=n(s.b,i.b),d=SC(s.opacity,i.opacity);return function(u){return s.r=a(u),s.g=l(u),s.b=c(u),s.opacity=d(u),s+""}}return r.gamma=e,r}(1);function Nr(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Rx=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ud=new RegExp(Rx.source,"g");function q6(e){return function(){return e}}function B6(e){return function(t){return e(t)+""}}function W6(e,t){var n=Rx.lastIndex=ud.lastIndex=0,r,s,i,a=-1,l=[],c=[];for(e=e+"",t=t+"";(r=Rx.exec(e))&&(s=ud.exec(t));)(i=s.index)>n&&(i=t.slice(n,i),l[a]?l[a]+=i:l[++a]=i),(r=r[0])===(s=s[0])?l[a]?l[a]+=s:l[++a]=s:(l[++a]=null,c.push({i:a,x:Nr(r,s)})),n=ud.lastIndex;return n<t.length&&(i=t.slice(n),l[a]?l[a]+=i:l[++a]=i),l.length<2?c[0]?B6(c[0].x):q6(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}var xb=180/Math.PI,Ax={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function kC(e,t,n,r,s,i){var a,l,c;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,c/=l),e*r<t*n&&(e=-e,t=-t,c=-c,a=-a),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*xb,skewX:Math.atan(c)*xb,scaleX:a,scaleY:l}}var Ja;function H6(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Ax:kC(t.a,t.b,t.c,t.d,t.e,t.f)}function V6(e){return e==null||(Ja||(Ja=document.createElementNS("http://www.w3.org/2000/svg","g")),Ja.setAttribute("transform",e),!(e=Ja.transform.baseVal.consolidate()))?Ax:(e=e.matrix,kC(e.a,e.b,e.c,e.d,e.e,e.f))}function NC(e,t,n,r){function s(d){return d.length?d.pop()+" ":""}function i(d,u,f,p,h,v){if(d!==f||u!==p){var g=h.push("translate(",null,t,null,n);v.push({i:g-4,x:Nr(d,f)},{i:g-2,x:Nr(u,p)})}else(f||p)&&h.push("translate("+f+t+p+n)}function a(d,u,f,p){d!==u?(d-u>180?u+=360:u-d>180&&(d+=360),p.push({i:f.push(s(f)+"rotate(",null,r)-2,x:Nr(d,u)})):u&&f.push(s(f)+"rotate("+u+r)}function l(d,u,f,p){d!==u?p.push({i:f.push(s(f)+"skewX(",null,r)-2,x:Nr(d,u)}):u&&f.push(s(f)+"skewX("+u+r)}function c(d,u,f,p,h,v){if(d!==f||u!==p){var g=h.push(s(h)+"scale(",null,",",null,")");v.push({i:g-4,x:Nr(d,f)},{i:g-2,x:Nr(u,p)})}else(f!==1||p!==1)&&h.push(s(h)+"scale("+f+","+p+")")}return function(d,u){var f=[],p=[];return d=e(d),u=e(u),i(d.translateX,d.translateY,u.translateX,u.translateY,f,p),a(d.rotate,u.rotate,f,p),l(d.skewX,u.skewX,f,p),c(d.scaleX,d.scaleY,u.scaleX,u.scaleY,f,p),d=u=null,function(h){for(var v=-1,g=p.length,_;++v<g;)f[(_=p[v]).i]=_.x(h);return f.join("")}}}var U6=NC(H6,"px, ","px)","deg)"),G6=NC(V6,", ",")",")"),K6=1e-12;function vb(e){return((e=Math.exp(e))+1/e)/2}function Y6(e){return((e=Math.exp(e))-1/e)/2}function X6(e){return((e=Math.exp(2*e))-1)/(e+1)}const Q6=function e(t,n,r){function s(i,a){var l=i[0],c=i[1],d=i[2],u=a[0],f=a[1],p=a[2],h=u-l,v=f-c,g=h*h+v*v,_,x;if(g<K6)x=Math.log(p/d)/t,_=function(S){return[l+S*h,c+S*v,d*Math.exp(t*S*x)]};else{var y=Math.sqrt(g),b=(p*p-d*d+r*g)/(2*d*n*y),j=(p*p-d*d-r*g)/(2*p*n*y),N=Math.log(Math.sqrt(b*b+1)-b),E=Math.log(Math.sqrt(j*j+1)-j);x=(E-N)/t,_=function(S){var k=S*x,w=vb(N),R=d/(n*y)*(w*X6(t*k+N)-Y6(N));return[l+R*h,c+R*v,d*w/vb(t*k+N)]}}return _.duration=x*1e3*t/Math.SQRT2,_}return s.rho=function(i){var a=Math.max(.001,+i),l=a*a,c=l*l;return e(a,l,c)},s}(Math.SQRT2,2,4);var ki=0,ho=0,Qi=0,CC=1e3,cc,mo,uc=0,ks=0,eu=0,na=typeof performance=="object"&&performance.now?performance:Date,EC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ey(){return ks||(EC(Z6),ks=na.now()+eu)}function Z6(){ks=0}function dc(){this._call=this._time=this._next=null}dc.prototype=TC.prototype={constructor:dc,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?ey():+n)+(t==null?0:+t),!this._next&&mo!==this&&(mo?mo._next=this:cc=this,mo=this),this._call=e,this._time=n,Ix()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ix())}};function TC(e,t,n){var r=new dc;return r.restart(e,t,n),r}function J6(){ey(),++ki;for(var e=cc,t;e;)(t=ks-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ki}function yb(){ks=(uc=na.now())+eu,ki=ho=0;try{J6()}finally{ki=0,tP(),ks=0}}function eP(){var e=na.now(),t=e-uc;t>CC&&(eu-=t,uc=e)}function tP(){for(var e,t=cc,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:cc=n);mo=e,Ix(r)}function Ix(e){if(!ki){ho&&(ho=clearTimeout(ho));var t=e-ks;t>24?(e<1/0&&(ho=setTimeout(yb,e-na.now()-eu)),Qi&&(Qi=clearInterval(Qi))):(Qi||(uc=na.now(),Qi=setInterval(eP,CC)),ki=1,EC(yb))}}function bb(e,t,n){var r=new dc;return t=t==null?0:+t,r.restart(s=>{r.stop(),e(s+t)},t,n),r}var nP=Zc("start","end","cancel","interrupt"),rP=[],RC=0,_b=1,Px=2,Il=3,wb=4,Mx=5,Pl=6;function tu(e,t,n,r,s,i){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;sP(e,n,{name:t,index:r,group:s,on:nP,tween:rP,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:RC})}function ty(e,t){var n=Mn(e,t);if(n.state>RC)throw new Error("too late; already scheduled");return n}function Yn(e,t){var n=Mn(e,t);if(n.state>Il)throw new Error("too late; already running");return n}function Mn(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function sP(e,t,n){var r=e.__transition,s;r[t]=n,n.timer=TC(i,0,n.time);function i(d){n.state=_b,n.timer.restart(a,n.delay,n.time),n.delay<=d&&a(d-n.delay)}function a(d){var u,f,p,h;if(n.state!==_b)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===Il)return bb(a);h.state===wb?(h.state=Pl,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=Pl,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(bb(function(){n.state===Il&&(n.state=wb,n.timer.restart(l,n.delay,n.time),l(d))}),n.state=Px,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Px){for(n.state=Il,s=new Array(p=n.tween.length),u=0,f=-1;u<p;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(s[++f]=h);s.length=f+1}}function l(d){for(var u=d<n.duration?n.ease.call(null,d/n.duration):(n.timer.restart(c),n.state=Mx,1),f=-1,p=s.length;++f<p;)s[f].call(e,u);n.state===Mx&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Pl,n.timer.stop(),delete r[t];for(var d in r)return;delete e.__transition}}function Ml(e,t){var n=e.__transition,r,s,i=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){i=!1;continue}s=r.state>Px&&r.state<Mx,r.state=Pl,r.timer.stop(),r.on.call(s?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}i&&delete e.__transition}}function iP(e){return this.each(function(){Ml(this,e)})}function oP(e,t){var n,r;return function(){var s=Yn(this,e),i=s.tween;if(i!==n){r=n=i;for(var a=0,l=r.length;a<l;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}s.tween=r}}function aP(e,t,n){var r,s;if(typeof n!="function")throw new Error;return function(){var i=Yn(this,e),a=i.tween;if(a!==r){s=(r=a).slice();for(var l={name:t,value:n},c=0,d=s.length;c<d;++c)if(s[c].name===t){s[c]=l;break}c===d&&s.push(l)}i.tween=s}}function lP(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Mn(this.node(),n).tween,s=0,i=r.length,a;s<i;++s)if((a=r[s]).name===e)return a.value;return null}return this.each((t==null?oP:aP)(n,e,t))}function ny(e,t,n){var r=e._id;return e.each(function(){var s=Yn(this,r);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return Mn(s,r).value[t]}}function AC(e,t){var n;return(typeof t=="number"?Nr:t instanceof ta?gb:(n=ta(t))?(t=n,gb):W6)(e,t)}function cP(e){return function(){this.removeAttribute(e)}}function uP(e){return function(){this.removeAttributeNS(e.space,e.local)}}function dP(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttribute(e);return a===s?null:a===r?i:i=t(r=a,n)}}function fP(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===s?null:a===r?i:i=t(r=a,n)}}function pP(e,t,n){var r,s,i;return function(){var a,l=n(this),c;return l==null?void this.removeAttribute(e):(a=this.getAttribute(e),c=l+"",a===c?null:a===r&&c===s?i:(s=c,i=t(r=a,l)))}}function hP(e,t,n){var r,s,i;return function(){var a,l=n(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),c=l+"",a===c?null:a===r&&c===s?i:(s=c,i=t(r=a,l)))}}function mP(e,t){var n=Jc(e),r=n==="transform"?G6:AC;return this.attrTween(e,typeof t=="function"?(n.local?hP:pP)(n,r,ny(this,"attr."+e,t)):t==null?(n.local?uP:cP)(n):(n.local?fP:dP)(n,r,t))}function gP(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function xP(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function vP(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&xP(e,i)),n}return s._value=t,s}function yP(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&gP(e,i)),n}return s._value=t,s}function bP(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Jc(e);return this.tween(n,(r.local?vP:yP)(r,t))}function _P(e,t){return function(){ty(this,e).delay=+t.apply(this,arguments)}}function wP(e,t){return t=+t,function(){ty(this,e).delay=t}}function jP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?_P:wP)(t,e)):Mn(this.node(),t).delay}function SP(e,t){return function(){Yn(this,e).duration=+t.apply(this,arguments)}}function kP(e,t){return t=+t,function(){Yn(this,e).duration=t}}function NP(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?SP:kP)(t,e)):Mn(this.node(),t).duration}function CP(e,t){if(typeof t!="function")throw new Error;return function(){Yn(this,e).ease=t}}function EP(e){var t=this._id;return arguments.length?this.each(CP(t,e)):Mn(this.node(),t).ease}function TP(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Yn(this,e).ease=n}}function RP(e){if(typeof e!="function")throw new Error;return this.each(TP(this._id,e))}function AP(e){typeof e!="function"&&(e=cC(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,l=r[s]=[],c,d=0;d<a;++d)(c=i[d])&&e.call(c,c.__data__,d,i)&&l.push(c);return new hr(r,this._parents,this._name,this._id)}function IP(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,s=n.length,i=Math.min(r,s),a=new Array(r),l=0;l<i;++l)for(var c=t[l],d=n[l],u=c.length,f=a[l]=new Array(u),p,h=0;h<u;++h)(p=c[h]||d[h])&&(f[h]=p);for(;l<r;++l)a[l]=t[l];return new hr(a,this._parents,this._name,this._id)}function PP(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function MP(e,t,n){var r,s,i=PP(t)?ty:Yn;return function(){var a=i(this,e),l=a.on;l!==r&&(s=(r=l).copy()).on(t,n),a.on=s}}function OP(e,t){var n=this._id;return arguments.length<2?Mn(this.node(),n).on.on(e):this.each(MP(n,e,t))}function DP(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function LP(){return this.on("end.remove",DP(this._id))}function zP(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Qv(e));for(var r=this._groups,s=r.length,i=new Array(s),a=0;a<s;++a)for(var l=r[a],c=l.length,d=i[a]=new Array(c),u,f,p=0;p<c;++p)(u=l[p])&&(f=e.call(u,u.__data__,p,l))&&("__data__"in u&&(f.__data__=u.__data__),d[p]=f,tu(d[p],t,n,p,d,Mn(u,n)));return new hr(i,this._parents,t,n)}function FP(e){var t=this._name,n=this._id;typeof e!="function"&&(e=lC(e));for(var r=this._groups,s=r.length,i=[],a=[],l=0;l<s;++l)for(var c=r[l],d=c.length,u,f=0;f<d;++f)if(u=c[f]){for(var p=e.call(u,u.__data__,f,c),h,v=Mn(u,n),g=0,_=p.length;g<_;++g)(h=p[g])&&tu(h,t,n,g,p,v);i.push(p),a.push(u)}return new hr(i,a,t,n)}var $P=ya.prototype.constructor;function qP(){return new $P(this._groups,this._parents)}function BP(e,t){var n,r,s;return function(){var i=Si(this,e),a=(this.style.removeProperty(e),Si(this,e));return i===a?null:i===n&&a===r?s:s=t(n=i,r=a)}}function IC(e){return function(){this.style.removeProperty(e)}}function WP(e,t,n){var r,s=n+"",i;return function(){var a=Si(this,e);return a===s?null:a===r?i:i=t(r=a,n)}}function HP(e,t,n){var r,s,i;return function(){var a=Si(this,e),l=n(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),Si(this,e))),a===c?null:a===r&&c===s?i:(s=c,i=t(r=a,l))}}function VP(e,t){var n,r,s,i="style."+t,a="end."+i,l;return function(){var c=Yn(this,e),d=c.on,u=c.value[i]==null?l||(l=IC(t)):void 0;(d!==n||s!==u)&&(r=(n=d).copy()).on(a,s=u),c.on=r}}function UP(e,t,n){var r=(e+="")=="transform"?U6:AC;return t==null?this.styleTween(e,BP(e,r)).on("end.style."+e,IC(e)):typeof t=="function"?this.styleTween(e,HP(e,r,ny(this,"style."+e,t))).each(VP(this._id,e)):this.styleTween(e,WP(e,r,t),n).on("end.style."+e,null)}function GP(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function KP(e,t,n){var r,s;function i(){var a=t.apply(this,arguments);return a!==s&&(r=(s=a)&&GP(e,a,n)),r}return i._value=t,i}function YP(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,KP(e,t,n??""))}function XP(e){return function(){this.textContent=e}}function QP(e){return function(){var t=e(this);this.textContent=t??""}}function ZP(e){return this.tween("text",typeof e=="function"?QP(ny(this,"text",e)):XP(e==null?"":e+""))}function JP(e){return function(t){this.textContent=e.call(this,t)}}function eM(e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&JP(s)),t}return r._value=e,r}function tM(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,eM(e))}function nM(){for(var e=this._name,t=this._id,n=PC(),r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],l=a.length,c,d=0;d<l;++d)if(c=a[d]){var u=Mn(c,t);tu(c,e,n,d,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new hr(r,this._parents,e,n)}function rM(){var e,t,n=this,r=n._id,s=n.size();return new Promise(function(i,a){var l={value:a},c={value:function(){--s===0&&i()}};n.each(function(){var d=Yn(this,r),u=d.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),d.on=t}),s===0&&i()})}var sM=0;function hr(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function PC(){return++sM}var Qn=ya.prototype;hr.prototype={constructor:hr,select:zP,selectAll:FP,selectChild:Qn.selectChild,selectChildren:Qn.selectChildren,filter:AP,merge:IP,selection:qP,transition:nM,call:Qn.call,nodes:Qn.nodes,node:Qn.node,size:Qn.size,empty:Qn.empty,each:Qn.each,on:OP,attr:mP,attrTween:bP,style:UP,styleTween:YP,text:ZP,textTween:tM,remove:LP,tween:lP,delay:jP,duration:NP,ease:EP,easeVarying:RP,end:rM,[Symbol.iterator]:Qn[Symbol.iterator]};function iM(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var oM={time:null,delay:0,duration:250,ease:iM};function aM(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function lM(e){var t,n;e instanceof hr?(t=e._id,e=e._name):(t=PC(),(n=oM).time=ey(),e=e==null?null:e+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],l=a.length,c,d=0;d<l;++d)(c=a[d])&&tu(c,e,t,d,a,n||aM(c,t));return new hr(r,this._parents,e,t)}ya.prototype.interrupt=iP;ya.prototype.transition=lM;const el=e=>()=>e;function cM(e,{sourceEvent:t,target:n,transform:r,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:s}})}function ir(e,t,n){this.k=e,this.x=t,this.y=n}ir.prototype={constructor:ir,scale:function(e){return e===1?this:new ir(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ir(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var cr=new ir(1,0,0);ir.prototype;function dd(e){e.stopImmediatePropagation()}function Zi(e){e.preventDefault(),e.stopImmediatePropagation()}function uM(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function dM(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function jb(){return this.__zoom||cr}function fM(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function pM(){return navigator.maxTouchPoints||"ontouchstart"in this}function hM(e,t,n){var r=e.invertX(t[0][0])-n[0][0],s=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(s>r?(r+s)/2:Math.min(0,r)||Math.max(0,s),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}function MC(){var e=uM,t=dM,n=hM,r=fM,s=pM,i=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],l=250,c=Q6,d=Zc("start","zoom","end"),u,f,p,h=500,v=150,g=0,_=10;function x(C){C.property("__zoom",jb).on("wheel.zoom",k,{passive:!1}).on("mousedown.zoom",w).on("dblclick.zoom",R).filter(s).on("touchstart.zoom",T).on("touchmove.zoom",I).on("touchend.zoom touchcancel.zoom",D).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(C,M,P,F){var O=C.selection?C.selection():C;O.property("__zoom",jb),C!==O?N(C,M,P,F):O.interrupt().each(function(){E(this,arguments).event(F).start().zoom(null,typeof M=="function"?M.apply(this,arguments):M).end()})},x.scaleBy=function(C,M,P,F){x.scaleTo(C,function(){var O=this.__zoom.k,A=typeof M=="function"?M.apply(this,arguments):M;return O*A},P,F)},x.scaleTo=function(C,M,P,F){x.transform(C,function(){var O=t.apply(this,arguments),A=this.__zoom,z=P==null?j(O):typeof P=="function"?P.apply(this,arguments):P,$=A.invert(z),B=typeof M=="function"?M.apply(this,arguments):M;return n(b(y(A,B),z,$),O,a)},P,F)},x.translateBy=function(C,M,P,F){x.transform(C,function(){return n(this.__zoom.translate(typeof M=="function"?M.apply(this,arguments):M,typeof P=="function"?P.apply(this,arguments):P),t.apply(this,arguments),a)},null,F)},x.translateTo=function(C,M,P,F,O){x.transform(C,function(){var A=t.apply(this,arguments),z=this.__zoom,$=F==null?j(A):typeof F=="function"?F.apply(this,arguments):F;return n(cr.translate($[0],$[1]).scale(z.k).translate(typeof M=="function"?-M.apply(this,arguments):-M,typeof P=="function"?-P.apply(this,arguments):-P),A,a)},F,O)};function y(C,M){return M=Math.max(i[0],Math.min(i[1],M)),M===C.k?C:new ir(M,C.x,C.y)}function b(C,M,P){var F=M[0]-P[0]*C.k,O=M[1]-P[1]*C.k;return F===C.x&&O===C.y?C:new ir(C.k,F,O)}function j(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function N(C,M,P,F){C.on("start.zoom",function(){E(this,arguments).event(F).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(F).end()}).tween("zoom",function(){var O=this,A=arguments,z=E(O,A).event(F),$=t.apply(O,A),B=P==null?j($):typeof P=="function"?P.apply(O,A):P,U=Math.max($[1][0]-$[0][0],$[1][1]-$[0][1]),G=O.__zoom,H=typeof M=="function"?M.apply(O,A):M,q=c(G.invert(B).concat(U/G.k),H.invert(B).concat(U/H.k));return function(Q){if(Q===1)Q=H;else{var se=q(Q),ie=U/se[2];Q=new ir(ie,B[0]-se[0]*ie,B[1]-se[1]*ie)}z.zoom(null,Q)}})}function E(C,M,P){return!P&&C.__zooming||new S(C,M)}function S(C,M){this.that=C,this.args=M,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,M),this.taps=0}S.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,M){return this.mouse&&C!=="mouse"&&(this.mouse[1]=M.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=M.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=M.invert(this.touch1[0])),this.that.__zoom=M,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var M=pn(this.that).datum();d.call(C,this.that,new cM(C,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:d}),M)}};function k(C,...M){if(!e.apply(this,arguments))return;var P=E(this,M).event(C),F=this.__zoom,O=Math.max(i[0],Math.min(i[1],F.k*Math.pow(2,r.apply(this,arguments)))),A=Cn(C);if(P.wheel)(P.mouse[0][0]!==A[0]||P.mouse[0][1]!==A[1])&&(P.mouse[1]=F.invert(P.mouse[0]=A)),clearTimeout(P.wheel);else{if(F.k===O)return;P.mouse=[A,F.invert(A)],Ml(this),P.start()}Zi(C),P.wheel=setTimeout(z,v),P.zoom("mouse",n(b(y(F,O),P.mouse[0],P.mouse[1]),P.extent,a));function z(){P.wheel=null,P.end()}}function w(C,...M){if(p||!e.apply(this,arguments))return;var P=C.currentTarget,F=E(this,M,!0).event(C),O=pn(C.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",U,!0),A=Cn(C,P),z=C.clientX,$=C.clientY;yC(C.view),dd(C),F.mouse=[A,this.__zoom.invert(A)],Ml(this),F.start();function B(G){if(Zi(G),!F.moved){var H=G.clientX-z,q=G.clientY-$;F.moved=H*H+q*q>g}F.event(G).zoom("mouse",n(b(F.that.__zoom,F.mouse[0]=Cn(G,P),F.mouse[1]),F.extent,a))}function U(G){O.on("mousemove.zoom mouseup.zoom",null),bC(G.view,F.moved),Zi(G),F.event(G).end()}}function R(C,...M){if(e.apply(this,arguments)){var P=this.__zoom,F=Cn(C.changedTouches?C.changedTouches[0]:C,this),O=P.invert(F),A=P.k*(C.shiftKey?.5:2),z=n(b(y(P,A),F,O),t.apply(this,M),a);Zi(C),l>0?pn(this).transition().duration(l).call(N,z,F,C):pn(this).call(x.transform,z,F,C)}}function T(C,...M){if(e.apply(this,arguments)){var P=C.touches,F=P.length,O=E(this,M,C.changedTouches.length===F).event(C),A,z,$,B;for(dd(C),z=0;z<F;++z)$=P[z],B=Cn($,this),B=[B,this.__zoom.invert(B),$.identifier],O.touch0?!O.touch1&&O.touch0[2]!==B[2]&&(O.touch1=B,O.taps=0):(O.touch0=B,A=!0,O.taps=1+!!u);u&&(u=clearTimeout(u)),A&&(O.taps<2&&(f=B[0],u=setTimeout(function(){u=null},h)),Ml(this),O.start())}}function I(C,...M){if(this.__zooming){var P=E(this,M).event(C),F=C.changedTouches,O=F.length,A,z,$,B;for(Zi(C),A=0;A<O;++A)z=F[A],$=Cn(z,this),P.touch0&&P.touch0[2]===z.identifier?P.touch0[0]=$:P.touch1&&P.touch1[2]===z.identifier&&(P.touch1[0]=$);if(z=P.that.__zoom,P.touch1){var U=P.touch0[0],G=P.touch0[1],H=P.touch1[0],q=P.touch1[1],Q=(Q=H[0]-U[0])*Q+(Q=H[1]-U[1])*Q,se=(se=q[0]-G[0])*se+(se=q[1]-G[1])*se;z=y(z,Math.sqrt(Q/se)),$=[(U[0]+H[0])/2,(U[1]+H[1])/2],B=[(G[0]+q[0])/2,(G[1]+q[1])/2]}else if(P.touch0)$=P.touch0[0],B=P.touch0[1];else return;P.zoom("touch",n(b(z,$,B),P.extent,a))}}function D(C,...M){if(this.__zooming){var P=E(this,M).event(C),F=C.changedTouches,O=F.length,A,z;for(dd(C),p&&clearTimeout(p),p=setTimeout(function(){p=null},h),A=0;A<O;++A)z=F[A],P.touch0&&P.touch0[2]===z.identifier?delete P.touch0:P.touch1&&P.touch1[2]===z.identifier&&delete P.touch1;if(P.touch1&&!P.touch0&&(P.touch0=P.touch1,delete P.touch1),P.touch0)P.touch0[1]=this.__zoom.invert(P.touch0[0]);else if(P.end(),P.taps===2&&(z=Cn(z,this),Math.hypot(f[0]-z[0],f[1]-z[1])<_)){var $=pn(this).on("dblclick.zoom");$&&$.apply(this,arguments)}}}return x.wheelDelta=function(C){return arguments.length?(r=typeof C=="function"?C:el(+C),x):r},x.filter=function(C){return arguments.length?(e=typeof C=="function"?C:el(!!C),x):e},x.touchable=function(C){return arguments.length?(s=typeof C=="function"?C:el(!!C),x):s},x.extent=function(C){return arguments.length?(t=typeof C=="function"?C:el([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),x):t},x.scaleExtent=function(C){return arguments.length?(i[0]=+C[0],i[1]=+C[1],x):[i[0],i[1]]},x.translateExtent=function(C){return arguments.length?(a[0][0]=+C[0][0],a[1][0]=+C[1][0],a[0][1]=+C[0][1],a[1][1]=+C[1][1],x):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},x.constrain=function(C){return arguments.length?(n=C,x):n},x.duration=function(C){return arguments.length?(l=+C,x):l},x.interpolate=function(C){return arguments.length?(c=C,x):c},x.on=function(){var C=d.on.apply(d,arguments);return C===d?x:C},x.clickDistance=function(C){return arguments.length?(g=(C=+C)*C,x):Math.sqrt(g)},x.tapDistance=function(C){return arguments.length?(_=+C,x):_},x}const nu=m.createContext(null),mM=nu.Provider,mr={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},OC=mr.error001();function Je(e,t){const n=m.useContext(nu);if(n===null)throw new Error(OC);return oC(n,e,t)}const wt=()=>{const e=m.useContext(nu);if(e===null)throw new Error(OC);return m.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},gM=e=>e.userSelectionActive?"none":"all";function Hr({position:e,children:t,className:n,style:r,...s}){const i=Je(gM),a=`${e}`.split("-");return X.createElement("div",{className:Xt(["react-flow__panel",n,...a]),style:{...r,pointerEvents:i},...s},t)}function xM({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:X.createElement(Hr,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},X.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const vM=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:s=!0,labelBgStyle:i={},labelBgPadding:a=[2,4],labelBgBorderRadius:l=2,children:c,className:d,...u})=>{const f=m.useRef(null),[p,h]=m.useState({x:0,y:0,width:0,height:0}),v=Xt(["react-flow__edge-textwrapper",d]);return m.useEffect(()=>{if(f.current){const g=f.current.getBBox();h({x:g.x,y:g.y,width:g.width,height:g.height})}},[n]),typeof n>"u"||!n?null:X.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:v,visibility:p.width?"visible":"hidden",...u},s&&X.createElement("rect",{width:p.width+2*a[0],x:-a[0],y:-a[1],height:p.height+2*a[1],className:"react-flow__edge-textbg",style:i,rx:l,ry:l}),X.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:f,style:r},n),c)};var yM=m.memo(vM);const ry=e=>({width:e.offsetWidth,height:e.offsetHeight}),Ni=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),sy=(e={x:0,y:0},t)=>({x:Ni(e.x,t[0][0],t[1][0]),y:Ni(e.y,t[0][1],t[1][1])}),Sb=(e,t,n)=>e<t?Ni(Math.abs(e-t),1,50)/50:e>n?-Ni(Math.abs(e-n),1,50)/50:0,DC=(e,t)=>{const n=Sb(e.x,35,t.width-35)*20,r=Sb(e.y,35,t.height-35)*20;return[n,r]},LC=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},zC=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),ra=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),FC=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),kb=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),bM=(e,t)=>FC(zC(ra(e),ra(t))),Ox=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},_M=e=>mn(e.width)&&mn(e.height)&&mn(e.x)&&mn(e.y),mn=e=>!isNaN(e)&&isFinite(e),ot=Symbol.for("internals"),$C=["Enter"," ","Escape"],wM=(e,t)=>{},jM=e=>"nativeEvent"in e;function Dx(e){var s,i;const t=jM(e)?e.nativeEvent:e,n=((i=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const qC=e=>"clientX"in e,Vr=(e,t)=>{var i,a;const n=qC(e),r=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,s=n?e.clientY:(a=e.touches)==null?void 0:a[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},fc=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},_a=({id:e,path:t,labelX:n,labelY:r,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h=20})=>X.createElement(X.Fragment,null,X.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:p}),h&&X.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),s&&mn(n)&&mn(r)?X.createElement(yM,{x:n,y:r,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d}):null);_a.displayName="BaseEdge";function Ji(e,t,n){return n===void 0?n:r=>{const s=t().edges.find(i=>i.id===e);s&&n(r,{...s})}}function BC({sourceX:e,sourceY:t,targetX:n,targetY:r}){const s=Math.abs(n-e)/2,i=n<e?n+s:n-s,a=Math.abs(r-t)/2,l=r<t?r+a:r-a;return[i,l,s,a]}function WC({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:s,sourceControlY:i,targetControlX:a,targetControlY:l}){const c=e*.125+s*.375+a*.375+n*.125,d=t*.125+i*.375+l*.375+r*.125,u=Math.abs(c-e),f=Math.abs(d-t);return[c,d,u,f]}var Ns;(function(e){e.Strict="strict",e.Loose="loose"})(Ns||(Ns={}));var ps;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(ps||(ps={}));var sa;(function(e){e.Partial="partial",e.Full="full"})(sa||(sa={}));var Ar;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Ar||(Ar={}));var pc;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(pc||(pc={}));var ce;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(ce||(ce={}));function Nb({pos:e,x1:t,y1:n,x2:r,y2:s}){return e===ce.Left||e===ce.Right?[.5*(t+r),n]:[t,.5*(n+s)]}function HC({sourceX:e,sourceY:t,sourcePosition:n=ce.Bottom,targetX:r,targetY:s,targetPosition:i=ce.Top}){const[a,l]=Nb({pos:n,x1:e,y1:t,x2:r,y2:s}),[c,d]=Nb({pos:i,x1:r,y1:s,x2:e,y2:t}),[u,f,p,h]=WC({sourceX:e,sourceY:t,targetX:r,targetY:s,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${a},${l} ${c},${d} ${r},${s}`,u,f,p,h]}const iy=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:s=ce.Bottom,targetPosition:i=ce.Top,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,interactionWidth:g})=>{const[_,x,y]=HC({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:r,targetPosition:i});return X.createElement(_a,{path:_,labelX:x,labelY:y,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,interactionWidth:g})});iy.displayName="SimpleBezierEdge";const Cb={[ce.Left]:{x:-1,y:0},[ce.Right]:{x:1,y:0},[ce.Top]:{x:0,y:-1},[ce.Bottom]:{x:0,y:1}},SM=({source:e,sourcePosition:t=ce.Bottom,target:n})=>t===ce.Left||t===ce.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Eb=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function kM({source:e,sourcePosition:t=ce.Bottom,target:n,targetPosition:r=ce.Top,center:s,offset:i}){const a=Cb[t],l=Cb[r],c={x:e.x+a.x*i,y:e.y+a.y*i},d={x:n.x+l.x*i,y:n.y+l.y*i},u=SM({source:c,sourcePosition:t,target:d}),f=u.x!==0?"x":"y",p=u[f];let h=[],v,g;const _={x:0,y:0},x={x:0,y:0},[y,b,j,N]=BC({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[f]*l[f]===-1){v=s.x??y,g=s.y??b;const S=[{x:v,y:c.y},{x:v,y:d.y}],k=[{x:c.x,y:g},{x:d.x,y:g}];a[f]===p?h=f==="x"?S:k:h=f==="x"?k:S}else{const S=[{x:c.x,y:d.y}],k=[{x:d.x,y:c.y}];if(f==="x"?h=a.x===p?k:S:h=a.y===p?S:k,t===r){const D=Math.abs(e[f]-n[f]);if(D<=i){const C=Math.min(i-1,i-D);a[f]===p?_[f]=(c[f]>e[f]?-1:1)*C:x[f]=(d[f]>n[f]?-1:1)*C}}if(t!==r){const D=f==="x"?"y":"x",C=a[f]===l[D],M=c[D]>d[D],P=c[D]<d[D];(a[f]===1&&(!C&&M||C&&P)||a[f]!==1&&(!C&&P||C&&M))&&(h=f==="x"?S:k)}const w={x:c.x+_.x,y:c.y+_.y},R={x:d.x+x.x,y:d.y+x.y},T=Math.max(Math.abs(w.x-h[0].x),Math.abs(R.x-h[0].x)),I=Math.max(Math.abs(w.y-h[0].y),Math.abs(R.y-h[0].y));T>=I?(v=(w.x+R.x)/2,g=h[0].y):(v=h[0].x,g=(w.y+R.y)/2)}return[[e,{x:c.x+_.x,y:c.y+_.y},...h,{x:d.x+x.x,y:d.y+x.y},n],v,g,j,N]}function NM(e,t,n,r){const s=Math.min(Eb(e,t)/2,Eb(t,n)/2,r),{x:i,y:a}=t;if(e.x===i&&i===n.x||e.y===a&&a===n.y)return`L${i} ${a}`;if(e.y===a){const d=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${i+s*d},${a}Q ${i},${a} ${i},${a+s*u}`}const l=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${i},${a+s*c}Q ${i},${a} ${i+s*l},${a}`}function Lx({sourceX:e,sourceY:t,sourcePosition:n=ce.Bottom,targetX:r,targetY:s,targetPosition:i=ce.Top,borderRadius:a=5,centerX:l,centerY:c,offset:d=20}){const[u,f,p,h,v]=kM({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:s},targetPosition:i,center:{x:l,y:c},offset:d});return[u.reduce((_,x,y)=>{let b="";return y>0&&y<u.length-1?b=NM(u[y-1],x,u[y+1],a):b=`${y===0?"M":"L"}${x.x} ${x.y}`,_+=b,_},""),f,p,h,v]}const ru=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,sourcePosition:f=ce.Bottom,targetPosition:p=ce.Top,markerEnd:h,markerStart:v,pathOptions:g,interactionWidth:_})=>{const[x,y,b]=Lx({sourceX:e,sourceY:t,sourcePosition:f,targetX:n,targetY:r,targetPosition:p,borderRadius:g==null?void 0:g.borderRadius,offset:g==null?void 0:g.offset});return X.createElement(_a,{path:x,labelX:y,labelY:b,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:v,interactionWidth:_})});ru.displayName="SmoothStepEdge";const oy=m.memo(e=>{var t;return X.createElement(ru,{...e,pathOptions:m.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});oy.displayName="StepEdge";function CM({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[s,i,a,l]=BC({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,s,i,a,l]}const ay=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})=>{const[v,g,_]=CM({sourceX:e,sourceY:t,targetX:n,targetY:r});return X.createElement(_a,{path:v,labelX:g,labelY:_,label:s,labelStyle:i,labelShowBg:a,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:p,interactionWidth:h})});ay.displayName="StraightEdge";function tl(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Tb({pos:e,x1:t,y1:n,x2:r,y2:s,c:i}){switch(e){case ce.Left:return[t-tl(t-r,i),n];case ce.Right:return[t+tl(r-t,i),n];case ce.Top:return[t,n-tl(n-s,i)];case ce.Bottom:return[t,n+tl(s-n,i)]}}function VC({sourceX:e,sourceY:t,sourcePosition:n=ce.Bottom,targetX:r,targetY:s,targetPosition:i=ce.Top,curvature:a=.25}){const[l,c]=Tb({pos:n,x1:e,y1:t,x2:r,y2:s,c:a}),[d,u]=Tb({pos:i,x1:r,y1:s,x2:e,y2:t,c:a}),[f,p,h,v]=WC({sourceX:e,sourceY:t,targetX:r,targetY:s,sourceControlX:l,sourceControlY:c,targetControlX:d,targetControlY:u});return[`M${e},${t} C${l},${c} ${d},${u} ${r},${s}`,f,p,h,v]}const hc=m.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:s=ce.Bottom,targetPosition:i=ce.Top,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,pathOptions:g,interactionWidth:_})=>{const[x,y,b]=VC({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:r,targetPosition:i,curvature:g==null?void 0:g.curvature});return X.createElement(_a,{path:x,labelX:y,labelY:b,label:a,labelStyle:l,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:p,markerEnd:h,markerStart:v,interactionWidth:_})});hc.displayName="BezierEdge";const ly=m.createContext(null),EM=ly.Provider;ly.Consumer;const TM=()=>m.useContext(ly),RM=e=>"id"in e&&"source"in e&&"target"in e,AM=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,zx=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,IM=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),PM=(e,t)=>{if(!e.source||!e.target)return t;let n;return RM(e)?n={...e}:n={...e,id:AM(e)},IM(n,t)?t:t.concat(n)},Fx=({x:e,y:t},[n,r,s],i,[a,l])=>{const c={x:(e-n)/s,y:(t-r)/s};return i?{x:a*Math.round(c.x/a),y:l*Math.round(c.y/l)}:c},UC=({x:e,y:t},[n,r,s])=>({x:e*s+n,y:t*s+r}),vs=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],s={x:e.position.x-n,y:e.position.y-r};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:s}},su=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,s)=>{const{x:i,y:a}=vs(s,t).positionAbsolute;return zC(r,ra({x:i,y:a,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return FC(n)},GC=(e,t,[n,r,s]=[0,0,1],i=!1,a=!1,l=[0,0])=>{const c={x:(t.x-n)/s,y:(t.y-r)/s,width:t.width/s,height:t.height/s},d=[];return e.forEach(u=>{const{width:f,height:p,selectable:h=!0,hidden:v=!1}=u;if(a&&!h||v)return!1;const{positionAbsolute:g}=vs(u,l),_={x:g.x,y:g.y,width:f||0,height:p||0},x=Ox(c,_),y=typeof f>"u"||typeof p>"u"||f===null||p===null,b=i&&x>0,j=(f||0)*(p||0);(y||b||x>=j||u.dragging)&&d.push(u)}),d},KC=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},YC=(e,t,n,r,s,i=.1)=>{const a=t/(e.width*(1+i)),l=n/(e.height*(1+i)),c=Math.min(a,l),d=Ni(c,r,s),u=e.x+e.width/2,f=e.y+e.height/2,p=t/2-u*d,h=n/2-f*d;return{x:p,y:h,zoom:d}},ls=(e,t=0)=>e.transition().duration(t);function Rb(e,t,n,r){return(t[n]||[]).reduce((s,i)=>{var a,l;return`${e.id}-${i.id}-${n}`!==r&&s.push({id:i.id||null,type:n,nodeId:e.id,x:(((a=e.positionAbsolute)==null?void 0:a.x)??0)+i.x+i.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+i.y+i.height/2}),s},[])}function MM(e,t,n,r,s,i){const{x:a,y:l}=Vr(e),d=t.elementsFromPoint(a,l).find(v=>v.classList.contains("react-flow__handle"));if(d){const v=d.getAttribute("data-nodeid");if(v){const g=cy(void 0,d),_=d.getAttribute("data-handleid"),x=i({nodeId:v,id:_,type:g});if(x){const y=s.find(b=>b.nodeId===v&&b.type===g&&b.id===_);return{handle:{id:_,type:g,nodeId:v,x:(y==null?void 0:y.x)||n.x,y:(y==null?void 0:y.y)||n.y},validHandleResult:x}}}}let u=[],f=1/0;if(s.forEach(v=>{const g=Math.sqrt((v.x-n.x)**2+(v.y-n.y)**2);if(g<=r){const _=i(v);g<=f&&(g<f?u=[{handle:v,validHandleResult:_}]:g===f&&u.push({handle:v,validHandleResult:_}),f=g)}}),!u.length)return{handle:null,validHandleResult:XC()};if(u.length===1)return u[0];const p=u.some(({validHandleResult:v})=>v.isValid),h=u.some(({handle:v})=>v.type==="target");return u.find(({handle:v,validHandleResult:g})=>h?v.type==="target":p?g.isValid:!0)||u[0]}const OM={source:null,target:null,sourceHandle:null,targetHandle:null},XC=()=>({handleDomNode:null,isValid:!1,connection:OM,endHandle:null});function QC(e,t,n,r,s,i,a){const l=s==="target",c=a.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),d={...XC(),handleDomNode:c};if(c){const u=cy(void 0,c),f=c.getAttribute("data-nodeid"),p=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),v=c.classList.contains("connectableend"),g={source:l?f:n,sourceHandle:l?p:r,target:l?n:f,targetHandle:l?r:p};d.connection=g,h&&v&&(t===Ns.Strict?l&&u==="source"||!l&&u==="target":f!==n||p!==r)&&(d.endHandle={nodeId:f,handleId:p,type:u},d.isValid=i(g))}return d}function DM({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((s,i)=>{if(i[ot]){const{handleBounds:a}=i[ot];let l=[],c=[];a&&(l=Rb(i,a,"source",`${t}-${n}-${r}`),c=Rb(i,a,"target",`${t}-${n}-${r}`)),s.push(...l,...c)}return s},[])}function cy(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function fd(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function LM(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function ZC({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:s,getState:i,setState:a,isValidConnection:l,edgeUpdaterType:c,onReconnectEnd:d}){const u=LC(e.target),{connectionMode:f,domNode:p,autoPanOnConnect:h,connectionRadius:v,onConnectStart:g,panBy:_,getNodes:x,cancelConnection:y}=i();let b=0,j;const{x:N,y:E}=Vr(e),S=u==null?void 0:u.elementFromPoint(N,E),k=cy(c,S),w=p==null?void 0:p.getBoundingClientRect();if(!w||!k)return;let R,T=Vr(e,w),I=!1,D=null,C=!1,M=null;const P=DM({nodes:x(),nodeId:n,handleId:t,handleType:k}),F=()=>{if(!h)return;const[z,$]=DC(T,w);_({x:z,y:$}),b=requestAnimationFrame(F)};a({connectionPosition:T,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:k,connectionStartHandle:{nodeId:n,handleId:t,type:k},connectionEndHandle:null}),g==null||g(e,{nodeId:n,handleId:t,handleType:k});function O(z){const{transform:$}=i();T=Vr(z,w);const{handle:B,validHandleResult:U}=MM(z,u,Fx(T,$,!1,[1,1]),v,P,G=>QC(G,f,n,t,s?"target":"source",l,u));if(j=B,I||(F(),I=!0),M=U.handleDomNode,D=U.connection,C=U.isValid,a({connectionPosition:j&&C?UC({x:j.x,y:j.y},$):T,connectionStatus:LM(!!j,C),connectionEndHandle:U.endHandle}),!j&&!C&&!M)return fd(R);D.source!==D.target&&M&&(fd(R),R=M,M.classList.add("connecting","react-flow__handle-connecting"),M.classList.toggle("valid",C),M.classList.toggle("react-flow__handle-valid",C))}function A(z){var $,B;(j||M)&&D&&C&&(r==null||r(D)),(B=($=i()).onConnectEnd)==null||B.call($,z),c&&(d==null||d(z)),fd(R),y(),cancelAnimationFrame(b),I=!1,C=!1,D=null,M=null,u.removeEventListener("mousemove",O),u.removeEventListener("mouseup",A),u.removeEventListener("touchmove",O),u.removeEventListener("touchend",A)}u.addEventListener("mousemove",O),u.addEventListener("mouseup",A),u.addEventListener("touchmove",O),u.addEventListener("touchend",A)}const Ab=()=>!0,zM=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),FM=(e,t,n)=>r=>{const{connectionStartHandle:s,connectionEndHandle:i,connectionClickStartHandle:a}=r;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n,clickConnecting:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.handleId)===t&&(a==null?void 0:a.type)===n}},JC=m.forwardRef(({type:e="source",position:t=ce.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:a,onConnect:l,children:c,className:d,onMouseDown:u,onTouchStart:f,...p},h)=>{var w,R;const v=a||null,g=e==="target",_=wt(),x=TM(),{connectOnClick:y,noPanClassName:b}=Je(zM,Mt),{connecting:j,clickConnecting:N}=Je(FM(x,v,e),Mt);x||(R=(w=_.getState()).onError)==null||R.call(w,"010",mr.error010());const E=T=>{const{defaultEdgeOptions:I,onConnect:D,hasDefaultEdges:C}=_.getState(),M={...I,...T};if(C){const{edges:P,setEdges:F}=_.getState();F(PM(M,P))}D==null||D(M),l==null||l(M)},S=T=>{if(!x)return;const I=qC(T);s&&(I&&T.button===0||!I)&&ZC({event:T,handleId:v,nodeId:x,onConnect:E,isTarget:g,getState:_.getState,setState:_.setState,isValidConnection:n||_.getState().isValidConnection||Ab}),I?u==null||u(T):f==null||f(T)},k=T=>{const{onClickConnectStart:I,onClickConnectEnd:D,connectionClickStartHandle:C,connectionMode:M,isValidConnection:P}=_.getState();if(!x||!C&&!s)return;if(!C){I==null||I(T,{nodeId:x,handleId:v,handleType:e}),_.setState({connectionClickStartHandle:{nodeId:x,type:e,handleId:v}});return}const F=LC(T.target),O=n||P||Ab,{connection:A,isValid:z}=QC({nodeId:x,id:v,type:e},M,C.nodeId,C.handleId||null,C.type,O,F);z&&E(A),D==null||D(T),_.setState({connectionClickStartHandle:null})};return X.createElement("div",{"data-handleid":v,"data-nodeid":x,"data-handlepos":t,"data-id":`${x}-${v}-${e}`,className:Xt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",b,d,{source:!g,target:g,connectable:r,connectablestart:s,connectableend:i,connecting:N,connectionindicator:r&&(s&&!j||i&&j)}]),onMouseDown:S,onTouchStart:S,onClick:y?k:void 0,ref:h,...p},c)});JC.displayName="Handle";var yn=m.memo(JC);const eE=({data:e,isConnectable:t,targetPosition:n=ce.Top,sourcePosition:r=ce.Bottom})=>X.createElement(X.Fragment,null,X.createElement(yn,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,X.createElement(yn,{type:"source",position:r,isConnectable:t}));eE.displayName="DefaultNode";var $x=m.memo(eE);const tE=({data:e,isConnectable:t,sourcePosition:n=ce.Bottom})=>X.createElement(X.Fragment,null,e==null?void 0:e.label,X.createElement(yn,{type:"source",position:n,isConnectable:t}));tE.displayName="InputNode";var nE=m.memo(tE);const rE=({data:e,isConnectable:t,targetPosition:n=ce.Top})=>X.createElement(X.Fragment,null,X.createElement(yn,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);rE.displayName="OutputNode";var sE=m.memo(rE);const uy=()=>null;uy.displayName="GroupNode";const $M=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),nl=e=>e.id;function qM(e,t){return Mt(e.selectedNodes.map(nl),t.selectedNodes.map(nl))&&Mt(e.selectedEdges.map(nl),t.selectedEdges.map(nl))}const iE=m.memo(({onSelectionChange:e})=>{const t=wt(),{selectedNodes:n,selectedEdges:r}=Je($M,qM);return m.useEffect(()=>{const s={nodes:n,edges:r};e==null||e(s),t.getState().onSelectionChange.forEach(i=>i(s))},[n,r,e]),null});iE.displayName="SelectionListener";const BM=e=>!!e.onSelectionChange;function WM({onSelectionChange:e}){const t=Je(BM);return e||t?X.createElement(iE,{onSelectionChange:e}):null}const HM=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Os(e,t){m.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Te(e,t,n){m.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const VM=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:s,onConnectStart:i,onConnectEnd:a,onClickConnectStart:l,onClickConnectEnd:c,nodesDraggable:d,nodesConnectable:u,nodesFocusable:f,edgesFocusable:p,edgesUpdatable:h,elevateNodesOnSelect:v,minZoom:g,maxZoom:_,nodeExtent:x,onNodesChange:y,onEdgesChange:b,elementsSelectable:j,connectionMode:N,snapGrid:E,snapToGrid:S,translateExtent:k,connectOnClick:w,defaultEdgeOptions:R,fitView:T,fitViewOptions:I,onNodesDelete:D,onEdgesDelete:C,onNodeDrag:M,onNodeDragStart:P,onNodeDragStop:F,onSelectionDrag:O,onSelectionDragStart:A,onSelectionDragStop:z,noPanClassName:$,nodeOrigin:B,rfId:U,autoPanOnConnect:G,autoPanOnNodeDrag:H,onError:q,connectionRadius:Q,isValidConnection:se,nodeDragThreshold:ie})=>{const{setNodes:Z,setEdges:Se,setDefaultNodesAndEdges:xe,setMinZoom:be,setMaxZoom:ve,setTranslateExtent:ae,setNodeExtent:Y,reset:te}=Je(HM,Mt),ee=wt();return m.useEffect(()=>{const ke=r==null?void 0:r.map(we=>({...we,...R}));return xe(n,ke),()=>{te()}},[]),Te("defaultEdgeOptions",R,ee.setState),Te("connectionMode",N,ee.setState),Te("onConnect",s,ee.setState),Te("onConnectStart",i,ee.setState),Te("onConnectEnd",a,ee.setState),Te("onClickConnectStart",l,ee.setState),Te("onClickConnectEnd",c,ee.setState),Te("nodesDraggable",d,ee.setState),Te("nodesConnectable",u,ee.setState),Te("nodesFocusable",f,ee.setState),Te("edgesFocusable",p,ee.setState),Te("edgesUpdatable",h,ee.setState),Te("elementsSelectable",j,ee.setState),Te("elevateNodesOnSelect",v,ee.setState),Te("snapToGrid",S,ee.setState),Te("snapGrid",E,ee.setState),Te("onNodesChange",y,ee.setState),Te("onEdgesChange",b,ee.setState),Te("connectOnClick",w,ee.setState),Te("fitViewOnInit",T,ee.setState),Te("fitViewOnInitOptions",I,ee.setState),Te("onNodesDelete",D,ee.setState),Te("onEdgesDelete",C,ee.setState),Te("onNodeDrag",M,ee.setState),Te("onNodeDragStart",P,ee.setState),Te("onNodeDragStop",F,ee.setState),Te("onSelectionDrag",O,ee.setState),Te("onSelectionDragStart",A,ee.setState),Te("onSelectionDragStop",z,ee.setState),Te("noPanClassName",$,ee.setState),Te("nodeOrigin",B,ee.setState),Te("rfId",U,ee.setState),Te("autoPanOnConnect",G,ee.setState),Te("autoPanOnNodeDrag",H,ee.setState),Te("onError",q,ee.setState),Te("connectionRadius",Q,ee.setState),Te("isValidConnection",se,ee.setState),Te("nodeDragThreshold",ie,ee.setState),Os(e,Z),Os(t,Se),Os(g,be),Os(_,ve),Os(k,ae),Os(x,Y),null},Ib={display:"none"},UM={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},oE="react-flow__node-desc",aE="react-flow__edge-desc",GM="react-flow__aria-live",KM=e=>e.ariaLiveMessage;function YM({rfId:e}){const t=Je(KM);return X.createElement("div",{id:`${GM}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:UM},t)}function XM({rfId:e,disableKeyboardA11y:t}){return X.createElement(X.Fragment,null,X.createElement("div",{id:`${oE}-${e}`,style:Ib},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),X.createElement("div",{id:`${aE}-${e}`,style:Ib},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&X.createElement(YM,{rfId:e}))}var ia=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=m.useState(!1),s=m.useRef(!1),i=m.useRef(new Set([])),[a,l]=m.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),u=d.reduce((f,p)=>f.concat(...p),[]);return[d,u]}return[[],[]]},[e]);return m.useEffect(()=>{const c=typeof document<"u"?document:null,d=(t==null?void 0:t.target)||c;if(e!==null){const u=h=>{if(s.current=h.ctrlKey||h.metaKey||h.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Dx(h))return!1;const g=Mb(h.code,l);i.current.add(h[g]),Pb(a,i.current,!1)&&(h.preventDefault(),r(!0))},f=h=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Dx(h))return!1;const g=Mb(h.code,l);Pb(a,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(h[g]),h.key==="Meta"&&i.current.clear(),s.current=!1},p=()=>{i.current.clear(),r(!1)};return d==null||d.addEventListener("keydown",u),d==null||d.addEventListener("keyup",f),window.addEventListener("blur",p),()=>{d==null||d.removeEventListener("keydown",u),d==null||d.removeEventListener("keyup",f),window.removeEventListener("blur",p)}}},[e,r]),n};function Pb(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(s=>t.has(s)))}function Mb(e,t){return t.includes(e)?"code":"key"}function lE(e,t,n,r){var l,c;const s=e.parentNode||e.parentId;if(!s)return n;const i=t.get(s),a=vs(i,r);return lE(i,t,{x:(n.x??0)+a.x,y:(n.y??0)+a.y,z:(((l=i[ot])==null?void 0:l.z)??0)>(n.z??0)?((c=i[ot])==null?void 0:c.z)??0:n.z??0},r)}function cE(e,t,n){e.forEach(r=>{var i;const s=r.parentNode||r.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||n!=null&&n[r.id]){const{x:a,y:l,z:c}=lE(r,e,{...r.position,z:((i=r[ot])==null?void 0:i.z)??0},t);r.positionAbsolute={x:a,y:l},r[ot].z=c,n!=null&&n[r.id]&&(r[ot].isParent=!0)}})}function pd(e,t,n,r){const s=new Map,i={},a=r?1e3:0;return e.forEach(l=>{var h;const c=(mn(l.zIndex)?l.zIndex:0)+(l.selected?a:0),d=t.get(l.id),u={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},f=l.parentNode||l.parentId;f&&(i[f]=!0);const p=(d==null?void 0:d.type)&&(d==null?void 0:d.type)!==l.type;Object.defineProperty(u,ot,{enumerable:!1,value:{handleBounds:p||(h=d==null?void 0:d[ot])==null?void 0:h.handleBounds,z:c}}),s.set(l.id,u)}),cE(s,n,i),s}function uE(e,t={}){const{getNodes:n,width:r,height:s,minZoom:i,maxZoom:a,d3Zoom:l,d3Selection:c,fitViewOnInitDone:d,fitViewOnInit:u,nodeOrigin:f}=e(),p=t.initial&&!d&&u;if(l&&c&&(p||!t.initial)){const v=n().filter(_=>{var y;const x=t.includeHiddenNodes?_.width&&_.height:!_.hidden;return(y=t.nodes)!=null&&y.length?x&&t.nodes.some(b=>b.id===_.id):x}),g=v.every(_=>_.width&&_.height);if(v.length>0&&g){const _=su(v,f),{x,y,zoom:b}=YC(_,r,s,t.minZoom??i,t.maxZoom??a,t.padding??.1),j=cr.translate(x,y).scale(b);return typeof t.duration=="number"&&t.duration>0?l.transform(ls(c,t.duration),j):l.transform(c,j),!0}}return!1}function QM(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[ot]:r[ot],selected:n.selected})}),new Map(t)}function ZM(e,t){return t.map(n=>{const r=e.find(s=>s.id===n.id);return r&&(n.selected=r.selected),n})}function rl({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:s,edges:i,onNodesChange:a,onEdgesChange:l,hasDefaultNodes:c,hasDefaultEdges:d}=n();e!=null&&e.length&&(c&&r({nodeInternals:QM(e,s)}),a==null||a(e)),t!=null&&t.length&&(d&&r({edges:ZM(t,i)}),l==null||l(t))}const Ds=()=>{},JM={zoomIn:Ds,zoomOut:Ds,zoomTo:Ds,getZoom:()=>1,setViewport:Ds,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Ds,fitBounds:Ds,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},eO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),tO=()=>{const e=wt(),{d3Zoom:t,d3Selection:n}=Je(eO,Mt);return m.useMemo(()=>n&&t?{zoomIn:s=>t.scaleBy(ls(n,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(ls(n,s==null?void 0:s.duration),1/1.2),zoomTo:(s,i)=>t.scaleTo(ls(n,i==null?void 0:i.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,i)=>{const[a,l,c]=e.getState().transform,d=cr.translate(s.x??a,s.y??l).scale(s.zoom??c);t.transform(ls(n,i==null?void 0:i.duration),d)},getViewport:()=>{const[s,i,a]=e.getState().transform;return{x:s,y:i,zoom:a}},fitView:s=>uE(e.getState,s),setCenter:(s,i,a)=>{const{width:l,height:c,maxZoom:d}=e.getState(),u=typeof(a==null?void 0:a.zoom)<"u"?a.zoom:d,f=l/2-s*u,p=c/2-i*u,h=cr.translate(f,p).scale(u);t.transform(ls(n,a==null?void 0:a.duration),h)},fitBounds:(s,i)=>{const{width:a,height:l,minZoom:c,maxZoom:d}=e.getState(),{x:u,y:f,zoom:p}=YC(s,a,l,c,d,(i==null?void 0:i.padding)??.1),h=cr.translate(u,f).scale(p);t.transform(ls(n,i==null?void 0:i.duration),h)},project:s=>{const{transform:i,snapToGrid:a,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Fx(s,i,a,l)},screenToFlowPosition:s=>{const{transform:i,snapToGrid:a,snapGrid:l,domNode:c}=e.getState();if(!c)return s;const{x:d,y:u}=c.getBoundingClientRect(),f={x:s.x-d,y:s.y-u};return Fx(f,i,a,l)},flowToScreenPosition:s=>{const{transform:i,domNode:a}=e.getState();if(!a)return s;const{x:l,y:c}=a.getBoundingClientRect(),d=UC(s,i);return{x:d.x+l,y:d.y+c}},viewportInitialized:!0}:JM,[t,n])};function iu(){const e=tO(),t=wt(),n=m.useCallback(()=>t.getState().getNodes().map(g=>({...g})),[]),r=m.useCallback(g=>t.getState().nodeInternals.get(g),[]),s=m.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(_=>({..._}))},[]),i=m.useCallback(g=>{const{edges:_=[]}=t.getState();return _.find(x=>x.id===g)},[]),a=m.useCallback(g=>{const{getNodes:_,setNodes:x,hasDefaultNodes:y,onNodesChange:b}=t.getState(),j=_(),N=typeof g=="function"?g(j):g;if(y)x(N);else if(b){const E=N.length===0?j.map(S=>({type:"remove",id:S.id})):N.map(S=>({item:S,type:"reset"}));b(E)}},[]),l=m.useCallback(g=>{const{edges:_=[],setEdges:x,hasDefaultEdges:y,onEdgesChange:b}=t.getState(),j=typeof g=="function"?g(_):g;if(y)x(j);else if(b){const N=j.length===0?_.map(E=>({type:"remove",id:E.id})):j.map(E=>({item:E,type:"reset"}));b(N)}},[]),c=m.useCallback(g=>{const _=Array.isArray(g)?g:[g],{getNodes:x,setNodes:y,hasDefaultNodes:b,onNodesChange:j}=t.getState();if(b){const E=[...x(),..._];y(E)}else if(j){const N=_.map(E=>({item:E,type:"add"}));j(N)}},[]),d=m.useCallback(g=>{const _=Array.isArray(g)?g:[g],{edges:x=[],setEdges:y,hasDefaultEdges:b,onEdgesChange:j}=t.getState();if(b)y([...x,..._]);else if(j){const N=_.map(E=>({item:E,type:"add"}));j(N)}},[]),u=m.useCallback(()=>{const{getNodes:g,edges:_=[],transform:x}=t.getState(),[y,b,j]=x;return{nodes:g().map(N=>({...N})),edges:_.map(N=>({...N})),viewport:{x:y,y:b,zoom:j}}},[]),f=m.useCallback(({nodes:g,edges:_})=>{const{nodeInternals:x,getNodes:y,edges:b,hasDefaultNodes:j,hasDefaultEdges:N,onNodesDelete:E,onEdgesDelete:S,onNodesChange:k,onEdgesChange:w}=t.getState(),R=(g||[]).map(M=>M.id),T=(_||[]).map(M=>M.id),I=y().reduce((M,P)=>{const F=P.parentNode||P.parentId,O=!R.includes(P.id)&&F&&M.find(z=>z.id===F);return(typeof P.deletable=="boolean"?P.deletable:!0)&&(R.includes(P.id)||O)&&M.push(P),M},[]),D=b.filter(M=>typeof M.deletable=="boolean"?M.deletable:!0),C=D.filter(M=>T.includes(M.id));if(I||C){const M=KC(I,D),P=[...C,...M],F=P.reduce((O,A)=>(O.includes(A.id)||O.push(A.id),O),[]);if((N||j)&&(N&&t.setState({edges:b.filter(O=>!F.includes(O.id))}),j&&(I.forEach(O=>{x.delete(O.id)}),t.setState({nodeInternals:new Map(x)}))),F.length>0&&(S==null||S(P),w&&w(F.map(O=>({id:O,type:"remove"})))),I.length>0&&(E==null||E(I),k)){const O=I.map(A=>({id:A.id,type:"remove"}));k(O)}}},[]),p=m.useCallback(g=>{const _=_M(g),x=_?null:t.getState().nodeInternals.get(g.id);return!_&&!x?[null,null,_]:[_?g:kb(x),x,_]},[]),h=m.useCallback((g,_=!0,x)=>{const[y,b,j]=p(g);return y?(x||t.getState().getNodes()).filter(N=>{if(!j&&(N.id===b.id||!N.positionAbsolute))return!1;const E=kb(N),S=Ox(E,y);return _&&S>0||S>=y.width*y.height}):[]},[]),v=m.useCallback((g,_,x=!0)=>{const[y]=p(g);if(!y)return!1;const b=Ox(y,_);return x&&b>0||b>=y.width*y.height},[]);return m.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:s,getEdge:i,setNodes:a,setEdges:l,addNodes:c,addEdges:d,toObject:u,deleteElements:f,getIntersectingNodes:h,isNodeIntersecting:v}),[e,n,r,s,i,a,l,c,d,u,f,h,v])}const nO={actInsideInputWithModifier:!1};var rO=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=wt(),{deleteElements:r}=iu(),s=ia(e,nO),i=ia(t);m.useEffect(()=>{if(s){const{edges:a,getNodes:l}=n.getState(),c=l().filter(u=>u.selected),d=a.filter(u=>u.selected);r({nodes:c,edges:d}),n.setState({nodesSelectionActive:!1})}},[s]),m.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function sO(e){const t=wt();m.useEffect(()=>{let n;const r=()=>{var i,a;if(!e.current)return;const s=ry(e.current);(s.height===0||s.width===0)&&((a=(i=t.getState()).onError)==null||a.call(i,"004",mr.error004())),t.setState({width:s.width||500,height:s.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const dy={position:"absolute",width:"100%",height:"100%",top:0,left:0},iO=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,sl=e=>({x:e.x,y:e.y,zoom:e.k}),Ls=(e,t)=>e.target.closest(`.${t}`),Ob=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Db=e=>{const t=e.ctrlKey&&fc()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},oO=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),aO=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:s=!0,zoomOnPinch:i=!0,panOnScroll:a=!1,panOnScrollSpeed:l=.5,panOnScrollMode:c=ps.Free,zoomOnDoubleClick:d=!0,elementsSelectable:u,panOnDrag:f=!0,defaultViewport:p,translateExtent:h,minZoom:v,maxZoom:g,zoomActivationKeyCode:_,preventScrolling:x=!0,children:y,noWheelClassName:b,noPanClassName:j})=>{const N=m.useRef(),E=wt(),S=m.useRef(!1),k=m.useRef(!1),w=m.useRef(null),R=m.useRef({x:0,y:0,zoom:0}),{d3Zoom:T,d3Selection:I,d3ZoomHandler:D,userSelectionActive:C}=Je(oO,Mt),M=ia(_),P=m.useRef(0),F=m.useRef(!1),O=m.useRef();return sO(w),m.useEffect(()=>{if(w.current){const A=w.current.getBoundingClientRect(),z=MC().scaleExtent([v,g]).translateExtent(h),$=pn(w.current).call(z),B=cr.translate(p.x,p.y).scale(Ni(p.zoom,v,g)),U=[[0,0],[A.width,A.height]],G=z.constrain()(B,U,h);z.transform($,G),z.wheelDelta(Db),E.setState({d3Zoom:z,d3Selection:$,d3ZoomHandler:$.on("wheel.zoom"),transform:[G.x,G.y,G.k],domNode:w.current.closest(".react-flow")})}},[]),m.useEffect(()=>{I&&T&&(a&&!M&&!C?I.on("wheel.zoom",A=>{if(Ls(A,b))return!1;A.preventDefault(),A.stopImmediatePropagation();const z=I.property("__zoom").k||1;if(A.ctrlKey&&i){const se=Cn(A),ie=Db(A),Z=z*Math.pow(2,ie);T.scaleTo(I,Z,se,A);return}const $=A.deltaMode===1?20:1;let B=c===ps.Vertical?0:A.deltaX*$,U=c===ps.Horizontal?0:A.deltaY*$;!fc()&&A.shiftKey&&c!==ps.Vertical&&(B=A.deltaY*$,U=0),T.translateBy(I,-(B/z)*l,-(U/z)*l,{internal:!0});const G=sl(I.property("__zoom")),{onViewportChangeStart:H,onViewportChange:q,onViewportChangeEnd:Q}=E.getState();clearTimeout(O.current),F.current||(F.current=!0,t==null||t(A,G),H==null||H(G)),F.current&&(e==null||e(A,G),q==null||q(G),O.current=setTimeout(()=>{n==null||n(A,G),Q==null||Q(G),F.current=!1},150))},{passive:!1}):typeof D<"u"&&I.on("wheel.zoom",function(A,z){if(!x&&A.type==="wheel"&&!A.ctrlKey||Ls(A,b))return null;A.preventDefault(),D.call(this,A,z)},{passive:!1}))},[C,a,c,I,T,D,M,i,x,b,t,e,n]),m.useEffect(()=>{T&&T.on("start",A=>{var B,U;if(!A.sourceEvent||A.sourceEvent.internal)return null;P.current=(B=A.sourceEvent)==null?void 0:B.button;const{onViewportChangeStart:z}=E.getState(),$=sl(A.transform);S.current=!0,R.current=$,((U=A.sourceEvent)==null?void 0:U.type)==="mousedown"&&E.setState({paneDragging:!0}),z==null||z($),t==null||t(A.sourceEvent,$)})},[T,t]),m.useEffect(()=>{T&&(C&&!S.current?T.on("zoom",null):C||T.on("zoom",A=>{var $;const{onViewportChange:z}=E.getState();if(E.setState({transform:[A.transform.x,A.transform.y,A.transform.k]}),k.current=!!(r&&Ob(f,P.current??0)),(e||z)&&!(($=A.sourceEvent)!=null&&$.internal)){const B=sl(A.transform);z==null||z(B),e==null||e(A.sourceEvent,B)}}))},[C,T,e,f,r]),m.useEffect(()=>{T&&T.on("end",A=>{if(!A.sourceEvent||A.sourceEvent.internal)return null;const{onViewportChangeEnd:z}=E.getState();if(S.current=!1,E.setState({paneDragging:!1}),r&&Ob(f,P.current??0)&&!k.current&&r(A.sourceEvent),k.current=!1,(n||z)&&iO(R.current,A.transform)){const $=sl(A.transform);R.current=$,clearTimeout(N.current),N.current=setTimeout(()=>{z==null||z($),n==null||n(A.sourceEvent,$)},a?150:0)}})},[T,a,f,n,r]),m.useEffect(()=>{T&&T.filter(A=>{const z=M||s,$=i&&A.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&A.button===1&&A.type==="mousedown"&&(Ls(A,"react-flow__node")||Ls(A,"react-flow__edge")))return!0;if(!f&&!z&&!a&&!d&&!i||C||!d&&A.type==="dblclick"||Ls(A,b)&&A.type==="wheel"||Ls(A,j)&&(A.type!=="wheel"||a&&A.type==="wheel"&&!M)||!i&&A.ctrlKey&&A.type==="wheel"||!z&&!a&&!$&&A.type==="wheel"||!f&&(A.type==="mousedown"||A.type==="touchstart")||Array.isArray(f)&&!f.includes(A.button)&&A.type==="mousedown")return!1;const B=Array.isArray(f)&&f.includes(A.button)||!A.button||A.button<=1;return(!A.ctrlKey||A.type==="wheel")&&B})},[C,T,s,i,a,d,f,u,M]),X.createElement("div",{className:"react-flow__renderer",ref:w,style:dy},y)},lO=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function cO(){const{userSelectionActive:e,userSelectionRect:t}=Je(lO,Mt);return e&&t?X.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Lb(e,t){const n=t.parentNode||t.parentId,r=e.find(s=>s.id===n);if(r){const s=t.position.x+t.width-r.width,i=t.position.y+t.height-r.height;if(s>0||i>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,s>0&&(r.style.width+=s),i>0&&(r.style.height+=i),t.position.x<0){const a=Math.abs(t.position.x);r.position.x=r.position.x-a,r.style.width+=a,t.position.x=0}if(t.position.y<0){const a=Math.abs(t.position.y);r.position.y=r.position.y-a,r.style.height+=a,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function dE(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,s)=>{const i=e.filter(l=>l.id===s.id);if(i.length===0)return r.push(s),r;const a={...s};for(const l of i)if(l)switch(l.type){case"select":{a.selected=l.selected;break}case"position":{typeof l.position<"u"&&(a.position=l.position),typeof l.positionAbsolute<"u"&&(a.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(a.dragging=l.dragging),a.expandParent&&Lb(r,a);break}case"dimensions":{typeof l.dimensions<"u"&&(a.width=l.dimensions.width,a.height=l.dimensions.height),typeof l.updateStyle<"u"&&(a.style={...a.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(a.resizing=l.resizing),a.expandParent&&Lb(r,a);break}case"remove":return r}return r.push(a),r},n)}function fE(e,t){return dE(e,t)}function uO(e,t){return dE(e,t)}const Cr=(e,t)=>({id:e,type:"select",selected:t});function ri(e,t){return e.reduce((n,r)=>{const s=t.includes(r.id);return!r.selected&&s?(r.selected=!0,n.push(Cr(r.id,!0))):r.selected&&!s&&(r.selected=!1,n.push(Cr(r.id,!1))),n},[])}const hd=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},dO=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),pE=m.memo(({isSelecting:e,selectionMode:t=sa.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:s,onPaneClick:i,onPaneContextMenu:a,onPaneScroll:l,onPaneMouseEnter:c,onPaneMouseMove:d,onPaneMouseLeave:u,children:f})=>{const p=m.useRef(null),h=wt(),v=m.useRef(0),g=m.useRef(0),_=m.useRef(),{userSelectionActive:x,elementsSelectable:y,dragging:b}=Je(dO,Mt),j=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,g.current=0},N=D=>{i==null||i(D),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},E=D=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){D.preventDefault();return}a==null||a(D)},S=l?D=>l(D):void 0,k=D=>{const{resetSelectedElements:C,domNode:M}=h.getState();if(_.current=M==null?void 0:M.getBoundingClientRect(),!y||!e||D.button!==0||D.target!==p.current||!_.current)return;const{x:P,y:F}=Vr(D,_.current);C(),h.setState({userSelectionRect:{width:0,height:0,startX:P,startY:F,x:P,y:F}}),r==null||r(D)},w=D=>{const{userSelectionRect:C,nodeInternals:M,edges:P,transform:F,onNodesChange:O,onEdgesChange:A,nodeOrigin:z,getNodes:$}=h.getState();if(!e||!_.current||!C)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const B=Vr(D,_.current),U=C.startX??0,G=C.startY??0,H={...C,x:B.x<U?B.x:U,y:B.y<G?B.y:G,width:Math.abs(B.x-U),height:Math.abs(B.y-G)},q=$(),Q=GC(M,H,F,t===sa.Partial,!0,z),se=KC(Q,P).map(Z=>Z.id),ie=Q.map(Z=>Z.id);if(v.current!==ie.length){v.current=ie.length;const Z=ri(q,ie);Z.length&&(O==null||O(Z))}if(g.current!==se.length){g.current=se.length;const Z=ri(P,se);Z.length&&(A==null||A(Z))}h.setState({userSelectionRect:H})},R=D=>{if(D.button!==0)return;const{userSelectionRect:C}=h.getState();!x&&C&&D.target===p.current&&(N==null||N(D)),h.setState({nodesSelectionActive:v.current>0}),j(),s==null||s(D)},T=D=>{x&&(h.setState({nodesSelectionActive:v.current>0}),s==null||s(D)),j()},I=y&&(e||x);return X.createElement("div",{className:Xt(["react-flow__pane",{dragging:b,selection:e}]),onClick:I?void 0:hd(N,p),onContextMenu:hd(E,p),onWheel:hd(S,p),onMouseEnter:I?void 0:c,onMouseDown:I?k:void 0,onMouseMove:I?w:d,onMouseUp:I?R:void 0,onMouseLeave:I?T:u,ref:p,style:dy},f,X.createElement(cO,null))});pE.displayName="Pane";function hE(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:hE(r,t):!1}function zb(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function fO(e,t,n,r){return Array.from(e.values()).filter(s=>(s.selected||s.id===r)&&(!s.parentNode||s.parentId||!hE(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var i,a;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((i=s.positionAbsolute)==null?void 0:i.x)??0),y:n.y-(((a=s.positionAbsolute)==null?void 0:a.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function pO(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function mE(e,t,n,r,s=[0,0],i){const a=pO(e,e.extent||r);let l=a;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=n.get(c),{x:p,y:h}=vs(f,s).positionAbsolute;l=f&&mn(p)&&mn(h)&&mn(f.width)&&mn(f.height)?[[p+e.width*s[0],h+e.height*s[1]],[p+f.width-e.width+e.width*s[0],h+f.height-e.height+e.height*s[1]]]:l}else i==null||i("005",mr.error005()),l=a;else if(e.extent&&c&&e.extent!=="parent"){const f=n.get(c),{x:p,y:h}=vs(f,s).positionAbsolute;l=[[e.extent[0][0]+p,e.extent[0][1]+h],[e.extent[1][0]+p,e.extent[1][1]+h]]}let d={x:0,y:0};if(c){const f=n.get(c);d=vs(f,s).positionAbsolute}const u=l&&l!=="parent"?sy(t,l):t;return{position:{x:u.x-d.x,y:u.y-d.y},positionAbsolute:u}}function md({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(s=>({...n.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?r.find(s=>s.id===e):r[0],r]}const Fb=(e,t,n,r)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const i=Array.from(s),a=t.getBoundingClientRect(),l={x:a.width*r[0],y:a.height*r[1]};return i.map(c=>{const d=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(d.left-a.left-l.x)/n,y:(d.top-a.top-l.y)/n,...ry(c)}})};function eo(e,t,n){return n===void 0?n:r=>{const s=t().nodeInternals.get(e);s&&n(r,{...s})}}function qx({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:a,nodeInternals:l,onError:c}=t.getState(),d=l.get(e);if(!d){c==null||c("012",mr.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(n||d.selected&&a)&&(i({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):s([e])}function hO(){const e=wt();return m.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:s,snapToGrid:i}=e.getState(),a=n.touches?n.touches[0].clientX:n.clientX,l=n.touches?n.touches[0].clientY:n.clientY,c={x:(a-r[0])/r[2],y:(l-r[1])/r[2]};return{xSnapped:i?s[0]*Math.round(c.x/s[0]):c.x,ySnapped:i?s[1]*Math.round(c.y/s[1]):c.y,...c}},[])}function gd(e){return(t,n,r)=>e==null?void 0:e(t,r)}function gE({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:s,isSelectable:i,selectNodesOnDrag:a}){const l=wt(),[c,d]=m.useState(!1),u=m.useRef([]),f=m.useRef({x:null,y:null}),p=m.useRef(0),h=m.useRef(null),v=m.useRef({x:0,y:0}),g=m.useRef(null),_=m.useRef(!1),x=m.useRef(!1),y=m.useRef(!1),b=hO();return m.useEffect(()=>{if(e!=null&&e.current){const j=pn(e.current),N=({x:k,y:w})=>{const{nodeInternals:R,onNodeDrag:T,onSelectionDrag:I,updateNodePositions:D,nodeExtent:C,snapGrid:M,snapToGrid:P,nodeOrigin:F,onError:O}=l.getState();f.current={x:k,y:w};let A=!1,z={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&C){const B=su(u.current,F);z=ra(B)}if(u.current=u.current.map(B=>{const U={x:k-B.distance.x,y:w-B.distance.y};P&&(U.x=M[0]*Math.round(U.x/M[0]),U.y=M[1]*Math.round(U.y/M[1]));const G=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];u.current.length>1&&C&&!B.extent&&(G[0][0]=B.positionAbsolute.x-z.x+C[0][0],G[1][0]=B.positionAbsolute.x+(B.width??0)-z.x2+C[1][0],G[0][1]=B.positionAbsolute.y-z.y+C[0][1],G[1][1]=B.positionAbsolute.y+(B.height??0)-z.y2+C[1][1]);const H=mE(B,U,R,G,F,O);return A=A||B.position.x!==H.position.x||B.position.y!==H.position.y,B.position=H.position,B.positionAbsolute=H.positionAbsolute,B}),!A)return;D(u.current,!0,!0),d(!0);const $=s?T:gd(I);if($&&g.current){const[B,U]=md({nodeId:s,dragItems:u.current,nodeInternals:R});$(g.current,B,U)}},E=()=>{if(!h.current)return;const[k,w]=DC(v.current,h.current);if(k!==0||w!==0){const{transform:R,panBy:T}=l.getState();f.current.x=(f.current.x??0)-k/R[2],f.current.y=(f.current.y??0)-w/R[2],T({x:k,y:w})&&N(f.current)}p.current=requestAnimationFrame(E)},S=k=>{var F;const{nodeInternals:w,multiSelectionActive:R,nodesDraggable:T,unselectNodesAndEdges:I,onNodeDragStart:D,onSelectionDragStart:C}=l.getState();x.current=!0;const M=s?D:gd(C);(!a||!i)&&!R&&s&&((F=w.get(s))!=null&&F.selected||I()),s&&i&&a&&qx({id:s,store:l,nodeRef:e});const P=b(k);if(f.current=P,u.current=fO(w,T,P,s),M&&u.current){const[O,A]=md({nodeId:s,dragItems:u.current,nodeInternals:w});M(k.sourceEvent,O,A)}};if(t)j.on(".drag",null);else{const k=k6().on("start",w=>{const{domNode:R,nodeDragThreshold:T}=l.getState();T===0&&S(w),y.current=!1;const I=b(w);f.current=I,h.current=(R==null?void 0:R.getBoundingClientRect())||null,v.current=Vr(w.sourceEvent,h.current)}).on("drag",w=>{var D,C;const R=b(w),{autoPanOnNodeDrag:T,nodeDragThreshold:I}=l.getState();if(w.sourceEvent.type==="touchmove"&&w.sourceEvent.touches.length>1&&(y.current=!0),!y.current){if(!_.current&&x.current&&T&&(_.current=!0,E()),!x.current){const M=R.xSnapped-(((D=f==null?void 0:f.current)==null?void 0:D.x)??0),P=R.ySnapped-(((C=f==null?void 0:f.current)==null?void 0:C.y)??0);Math.sqrt(M*M+P*P)>I&&S(w)}(f.current.x!==R.xSnapped||f.current.y!==R.ySnapped)&&u.current&&x.current&&(g.current=w.sourceEvent,v.current=Vr(w.sourceEvent,h.current),N(R))}}).on("end",w=>{if(!(!x.current||y.current)&&(d(!1),_.current=!1,x.current=!1,cancelAnimationFrame(p.current),u.current)){const{updateNodePositions:R,nodeInternals:T,onNodeDragStop:I,onSelectionDragStop:D}=l.getState(),C=s?I:gd(D);if(R(u.current,!1,!1),C){const[M,P]=md({nodeId:s,dragItems:u.current,nodeInternals:T});C(w.sourceEvent,M,P)}}}).filter(w=>{const R=w.target;return!w.button&&(!n||!zb(R,`.${n}`,e))&&(!r||zb(R,r,e))});return j.call(k),()=>{j.on(".drag",null)}}}},[e,t,n,r,i,l,s,a,b]),c}function xE(){const e=wt();return m.useCallback(n=>{const{nodeInternals:r,nodeExtent:s,updateNodePositions:i,getNodes:a,snapToGrid:l,snapGrid:c,onError:d,nodesDraggable:u}=e.getState(),f=a().filter(y=>y.selected&&(y.draggable||u&&typeof y.draggable>"u")),p=l?c[0]:5,h=l?c[1]:5,v=n.isShiftPressed?4:1,g=n.x*p*v,_=n.y*h*v,x=f.map(y=>{if(y.positionAbsolute){const b={x:y.positionAbsolute.x+g,y:y.positionAbsolute.y+_};l&&(b.x=c[0]*Math.round(b.x/c[0]),b.y=c[1]*Math.round(b.y/c[1]));const{positionAbsolute:j,position:N}=mE(y,b,r,s,void 0,d);y.position=N,y.positionAbsolute=j}return y});i(x,!0,!1)},[])}const hi={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var to=e=>{const t=({id:n,type:r,data:s,xPos:i,yPos:a,xPosOrigin:l,yPosOrigin:c,selected:d,onClick:u,onMouseEnter:f,onMouseMove:p,onMouseLeave:h,onContextMenu:v,onDoubleClick:g,style:_,className:x,isDraggable:y,isSelectable:b,isConnectable:j,isFocusable:N,selectNodesOnDrag:E,sourcePosition:S,targetPosition:k,hidden:w,resizeObserver:R,dragHandle:T,zIndex:I,isParent:D,noDragClassName:C,noPanClassName:M,initialized:P,disableKeyboardA11y:F,ariaLabel:O,rfId:A,hasHandleBounds:z})=>{const $=wt(),B=m.useRef(null),U=m.useRef(null),G=m.useRef(S),H=m.useRef(k),q=m.useRef(r),Q=b||y||u||f||p||h,se=xE(),ie=eo(n,$.getState,f),Z=eo(n,$.getState,p),Se=eo(n,$.getState,h),xe=eo(n,$.getState,v),be=eo(n,$.getState,g),ve=te=>{const{nodeDragThreshold:ee}=$.getState();if(b&&(!E||!y||ee>0)&&qx({id:n,store:$,nodeRef:B}),u){const ke=$.getState().nodeInternals.get(n);ke&&u(te,{...ke})}},ae=te=>{if(!Dx(te)&&!F)if($C.includes(te.key)&&b){const ee=te.key==="Escape";qx({id:n,store:$,unselect:ee,nodeRef:B})}else y&&d&&Object.prototype.hasOwnProperty.call(hi,te.key)&&($.setState({ariaLiveMessage:`Moved selected node ${te.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~a}`}),se({x:hi[te.key].x,y:hi[te.key].y,isShiftPressed:te.shiftKey}))};m.useEffect(()=>()=>{U.current&&(R==null||R.unobserve(U.current),U.current=null)},[]),m.useEffect(()=>{if(B.current&&!w){const te=B.current;(!P||!z||U.current!==te)&&(U.current&&(R==null||R.unobserve(U.current)),R==null||R.observe(te),U.current=te)}},[w,P,z]),m.useEffect(()=>{const te=q.current!==r,ee=G.current!==S,ke=H.current!==k;B.current&&(te||ee||ke)&&(te&&(q.current=r),ee&&(G.current=S),ke&&(H.current=k),$.getState().updateNodeDimensions([{id:n,nodeElement:B.current,forceUpdate:!0}]))},[n,r,S,k]);const Y=gE({nodeRef:B,disabled:w||!y,noDragClassName:C,handleSelector:T,nodeId:n,isSelectable:b,selectNodesOnDrag:E});return w?null:X.createElement("div",{className:Xt(["react-flow__node",`react-flow__node-${r}`,{[M]:y},x,{selected:d,selectable:b,parent:D,dragging:Y}]),ref:B,style:{zIndex:I,transform:`translate(${l}px,${c}px)`,pointerEvents:Q?"all":"none",visibility:P?"visible":"hidden",..._},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:ie,onMouseMove:Z,onMouseLeave:Se,onContextMenu:xe,onClick:ve,onDoubleClick:be,onKeyDown:N?ae:void 0,tabIndex:N?0:void 0,role:N?"button":void 0,"aria-describedby":F?void 0:`${oE}-${A}`,"aria-label":O},X.createElement(EM,{value:n},X.createElement(e,{id:n,data:s,type:r,xPos:i,yPos:a,selected:d,isConnectable:j,sourcePosition:S,targetPosition:k,dragging:Y,dragHandle:T,zIndex:I})))};return t.displayName="NodeWrapper",m.memo(t)};const mO=e=>{const t=e.getNodes().filter(n=>n.selected);return{...su(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function gO({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=wt(),{width:s,height:i,x:a,y:l,transformString:c,userSelectionActive:d}=Je(mO,Mt),u=xE(),f=m.useRef(null);if(m.useEffect(()=>{var v;n||(v=f.current)==null||v.focus({preventScroll:!0})},[n]),gE({nodeRef:f}),d||!s||!i)return null;const p=e?v=>{const g=r.getState().getNodes().filter(_=>_.selected);e(v,g)}:void 0,h=v=>{Object.prototype.hasOwnProperty.call(hi,v.key)&&u({x:hi[v.key].x,y:hi[v.key].y,isShiftPressed:v.shiftKey})};return X.createElement("div",{className:Xt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},X.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:s,height:i,top:l,left:a}}))}var xO=m.memo(gO);const vO=e=>e.nodesSelectionActive,vE=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:a,deleteKeyCode:l,onMove:c,onMoveStart:d,onMoveEnd:u,selectionKeyCode:f,selectionOnDrag:p,selectionMode:h,onSelectionStart:v,onSelectionEnd:g,multiSelectionKeyCode:_,panActivationKeyCode:x,zoomActivationKeyCode:y,elementsSelectable:b,zoomOnScroll:j,zoomOnPinch:N,panOnScroll:E,panOnScrollSpeed:S,panOnScrollMode:k,zoomOnDoubleClick:w,panOnDrag:R,defaultViewport:T,translateExtent:I,minZoom:D,maxZoom:C,preventScrolling:M,onSelectionContextMenu:P,noWheelClassName:F,noPanClassName:O,disableKeyboardA11y:A})=>{const z=Je(vO),$=ia(f),B=ia(x),U=B||R,G=B||E,H=$||p&&U!==!0;return rO({deleteKeyCode:l,multiSelectionKeyCode:_}),X.createElement(aO,{onMove:c,onMoveStart:d,onMoveEnd:u,onPaneContextMenu:i,elementsSelectable:b,zoomOnScroll:j,zoomOnPinch:N,panOnScroll:G,panOnScrollSpeed:S,panOnScrollMode:k,zoomOnDoubleClick:w,panOnDrag:!$&&U,defaultViewport:T,translateExtent:I,minZoom:D,maxZoom:C,zoomActivationKeyCode:y,preventScrolling:M,noWheelClassName:F,noPanClassName:O},X.createElement(pE,{onSelectionStart:v,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:a,panOnDrag:U,isSelecting:!!H,selectionMode:h},e,z&&X.createElement(xO,{onSelectionContextMenu:P,noPanClassName:O,disableKeyboardA11y:A})))};vE.displayName="FlowRenderer";var yO=m.memo(vE);function bO(e){return Je(m.useCallback(n=>e?GC(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function _O(e){const t={input:to(e.input||nE),default:to(e.default||$x),output:to(e.output||sE),group:to(e.group||uy)},n={},r=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,i)=>(s[i]=to(e[i]||$x),s),n);return{...t,...r}}const wO=({x:e,y:t,width:n,height:r,origin:s})=>!n||!r?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-n*s[0],y:t-r*s[1]},jO=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),yE=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:s,updateNodeDimensions:i,onError:a}=Je(jO,Mt),l=bO(e.onlyRenderVisibleElements),c=m.useRef(),d=m.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(f=>{const p=f.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));i(p)});return c.current=u,u},[]);return m.useEffect(()=>()=>{var u;(u=c==null?void 0:c.current)==null||u.disconnect()},[]),X.createElement("div",{className:"react-flow__nodes",style:dy},l.map(u=>{var N,E,S;let f=u.type||"default";e.nodeTypes[f]||(a==null||a("003",mr.error003(f)),f="default");const p=e.nodeTypes[f]||e.nodeTypes.default,h=!!(u.draggable||t&&typeof u.draggable>"u"),v=!!(u.selectable||s&&typeof u.selectable>"u"),g=!!(u.connectable||n&&typeof u.connectable>"u"),_=!!(u.focusable||r&&typeof u.focusable>"u"),x=e.nodeExtent?sy(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,y=(x==null?void 0:x.x)??0,b=(x==null?void 0:x.y)??0,j=wO({x:y,y:b,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return X.createElement(p,{key:u.id,id:u.id,className:u.className,style:u.style,type:f,data:u.data,sourcePosition:u.sourcePosition||ce.Bottom,targetPosition:u.targetPosition||ce.Top,hidden:u.hidden,xPos:y,yPos:b,xPosOrigin:j.x,yPosOrigin:j.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:h,isSelectable:v,isConnectable:g,isFocusable:_,resizeObserver:d,dragHandle:u.dragHandle,zIndex:((N=u[ot])==null?void 0:N.z)??0,isParent:!!((E=u[ot])!=null&&E.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!((S=u[ot])!=null&&S.handleBounds)})}))};yE.displayName="NodeRenderer";var SO=m.memo(yE);const kO=(e,t,n)=>n===ce.Left?e-t:n===ce.Right?e+t:e,NO=(e,t,n)=>n===ce.Top?e-t:n===ce.Bottom?e+t:e,$b="react-flow__edgeupdater",qb=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:s,onMouseEnter:i,onMouseOut:a,type:l})=>X.createElement("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:a,className:Xt([$b,`${$b}-${l}`]),cx:kO(t,r,e),cy:NO(n,r,e),r,stroke:"transparent",fill:"transparent"}),CO=()=>!0;var zs=e=>{const t=({id:n,className:r,type:s,data:i,onClick:a,onEdgeDoubleClick:l,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:v,labelBgBorderRadius:g,style:_,source:x,target:y,sourceX:b,sourceY:j,targetX:N,targetY:E,sourcePosition:S,targetPosition:k,elementsSelectable:w,hidden:R,sourceHandleId:T,targetHandleId:I,onContextMenu:D,onMouseEnter:C,onMouseMove:M,onMouseLeave:P,reconnectRadius:F,onReconnect:O,onReconnectStart:A,onReconnectEnd:z,markerEnd:$,markerStart:B,rfId:U,ariaLabel:G,isFocusable:H,isReconnectable:q,pathOptions:Q,interactionWidth:se,disableKeyboardA11y:ie})=>{const Z=m.useRef(null),[Se,xe]=m.useState(!1),[be,ve]=m.useState(!1),ae=wt(),Y=m.useMemo(()=>`url('#${zx(B,U)}')`,[B,U]),te=m.useMemo(()=>`url('#${zx($,U)}')`,[$,U]);if(R)return null;const ee=fe=>{var st;const{edges:V,addSelectedEdges:ge,unselectNodesAndEdges:pe,multiSelectionActive:ze}=ae.getState(),We=V.find(Ue=>Ue.id===n);We&&(w&&(ae.setState({nodesSelectionActive:!1}),We.selected&&ze?(pe({nodes:[],edges:[We]}),(st=Z.current)==null||st.blur()):ge([n])),a&&a(fe,We))},ke=Ji(n,ae.getState,l),we=Ji(n,ae.getState,D),Ee=Ji(n,ae.getState,C),Ne=Ji(n,ae.getState,M),ne=Ji(n,ae.getState,P),je=(fe,V)=>{if(fe.button!==0)return;const{edges:ge,isValidConnection:pe}=ae.getState(),ze=V?y:x,We=(V?I:T)||null,st=V?"target":"source",Ue=pe||CO,L=V,W=ge.find(Fe=>Fe.id===n);ve(!0),A==null||A(fe,W,st);const K=Fe=>{ve(!1),z==null||z(Fe,W,st)};ZC({event:fe,handleId:We,nodeId:ze,onConnect:Fe=>O==null?void 0:O(W,Fe),isTarget:L,getState:ae.getState,setState:ae.setState,isValidConnection:Ue,edgeUpdaterType:st,onReconnectEnd:K})},Ve=fe=>je(fe,!0),ct=fe=>je(fe,!1),Be=()=>xe(!0),Ie=()=>xe(!1),oe=!w&&!a,me=fe=>{var V;if(!ie&&$C.includes(fe.key)&&w){const{unselectNodesAndEdges:ge,addSelectedEdges:pe,edges:ze}=ae.getState();fe.key==="Escape"?((V=Z.current)==null||V.blur(),ge({edges:[ze.find(st=>st.id===n)]})):pe([n])}};return X.createElement("g",{className:Xt(["react-flow__edge",`react-flow__edge-${s}`,r,{selected:c,animated:d,inactive:oe,updating:Se}]),onClick:ee,onDoubleClick:ke,onContextMenu:we,onMouseEnter:Ee,onMouseMove:Ne,onMouseLeave:ne,onKeyDown:H?me:void 0,tabIndex:H?0:void 0,role:H?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":G===null?void 0:G||`Edge from ${x} to ${y}`,"aria-describedby":H?`${aE}-${U}`:void 0,ref:Z},!be&&X.createElement(e,{id:n,source:x,target:y,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:v,labelBgBorderRadius:g,data:i,style:_,sourceX:b,sourceY:j,targetX:N,targetY:E,sourcePosition:S,targetPosition:k,sourceHandleId:T,targetHandleId:I,markerStart:Y,markerEnd:te,pathOptions:Q,interactionWidth:se}),q&&X.createElement(X.Fragment,null,(q==="source"||q===!0)&&X.createElement(qb,{position:S,centerX:b,centerY:j,radius:F,onMouseDown:Ve,onMouseEnter:Be,onMouseOut:Ie,type:"source"}),(q==="target"||q===!0)&&X.createElement(qb,{position:k,centerX:N,centerY:E,radius:F,onMouseDown:ct,onMouseEnter:Be,onMouseOut:Ie,type:"target"})))};return t.displayName="EdgeWrapper",m.memo(t)};function EO(e){const t={default:zs(e.default||hc),straight:zs(e.bezier||ay),step:zs(e.step||oy),smoothstep:zs(e.step||ru),simplebezier:zs(e.simplebezier||iy)},n={},r=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,i)=>(s[i]=zs(e[i]||hc),s),n);return{...t,...r}}function Bb(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,s=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,a=(n==null?void 0:n.height)||t.height;switch(e){case ce.Top:return{x:r+i/2,y:s};case ce.Right:return{x:r+i,y:s+a/2};case ce.Bottom:return{x:r+i/2,y:s+a};case ce.Left:return{x:r,y:s+a/2}}}function Wb(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const TO=(e,t,n,r,s,i)=>{const a=Bb(n,e,t),l=Bb(i,r,s);return{sourceX:a.x,sourceY:a.y,targetX:l.x,targetY:l.y}};function RO({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:s,targetHeight:i,width:a,height:l,transform:c}){const d={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+r,t.y+i)};d.x===d.x2&&(d.x2+=1),d.y===d.y2&&(d.y2+=1);const u=ra({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:a/c[2],height:l/c[2]}),f=Math.max(0,Math.min(u.x2,d.x2)-Math.max(u.x,d.x)),p=Math.max(0,Math.min(u.y2,d.y2)-Math.max(u.y,d.y));return Math.ceil(f*p)>0}function Hb(e){var r,s,i,a,l;const t=((r=e==null?void 0:e[ot])==null?void 0:r.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const AO=[{level:0,isMaxLevel:!0,edges:[]}];function IO(e,t,n=!1){let r=-1;const s=e.reduce((a,l)=>{var u,f;const c=mn(l.zIndex);let d=c?l.zIndex:0;if(n){const p=t.get(l.target),h=t.get(l.source),v=l.selected||(p==null?void 0:p.selected)||(h==null?void 0:h.selected),g=Math.max(((u=h==null?void 0:h[ot])==null?void 0:u.z)||0,((f=p==null?void 0:p[ot])==null?void 0:f.z)||0,1e3);d=(c?l.zIndex:0)+(v?g:0)}return a[d]?a[d].push(l):a[d]=[l],r=d>r?d:r,a},{}),i=Object.entries(s).map(([a,l])=>{const c=+a;return{edges:l,level:c,isMaxLevel:c===r}});return i.length===0?AO:i}function PO(e,t,n){const r=Je(m.useCallback(s=>e?s.edges.filter(i=>{const a=t.get(i.source),l=t.get(i.target);return(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&RO({sourcePos:a.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:a.width,sourceHeight:a.height,targetWidth:l.width,targetHeight:l.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return IO(r,t,n)}const MO=({color:e="none",strokeWidth:t=1})=>X.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),OO=({color:e="none",strokeWidth:t=1})=>X.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Vb={[pc.Arrow]:MO,[pc.ArrowClosed]:OO};function DO(e){const t=wt();return m.useMemo(()=>{var s,i;return Object.prototype.hasOwnProperty.call(Vb,e)?Vb[e]:((i=(s=t.getState()).onError)==null||i.call(s,"009",mr.error009(e)),null)},[e])}const LO=({id:e,type:t,color:n,width:r=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:a,orient:l="auto-start-reverse"})=>{const c=DO(t);return c?X.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:l,refX:"0",refY:"0"},X.createElement(c,{color:n,strokeWidth:a})):null},zO=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((s,i)=>([i.markerStart,i.markerEnd].forEach(a=>{if(a&&typeof a=="object"){const l=zx(a,t);r.includes(l)||(s.push({id:l,color:a.color||e,...a}),r.push(l))}}),s),[]).sort((s,i)=>s.id.localeCompare(i.id))},bE=({defaultColor:e,rfId:t})=>{const n=Je(m.useCallback(zO({defaultColor:e,rfId:t}),[e,t]),(r,s)=>!(r.length!==s.length||r.some((i,a)=>i.id!==s[a].id)));return X.createElement("defs",null,n.map(r=>X.createElement(LO,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};bE.displayName="MarkerDefinitions";var FO=m.memo(bE);const $O=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),_E=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:s,noPanClassName:i,onEdgeContextMenu:a,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:d,onEdgeClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:v,reconnectRadius:g,children:_,disableKeyboardA11y:x})=>{const{edgesFocusable:y,edgesUpdatable:b,elementsSelectable:j,width:N,height:E,connectionMode:S,nodeInternals:k,onError:w}=Je($O,Mt),R=PO(t,k,n);return N?X.createElement(X.Fragment,null,R.map(({level:T,edges:I,isMaxLevel:D})=>X.createElement("svg",{key:T,style:{zIndex:T},width:N,height:E,className:"react-flow__edges react-flow__container"},D&&X.createElement(FO,{defaultColor:e,rfId:r}),X.createElement("g",null,I.map(C=>{const[M,P,F]=Hb(k.get(C.source)),[O,A,z]=Hb(k.get(C.target));if(!F||!z)return null;let $=C.type||"default";s[$]||(w==null||w("011",mr.error011($)),$="default");const B=s[$]||s.default,U=S===Ns.Strict?A.target:(A.target??[]).concat(A.source??[]),G=Wb(P.source,C.sourceHandle),H=Wb(U,C.targetHandle),q=(G==null?void 0:G.position)||ce.Bottom,Q=(H==null?void 0:H.position)||ce.Top,se=!!(C.focusable||y&&typeof C.focusable>"u"),ie=C.reconnectable||C.updatable,Z=typeof p<"u"&&(ie||b&&typeof ie>"u");if(!G||!H)return w==null||w("008",mr.error008(G,C)),null;const{sourceX:Se,sourceY:xe,targetX:be,targetY:ve}=TO(M,G,q,O,H,Q);return X.createElement(B,{key:C.id,id:C.id,className:Xt([C.className,i]),type:$,data:C.data,selected:!!C.selected,animated:!!C.animated,hidden:!!C.hidden,label:C.label,labelStyle:C.labelStyle,labelShowBg:C.labelShowBg,labelBgStyle:C.labelBgStyle,labelBgPadding:C.labelBgPadding,labelBgBorderRadius:C.labelBgBorderRadius,style:C.style,source:C.source,target:C.target,sourceHandleId:C.sourceHandle,targetHandleId:C.targetHandle,markerEnd:C.markerEnd,markerStart:C.markerStart,sourceX:Se,sourceY:xe,targetX:be,targetY:ve,sourcePosition:q,targetPosition:Q,elementsSelectable:j,onContextMenu:a,onMouseEnter:l,onMouseMove:c,onMouseLeave:d,onClick:u,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:h,onReconnectEnd:v,reconnectRadius:g,rfId:r,ariaLabel:C.ariaLabel,isFocusable:se,isReconnectable:Z,pathOptions:"pathOptions"in C?C.pathOptions:void 0,interactionWidth:C.interactionWidth,disableKeyboardA11y:x})})))),_):null};_E.displayName="EdgeRenderer";var qO=m.memo(_E);const BO=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function WO({children:e}){const t=Je(BO);return X.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function HO(e){const t=iu(),n=m.useRef(!1);m.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const VO={[ce.Left]:ce.Right,[ce.Right]:ce.Left,[ce.Top]:ce.Bottom,[ce.Bottom]:ce.Top},wE=({nodeId:e,handleType:t,style:n,type:r=Ar.Bezier,CustomComponent:s,connectionStatus:i})=>{var E,S,k;const{fromNode:a,handleId:l,toX:c,toY:d,connectionMode:u}=Je(m.useCallback(w=>({fromNode:w.nodeInternals.get(e),handleId:w.connectionHandleId,toX:(w.connectionPosition.x-w.transform[0])/w.transform[2],toY:(w.connectionPosition.y-w.transform[1])/w.transform[2],connectionMode:w.connectionMode}),[e]),Mt),f=(E=a==null?void 0:a[ot])==null?void 0:E.handleBounds;let p=f==null?void 0:f[t];if(u===Ns.Loose&&(p=p||(f==null?void 0:f[t==="source"?"target":"source"])),!a||!p)return null;const h=l?p.find(w=>w.id===l):p[0],v=h?h.x+h.width/2:(a.width??0)/2,g=h?h.y+h.height/2:a.height??0,_=(((S=a.positionAbsolute)==null?void 0:S.x)??0)+v,x=(((k=a.positionAbsolute)==null?void 0:k.y)??0)+g,y=h==null?void 0:h.position,b=y?VO[y]:null;if(!y||!b)return null;if(s)return X.createElement(s,{connectionLineType:r,connectionLineStyle:n,fromNode:a,fromHandle:h,fromX:_,fromY:x,toX:c,toY:d,fromPosition:y,toPosition:b,connectionStatus:i});let j="";const N={sourceX:_,sourceY:x,sourcePosition:y,targetX:c,targetY:d,targetPosition:b};return r===Ar.Bezier?[j]=VC(N):r===Ar.Step?[j]=Lx({...N,borderRadius:0}):r===Ar.SmoothStep?[j]=Lx(N):r===Ar.SimpleBezier?[j]=HC(N):j=`M${_},${x} ${c},${d}`,X.createElement("path",{d:j,fill:"none",className:"react-flow__connection-path",style:n})};wE.displayName="ConnectionLine";const UO=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function GO({containerStyle:e,style:t,type:n,component:r}){const{nodeId:s,handleType:i,nodesConnectable:a,width:l,height:c,connectionStatus:d}=Je(UO,Mt);return!(s&&i&&l&&a)?null:X.createElement("svg",{style:e,width:l,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},X.createElement("g",{className:Xt(["react-flow__connection",d])},X.createElement(wE,{nodeId:s,handleType:i,style:t,type:n,CustomComponent:r,connectionStatus:d})))}function Ub(e,t){return m.useRef(null),wt(),m.useMemo(()=>t(e),[e])}const jE=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:s,onInit:i,onNodeClick:a,onEdgeClick:l,onNodeDoubleClick:c,onEdgeDoubleClick:d,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,onSelectionContextMenu:v,onSelectionStart:g,onSelectionEnd:_,connectionLineType:x,connectionLineStyle:y,connectionLineComponent:b,connectionLineContainerStyle:j,selectionKeyCode:N,selectionOnDrag:E,selectionMode:S,multiSelectionKeyCode:k,panActivationKeyCode:w,zoomActivationKeyCode:R,deleteKeyCode:T,onlyRenderVisibleElements:I,elementsSelectable:D,selectNodesOnDrag:C,defaultViewport:M,translateExtent:P,minZoom:F,maxZoom:O,preventScrolling:A,defaultMarkerColor:z,zoomOnScroll:$,zoomOnPinch:B,panOnScroll:U,panOnScrollSpeed:G,panOnScrollMode:H,zoomOnDoubleClick:q,panOnDrag:Q,onPaneClick:se,onPaneMouseEnter:ie,onPaneMouseMove:Z,onPaneMouseLeave:Se,onPaneScroll:xe,onPaneContextMenu:be,onEdgeContextMenu:ve,onEdgeMouseEnter:ae,onEdgeMouseMove:Y,onEdgeMouseLeave:te,onReconnect:ee,onReconnectStart:ke,onReconnectEnd:we,reconnectRadius:Ee,noDragClassName:Ne,noWheelClassName:ne,noPanClassName:je,elevateEdgesOnSelect:Ve,disableKeyboardA11y:ct,nodeOrigin:Be,nodeExtent:Ie,rfId:oe})=>{const me=Ub(e,_O),fe=Ub(t,EO);return HO(i),X.createElement(yO,{onPaneClick:se,onPaneMouseEnter:ie,onPaneMouseMove:Z,onPaneMouseLeave:Se,onPaneContextMenu:be,onPaneScroll:xe,deleteKeyCode:T,selectionKeyCode:N,selectionOnDrag:E,selectionMode:S,onSelectionStart:g,onSelectionEnd:_,multiSelectionKeyCode:k,panActivationKeyCode:w,zoomActivationKeyCode:R,elementsSelectable:D,onMove:n,onMoveStart:r,onMoveEnd:s,zoomOnScroll:$,zoomOnPinch:B,zoomOnDoubleClick:q,panOnScroll:U,panOnScrollSpeed:G,panOnScrollMode:H,panOnDrag:Q,defaultViewport:M,translateExtent:P,minZoom:F,maxZoom:O,onSelectionContextMenu:v,preventScrolling:A,noDragClassName:Ne,noWheelClassName:ne,noPanClassName:je,disableKeyboardA11y:ct},X.createElement(WO,null,X.createElement(qO,{edgeTypes:fe,onEdgeClick:l,onEdgeDoubleClick:d,onlyRenderVisibleElements:I,onEdgeContextMenu:ve,onEdgeMouseEnter:ae,onEdgeMouseMove:Y,onEdgeMouseLeave:te,onReconnect:ee,onReconnectStart:ke,onReconnectEnd:we,reconnectRadius:Ee,defaultMarkerColor:z,noPanClassName:je,elevateEdgesOnSelect:!!Ve,disableKeyboardA11y:ct,rfId:oe},X.createElement(GO,{style:y,type:x,component:b,containerStyle:j})),X.createElement("div",{className:"react-flow__edgelabel-renderer"}),X.createElement(SO,{nodeTypes:me,onNodeClick:a,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:h,selectNodesOnDrag:C,onlyRenderVisibleElements:I,noPanClassName:je,noDragClassName:Ne,disableKeyboardA11y:ct,nodeOrigin:Be,nodeExtent:Ie,rfId:oe})))};jE.displayName="GraphView";var KO=m.memo(jE);const Bx=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],wr={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Bx,nodeExtent:Bx,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ns.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:wM,isValidConnection:void 0},YO=()=>LA((e,t)=>({...wr,setNodes:n=>{const{nodeInternals:r,nodeOrigin:s,elevateNodesOnSelect:i}=t();e({nodeInternals:pd(n,r,s,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(s=>({...r,...s}))})},setDefaultNodesAndEdges:(n,r)=>{const s=typeof n<"u",i=typeof r<"u",a=s?pd(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:a,edges:i?r:[],hasDefaultNodes:s,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:s,fitViewOnInit:i,fitViewOnInitDone:a,fitViewOnInitOptions:l,domNode:c,nodeOrigin:d}=t(),u=c==null?void 0:c.querySelector(".react-flow__viewport");if(!u)return;const f=window.getComputedStyle(u),{m22:p}=new window.DOMMatrixReadOnly(f.transform),h=n.reduce((g,_)=>{const x=s.get(_.id);if(x!=null&&x.hidden)s.set(x.id,{...x,[ot]:{...x[ot],handleBounds:void 0}});else if(x){const y=ry(_.nodeElement);!!(y.width&&y.height&&(x.width!==y.width||x.height!==y.height||_.forceUpdate))&&(s.set(x.id,{...x,[ot]:{...x[ot],handleBounds:{source:Fb(".source",_.nodeElement,p,d),target:Fb(".target",_.nodeElement,p,d)}},...y}),g.push({id:x.id,type:"dimensions",dimensions:y}))}return g},[]);cE(s,d);const v=a||i&&!a&&uE(t,{initial:!0,...l});e({nodeInternals:new Map(s),fitViewOnInitDone:v}),(h==null?void 0:h.length)>0&&(r==null||r(h))},updateNodePositions:(n,r=!0,s=!1)=>{const{triggerNodeChanges:i}=t(),a=n.map(l=>{const c={id:l.id,type:"position",dragging:s};return r&&(c.positionAbsolute=l.positionAbsolute,c.position=l.position),c});i(a)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:s,hasDefaultNodes:i,nodeOrigin:a,getNodes:l,elevateNodesOnSelect:c}=t();if(n!=null&&n.length){if(i){const d=fE(n,l()),u=pd(d,s,a,c);e({nodeInternals:u})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:s,getNodes:i}=t();let a,l=null;r?a=n.map(c=>Cr(c,!0)):(a=ri(i(),n),l=ri(s,[])),rl({changedNodes:a,changedEdges:l,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:s,getNodes:i}=t();let a,l=null;r?a=n.map(c=>Cr(c,!0)):(a=ri(s,n),l=ri(i(),[])),rl({changedNodes:l,changedEdges:a,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:s,getNodes:i}=t(),a=n||i(),l=r||s,c=a.map(u=>(u.selected=!1,Cr(u.id,!1))),d=l.map(u=>Cr(u.id,!1));rl({changedNodes:c,changedEdges:d,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:s}=t();r==null||r.scaleExtent([n,s]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:s}=t();r==null||r.scaleExtent([s,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;(r=t().d3Zoom)==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),i=r().filter(l=>l.selected).map(l=>Cr(l.id,!1)),a=n.filter(l=>l.selected).map(l=>Cr(l.id,!1));rl({changedNodes:i,changedEdges:a,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(s=>{s.positionAbsolute=sy(s.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:s,height:i,d3Zoom:a,d3Selection:l,translateExtent:c}=t();if(!a||!l||!n.x&&!n.y)return!1;const d=cr.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),u=[[0,0],[s,i]],f=a==null?void 0:a.constrain()(d,u,c);return a.transform(l,f),r[0]!==f.x||r[1]!==f.y||r[2]!==f.k},cancelConnection:()=>e({connectionNodeId:wr.connectionNodeId,connectionHandleId:wr.connectionHandleId,connectionHandleType:wr.connectionHandleType,connectionStatus:wr.connectionStatus,connectionStartHandle:wr.connectionStartHandle,connectionEndHandle:wr.connectionEndHandle}),reset:()=>e({...wr})}),Object.is),Ii=({children:e})=>{const t=m.useRef(null);return t.current||(t.current=YO()),X.createElement(mM,{value:t.current},e)};Ii.displayName="ReactFlowProvider";const SE=({children:e})=>m.useContext(nu)?X.createElement(X.Fragment,null,e):X.createElement(Ii,null,e);SE.displayName="ReactFlowWrapper";const XO={input:nE,default:$x,output:sE,group:uy},QO={default:hc,straight:ay,step:oy,smoothstep:ru,simplebezier:iy},ZO=[0,0],JO=[15,15],e8={x:0,y:0,zoom:1},t8={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},wa=m.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:s,nodeTypes:i=XO,edgeTypes:a=QO,onNodeClick:l,onEdgeClick:c,onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onConnect:h,onConnectStart:v,onConnectEnd:g,onClickConnectStart:_,onClickConnectEnd:x,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:j,onNodeContextMenu:N,onNodeDoubleClick:E,onNodeDragStart:S,onNodeDrag:k,onNodeDragStop:w,onNodesDelete:R,onEdgesDelete:T,onSelectionChange:I,onSelectionDragStart:D,onSelectionDrag:C,onSelectionDragStop:M,onSelectionContextMenu:P,onSelectionStart:F,onSelectionEnd:O,connectionMode:A=Ns.Strict,connectionLineType:z=Ar.Bezier,connectionLineStyle:$,connectionLineComponent:B,connectionLineContainerStyle:U,deleteKeyCode:G="Backspace",selectionKeyCode:H="Shift",selectionOnDrag:q=!1,selectionMode:Q=sa.Full,panActivationKeyCode:se="Space",multiSelectionKeyCode:ie=fc()?"Meta":"Control",zoomActivationKeyCode:Z=fc()?"Meta":"Control",snapToGrid:Se=!1,snapGrid:xe=JO,onlyRenderVisibleElements:be=!1,selectNodesOnDrag:ve=!0,nodesDraggable:ae,nodesConnectable:Y,nodesFocusable:te,nodeOrigin:ee=ZO,edgesFocusable:ke,edgesUpdatable:we,elementsSelectable:Ee,defaultViewport:Ne=e8,minZoom:ne=.5,maxZoom:je=2,translateExtent:Ve=Bx,preventScrolling:ct=!0,nodeExtent:Be,defaultMarkerColor:Ie="#b1b1b7",zoomOnScroll:oe=!0,zoomOnPinch:me=!0,panOnScroll:fe=!1,panOnScrollSpeed:V=.5,panOnScrollMode:ge=ps.Free,zoomOnDoubleClick:pe=!0,panOnDrag:ze=!0,onPaneClick:We,onPaneMouseEnter:st,onPaneMouseMove:Ue,onPaneMouseLeave:L,onPaneScroll:W,onPaneContextMenu:K,children:re,onEdgeContextMenu:Fe,onEdgeDoubleClick:pt,onEdgeMouseEnter:ln,onEdgeMouseMove:Tt,onEdgeMouseLeave:jt,onEdgeUpdate:qt,onEdgeUpdateStart:Ln,onEdgeUpdateEnd:at,onReconnect:ue,onReconnectStart:de,onReconnectEnd:Ye,reconnectRadius:wn=10,edgeUpdaterRadius:ns=10,onNodesChange:zn,onEdgesChange:rs,noDragClassName:Bi="nodrag",noWheelClassName:jT="nowheel",noPanClassName:Uy="nopan",fitView:ST=!1,fitViewOptions:kT,connectOnClick:NT=!0,attributionPosition:CT,proOptions:ET,defaultEdgeOptions:TT,elevateNodesOnSelect:RT=!0,elevateEdgesOnSelect:AT=!1,disableKeyboardA11y:Gy=!1,autoPanOnConnect:IT=!0,autoPanOnNodeDrag:PT=!0,connectionRadius:MT=20,isValidConnection:OT,onError:DT,style:LT,id:Ky,nodeDragThreshold:zT,...FT},$T)=>{const Mu=Ky||"1";return X.createElement("div",{...FT,style:{...LT,...t8},ref:$T,className:Xt(["react-flow",s]),"data-testid":"rf__wrapper",id:Ky},X.createElement(SE,null,X.createElement(KO,{onInit:d,onMove:u,onMoveStart:f,onMoveEnd:p,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:y,onNodeMouseMove:b,onNodeMouseLeave:j,onNodeContextMenu:N,onNodeDoubleClick:E,nodeTypes:i,edgeTypes:a,connectionLineType:z,connectionLineStyle:$,connectionLineComponent:B,connectionLineContainerStyle:U,selectionKeyCode:H,selectionOnDrag:q,selectionMode:Q,deleteKeyCode:G,multiSelectionKeyCode:ie,panActivationKeyCode:se,zoomActivationKeyCode:Z,onlyRenderVisibleElements:be,selectNodesOnDrag:ve,defaultViewport:Ne,translateExtent:Ve,minZoom:ne,maxZoom:je,preventScrolling:ct,zoomOnScroll:oe,zoomOnPinch:me,zoomOnDoubleClick:pe,panOnScroll:fe,panOnScrollSpeed:V,panOnScrollMode:ge,panOnDrag:ze,onPaneClick:We,onPaneMouseEnter:st,onPaneMouseMove:Ue,onPaneMouseLeave:L,onPaneScroll:W,onPaneContextMenu:K,onSelectionContextMenu:P,onSelectionStart:F,onSelectionEnd:O,onEdgeContextMenu:Fe,onEdgeDoubleClick:pt,onEdgeMouseEnter:ln,onEdgeMouseMove:Tt,onEdgeMouseLeave:jt,onReconnect:ue??qt,onReconnectStart:de??Ln,onReconnectEnd:Ye??at,reconnectRadius:wn??ns,defaultMarkerColor:Ie,noDragClassName:Bi,noWheelClassName:jT,noPanClassName:Uy,elevateEdgesOnSelect:AT,rfId:Mu,disableKeyboardA11y:Gy,nodeOrigin:ee,nodeExtent:Be}),X.createElement(VM,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:v,onConnectEnd:g,onClickConnectStart:_,onClickConnectEnd:x,nodesDraggable:ae,nodesConnectable:Y,nodesFocusable:te,edgesFocusable:ke,edgesUpdatable:we,elementsSelectable:Ee,elevateNodesOnSelect:RT,minZoom:ne,maxZoom:je,nodeExtent:Be,onNodesChange:zn,onEdgesChange:rs,snapToGrid:Se,snapGrid:xe,connectionMode:A,translateExtent:Ve,connectOnClick:NT,defaultEdgeOptions:TT,fitView:ST,fitViewOptions:kT,onNodesDelete:R,onEdgesDelete:T,onNodeDragStart:S,onNodeDrag:k,onNodeDragStop:w,onSelectionDrag:C,onSelectionDragStart:D,onSelectionDragStop:M,noPanClassName:Uy,nodeOrigin:ee,rfId:Mu,autoPanOnConnect:IT,autoPanOnNodeDrag:PT,onError:DT,connectionRadius:MT,isValidConnection:OT,nodeDragThreshold:zT}),X.createElement(WM,{onSelectionChange:I}),re,X.createElement(xM,{proOptions:ET,position:CT}),X.createElement(XM,{rfId:Mu,disableKeyboardA11y:Gy})))});wa.displayName="ReactFlow";function kE(e){return t=>{const[n,r]=m.useState(t),s=m.useCallback(i=>r(a=>e(i,a)),[]);return[n,r,s]}}const NE=kE(fE),CE=kE(uO),EE=({id:e,x:t,y:n,width:r,height:s,style:i,color:a,strokeColor:l,strokeWidth:c,className:d,borderRadius:u,shapeRendering:f,onClick:p,selected:h})=>{const{background:v,backgroundColor:g}=i||{},_=a||v||g;return X.createElement("rect",{className:Xt(["react-flow__minimap-node",{selected:h},d]),x:t,y:n,rx:u,ry:u,width:r,height:s,fill:_,stroke:l,strokeWidth:c,shapeRendering:f,onClick:p?x=>p(x,e):void 0})};EE.displayName="MiniMapNode";var n8=m.memo(EE);const r8=e=>e.nodeOrigin,s8=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),xd=e=>e instanceof Function?e:()=>e;function i8({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:s=2,nodeComponent:i=n8,onClick:a}){const l=Je(s8,Mt),c=Je(r8),d=xd(t),u=xd(e),f=xd(n),p=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return X.createElement(X.Fragment,null,l.map(h=>{const{x:v,y:g}=vs(h,c).positionAbsolute;return X.createElement(i,{key:h.id,x:v,y:g,width:h.width,height:h.height,style:h.style,selected:h.selected,className:f(h),color:d(h),borderRadius:r,strokeColor:u(h),strokeWidth:s,shapeRendering:p,onClick:a,id:h.id})}))}var o8=m.memo(i8);const a8=200,l8=150,c8=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?bM(su(t,e.nodeOrigin),n):n,rfId:e.rfId}},u8="react-flow__minimap-desc";function TE({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:s="",nodeBorderRadius:i=5,nodeStrokeWidth:a=2,nodeComponent:l,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:d="none",maskStrokeWidth:u=1,position:f="bottom-right",onClick:p,onNodeClick:h,pannable:v=!1,zoomable:g=!1,ariaLabel:_="React Flow mini map",inversePan:x=!1,zoomStep:y=10,offsetScale:b=5}){const j=wt(),N=m.useRef(null),{boundingRect:E,viewBB:S,rfId:k}=Je(c8,Mt),w=(e==null?void 0:e.width)??a8,R=(e==null?void 0:e.height)??l8,T=E.width/w,I=E.height/R,D=Math.max(T,I),C=D*w,M=D*R,P=b*D,F=E.x-(C-E.width)/2-P,O=E.y-(M-E.height)/2-P,A=C+P*2,z=M+P*2,$=`${u8}-${k}`,B=m.useRef(0);B.current=D,m.useEffect(()=>{if(N.current){const H=pn(N.current),q=ie=>{const{transform:Z,d3Selection:Se,d3Zoom:xe}=j.getState();if(ie.sourceEvent.type!=="wheel"||!Se||!xe)return;const be=-ie.sourceEvent.deltaY*(ie.sourceEvent.deltaMode===1?.05:ie.sourceEvent.deltaMode?1:.002)*y,ve=Z[2]*Math.pow(2,be);xe.scaleTo(Se,ve)},Q=ie=>{const{transform:Z,d3Selection:Se,d3Zoom:xe,translateExtent:be,width:ve,height:ae}=j.getState();if(ie.sourceEvent.type!=="mousemove"||!Se||!xe)return;const Y=B.current*Math.max(1,Z[2])*(x?-1:1),te={x:Z[0]-ie.sourceEvent.movementX*Y,y:Z[1]-ie.sourceEvent.movementY*Y},ee=[[0,0],[ve,ae]],ke=cr.translate(te.x,te.y).scale(Z[2]),we=xe.constrain()(ke,ee,be);xe.transform(Se,we)},se=MC().on("zoom",v?Q:null).on("zoom.wheel",g?q:null);return H.call(se),()=>{H.on("zoom",null)}}},[v,g,x,y]);const U=p?H=>{const q=Cn(H);p(H,{x:q[0],y:q[1]})}:void 0,G=h?(H,q)=>{const Q=j.getState().nodeInternals.get(q);h(H,Q)}:void 0;return X.createElement(Hr,{position:f,style:e,className:Xt(["react-flow__minimap",t]),"data-testid":"rf__minimap"},X.createElement("svg",{width:w,height:R,viewBox:`${F} ${O} ${A} ${z}`,role:"img","aria-labelledby":$,ref:N,onClick:U},_&&X.createElement("title",{id:$},_),X.createElement(o8,{onClick:G,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:s,nodeStrokeWidth:a,nodeComponent:l}),X.createElement("path",{className:"react-flow__minimap-mask",d:`M${F-P},${O-P}h${A+P*2}v${z+P*2}h${-A-P*2}z
        M${S.x},${S.y}h${S.width}v${S.height}h${-S.width}z`,fill:c,fillRule:"evenodd",stroke:d,strokeWidth:u,pointerEvents:"none"})))}TE.displayName="MiniMap";var RE=m.memo(TE);const il={active:"#f59e0b",complete:"#10b981",queued:"#64748b"},d8=180,f8=400,p8=260,h8=48;function m8(e){if(!e)return"";try{const t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:t.getFullYear()!==new Date().getFullYear()?"numeric":void 0})}catch{return""}}function g8({projects:e,selectedId:t,onSelectProject:n,onNewProject:r,showArchived:s,onToggleShowArchived:i,userSection:a}){const[l,c]=m.useState(!1),[d,u]=m.useState(p8),[f,p]=m.useState(!1),h=m.useRef(null),v=m.useRef(null);m.useEffect(()=>{v.current&&v.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const g=m.useMemo(()=>Object.values(e).sort((N,E)=>{const S=(N.name||"").localeCompare(E.name||"");return S!==0?S:(N.projectId||"").localeCompare(E.projectId||"")}),[e]),_=()=>{r()},x=m.useCallback(N=>{N.preventDefault(),p(!0)},[]),y=m.useCallback(N=>{if(!f)return;const E=Math.min(f8,Math.max(d8,N.clientX));u(E)},[f]),b=m.useCallback(()=>{p(!1)},[]);m.useEffect(()=>(f?(document.addEventListener("mousemove",y),document.addEventListener("mouseup",b),document.body.style.cursor="col-resize",document.body.style.userSelect="none"):(document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""),()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",b),document.body.style.cursor="",document.body.style.userSelect=""}),[f,y,b]);const j=l?h8:d;return o.jsxs("div",{ref:h,className:"h-full flex flex-col relative",onWheel:N=>N.stopPropagation(),style:{width:j,minWidth:j,background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)",transition:f?"none":"width 0.2s ease"},children:[o.jsxs("div",{className:"p-3 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[!l&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Projects"}),o.jsx("button",{onClick:i,className:"p-1 rounded hover:bg-white/10 transition-colors",style:{color:s?"#f59e0b":"var(--text-muted)"},title:s?"Hide archived":"Show archived",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})})]}),o.jsx("button",{onClick:()=>c(!l),className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:l?"Expand sidebar":"Collapse sidebar",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",style:{transform:l?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:o.jsx("path",{d:"M10 12L6 8L10 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),!l&&o.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:g.map(N=>{const E=t===N.id;return o.jsxs("div",{ref:E?v:null,onClick:()=>n(N.id),className:"p-3 rounded-lg mb-2 cursor-pointer transition-all",style:{background:E?"var(--state-active-bg)":"transparent",border:E?"1px solid var(--state-active-bg)":"1px solid transparent",boxShadow:E?"0 0 12px rgba(245, 158, 11, 0.3)":"none"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:E?"#ffffff":il[N.status]||il.queued}}),o.jsx("span",{className:"text-sm font-medium truncate flex-1",style:{color:E?"#ffffff":"var(--text-primary)"},children:N.name}),N.isArchived&&o.jsx("svg",{className:"w-3.5 h-3.5 flex-shrink-0",style:{color:E?"rgba(255,255,255,0.7)":"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",title:"Archived",children:o.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"})})]}),o.jsxs("div",{className:"flex items-center justify-between mt-0.5 ml-4",children:[o.jsx("span",{className:"text-[10px] font-mono",style:{color:E?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:N.projectId}),o.jsx("span",{className:"text-[10px]",style:{color:E?"rgba(255,255,255,0.8)":"var(--text-muted)"},children:m8(N.createdAt)})]})]},N.id)})}),l&&o.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:g.map(N=>o.jsx("div",{onClick:()=>n(N.id),className:"flex items-center justify-center py-2 cursor-pointer hover:bg-white/5",title:N.name,children:o.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:il[N.status]||il.queued,boxShadow:t===N.id?"0 0 0 2px var(--bg-panel), 0 0 0 4px var(--border-node)":"none"}})},N.id))}),!l&&o.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:o.jsxs("button",{onClick:_,className:"w-full py-2.5 rounded-lg text-sm font-medium flex items-center justify-center gap-2 transition-colors",style:{background:"#10b981",color:"white"},children:[o.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"}),o.jsx("span",{children:"New Project"})]})}),l&&o.jsx("div",{className:"p-2 border-t flex justify-center",style:{borderColor:"var(--border-panel)"},children:o.jsx("button",{onClick:_,className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{background:"#10b981",color:"white"},title:"New Project",children:o.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})}),a,!l&&o.jsx("div",{onMouseDown:x,className:"absolute top-0 right-0 w-1 h-full cursor-col-resize hover:bg-emerald-500/50 transition-colors",style:{background:f?"var(--state-active-bg)":"transparent"}})]})}function x8({stations:e}){if(!(e!=null&&e.length))return null;const t=e.reduce((i,a,l)=>a.state==="complete"?l:i,-1),n=e.findIndex(i=>i.state==="active"),r=e.find(i=>i.state==="active"),s=r==null?void 0:r.currentStep;return o.jsxs("div",{className:"mt-2",children:[o.jsxs("div",{className:"relative flex items-start",children:[o.jsx("div",{className:"absolute h-0.5 left-0 right-0",style:{top:5,background:"var(--state-queued-bg)"}}),t>=0&&o.jsx("div",{className:"absolute h-0.5 left-0",style:{top:5,width:`${(t+.5)/e.length*100}%`,background:"var(--state-stabilized-bg)"}}),n>=0&&o.jsx("div",{className:"absolute h-0.5",style:{top:5,left:t>=0?`${(t+.5)/e.length*100}%`:"0%",width:t>=0?`${(n-t)/e.length*100}%`:`${(n+.5)/e.length*100}%`,background:"var(--state-active-bg)"}}),e.map(i=>{const a=i.state==="active",c=i.state==="complete"?"var(--state-stabilized-bg)":a?"var(--state-active-bg)":i.state==="failed"?"var(--state-blocked-bg)":"var(--state-queued-bg)",d=a?"var(--state-active-text)":"var(--text-muted)";return o.jsxs("div",{className:"flex-1 flex flex-col items-center relative z-10",children:[o.jsx("div",{className:`w-3 h-3 rounded-full${a?" station-active":""}${a&&i.needs_input?" station-needs-input":""}`,style:{background:c,boxShadow:a&&i.needs_input?"0 0 0 2px var(--state-active-bg)":void 0}}),o.jsx("span",{className:"text-[7px] mt-0.5",style:{color:a&&i.needs_input?"var(--state-active-text)":d,fontWeight:a?500:400},children:i.label})]},i.id)})]}),s&&o.jsx("div",{className:"text-center text-[8px] mt-1 font-medium",style:{color:"var(--state-active-text)"},children:s.name})]})}const Gb={light:{blocked:"#ef4444",in_progress:"#6366f1",ready:"#eab308",stabilized:"#10b981",active:"#6366f1",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"},industrial:{blocked:"#ef4444",in_progress:"#f59e0b",ready:"#eab308",stabilized:"#10b981",active:"#f59e0b",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"},blueprint:{blocked:"#ef4444",in_progress:"#fbbf24",ready:"#eab308",stabilized:"#10b981",active:"#fbbf24",queued:"#eab308",produced:"#10b981",requirements_not_met:"#ef4444"}};function v8(e){return["produced","stabilized","ready","complete"].includes(e)?"stabilized":["requirements_not_met","blocked","halted","failed"].includes(e)?"blocked":["in_production","active","queued","awaiting_operator"].includes(e)?"in_progress":(["ready_for_production","waiting","pending_acceptance"].includes(e),"ready")}const AE=(e,t)=>{var r;const n=v8(e);return((r=Gb[t])==null?void 0:r[n])||Gb.industrial.ready},Sn={EPICS_PER_ROW:3,EPIC_WIDTH:220,EPIC_HEIGHT:70,EPIC_GAP_X:50,EPIC_GAP_Y:100,EPIC_OFFSET_X:80,EPIC_OFFSET_Y:80},mc={GAP:8},Ir=["industrial","light","blueprint"],y8=400,b8=560;function _8({question:e,value:t,onChange:n}){const r=e.answer_type||"text",s=e.choices||[];if(r==="single_choice"&&s.length>0)return o.jsx("div",{className:"space-y-1.5",children:s.map(i=>o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[o.jsx("input",{type:"radio",name:e.id,value:i.value,checked:t===i.value,onChange:()=>n(i.value),className:"w-3.5 h-3.5 accent-amber-500"}),o.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:i.label})]},i.value))});if(r==="multi_choice"&&s.length>0){const i=Array.isArray(t)?t:[];return o.jsx("div",{className:"space-y-1.5",children:s.map(a=>o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[o.jsx("input",{type:"checkbox",checked:i.includes(a.value),onChange:l=>{l.target.checked?n([...i,a.value]):n(i.filter(c=>c!==a.value))},className:"w-3.5 h-3.5 accent-amber-500"}),o.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:a.label})]},a.value))})}return r==="boolean"?o.jsx("div",{className:"flex gap-3",children:[{label:"Yes",value:!0},{label:"No",value:!1}].map(i=>o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[o.jsx("input",{type:"radio",name:e.id,checked:t===i.value,onChange:()=>n(i.value),className:"w-3.5 h-3.5 accent-amber-500"}),o.jsx("span",{className:"text-xs group-hover:opacity-80",style:{color:"var(--text-sidecar)"},children:i.label})]},String(i.value)))}):r==="number"?o.jsx("input",{type:"number",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)"},value:t||"",onChange:i=>n(i.target.value?Number(i.target.value):"")}):r==="free_text"||r==="long_text"?o.jsx("textarea",{className:"w-full rounded px-2 py-1.5 text-xs border resize-none",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)",minHeight:60},value:t||"",onChange:i=>n(i.target.value)}):o.jsx("input",{type:"text",className:"w-full rounded px-2 py-1.5 text-xs border",style:{background:"var(--bg-input)",borderColor:"var(--border-input)",color:"var(--text-input)"},value:t||"",onChange:i=>n(i.target.value)})}function w8({priority:e}){if(!e)return null;const t={must:{bg:"bg-red-500/20",text:"text-red-400"},should:{bg:"bg-amber-500/20",text:"text-amber-400"},could:{bg:"bg-blue-500/20",text:"text-blue-400"}},n=t[e]||t.should;return o.jsx("span",{className:`${n.bg} ${n.text} text-[8px] px-1.5 py-0.5 rounded uppercase font-semibold`,children:e})}function j8({questions:e,nodeWidth:t,onSubmit:n,onClose:r}){const[s,i]=m.useState({}),[a,l]=m.useState(!1),[c,d]=m.useState(!1),u=e.filter(g=>g.required).every(g=>{const _=s[g.id];return Array.isArray(_)?_.length>0:_!==void 0&&_!==""}),f=a?b8:y8,p=(g,_)=>{i(x=>({...x,[g]:_}))},h=async()=>{d(!0);try{await n(s)}catch(g){console.error("Submit failed:",g),d(!1)}},v=g=>g.stopPropagation();return o.jsxs("div",{className:"absolute top-0 border border-amber-500/50 rounded-lg shadow-2xl tray-slide nowheel nopan nodrag",style:{left:t+mc.GAP,width:f,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)",transition:"width 0.2s ease",userSelect:"text"},onMouseDown:v,onPointerDown:v,onWheel:v,children:[o.jsx("div",{className:"absolute border-t-2 border-dashed border-amber-500/60",style:{top:14,right:"100%",width:mc.GAP}}),o.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-amber-500",style:{top:11,right:"100%",marginRight:-4}}),o.jsxs("div",{className:"bg-amber-500/10 border-b border-amber-500/30 px-3 py-2 flex justify-between items-center",children:[o.jsx("span",{className:"text-[9px] font-semibold text-amber-600 uppercase tracking-wide",children:"Operator Input Required"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>l(!a),title:a?"Contract":"Expand",className:"hover:opacity-70 transition-opacity p-1",style:{color:"var(--text-sidecar-muted)"},children:a?o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M9 1v4h4M5 13v-4H1M9 5L13 1M5 9L1 13"})}):o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M13 5V1h-4M1 9v4h4M13 1L9 5M1 13l4-4"})})}),o.jsx("button",{onClick:r,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]})]}),o.jsx("div",{className:`p-3 space-y-4 overflow-y-auto nowheel ${a?"max-h-[520px]":"max-h-[420px]"}`,children:e.map(g=>o.jsxs("div",{className:"pb-3",style:{borderBottom:"1px solid var(--border-input)"},children:[o.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[o.jsxs("label",{className:"block text-[11px] font-medium",style:{color:"var(--text-sidecar)"},children:[g.text," ",g.required&&o.jsx("span",{className:"text-amber-500",children:"*"})]}),o.jsx(w8,{priority:g.priority})]}),g.why_it_matters&&o.jsx("p",{className:"text-[9px] mb-2 italic",style:{color:"var(--text-sidecar-muted)"},children:g.why_it_matters}),o.jsx(_8,{question:g,value:s[g.id],onChange:_=>p(g.id,_)})]},g.id))}),o.jsx("div",{className:"p-3",style:{borderTop:"1px solid var(--border-node)"},children:o.jsx("button",{className:`w-full py-2 rounded text-xs font-medium transition-colors ${u&&!c?"bg-amber-500 text-slate-900 hover:bg-amber-400":"subway-button cursor-not-allowed"}`,disabled:!u||c,onClick:h,children:c?"Submitting...":"Submit & Continue"})})]})}function S8({features:e,epicName:t,nodeWidth:n,onClose:r,onZoomComplete:s}){const i=e.length>6,a=i?240:320;m.useEffect(()=>{if(s){const c=setTimeout(()=>s(),150);return()=>clearTimeout(c)}},[s]);const l=c=>c.stopPropagation();return o.jsxs("div",{className:"absolute top-0 border border-indigo-500/50 rounded-lg shadow-2xl tray-slide nowheel nopan nodrag",style:{left:n+mc.GAP,width:a,boxShadow:"0 0 30px rgba(0,0,0,0.5)",zIndex:1e3,background:"var(--bg-sidecar)",userSelect:"text"},onMouseDown:l,onPointerDown:l,onWheel:l,children:[o.jsx("div",{className:"absolute border-t-2 border-dashed border-indigo-500/60",style:{top:14,right:"100%",width:mc.GAP}}),o.jsx("div",{className:"absolute w-2 h-2 rounded-full bg-indigo-500",style:{top:11,right:"100%",marginRight:-4}}),o.jsxs("div",{className:"bg-indigo-500/10 border-b border-indigo-500/30 px-3 py-2 flex justify-between items-center",children:[o.jsxs("span",{className:"text-[9px] font-semibold uppercase tracking-wide",style:{color:"var(--text-sidecar-muted)"},children:["Features - ",t]}),o.jsx("button",{onClick:r,style:{color:"var(--text-sidecar-muted)"},className:"hover:opacity-70 text-sm leading-none",children:""})]}),o.jsx("div",{className:`p-3 max-h-64 overflow-y-auto ${i?"":"grid grid-cols-2 gap-2"}`,children:e.map(c=>{const d=c.state==="complete"?"var(--state-stabilized-bg)":c.state==="active"?"var(--state-active-bg)":"var(--state-queued-bg)";return o.jsxs("div",{className:`flex items-center gap-2 p-1.5 rounded cursor-pointer hover:opacity-80 ${i?"mb-1":""}`,children:[o.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:d}}),o.jsx("span",{className:"text-[10px] truncate",style:{color:"var(--text-sidecar)"},children:c.name})]},c.id)})}),o.jsxs("div",{className:"px-3 py-2 text-[9px]",style:{borderTop:"1px solid var(--border-node)",color:"var(--text-sidecar-muted)"},children:[e.length," features"]})]})}const k8={blocked:{bg:"var(--state-blocked-bg)",text:"var(--state-blocked-text)"},in_progress:{bg:"var(--state-active-bg)",text:"var(--state-active-text)"},ready:{bg:"var(--state-ready-bg)",text:"var(--state-ready-text)"},stabilized:{bg:"var(--state-stabilized-bg)",text:"var(--state-stabilized-text)"}};function N8(e){return["produced","stabilized","ready","complete"].includes(e)?"stabilized":["requirements_not_met","blocked","halted","failed"].includes(e)?"blocked":["in_production","active","queued","awaiting_operator"].includes(e)?"in_progress":(["ready_for_production","waiting","pending_acceptance"].includes(e),"ready")}const C8={blocked:"Blocked",in_progress:"In Progress",ready:"Ready",stabilized:"Stabilized"};function E8(e){return e?e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "):""}function T8({data:e}){var E,S,k,w,R;const n=(e.level||1)===1,r=e.isExpanded,s=e.expandType,i=((E=e.questions)==null?void 0:E.length)>0,a=((S=e.features)==null?void 0:S.length)>0,l=(k=e.stations)==null?void 0:k.some(T=>T.state==="active"&&T.needs_input),c=e.state||"ready_for_production",d=N8(c),u=d==="stabilized",f=d==="in_progress",p=d==="blocked",h=((w=e.stations)==null?void 0:w.length)>0,v=f?"node-active":"",g=n?"DOCUMENT":"EPIC",_=n?"subway-node-header-doc":"subway-node-header-epic",x=k8[d],y=x.bg,b=x.text,j=x.bg,N=C8[d];return o.jsxs("div",{className:"relative",children:[o.jsx(yn,{type:"target",position:ce.Top,className:"!opacity-0",style:{left:"15%"}}),o.jsxs("div",{className:`subway-node rounded-lg border ${v} overflow-hidden`,style:{width:e.width,minHeight:e.height,borderColor:j},children:[o.jsxs("div",{className:`${_} border-b px-3 py-1.5 flex items-center justify-between`,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-[8px] font-bold uppercase tracking-wider",style:{color:n?"var(--header-text-doc)":"var(--header-text-epic)"},children:g}),o.jsx("span",{className:"text-[10px] font-medium",style:{color:"var(--text-primary)"},children:e.name})]}),e.intent==="optional"&&o.jsx("span",{className:"subway-button text-[8px] px-1.5 py-0.5 rounded",children:"OPTIONAL"})]}),o.jsxs("div",{className:"p-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"rounded-full flex-shrink-0",style:{width:n?24:18,height:n?24:18,backgroundColor:y}}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-wide",style:{color:b},children:N}),n&&e.desc&&o.jsx("p",{className:"text-[9px] mt-0.5 truncate",style:{color:"var(--text-muted)"},children:e.desc})]})]}),h&&o.jsx(x8,{stations:e.stations}),o.jsxs("div",{className:"mt-2 flex flex-wrap gap-1.5",children:[u&&o.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all",style:{backgroundColor:"var(--state-stabilized-bg)",color:"white"},onClick:T=>{var I;T.stopPropagation(),(I=e.onViewFullDocument)==null||I.call(e,e.instanceId?{docTypeId:e.docTypeId,instanceId:e.instanceId}:e.id)},children:"View Document"}),n&&d==="ready"&&o.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all",style:{backgroundColor:"var(--state-ready-bg)",color:"white"},onClick:T=>{var I;T.stopPropagation(),(I=e.onStartProduction)==null||I.call(e,e.id)},children:"Start Production"}),l&&i&&!r&&o.jsx("button",{className:"px-2 py-1 rounded text-[9px] font-semibold hover:brightness-110 transition-all amber-pulse",style:{backgroundColor:"var(--state-active-bg)",color:"white"},onClick:T=>{var I;T.stopPropagation(),(I=e.onExpand)==null||I.call(e,e.id,"questions")},children:"Answer Questions"}),!n&&a&&(r&&s==="features"?o.jsxs("span",{className:"text-[9px] text-indigo-400",children:[e.features.length," features expanded"]}):o.jsxs("button",{className:"subway-button px-2 py-1 rounded text-[9px] transition-colors flex items-center gap-1",onClick:T=>{var I;T.stopPropagation(),(I=e.onExpand)==null||I.call(e,e.id,"features")},children:[o.jsx("span",{className:"text-indigo-400",children:e.features.length}),o.jsx("span",{children:"features"}),o.jsx("span",{className:"text-indigo-400",children:""})]}))]}),((R=e.blockedBy)==null?void 0:R.length)>0&&(p||d==="ready")&&o.jsxs("div",{className:"mt-2 pt-2 border-t text-[8px]",style:{borderColor:"var(--border-node)",color:"var(--text-muted)"},children:[o.jsx("span",{className:"font-medium",children:"Waiting for: "}),e.blockedBy.map(E8).join(", ")]})]})]}),r&&s==="questions"&&i&&o.jsx(j8,{questions:e.questions,nodeWidth:e.width,onSubmit:T=>{var I;return(I=e.onSubmitQuestions)==null?void 0:I.call(e,e.id,T)},onClose:()=>{var T;return(T=e.onCollapse)==null?void 0:T.call(e)}}),r&&s==="features"&&a&&o.jsx(S8,{features:e.features,epicName:e.name,nodeWidth:e.width,onClose:()=>{var T;return(T=e.onCollapse)==null?void 0:T.call(e)},onZoomComplete:()=>{var T;return(T=e.onZoomToNode)==null?void 0:T.call(e,e.id)}}),o.jsx(yn,{type:"source",position:ce.Bottom,className:"!opacity-0",style:{left:"15%"}})]})}function R8(){return o.jsxs("div",{style:{width:1,height:1,background:"transparent"},children:[o.jsx(yn,{type:"target",position:ce.Top,style:{opacity:0}}),o.jsx(yn,{type:"source",position:ce.Bottom,style:{opacity:0}})]})}const fy="/api/v1";class A8 extends Error{constructor(t,n,r){super(t),this.name="ApiError",this.status=n,this.data=r}}function I8(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Oe(e,t={}){const n=`${fy}${e}`,r={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t},s=await fetch(n,r);if(!s.ok){const i=await s.json().catch(()=>({}));throw new A8(i.detail||`Request failed: ${s.status}`,s.status,i)}return s.status===204?null:s.json()}const Ke={getMe:()=>fetch("/api/me",{credentials:"same-origin"}).then(e=>{if(e.status===401)return null;if(!e.ok)throw new Error(`Request failed: ${e.status}`);return e.json()}).catch(e=>(console.error("Auth check failed:",e),null)),logout:()=>fetch("/auth/logout",{method:"POST",credentials:"same-origin",headers:{"X-CSRF-Token":I8()||""}}),getProjects:(e={})=>{const t=new URLSearchParams;e.search&&t.set("search",e.search),e.includeArchived&&t.set("include_archived","true");const n=t.toString();return Oe(`/projects${n?"?"+n:""}`)},getProject:e=>Oe(`/projects/${e}`),getProjectTree:e=>Oe(`/projects/${e}/tree`),createProject:e=>Oe("/projects",{method:"POST",body:JSON.stringify(e)}),updateProject:(e,t)=>Oe(`/projects/${e}`,{method:"PATCH",body:JSON.stringify(t)}),saveFloorLayout:(e,t)=>Oe(`/projects/${e}`,{method:"PATCH",body:JSON.stringify({metadata:{floor_layout:t}})}),archiveProject:e=>Oe(`/projects/${e}/archive`,{method:"POST"}),unarchiveProject:e=>Oe(`/projects/${e}/unarchive`,{method:"POST"}),deleteProject:e=>Oe(`/projects/${e}`,{method:"DELETE"}),getProductionStatus:e=>Oe(`/production/status?project_id=${e}`),startProduction:(e,t=null)=>{const n=new URLSearchParams({project_id:e});return t&&n.set("document_type",t),Oe(`/production/start?${n}`,{method:"POST"})},getProjectInterrupts:e=>Oe(`/projects/${e}/interrupts`),resolveInterrupt:(e,t)=>Oe(`/interrupts/${e}/resolve`,{method:"POST",body:JSON.stringify(t)}),startWorkflow:(e,t,n=null)=>Oe("/document-workflows/start",{method:"POST",body:JSON.stringify({project_id:e,document_type:t,initial_context:n})}),submitWorkflowInput:(e,t,n=null)=>Oe(`/document-workflows/executions/${e}/input`,{method:"POST",body:JSON.stringify({user_input:t,selected_option_id:n})}),getExecutionStatus:e=>Oe(`/document-workflows/executions/${e}`),getPgcAnswers:e=>Oe(`/document-workflows/executions/${e}/pgc-answers`),getDocument:(e,t,n)=>{const r=n?`?instance_id=${encodeURIComponent(n)}`:"";return Oe(`/projects/${e}/documents/${t}${r}`)},getDocumentRenderModel:(e,t,n)=>{const r=n?`?instance_id=${encodeURIComponent(n)}`:"";return Oe(`/projects/${e}/documents/${t}/render-model${r}`)},getDocumentPgc:(e,t,n)=>{const r=n?`?instance_id=${encodeURIComponent(n)}`:"";return Oe(`/projects/${e}/documents/${t}/pgc${r}`)},startIntake:()=>Oe("/intake/start",{method:"POST"}),getIntakeState:e=>Oe(`/intake/${e}`),submitIntakeMessage:(e,t)=>Oe(`/intake/${e}/message`,{method:"POST",body:JSON.stringify({content:t})}),updateIntakeField:(e,t,n)=>Oe(`/intake/${e}/field/${t}`,{method:"PATCH",body:JSON.stringify({value:n})}),initializeIntake:e=>Oe(`/intake/${e}/initialize`,{method:"POST"}),getWorkflowInstance:e=>Oe(`/projects/${e}/workflow`),createWorkflowInstance:(e,t,n)=>Oe(`/projects/${e}/workflow`,{method:"POST",body:JSON.stringify({workflow_id:t,version:n})}),updateWorkflowInstance:(e,t)=>Oe(`/projects/${e}/workflow`,{method:"PUT",body:JSON.stringify({effective_workflow:t})}),getWorkflowDrift:e=>Oe(`/projects/${e}/workflow/drift`),getWorkflowHistory:(e,t=50,n=0)=>Oe(`/projects/${e}/workflow/history?limit=${t}&offset=${n}`),completeWorkflowInstance:e=>Oe(`/projects/${e}/workflow/complete`,{method:"POST"}),createIntent:(e,t)=>Oe("/intents",{method:"POST",body:JSON.stringify({project_id:e,...t})}),getIntent:e=>Oe(`/intents/${e}`)};function P8(e){const t=`${fy}/production/events?project_id=${e}`;return new EventSource(t)}function M8(e){const t=`${fy}/intake/${e}/events`;return new EventSource(t)}function O8(e){return`/auth/login/${e}`}function D8({block:e}){const{data:t}=e,n=t.content||t.value||"";return n?o.jsxs("div",{style:{marginBottom:12},children:[o.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:n}),t.detail_ref&&o.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none",marginTop:4,display:"inline-block"},children:"View details "})]}):null}function Kb({block:e}){const{data:t}=e,n=t.items||[],r=t.style||"bullet";if(n.length===0)return null;const s=r==="numbered"?"decimal":"disc";return o.jsxs("div",{style:{marginBottom:12},children:[t.title&&o.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:t.title}),o.jsx("ul",{style:{margin:0,paddingLeft:r==="check"?0:20,listStyle:r==="check"?"none":s},children:n.map((i,a)=>o.jsxs("li",{style:{fontSize:14,lineHeight:1.6,color:"#374151",marginBottom:4,display:r==="check"?"flex":"list-item",alignItems:"flex-start",gap:8},children:[r==="check"&&o.jsx("span",{style:{color:"#10b981"},children:""}),typeof i=="string"?i:typeof i=="object"&&i!==null?o.jsx(L8,{item:i}):String(i)]},(i==null?void 0:i.id)||a))})]})}function L8({item:e}){const t=e.value||e.text||e.constraint||e.assumption||e.guardrail||e.recommendation||e.question||e.description||e.statement||e.name;return t?o.jsxs("span",{children:[e.id&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af",marginRight:6},children:e.id}),t,e.constraint_type&&o.jsx("span",{style:{marginLeft:6,fontSize:11,padding:"1px 6px",background:"#f3f4f6",borderRadius:4,color:"#6b7280"},children:e.constraint_type}),e.confidence&&o.jsx("span",{style:{marginLeft:6,fontSize:11,padding:"1px 6px",borderRadius:4,fontWeight:600,background:e.confidence==="high"?"#dcfce7":e.confidence==="medium"?"#fef3c7":"#fee2e2",color:e.confidence==="high"?"#166534":e.confidence==="medium"?"#92400e":"#991b1b"},children:e.confidence}),e.validation_approach&&o.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:[o.jsx("span",{style:{fontWeight:500},children:"Validation:"})," ",e.validation_approach]})]}):o.jsx("span",{children:Object.entries(e).map(([n,r],s)=>o.jsxs("span",{children:[s>0&&"  ",o.jsxs("span",{style:{fontWeight:500},children:[n,":"]})," ",typeof r=="string"?r:JSON.stringify(r)]},n))})}function z8({block:e}){const{data:t}=e,n=t.value||"unknown",r=t.label,i={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"},critical:{bg:"#fecaca",text:"#7f1d1d"},none:{bg:"#e5e7eb",text:"#374151"},external:{bg:"#dbeafe",text:"#1e40af"},qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"}}[n.toLowerCase()]||{bg:"#f3f4f6",text:"#374151"};return o.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginBottom:12},children:[r&&o.jsxs("span",{style:{fontSize:12,color:"#6b7280",fontWeight:500},children:[r,":"]}),o.jsx("span",{style:{display:"inline-block",padding:"4px 12px",borderRadius:20,background:i.bg,color:i.text,fontSize:12,fontWeight:500,textTransform:"capitalize"},children:n})]})}function IE({block:e}){const{data:t}=e,n=t.text||t.question||t.decision_area,{id:r,blocking:s,priority:i,tags:a,options:l}=t,c=t.why_it_matters||t.why_early,d=t.directed_to,u=t.recommendation_direction,f={must:{bg:"#fee2e2",text:"#991b1b"},should:{bg:"#fef3c7",text:"#92400e"},could:{bg:"#e5e7eb",text:"#374151"}},p=f[i]||f.should;return o.jsx("div",{style:{padding:"12px 16px",background:s?"#fef2f2":"#f8fafc",borderRadius:8,border:`1px solid ${s?"#fecaca":"#e2e8f0"}`,marginBottom:12},children:o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[o.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6b7280",background:"#e5e7eb",padding:"2px 6px",borderRadius:4,flexShrink:0},children:r}),o.jsxs("div",{style:{flex:1},children:[o.jsx("p",{style:{margin:0,fontSize:14,fontWeight:500,color:"#111827",marginBottom:6},children:n}),c&&o.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",fontStyle:"italic"},children:c}),o.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[s&&o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#fee2e2",color:"#991b1b",fontWeight:600},children:"BLOCKING"}),d&&o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:d.replace(/_/g," ")}),i&&o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:p.bg,color:p.text,textTransform:"uppercase"},children:i}),a==null?void 0:a.map((h,v)=>o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"#e0e7ff",color:"#3730a3"},children:h},v))]}),l&&l.length>0&&o.jsxs("div",{style:{marginTop:8},children:[o.jsx("span",{style:{fontSize:11,color:"#6b7280",fontWeight:500},children:"Options: "}),l.map((h,v)=>o.jsx("span",{style:{fontSize:11,color:"#374151",marginLeft:v>0?8:4},children:h},v))]}),u&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:"#059669"},children:["Recommendation: ",u]})]})]})})}function F8({block:e}){const{data:t}=e,n=t.items||[],r=t.total_count||n.length,s=t.blocking_count||n.filter(i=>i.blocking).length;return n.length===0?o.jsx("div",{style:{padding:"16px",background:"#f0fdf4",borderRadius:8,border:"1px solid #bbf7d0",textAlign:"center",color:"#166534",fontSize:14},children:"No open questions"}):o.jsxs("div",{children:[o.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12,padding:"8px 12px",background:"#f8fafc",borderRadius:6,fontSize:12},children:[o.jsxs("span",{style:{color:"#6b7280"},children:[o.jsx("strong",{style:{color:"#374151"},children:r})," questions"]}),s>0&&o.jsxs("span",{style:{color:"#dc2626"},children:[o.jsx("strong",{children:s})," blocking"]})]}),n.map((i,a)=>o.jsx(IE,{block:{type:"schema:OpenQuestionV1",data:i}},i.id||a))]})}function Yb({block:e}){const{data:t}=e,n=t.items||[],r=t.title;if(n.length===0)return null;const s={low:{bg:"#d1fae5",text:"#065f46",border:"#a7f3d0"},medium:{bg:"#fef3c7",text:"#92400e",border:"#fde68a"},high:{bg:"#fee2e2",text:"#991b1b",border:"#fecaca"},critical:{bg:"#fecaca",text:"#7f1d1d",border:"#f87171"}};return o.jsxs("div",{style:{marginBottom:12},children:[r&&o.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:r}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:n.map((i,a)=>{const l=i.severity||i.impact||i.likelihood||"medium",c=s[l]||s.medium;return o.jsx("div",{style:{padding:"10px 14px",background:c.bg,borderRadius:6,border:`1px solid ${c.border}`},children:o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10},children:[i.id&&o.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:c.text,background:"rgba(255,255,255,0.5)",padding:"2px 6px",borderRadius:4,flexShrink:0},children:i.id}),o.jsxs("div",{style:{flex:1},children:[o.jsx("p",{style:{margin:0,fontSize:13,color:c.text,fontWeight:500},children:i.risk||i.description||i.reason||JSON.stringify(i)}),i.impact&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Impact: ",i.impact]}),i.impact_on_planning&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Planning impact: ",i.impact_on_planning]}),(i.mitigation||i.mitigation_direction)&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:12,color:c.text,opacity:.8},children:["Mitigation: ",i.mitigation||i.mitigation_direction]}),i.status&&o.jsxs("p",{style:{margin:"4px 0 0",fontSize:11,color:c.text,opacity:.7,textTransform:"capitalize"},children:["Status: ",i.status]})]}),o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:"rgba(255,255,255,0.5)",color:c.text,textTransform:"uppercase",fontWeight:600},children:l})]})},i.id||a)})})]})}function $8({block:e}){const{data:t}=e,r=Object.entries({problem_understanding:"Problem Understanding",architectural_intent:"Architectural Intent",scope_pressure_points:"Scope Pressure Points",proposed_system_shape:"Proposed System Shape",overall_intent:"Overall Intent",mvp_definition:"MVP Definition",refined_description:"Description",architectural_style:"Architectural Style",style:"Architectural Style"}).filter(([s])=>t[s]&&typeof t[s]=="string").map(([s,i])=>({title:i,content:t[s]}));return r.length===0&&!t.title?null:o.jsxs("div",{style:{marginBottom:12},children:[t.title&&o.jsx("h3",{style:{fontSize:16,fontWeight:600,color:"#1f2937",marginBottom:12},children:t.title}),r.map((s,i)=>o.jsxs("div",{style:{marginBottom:16},children:[o.jsx("h4",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:s.title}),o.jsx("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,borderLeft:"3px solid #6366f1"},children:o.jsx("p",{style:{margin:0,fontSize:14,lineHeight:1.6,color:"#374151",whiteSpace:"pre-line"},children:s.content})})]},i))]})}function Xb({block:e}){const{data:t}=e,{epic_id:n,title:r,name:s,intent:i,phase:a,mvp_phase:l,risk_level:c,stories:d,detail_ref:u}=t,f=a||l,p=r||s,h={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}},v=h[c]||h.medium,g={mvp:{bg:"#dbeafe",text:"#1e40af"},"later-phase":{bg:"#e5e7eb",text:"#374151"},later:{bg:"#e5e7eb",text:"#374151"}},_=g[f]||g.mvp;return o.jsxs("div",{style:{padding:"14px 16px",background:"#ffffff",borderRadius:8,border:"1px solid #e2e8f0",marginBottom:12,boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12},children:[o.jsxs("div",{style:{flex:1},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[n&&o.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#6366f1",background:"#eef2ff",padding:"2px 6px",borderRadius:4},children:n}),o.jsx("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"#111827"},children:p})]}),i&&o.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:i}),d&&d.length>0&&o.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:[d.length," stories"]})]}),o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,alignItems:"flex-end"},children:[f&&o.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:_.bg,color:_.text,textTransform:"uppercase",fontWeight:500},children:f==="later-phase"?"LATER":f}),c&&o.jsxs("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:10,background:v.bg,color:v.text,textTransform:"uppercase",fontWeight:500},children:[c," risk"]})]})]}),u&&o.jsx("div",{style:{marginTop:10,paddingTop:10,borderTop:"1px solid #f3f4f6"},children:o.jsx("a",{href:"#",style:{fontSize:12,color:"#6366f1",textDecoration:"none"},children:"View epic details "})})]})}function q8({block:e}){const{data:t}=e,{story_id:n,title:r,intent:s,phase:i,risk_level:a,detail_ref:l}=t,d={low:{bg:"#d1fae5",text:"#065f46"},medium:{bg:"#fef3c7",text:"#92400e"},high:{bg:"#fee2e2",text:"#991b1b"}}[a]||null,u={mvp:{bg:"#dbeafe",text:"#1e40af"},later:{bg:"#e5e7eb",text:"#374151"}},f=u[i]||u.mvp;return o.jsx("div",{style:{padding:"10px 14px",background:"#fafafa",borderRadius:6,border:"1px solid #e5e7eb",marginBottom:8},children:o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:10},children:[o.jsxs("div",{style:{flex:1},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[n&&o.jsx("span",{style:{fontSize:10,fontFamily:"monospace",color:"#059669",background:"#ecfdf5",padding:"1px 5px",borderRadius:3},children:n}),o.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:r})]}),s&&o.jsx("p",{style:{margin:0,fontSize:12,color:"#6b7280",lineHeight:1.4},children:s})]}),o.jsxs("div",{style:{display:"flex",gap:4},children:[i&&o.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:f.bg,color:f.text,textTransform:"uppercase",fontWeight:500},children:i}),d&&o.jsx("span",{style:{fontSize:9,padding:"2px 6px",borderRadius:8,background:d.bg,color:d.text,textTransform:"uppercase",fontWeight:500},children:a})]})]})})}function B8({block:e}){const{data:t}=e;if(!t||!t.name)return null;const n=t.technology||(Array.isArray(t.technology_choices)?t.technology_choices.join(", "):null),r=t.interfaces||[],s=t.dependencies||t.depends_on_components||[],i=t.responsibilities||[],a=t.layer,l=t.mvp_phase,c={fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:2},d={fontSize:13,color:"#374151",lineHeight:1.5,margin:0},u=(f,p)=>({fontSize:12,padding:"2px 8px",background:f,color:p,borderRadius:4});return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[o.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),a&&o.jsx("span",{style:u("#f0fdf4","#166534"),children:a}),l&&o.jsx("span",{style:u("#eff6ff","#1e40af"),children:l})]}),t.purpose&&o.jsx("p",{style:{...d,marginBottom:10,color:"#475569"},children:t.purpose}),n&&o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:c,children:"Technology"}),o.jsx("p",{style:d,children:n})]}),Array.isArray(i)&&i.length>0&&o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:c,children:"Responsibilities"}),o.jsx("ul",{style:{margin:0,paddingLeft:18},children:i.map((f,p)=>o.jsx("li",{style:{fontSize:13,color:"#374151",lineHeight:1.5},children:f},p))})]}),Array.isArray(r)&&r.length>0&&o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:c,children:"Interfaces"}),o.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:r.map((f,p)=>o.jsx("span",{style:u("#e0e7ff","#3730a3"),children:f},p))})]}),Array.isArray(s)&&s.length>0&&o.jsxs("div",{children:[o.jsx("div",{style:c,children:"Dependencies"}),o.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:s.map((f,p)=>o.jsx("span",{style:u("#fef3c7","#92400e"),children:f},p))})]})]})}function py(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var vd,Qb;function W8(){if(Qb)return vd;Qb=1;function e(){this.__data__=[],this.size=0}return vd=e,vd}var yd,Zb;function Pi(){if(Zb)return yd;Zb=1;function e(t,n){return t===n||t!==t&&n!==n}return yd=e,yd}var bd,Jb;function ou(){if(Jb)return bd;Jb=1;var e=Pi();function t(n,r){for(var s=n.length;s--;)if(e(n[s][0],r))return s;return-1}return bd=t,bd}var _d,e1;function H8(){if(e1)return _d;e1=1;var e=ou(),t=Array.prototype,n=t.splice;function r(s){var i=this.__data__,a=e(i,s);if(a<0)return!1;var l=i.length-1;return a==l?i.pop():n.call(i,a,1),--this.size,!0}return _d=r,_d}var wd,t1;function V8(){if(t1)return wd;t1=1;var e=ou();function t(n){var r=this.__data__,s=e(r,n);return s<0?void 0:r[s][1]}return wd=t,wd}var jd,n1;function U8(){if(n1)return jd;n1=1;var e=ou();function t(n){return e(this.__data__,n)>-1}return jd=t,jd}var Sd,r1;function G8(){if(r1)return Sd;r1=1;var e=ou();function t(n,r){var s=this.__data__,i=e(s,n);return i<0?(++this.size,s.push([n,r])):s[i][1]=r,this}return Sd=t,Sd}var kd,s1;function au(){if(s1)return kd;s1=1;var e=W8(),t=H8(),n=V8(),r=U8(),s=G8();function i(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=n,i.prototype.has=r,i.prototype.set=s,kd=i,kd}var Nd,i1;function K8(){if(i1)return Nd;i1=1;var e=au();function t(){this.__data__=new e,this.size=0}return Nd=t,Nd}var Cd,o1;function Y8(){if(o1)return Cd;o1=1;function e(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}return Cd=e,Cd}var Ed,a1;function X8(){if(a1)return Ed;a1=1;function e(t){return this.__data__.get(t)}return Ed=e,Ed}var Td,l1;function Q8(){if(l1)return Td;l1=1;function e(t){return this.__data__.has(t)}return Td=e,Td}var Rd,c1;function PE(){if(c1)return Rd;c1=1;var e=typeof Ia=="object"&&Ia&&Ia.Object===Object&&Ia;return Rd=e,Rd}var Ad,u1;function On(){if(u1)return Ad;u1=1;var e=PE(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return Ad=n,Ad}var Id,d1;function Mi(){if(d1)return Id;d1=1;var e=On(),t=e.Symbol;return Id=t,Id}var Pd,f1;function Z8(){if(f1)return Pd;f1=1;var e=Mi(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,s=e?e.toStringTag:void 0;function i(a){var l=n.call(a,s),c=a[s];try{a[s]=void 0;var d=!0}catch{}var u=r.call(a);return d&&(l?a[s]=c:delete a[s]),u}return Pd=i,Pd}var Md,p1;function J8(){if(p1)return Md;p1=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return Md=n,Md}var Od,h1;function Ts(){if(h1)return Od;h1=1;var e=Mi(),t=Z8(),n=J8(),r="[object Null]",s="[object Undefined]",i=e?e.toStringTag:void 0;function a(l){return l==null?l===void 0?s:r:i&&i in Object(l)?t(l):n(l)}return Od=a,Od}var Dd,m1;function bn(){if(m1)return Dd;m1=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return Dd=e,Dd}var Ld,g1;function ja(){if(g1)return Ld;g1=1;var e=Ts(),t=bn(),n="[object AsyncFunction]",r="[object Function]",s="[object GeneratorFunction]",i="[object Proxy]";function a(l){if(!t(l))return!1;var c=e(l);return c==r||c==s||c==n||c==i}return Ld=a,Ld}var zd,x1;function eD(){if(x1)return zd;x1=1;var e=On(),t=e["__core-js_shared__"];return zd=t,zd}var Fd,v1;function tD(){if(v1)return Fd;v1=1;var e=eD(),t=function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function n(r){return!!t&&t in r}return Fd=n,Fd}var $d,y1;function ME(){if(y1)return $d;y1=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return $d=n,$d}var qd,b1;function nD(){if(b1)return qd;b1=1;var e=ja(),t=tD(),n=bn(),r=ME(),s=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,a=Function.prototype,l=Object.prototype,c=a.toString,d=l.hasOwnProperty,u=RegExp("^"+c.call(d).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(p){if(!n(p)||t(p))return!1;var h=e(p)?u:i;return h.test(r(p))}return qd=f,qd}var Bd,_1;function rD(){if(_1)return Bd;_1=1;function e(t,n){return t==null?void 0:t[n]}return Bd=e,Bd}var Wd,w1;function Rs(){if(w1)return Wd;w1=1;var e=nD(),t=rD();function n(r,s){var i=t(r,s);return e(i)?i:void 0}return Wd=n,Wd}var Hd,j1;function hy(){if(j1)return Hd;j1=1;var e=Rs(),t=On(),n=e(t,"Map");return Hd=n,Hd}var Vd,S1;function lu(){if(S1)return Vd;S1=1;var e=Rs(),t=e(Object,"create");return Vd=t,Vd}var Ud,k1;function sD(){if(k1)return Ud;k1=1;var e=lu();function t(){this.__data__=e?e(null):{},this.size=0}return Ud=t,Ud}var Gd,N1;function iD(){if(N1)return Gd;N1=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return Gd=e,Gd}var Kd,C1;function oD(){if(C1)return Kd;C1=1;var e=lu(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function s(i){var a=this.__data__;if(e){var l=a[i];return l===t?void 0:l}return r.call(a,i)?a[i]:void 0}return Kd=s,Kd}var Yd,E1;function aD(){if(E1)return Yd;E1=1;var e=lu(),t=Object.prototype,n=t.hasOwnProperty;function r(s){var i=this.__data__;return e?i[s]!==void 0:n.call(i,s)}return Yd=r,Yd}var Xd,T1;function lD(){if(T1)return Xd;T1=1;var e=lu(),t="__lodash_hash_undefined__";function n(r,s){var i=this.__data__;return this.size+=this.has(r)?0:1,i[r]=e&&s===void 0?t:s,this}return Xd=n,Xd}var Qd,R1;function cD(){if(R1)return Qd;R1=1;var e=sD(),t=iD(),n=oD(),r=aD(),s=lD();function i(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=n,i.prototype.has=r,i.prototype.set=s,Qd=i,Qd}var Zd,A1;function uD(){if(A1)return Zd;A1=1;var e=cD(),t=au(),n=hy();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return Zd=r,Zd}var Jd,I1;function dD(){if(I1)return Jd;I1=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return Jd=e,Jd}var ef,P1;function cu(){if(P1)return ef;P1=1;var e=dD();function t(n,r){var s=n.__data__;return e(r)?s[typeof r=="string"?"string":"hash"]:s.map}return ef=t,ef}var tf,M1;function fD(){if(M1)return tf;M1=1;var e=cu();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return tf=t,tf}var nf,O1;function pD(){if(O1)return nf;O1=1;var e=cu();function t(n){return e(this,n).get(n)}return nf=t,nf}var rf,D1;function hD(){if(D1)return rf;D1=1;var e=cu();function t(n){return e(this,n).has(n)}return rf=t,rf}var sf,L1;function mD(){if(L1)return sf;L1=1;var e=cu();function t(n,r){var s=e(this,n),i=s.size;return s.set(n,r),this.size+=s.size==i?0:1,this}return sf=t,sf}var of,z1;function my(){if(z1)return of;z1=1;var e=uD(),t=fD(),n=pD(),r=hD(),s=mD();function i(a){var l=-1,c=a==null?0:a.length;for(this.clear();++l<c;){var d=a[l];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=n,i.prototype.has=r,i.prototype.set=s,of=i,of}var af,F1;function gD(){if(F1)return af;F1=1;var e=au(),t=hy(),n=my(),r=200;function s(i,a){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<r-1)return c.push([i,a]),this.size=++l.size,this;l=this.__data__=new n(c)}return l.set(i,a),this.size=l.size,this}return af=s,af}var lf,$1;function uu(){if($1)return lf;$1=1;var e=au(),t=K8(),n=Y8(),r=X8(),s=Q8(),i=gD();function a(l){var c=this.__data__=new e(l);this.size=c.size}return a.prototype.clear=t,a.prototype.delete=n,a.prototype.get=r,a.prototype.has=s,a.prototype.set=i,lf=a,lf}var cf,q1;function gy(){if(q1)return cf;q1=1;function e(t,n){for(var r=-1,s=t==null?0:t.length;++r<s&&n(t[r],r,t)!==!1;);return t}return cf=e,cf}var uf,B1;function OE(){if(B1)return uf;B1=1;var e=Rs(),t=function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}}();return uf=t,uf}var df,W1;function du(){if(W1)return df;W1=1;var e=OE();function t(n,r,s){r=="__proto__"&&e?e(n,r,{configurable:!0,enumerable:!0,value:s,writable:!0}):n[r]=s}return df=t,df}var ff,H1;function fu(){if(H1)return ff;H1=1;var e=du(),t=Pi(),n=Object.prototype,r=n.hasOwnProperty;function s(i,a,l){var c=i[a];(!(r.call(i,a)&&t(c,l))||l===void 0&&!(a in i))&&e(i,a,l)}return ff=s,ff}var pf,V1;function Sa(){if(V1)return pf;V1=1;var e=fu(),t=du();function n(r,s,i,a){var l=!i;i||(i={});for(var c=-1,d=s.length;++c<d;){var u=s[c],f=a?a(i[u],r[u],u,i,r):void 0;f===void 0&&(f=r[u]),l?t(i,u,f):e(i,u,f)}return i}return pf=n,pf}var hf,U1;function xD(){if(U1)return hf;U1=1;function e(t,n){for(var r=-1,s=Array(t);++r<t;)s[r]=n(r);return s}return hf=e,hf}var mf,G1;function Xn(){if(G1)return mf;G1=1;function e(t){return t!=null&&typeof t=="object"}return mf=e,mf}var gf,K1;function vD(){if(K1)return gf;K1=1;var e=Ts(),t=Xn(),n="[object Arguments]";function r(s){return t(s)&&e(s)==n}return gf=r,gf}var xf,Y1;function ka(){if(Y1)return xf;Y1=1;var e=vD(),t=Xn(),n=Object.prototype,r=n.hasOwnProperty,s=n.propertyIsEnumerable,i=e(function(){return arguments}())?e:function(a){return t(a)&&r.call(a,"callee")&&!s.call(a,"callee")};return xf=i,xf}var vf,X1;function ft(){if(X1)return vf;X1=1;var e=Array.isArray;return vf=e,vf}var go={exports:{}},yf,Q1;function yD(){if(Q1)return yf;Q1=1;function e(){return!1}return yf=e,yf}go.exports;var Z1;function Oi(){return Z1||(Z1=1,function(e,t){var n=On(),r=yD(),s=t&&!t.nodeType&&t,i=s&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===s,l=a?n.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||r;e.exports=d}(go,go.exports)),go.exports}var bf,J1;function pu(){if(J1)return bf;J1=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(r,s){var i=typeof r;return s=s??e,!!s&&(i=="number"||i!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<s}return bf=n,bf}var _f,e_;function xy(){if(e_)return _f;e_=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return _f=t,_f}var wf,t_;function bD(){if(t_)return wf;t_=1;var e=Ts(),t=xy(),n=Xn(),r="[object Arguments]",s="[object Array]",i="[object Boolean]",a="[object Date]",l="[object Error]",c="[object Function]",d="[object Map]",u="[object Number]",f="[object Object]",p="[object RegExp]",h="[object Set]",v="[object String]",g="[object WeakMap]",_="[object ArrayBuffer]",x="[object DataView]",y="[object Float32Array]",b="[object Float64Array]",j="[object Int8Array]",N="[object Int16Array]",E="[object Int32Array]",S="[object Uint8Array]",k="[object Uint8ClampedArray]",w="[object Uint16Array]",R="[object Uint32Array]",T={};T[y]=T[b]=T[j]=T[N]=T[E]=T[S]=T[k]=T[w]=T[R]=!0,T[r]=T[s]=T[_]=T[i]=T[x]=T[a]=T[l]=T[c]=T[d]=T[u]=T[f]=T[p]=T[h]=T[v]=T[g]=!1;function I(D){return n(D)&&t(D.length)&&!!T[e(D)]}return wf=I,wf}var jf,n_;function hu(){if(n_)return jf;n_=1;function e(t){return function(n){return t(n)}}return jf=e,jf}var xo={exports:{}};xo.exports;var r_;function vy(){return r_||(r_=1,function(e,t){var n=PE(),r=t&&!t.nodeType&&t,s=r&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===r,a=i&&n.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}}();e.exports=l}(xo,xo.exports)),xo.exports}var Sf,s_;function Na(){if(s_)return Sf;s_=1;var e=bD(),t=hu(),n=vy(),r=n&&n.isTypedArray,s=r?t(r):e;return Sf=s,Sf}var kf,i_;function DE(){if(i_)return kf;i_=1;var e=xD(),t=ka(),n=ft(),r=Oi(),s=pu(),i=Na(),a=Object.prototype,l=a.hasOwnProperty;function c(d,u){var f=n(d),p=!f&&t(d),h=!f&&!p&&r(d),v=!f&&!p&&!h&&i(d),g=f||p||h||v,_=g?e(d.length,String):[],x=_.length;for(var y in d)(u||l.call(d,y))&&!(g&&(y=="length"||h&&(y=="offset"||y=="parent")||v&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||s(y,x)))&&_.push(y);return _}return kf=c,kf}var Nf,o_;function mu(){if(o_)return Nf;o_=1;var e=Object.prototype;function t(n){var r=n&&n.constructor,s=typeof r=="function"&&r.prototype||e;return n===s}return Nf=t,Nf}var Cf,a_;function LE(){if(a_)return Cf;a_=1;function e(t,n){return function(r){return t(n(r))}}return Cf=e,Cf}var Ef,l_;function _D(){if(l_)return Ef;l_=1;var e=LE(),t=e(Object.keys,Object);return Ef=t,Ef}var Tf,c_;function yy(){if(c_)return Tf;c_=1;var e=mu(),t=_D(),n=Object.prototype,r=n.hasOwnProperty;function s(i){if(!e(i))return t(i);var a=[];for(var l in Object(i))r.call(i,l)&&l!="constructor"&&a.push(l);return a}return Tf=s,Tf}var Rf,u_;function yr(){if(u_)return Rf;u_=1;var e=ja(),t=xy();function n(r){return r!=null&&t(r.length)&&!e(r)}return Rf=n,Rf}var Af,d_;function ts(){if(d_)return Af;d_=1;var e=DE(),t=yy(),n=yr();function r(s){return n(s)?e(s):t(s)}return Af=r,Af}var If,f_;function wD(){if(f_)return If;f_=1;var e=Sa(),t=ts();function n(r,s){return r&&e(s,t(s),r)}return If=n,If}var Pf,p_;function jD(){if(p_)return Pf;p_=1;function e(t){var n=[];if(t!=null)for(var r in Object(t))n.push(r);return n}return Pf=e,Pf}var Mf,h_;function SD(){if(h_)return Mf;h_=1;var e=bn(),t=mu(),n=jD(),r=Object.prototype,s=r.hasOwnProperty;function i(a){if(!e(a))return n(a);var l=t(a),c=[];for(var d in a)d=="constructor"&&(l||!s.call(a,d))||c.push(d);return c}return Mf=i,Mf}var Of,m_;function As(){if(m_)return Of;m_=1;var e=DE(),t=SD(),n=yr();function r(s){return n(s)?e(s,!0):t(s)}return Of=r,Of}var Df,g_;function kD(){if(g_)return Df;g_=1;var e=Sa(),t=As();function n(r,s){return r&&e(s,t(s),r)}return Df=n,Df}var vo={exports:{}};vo.exports;var x_;function zE(){return x_||(x_=1,function(e,t){var n=On(),r=t&&!t.nodeType&&t,s=r&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===r,a=i?n.Buffer:void 0,l=a?a.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var f=d.length,p=l?l(f):new d.constructor(f);return d.copy(p),p}e.exports=c}(vo,vo.exports)),vo.exports}var Lf,v_;function FE(){if(v_)return Lf;v_=1;function e(t,n){var r=-1,s=t.length;for(n||(n=Array(s));++r<s;)n[r]=t[r];return n}return Lf=e,Lf}var zf,y_;function $E(){if(y_)return zf;y_=1;function e(t,n){for(var r=-1,s=t==null?0:t.length,i=0,a=[];++r<s;){var l=t[r];n(l,r,t)&&(a[i++]=l)}return a}return zf=e,zf}var Ff,b_;function qE(){if(b_)return Ff;b_=1;function e(){return[]}return Ff=e,Ff}var $f,__;function by(){if(__)return $f;__=1;var e=$E(),t=qE(),n=Object.prototype,r=n.propertyIsEnumerable,s=Object.getOwnPropertySymbols,i=s?function(a){return a==null?[]:(a=Object(a),e(s(a),function(l){return r.call(a,l)}))}:t;return $f=i,$f}var qf,w_;function ND(){if(w_)return qf;w_=1;var e=Sa(),t=by();function n(r,s){return e(r,t(r),s)}return qf=n,qf}var Bf,j_;function _y(){if(j_)return Bf;j_=1;function e(t,n){for(var r=-1,s=n.length,i=t.length;++r<s;)t[i+r]=n[r];return t}return Bf=e,Bf}var Wf,S_;function gu(){if(S_)return Wf;S_=1;var e=LE(),t=e(Object.getPrototypeOf,Object);return Wf=t,Wf}var Hf,k_;function BE(){if(k_)return Hf;k_=1;var e=_y(),t=gu(),n=by(),r=qE(),s=Object.getOwnPropertySymbols,i=s?function(a){for(var l=[];a;)e(l,n(a)),a=t(a);return l}:r;return Hf=i,Hf}var Vf,N_;function CD(){if(N_)return Vf;N_=1;var e=Sa(),t=BE();function n(r,s){return e(r,t(r),s)}return Vf=n,Vf}var Uf,C_;function WE(){if(C_)return Uf;C_=1;var e=_y(),t=ft();function n(r,s,i){var a=s(r);return t(r)?a:e(a,i(r))}return Uf=n,Uf}var Gf,E_;function HE(){if(E_)return Gf;E_=1;var e=WE(),t=by(),n=ts();function r(s){return e(s,n,t)}return Gf=r,Gf}var Kf,T_;function ED(){if(T_)return Kf;T_=1;var e=WE(),t=BE(),n=As();function r(s){return e(s,n,t)}return Kf=r,Kf}var Yf,R_;function TD(){if(R_)return Yf;R_=1;var e=Rs(),t=On(),n=e(t,"DataView");return Yf=n,Yf}var Xf,A_;function RD(){if(A_)return Xf;A_=1;var e=Rs(),t=On(),n=e(t,"Promise");return Xf=n,Xf}var Qf,I_;function VE(){if(I_)return Qf;I_=1;var e=Rs(),t=On(),n=e(t,"Set");return Qf=n,Qf}var Zf,P_;function AD(){if(P_)return Zf;P_=1;var e=Rs(),t=On(),n=e(t,"WeakMap");return Zf=n,Zf}var Jf,M_;function Di(){if(M_)return Jf;M_=1;var e=TD(),t=hy(),n=RD(),r=VE(),s=AD(),i=Ts(),a=ME(),l="[object Map]",c="[object Object]",d="[object Promise]",u="[object Set]",f="[object WeakMap]",p="[object DataView]",h=a(e),v=a(t),g=a(n),_=a(r),x=a(s),y=i;return(e&&y(new e(new ArrayBuffer(1)))!=p||t&&y(new t)!=l||n&&y(n.resolve())!=d||r&&y(new r)!=u||s&&y(new s)!=f)&&(y=function(b){var j=i(b),N=j==c?b.constructor:void 0,E=N?a(N):"";if(E)switch(E){case h:return p;case v:return l;case g:return d;case _:return u;case x:return f}return j}),Jf=y,Jf}var ep,O_;function ID(){if(O_)return ep;O_=1;var e=Object.prototype,t=e.hasOwnProperty;function n(r){var s=r.length,i=new r.constructor(s);return s&&typeof r[0]=="string"&&t.call(r,"index")&&(i.index=r.index,i.input=r.input),i}return ep=n,ep}var tp,D_;function UE(){if(D_)return tp;D_=1;var e=On(),t=e.Uint8Array;return tp=t,tp}var np,L_;function wy(){if(L_)return np;L_=1;var e=UE();function t(n){var r=new n.constructor(n.byteLength);return new e(r).set(new e(n)),r}return np=t,np}var rp,z_;function PD(){if(z_)return rp;z_=1;var e=wy();function t(n,r){var s=r?e(n.buffer):n.buffer;return new n.constructor(s,n.byteOffset,n.byteLength)}return rp=t,rp}var sp,F_;function MD(){if(F_)return sp;F_=1;var e=/\w*$/;function t(n){var r=new n.constructor(n.source,e.exec(n));return r.lastIndex=n.lastIndex,r}return sp=t,sp}var ip,$_;function OD(){if($_)return ip;$_=1;var e=Mi(),t=e?e.prototype:void 0,n=t?t.valueOf:void 0;function r(s){return n?Object(n.call(s)):{}}return ip=r,ip}var op,q_;function GE(){if(q_)return op;q_=1;var e=wy();function t(n,r){var s=r?e(n.buffer):n.buffer;return new n.constructor(s,n.byteOffset,n.length)}return op=t,op}var ap,B_;function DD(){if(B_)return ap;B_=1;var e=wy(),t=PD(),n=MD(),r=OD(),s=GE(),i="[object Boolean]",a="[object Date]",l="[object Map]",c="[object Number]",d="[object RegExp]",u="[object Set]",f="[object String]",p="[object Symbol]",h="[object ArrayBuffer]",v="[object DataView]",g="[object Float32Array]",_="[object Float64Array]",x="[object Int8Array]",y="[object Int16Array]",b="[object Int32Array]",j="[object Uint8Array]",N="[object Uint8ClampedArray]",E="[object Uint16Array]",S="[object Uint32Array]";function k(w,R,T){var I=w.constructor;switch(R){case h:return e(w);case i:case a:return new I(+w);case v:return t(w,T);case g:case _:case x:case y:case b:case j:case N:case E:case S:return s(w,T);case l:return new I;case c:case f:return new I(w);case d:return n(w);case u:return new I;case p:return r(w)}}return ap=k,ap}var lp,W_;function KE(){if(W_)return lp;W_=1;var e=bn(),t=Object.create,n=function(){function r(){}return function(s){if(!e(s))return{};if(t)return t(s);r.prototype=s;var i=new r;return r.prototype=void 0,i}}();return lp=n,lp}var cp,H_;function YE(){if(H_)return cp;H_=1;var e=KE(),t=gu(),n=mu();function r(s){return typeof s.constructor=="function"&&!n(s)?e(t(s)):{}}return cp=r,cp}var up,V_;function LD(){if(V_)return up;V_=1;var e=Di(),t=Xn(),n="[object Map]";function r(s){return t(s)&&e(s)==n}return up=r,up}var dp,U_;function zD(){if(U_)return dp;U_=1;var e=LD(),t=hu(),n=vy(),r=n&&n.isMap,s=r?t(r):e;return dp=s,dp}var fp,G_;function FD(){if(G_)return fp;G_=1;var e=Di(),t=Xn(),n="[object Set]";function r(s){return t(s)&&e(s)==n}return fp=r,fp}var pp,K_;function $D(){if(K_)return pp;K_=1;var e=FD(),t=hu(),n=vy(),r=n&&n.isSet,s=r?t(r):e;return pp=s,pp}var hp,Y_;function XE(){if(Y_)return hp;Y_=1;var e=uu(),t=gy(),n=fu(),r=wD(),s=kD(),i=zE(),a=FE(),l=ND(),c=CD(),d=HE(),u=ED(),f=Di(),p=ID(),h=DD(),v=YE(),g=ft(),_=Oi(),x=zD(),y=bn(),b=$D(),j=ts(),N=As(),E=1,S=2,k=4,w="[object Arguments]",R="[object Array]",T="[object Boolean]",I="[object Date]",D="[object Error]",C="[object Function]",M="[object GeneratorFunction]",P="[object Map]",F="[object Number]",O="[object Object]",A="[object RegExp]",z="[object Set]",$="[object String]",B="[object Symbol]",U="[object WeakMap]",G="[object ArrayBuffer]",H="[object DataView]",q="[object Float32Array]",Q="[object Float64Array]",se="[object Int8Array]",ie="[object Int16Array]",Z="[object Int32Array]",Se="[object Uint8Array]",xe="[object Uint8ClampedArray]",be="[object Uint16Array]",ve="[object Uint32Array]",ae={};ae[w]=ae[R]=ae[G]=ae[H]=ae[T]=ae[I]=ae[q]=ae[Q]=ae[se]=ae[ie]=ae[Z]=ae[P]=ae[F]=ae[O]=ae[A]=ae[z]=ae[$]=ae[B]=ae[Se]=ae[xe]=ae[be]=ae[ve]=!0,ae[D]=ae[C]=ae[U]=!1;function Y(te,ee,ke,we,Ee,Ne){var ne,je=ee&E,Ve=ee&S,ct=ee&k;if(ke&&(ne=Ee?ke(te,we,Ee,Ne):ke(te)),ne!==void 0)return ne;if(!y(te))return te;var Be=g(te);if(Be){if(ne=p(te),!je)return a(te,ne)}else{var Ie=f(te),oe=Ie==C||Ie==M;if(_(te))return i(te,je);if(Ie==O||Ie==w||oe&&!Ee){if(ne=Ve||oe?{}:v(te),!je)return Ve?c(te,s(ne,te)):l(te,r(ne,te))}else{if(!ae[Ie])return Ee?te:{};ne=h(te,Ie,je)}}Ne||(Ne=new e);var me=Ne.get(te);if(me)return me;Ne.set(te,ne),b(te)?te.forEach(function(ge){ne.add(Y(ge,ee,ke,ge,te,Ne))}):x(te)&&te.forEach(function(ge,pe){ne.set(pe,Y(ge,ee,ke,pe,te,Ne))});var fe=ct?Ve?u:d:Ve?N:j,V=Be?void 0:fe(te);return t(V||te,function(ge,pe){V&&(pe=ge,ge=te[pe]),n(ne,pe,Y(ge,ee,ke,pe,te,Ne))}),ne}return hp=Y,hp}var mp,X_;function qD(){if(X_)return mp;X_=1;var e=XE(),t=4;function n(r){return e(r,t)}return mp=n,mp}var gp,Q_;function jy(){if(Q_)return gp;Q_=1;function e(t){return function(){return t}}return gp=e,gp}var xp,Z_;function BD(){if(Z_)return xp;Z_=1;function e(t){return function(n,r,s){for(var i=-1,a=Object(n),l=s(n),c=l.length;c--;){var d=l[t?c:++i];if(r(a[d],d,a)===!1)break}return n}}return xp=e,xp}var vp,J_;function Sy(){if(J_)return vp;J_=1;var e=BD(),t=e();return vp=t,vp}var yp,ew;function ky(){if(ew)return yp;ew=1;var e=Sy(),t=ts();function n(r,s){return r&&e(r,s,t)}return yp=n,yp}var bp,tw;function WD(){if(tw)return bp;tw=1;var e=yr();function t(n,r){return function(s,i){if(s==null)return s;if(!e(s))return n(s,i);for(var a=s.length,l=r?a:-1,c=Object(s);(r?l--:++l<a)&&i(c[l],l,c)!==!1;);return s}}return bp=t,bp}var _p,nw;function xu(){if(nw)return _p;nw=1;var e=ky(),t=WD(),n=t(e);return _p=n,_p}var wp,rw;function Is(){if(rw)return wp;rw=1;function e(t){return t}return wp=e,wp}var jp,sw;function QE(){if(sw)return jp;sw=1;var e=Is();function t(n){return typeof n=="function"?n:e}return jp=t,jp}var Sp,iw;function ZE(){if(iw)return Sp;iw=1;var e=gy(),t=xu(),n=QE(),r=ft();function s(i,a){var l=r(i)?e:t;return l(i,n(a))}return Sp=s,Sp}var kp,ow;function JE(){return ow||(ow=1,kp=ZE()),kp}var Np,aw;function HD(){if(aw)return Np;aw=1;var e=xu();function t(n,r){var s=[];return e(n,function(i,a,l){r(i,a,l)&&s.push(i)}),s}return Np=t,Np}var Cp,lw;function VD(){if(lw)return Cp;lw=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return Cp=t,Cp}var Ep,cw;function UD(){if(cw)return Ep;cw=1;function e(t){return this.__data__.has(t)}return Ep=e,Ep}var Tp,uw;function e4(){if(uw)return Tp;uw=1;var e=my(),t=VD(),n=UD();function r(s){var i=-1,a=s==null?0:s.length;for(this.__data__=new e;++i<a;)this.add(s[i])}return r.prototype.add=r.prototype.push=t,r.prototype.has=n,Tp=r,Tp}var Rp,dw;function GD(){if(dw)return Rp;dw=1;function e(t,n){for(var r=-1,s=t==null?0:t.length;++r<s;)if(n(t[r],r,t))return!0;return!1}return Rp=e,Rp}var Ap,fw;function t4(){if(fw)return Ap;fw=1;function e(t,n){return t.has(n)}return Ap=e,Ap}var Ip,pw;function n4(){if(pw)return Ip;pw=1;var e=e4(),t=GD(),n=t4(),r=1,s=2;function i(a,l,c,d,u,f){var p=c&r,h=a.length,v=l.length;if(h!=v&&!(p&&v>h))return!1;var g=f.get(a),_=f.get(l);if(g&&_)return g==l&&_==a;var x=-1,y=!0,b=c&s?new e:void 0;for(f.set(a,l),f.set(l,a);++x<h;){var j=a[x],N=l[x];if(d)var E=p?d(N,j,x,l,a,f):d(j,N,x,a,l,f);if(E!==void 0){if(E)continue;y=!1;break}if(b){if(!t(l,function(S,k){if(!n(b,k)&&(j===S||u(j,S,c,d,f)))return b.push(k)})){y=!1;break}}else if(!(j===N||u(j,N,c,d,f))){y=!1;break}}return f.delete(a),f.delete(l),y}return Ip=i,Ip}var Pp,hw;function KD(){if(hw)return Pp;hw=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(s,i){r[++n]=[i,s]}),r}return Pp=e,Pp}var Mp,mw;function Ny(){if(mw)return Mp;mw=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(s){r[++n]=s}),r}return Mp=e,Mp}var Op,gw;function YD(){if(gw)return Op;gw=1;var e=Mi(),t=UE(),n=Pi(),r=n4(),s=KD(),i=Ny(),a=1,l=2,c="[object Boolean]",d="[object Date]",u="[object Error]",f="[object Map]",p="[object Number]",h="[object RegExp]",v="[object Set]",g="[object String]",_="[object Symbol]",x="[object ArrayBuffer]",y="[object DataView]",b=e?e.prototype:void 0,j=b?b.valueOf:void 0;function N(E,S,k,w,R,T,I){switch(k){case y:if(E.byteLength!=S.byteLength||E.byteOffset!=S.byteOffset)return!1;E=E.buffer,S=S.buffer;case x:return!(E.byteLength!=S.byteLength||!T(new t(E),new t(S)));case c:case d:case p:return n(+E,+S);case u:return E.name==S.name&&E.message==S.message;case h:case g:return E==S+"";case f:var D=s;case v:var C=w&a;if(D||(D=i),E.size!=S.size&&!C)return!1;var M=I.get(E);if(M)return M==S;w|=l,I.set(E,S);var P=r(D(E),D(S),w,R,T,I);return I.delete(E),P;case _:if(j)return j.call(E)==j.call(S)}return!1}return Op=N,Op}var Dp,xw;function XD(){if(xw)return Dp;xw=1;var e=HE(),t=1,n=Object.prototype,r=n.hasOwnProperty;function s(i,a,l,c,d,u){var f=l&t,p=e(i),h=p.length,v=e(a),g=v.length;if(h!=g&&!f)return!1;for(var _=h;_--;){var x=p[_];if(!(f?x in a:r.call(a,x)))return!1}var y=u.get(i),b=u.get(a);if(y&&b)return y==a&&b==i;var j=!0;u.set(i,a),u.set(a,i);for(var N=f;++_<h;){x=p[_];var E=i[x],S=a[x];if(c)var k=f?c(S,E,x,a,i,u):c(E,S,x,i,a,u);if(!(k===void 0?E===S||d(E,S,l,c,u):k)){j=!1;break}N||(N=x=="constructor")}if(j&&!N){var w=i.constructor,R=a.constructor;w!=R&&"constructor"in i&&"constructor"in a&&!(typeof w=="function"&&w instanceof w&&typeof R=="function"&&R instanceof R)&&(j=!1)}return u.delete(i),u.delete(a),j}return Dp=s,Dp}var Lp,vw;function QD(){if(vw)return Lp;vw=1;var e=uu(),t=n4(),n=YD(),r=XD(),s=Di(),i=ft(),a=Oi(),l=Na(),c=1,d="[object Arguments]",u="[object Array]",f="[object Object]",p=Object.prototype,h=p.hasOwnProperty;function v(g,_,x,y,b,j){var N=i(g),E=i(_),S=N?u:s(g),k=E?u:s(_);S=S==d?f:S,k=k==d?f:k;var w=S==f,R=k==f,T=S==k;if(T&&a(g)){if(!a(_))return!1;N=!0,w=!1}if(T&&!w)return j||(j=new e),N||l(g)?t(g,_,x,y,b,j):n(g,_,S,x,y,b,j);if(!(x&c)){var I=w&&h.call(g,"__wrapped__"),D=R&&h.call(_,"__wrapped__");if(I||D){var C=I?g.value():g,M=D?_.value():_;return j||(j=new e),b(C,M,x,y,j)}}return T?(j||(j=new e),r(g,_,x,y,b,j)):!1}return Lp=v,Lp}var zp,yw;function r4(){if(yw)return zp;yw=1;var e=QD(),t=Xn();function n(r,s,i,a,l){return r===s?!0:r==null||s==null||!t(r)&&!t(s)?r!==r&&s!==s:e(r,s,i,a,n,l)}return zp=n,zp}var Fp,bw;function ZD(){if(bw)return Fp;bw=1;var e=uu(),t=r4(),n=1,r=2;function s(i,a,l,c){var d=l.length,u=d,f=!c;if(i==null)return!u;for(i=Object(i);d--;){var p=l[d];if(f&&p[2]?p[1]!==i[p[0]]:!(p[0]in i))return!1}for(;++d<u;){p=l[d];var h=p[0],v=i[h],g=p[1];if(f&&p[2]){if(v===void 0&&!(h in i))return!1}else{var _=new e;if(c)var x=c(v,g,h,i,a,_);if(!(x===void 0?t(g,v,n|r,c,_):x))return!1}}return!0}return Fp=s,Fp}var $p,_w;function s4(){if(_w)return $p;_w=1;var e=bn();function t(n){return n===n&&!e(n)}return $p=t,$p}var qp,ww;function JD(){if(ww)return qp;ww=1;var e=s4(),t=ts();function n(r){for(var s=t(r),i=s.length;i--;){var a=s[i],l=r[a];s[i]=[a,l,e(l)]}return s}return qp=n,qp}var Bp,jw;function i4(){if(jw)return Bp;jw=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return Bp=e,Bp}var Wp,Sw;function eL(){if(Sw)return Wp;Sw=1;var e=ZD(),t=JD(),n=i4();function r(s){var i=t(s);return i.length==1&&i[0][2]?n(i[0][0],i[0][1]):function(a){return a===s||e(a,s,i)}}return Wp=r,Wp}var Hp,kw;function Li(){if(kw)return Hp;kw=1;var e=Ts(),t=Xn(),n="[object Symbol]";function r(s){return typeof s=="symbol"||t(s)&&e(s)==n}return Hp=r,Hp}var Vp,Nw;function Cy(){if(Nw)return Vp;Nw=1;var e=ft(),t=Li(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function s(i,a){if(e(i))return!1;var l=typeof i;return l=="number"||l=="symbol"||l=="boolean"||i==null||t(i)?!0:r.test(i)||!n.test(i)||a!=null&&i in Object(a)}return Vp=s,Vp}var Up,Cw;function tL(){if(Cw)return Up;Cw=1;var e=my(),t="Expected a function";function n(r,s){if(typeof r!="function"||s!=null&&typeof s!="function")throw new TypeError(t);var i=function(){var a=arguments,l=s?s.apply(this,a):a[0],c=i.cache;if(c.has(l))return c.get(l);var d=r.apply(this,a);return i.cache=c.set(l,d)||c,d};return i.cache=new(n.Cache||e),i}return n.Cache=e,Up=n,Up}var Gp,Ew;function nL(){if(Ew)return Gp;Ew=1;var e=tL(),t=500;function n(r){var s=e(r,function(a){return i.size===t&&i.clear(),a}),i=s.cache;return s}return Gp=n,Gp}var Kp,Tw;function rL(){if(Tw)return Kp;Tw=1;var e=nL(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(s){var i=[];return s.charCodeAt(0)===46&&i.push(""),s.replace(t,function(a,l,c,d){i.push(c?d.replace(n,"$1"):l||a)}),i});return Kp=r,Kp}var Yp,Rw;function vu(){if(Rw)return Yp;Rw=1;function e(t,n){for(var r=-1,s=t==null?0:t.length,i=Array(s);++r<s;)i[r]=n(t[r],r,t);return i}return Yp=e,Yp}var Xp,Aw;function sL(){if(Aw)return Xp;Aw=1;var e=Mi(),t=vu(),n=ft(),r=Li(),s=e?e.prototype:void 0,i=s?s.toString:void 0;function a(l){if(typeof l=="string")return l;if(n(l))return t(l,a)+"";if(r(l))return i?i.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return Xp=a,Xp}var Qp,Iw;function o4(){if(Iw)return Qp;Iw=1;var e=sL();function t(n){return n==null?"":e(n)}return Qp=t,Qp}var Zp,Pw;function yu(){if(Pw)return Zp;Pw=1;var e=ft(),t=Cy(),n=rL(),r=o4();function s(i,a){return e(i)?i:t(i,a)?[i]:n(r(i))}return Zp=s,Zp}var Jp,Mw;function Ca(){if(Mw)return Jp;Mw=1;var e=Li();function t(n){if(typeof n=="string"||e(n))return n;var r=n+"";return r=="0"&&1/n==-1/0?"-0":r}return Jp=t,Jp}var eh,Ow;function bu(){if(Ow)return eh;Ow=1;var e=yu(),t=Ca();function n(r,s){s=e(s,r);for(var i=0,a=s.length;r!=null&&i<a;)r=r[t(s[i++])];return i&&i==a?r:void 0}return eh=n,eh}var th,Dw;function iL(){if(Dw)return th;Dw=1;var e=bu();function t(n,r,s){var i=n==null?void 0:e(n,r);return i===void 0?s:i}return th=t,th}var nh,Lw;function oL(){if(Lw)return nh;Lw=1;function e(t,n){return t!=null&&n in Object(t)}return nh=e,nh}var rh,zw;function a4(){if(zw)return rh;zw=1;var e=yu(),t=ka(),n=ft(),r=pu(),s=xy(),i=Ca();function a(l,c,d){c=e(c,l);for(var u=-1,f=c.length,p=!1;++u<f;){var h=i(c[u]);if(!(p=l!=null&&d(l,h)))break;l=l[h]}return p||++u!=f?p:(f=l==null?0:l.length,!!f&&s(f)&&r(h,f)&&(n(l)||t(l)))}return rh=a,rh}var sh,Fw;function l4(){if(Fw)return sh;Fw=1;var e=oL(),t=a4();function n(r,s){return r!=null&&t(r,s,e)}return sh=n,sh}var ih,$w;function aL(){if($w)return ih;$w=1;var e=r4(),t=iL(),n=l4(),r=Cy(),s=s4(),i=i4(),a=Ca(),l=1,c=2;function d(u,f){return r(u)&&s(f)?i(a(u),f):function(p){var h=t(p,u);return h===void 0&&h===f?n(p,u):e(f,h,l|c)}}return ih=d,ih}var oh,qw;function c4(){if(qw)return oh;qw=1;function e(t){return function(n){return n==null?void 0:n[t]}}return oh=e,oh}var ah,Bw;function lL(){if(Bw)return ah;Bw=1;var e=bu();function t(n){return function(r){return e(r,n)}}return ah=t,ah}var lh,Ww;function cL(){if(Ww)return lh;Ww=1;var e=c4(),t=lL(),n=Cy(),r=Ca();function s(i){return n(i)?e(r(i)):t(i)}return lh=s,lh}var ch,Hw;function br(){if(Hw)return ch;Hw=1;var e=eL(),t=aL(),n=Is(),r=ft(),s=cL();function i(a){return typeof a=="function"?a:a==null?n:typeof a=="object"?r(a)?t(a[0],a[1]):e(a):s(a)}return ch=i,ch}var uh,Vw;function u4(){if(Vw)return uh;Vw=1;var e=$E(),t=HD(),n=br(),r=ft();function s(i,a){var l=r(i)?e:t;return l(i,n(a,3))}return uh=s,uh}var dh,Uw;function uL(){if(Uw)return dh;Uw=1;var e=Object.prototype,t=e.hasOwnProperty;function n(r,s){return r!=null&&t.call(r,s)}return dh=n,dh}var fh,Gw;function d4(){if(Gw)return fh;Gw=1;var e=uL(),t=a4();function n(r,s){return r!=null&&t(r,s,e)}return fh=n,fh}var ph,Kw;function dL(){if(Kw)return ph;Kw=1;var e=yy(),t=Di(),n=ka(),r=ft(),s=yr(),i=Oi(),a=mu(),l=Na(),c="[object Map]",d="[object Set]",u=Object.prototype,f=u.hasOwnProperty;function p(h){if(h==null)return!0;if(s(h)&&(r(h)||typeof h=="string"||typeof h.splice=="function"||i(h)||l(h)||n(h)))return!h.length;var v=t(h);if(v==c||v==d)return!h.size;if(a(h))return!e(h).length;for(var g in h)if(f.call(h,g))return!1;return!0}return ph=p,ph}var hh,Yw;function f4(){if(Yw)return hh;Yw=1;function e(t){return t===void 0}return hh=e,hh}var mh,Xw;function p4(){if(Xw)return mh;Xw=1;var e=xu(),t=yr();function n(r,s){var i=-1,a=t(r)?Array(r.length):[];return e(r,function(l,c,d){a[++i]=s(l,c,d)}),a}return mh=n,mh}var gh,Qw;function h4(){if(Qw)return gh;Qw=1;var e=vu(),t=br(),n=p4(),r=ft();function s(i,a){var l=r(i)?e:n;return l(i,t(a,3))}return gh=s,gh}var xh,Zw;function fL(){if(Zw)return xh;Zw=1;function e(t,n,r,s){var i=-1,a=t==null?0:t.length;for(s&&a&&(r=t[++i]);++i<a;)r=n(r,t[i],i,t);return r}return xh=e,xh}var vh,Jw;function pL(){if(Jw)return vh;Jw=1;function e(t,n,r,s,i){return i(t,function(a,l,c){r=s?(s=!1,a):n(r,a,l,c)}),r}return vh=e,vh}var yh,ej;function m4(){if(ej)return yh;ej=1;var e=fL(),t=xu(),n=br(),r=pL(),s=ft();function i(a,l,c){var d=s(a)?e:r,u=arguments.length<3;return d(a,n(l,4),c,u,t)}return yh=i,yh}var bh,tj;function hL(){if(tj)return bh;tj=1;var e=Ts(),t=ft(),n=Xn(),r="[object String]";function s(i){return typeof i=="string"||!t(i)&&n(i)&&e(i)==r}return bh=s,bh}var _h,nj;function mL(){if(nj)return _h;nj=1;var e=c4(),t=e("length");return _h=t,_h}var wh,rj;function gL(){if(rj)return wh;rj=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",s=t+n+r,i="\\ufe0e\\ufe0f",a="\\u200d",l=RegExp("["+a+e+s+i+"]");function c(d){return l.test(d)}return wh=c,wh}var jh,sj;function xL(){if(sj)return jh;sj=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",s=t+n+r,i="\\ufe0e\\ufe0f",a="["+e+"]",l="["+s+"]",c="\\ud83c[\\udffb-\\udfff]",d="(?:"+l+"|"+c+")",u="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",p="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",v=d+"?",g="["+i+"]?",_="(?:"+h+"(?:"+[u,f,p].join("|")+")"+g+v+")*",x=g+v+_,y="(?:"+[u+l+"?",l,f,p,a].join("|")+")",b=RegExp(c+"(?="+c+")|"+y+x,"g");function j(N){for(var E=b.lastIndex=0;b.test(N);)++E;return E}return jh=j,jh}var Sh,ij;function vL(){if(ij)return Sh;ij=1;var e=mL(),t=gL(),n=xL();function r(s){return t(s)?n(s):e(s)}return Sh=r,Sh}var kh,oj;function yL(){if(oj)return kh;oj=1;var e=yy(),t=Di(),n=yr(),r=hL(),s=vL(),i="[object Map]",a="[object Set]";function l(c){if(c==null)return 0;if(n(c))return r(c)?s(c):c.length;var d=t(c);return d==i||d==a?c.size:e(c).length}return kh=l,kh}var Nh,aj;function bL(){if(aj)return Nh;aj=1;var e=gy(),t=KE(),n=ky(),r=br(),s=gu(),i=ft(),a=Oi(),l=ja(),c=bn(),d=Na();function u(f,p,h){var v=i(f),g=v||a(f)||d(f);if(p=r(p,4),h==null){var _=f&&f.constructor;g?h=v?new _:[]:c(f)?h=l(_)?t(s(f)):{}:h={}}return(g?e:n)(f,function(x,y,b){return p(h,x,y,b)}),h}return Nh=u,Nh}var Ch,lj;function _L(){if(lj)return Ch;lj=1;var e=Mi(),t=ka(),n=ft(),r=e?e.isConcatSpreadable:void 0;function s(i){return n(i)||t(i)||!!(r&&i&&i[r])}return Ch=s,Ch}var Eh,cj;function Ey(){if(cj)return Eh;cj=1;var e=_y(),t=_L();function n(r,s,i,a,l){var c=-1,d=r.length;for(i||(i=t),l||(l=[]);++c<d;){var u=r[c];s>0&&i(u)?s>1?n(u,s-1,i,a,l):e(l,u):a||(l[l.length]=u)}return l}return Eh=n,Eh}var Th,uj;function wL(){if(uj)return Th;uj=1;function e(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}return Th=e,Th}var Rh,dj;function g4(){if(dj)return Rh;dj=1;var e=wL(),t=Math.max;function n(r,s,i){return s=t(s===void 0?r.length-1:s,0),function(){for(var a=arguments,l=-1,c=t(a.length-s,0),d=Array(c);++l<c;)d[l]=a[s+l];l=-1;for(var u=Array(s+1);++l<s;)u[l]=a[l];return u[s]=i(d),e(r,this,u)}}return Rh=n,Rh}var Ah,fj;function jL(){if(fj)return Ah;fj=1;var e=jy(),t=OE(),n=Is(),r=t?function(s,i){return t(s,"toString",{configurable:!0,enumerable:!1,value:e(i),writable:!0})}:n;return Ah=r,Ah}var Ih,pj;function SL(){if(pj)return Ih;pj=1;var e=800,t=16,n=Date.now;function r(s){var i=0,a=0;return function(){var l=n(),c=t-(l-a);if(a=l,c>0){if(++i>=e)return arguments[0]}else i=0;return s.apply(void 0,arguments)}}return Ih=r,Ih}var Ph,hj;function x4(){if(hj)return Ph;hj=1;var e=jL(),t=SL(),n=t(e);return Ph=n,Ph}var Mh,mj;function _u(){if(mj)return Mh;mj=1;var e=Is(),t=g4(),n=x4();function r(s,i){return n(t(s,i,e),s+"")}return Mh=r,Mh}var Oh,gj;function v4(){if(gj)return Oh;gj=1;function e(t,n,r,s){for(var i=t.length,a=r+(s?1:-1);s?a--:++a<i;)if(n(t[a],a,t))return a;return-1}return Oh=e,Oh}var Dh,xj;function kL(){if(xj)return Dh;xj=1;function e(t){return t!==t}return Dh=e,Dh}var Lh,vj;function NL(){if(vj)return Lh;vj=1;function e(t,n,r){for(var s=r-1,i=t.length;++s<i;)if(t[s]===n)return s;return-1}return Lh=e,Lh}var zh,yj;function CL(){if(yj)return zh;yj=1;var e=v4(),t=kL(),n=NL();function r(s,i,a){return i===i?n(s,i,a):e(s,t,a)}return zh=r,zh}var Fh,bj;function EL(){if(bj)return Fh;bj=1;var e=CL();function t(n,r){var s=n==null?0:n.length;return!!s&&e(n,r,0)>-1}return Fh=t,Fh}var $h,_j;function TL(){if(_j)return $h;_j=1;function e(t,n,r){for(var s=-1,i=t==null?0:t.length;++s<i;)if(r(n,t[s]))return!0;return!1}return $h=e,$h}var qh,wj;function RL(){if(wj)return qh;wj=1;function e(){}return qh=e,qh}var Bh,jj;function AL(){if(jj)return Bh;jj=1;var e=VE(),t=RL(),n=Ny(),r=1/0,s=e&&1/n(new e([,-0]))[1]==r?function(i){return new e(i)}:t;return Bh=s,Bh}var Wh,Sj;function IL(){if(Sj)return Wh;Sj=1;var e=e4(),t=EL(),n=TL(),r=t4(),s=AL(),i=Ny(),a=200;function l(c,d,u){var f=-1,p=t,h=c.length,v=!0,g=[],_=g;if(u)v=!1,p=n;else if(h>=a){var x=d?null:s(c);if(x)return i(x);v=!1,p=r,_=new e}else _=d?[]:g;e:for(;++f<h;){var y=c[f],b=d?d(y):y;if(y=u||y!==0?y:0,v&&b===b){for(var j=_.length;j--;)if(_[j]===b)continue e;d&&_.push(b),g.push(y)}else p(_,b,u)||(_!==g&&_.push(b),g.push(y))}return g}return Wh=l,Wh}var Hh,kj;function y4(){if(kj)return Hh;kj=1;var e=yr(),t=Xn();function n(r){return t(r)&&e(r)}return Hh=n,Hh}var Vh,Nj;function PL(){if(Nj)return Vh;Nj=1;var e=Ey(),t=_u(),n=IL(),r=y4(),s=t(function(i){return n(e(i,1,r,!0))});return Vh=s,Vh}var Uh,Cj;function ML(){if(Cj)return Uh;Cj=1;var e=vu();function t(n,r){return e(r,function(s){return n[s]})}return Uh=t,Uh}var Gh,Ej;function b4(){if(Ej)return Gh;Ej=1;var e=ML(),t=ts();function n(r){return r==null?[]:e(r,t(r))}return Gh=n,Gh}var Kh,Tj;function _n(){if(Tj)return Kh;Tj=1;var e;if(typeof py=="function")try{e={clone:qD(),constant:jy(),each:JE(),filter:u4(),has:d4(),isArray:ft(),isEmpty:dL(),isFunction:ja(),isUndefined:f4(),keys:ts(),map:h4(),reduce:m4(),size:yL(),transform:bL(),union:PL(),values:b4()}}catch{}return e||(e=window._),Kh=e,Kh}var Yh,Rj;function Ty(){if(Rj)return Yh;Rj=1;var e=_n();Yh=s;var t="\0",n="\0",r="";function s(u){this._isDirected=e.has(u,"directed")?u.directed:!0,this._isMultigraph=e.has(u,"multigraph")?u.multigraph:!1,this._isCompound=e.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[n]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}s.prototype._nodeCount=0,s.prototype._edgeCount=0,s.prototype.isDirected=function(){return this._isDirected},s.prototype.isMultigraph=function(){return this._isMultigraph},s.prototype.isCompound=function(){return this._isCompound},s.prototype.setGraph=function(u){return this._label=u,this},s.prototype.graph=function(){return this._label},s.prototype.setDefaultNodeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultNodeLabelFn=u,this},s.prototype.nodeCount=function(){return this._nodeCount},s.prototype.nodes=function(){return e.keys(this._nodes)},s.prototype.sources=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._in[f])})},s.prototype.sinks=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._out[f])})},s.prototype.setNodes=function(u,f){var p=arguments,h=this;return e.each(u,function(v){p.length>1?h.setNode(v,f):h.setNode(v)}),this},s.prototype.setNode=function(u,f){return e.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=f),this):(this._nodes[u]=arguments.length>1?f:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=n,this._children[u]={},this._children[n][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},s.prototype.node=function(u){return this._nodes[u]},s.prototype.hasNode=function(u){return e.has(this._nodes,u)},s.prototype.removeNode=function(u){var f=this;if(e.has(this._nodes,u)){var p=function(h){f.removeEdge(f._edgeObjs[h])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],e.each(this.children(u),function(h){f.setParent(h)}),delete this._children[u]),e.each(e.keys(this._in[u]),p),delete this._in[u],delete this._preds[u],e.each(e.keys(this._out[u]),p),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},s.prototype.setParent=function(u,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=n;else{f+="";for(var p=f;!e.isUndefined(p);p=this.parent(p))if(p===u)throw new Error("Setting "+f+" as parent of "+u+" would create a cycle");this.setNode(f)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=f,this._children[f][u]=!0,this},s.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},s.prototype.parent=function(u){if(this._isCompound){var f=this._parent[u];if(f!==n)return f}},s.prototype.children=function(u){if(e.isUndefined(u)&&(u=n),this._isCompound){var f=this._children[u];if(f)return e.keys(f)}else{if(u===n)return this.nodes();if(this.hasNode(u))return[]}},s.prototype.predecessors=function(u){var f=this._preds[u];if(f)return e.keys(f)},s.prototype.successors=function(u){var f=this._sucs[u];if(f)return e.keys(f)},s.prototype.neighbors=function(u){var f=this.predecessors(u);if(f)return e.union(f,this.successors(u))},s.prototype.isLeaf=function(u){var f;return this.isDirected()?f=this.successors(u):f=this.neighbors(u),f.length===0},s.prototype.filterNodes=function(u){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var p=this;e.each(this._nodes,function(g,_){u(_)&&f.setNode(_,g)}),e.each(this._edgeObjs,function(g){f.hasNode(g.v)&&f.hasNode(g.w)&&f.setEdge(g,p.edge(g))});var h={};function v(g){var _=p.parent(g);return _===void 0||f.hasNode(_)?(h[g]=_,_):_ in h?h[_]:v(_)}return this._isCompound&&e.each(f.nodes(),function(g){f.setParent(g,v(g))}),f},s.prototype.setDefaultEdgeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultEdgeLabelFn=u,this},s.prototype.edgeCount=function(){return this._edgeCount},s.prototype.edges=function(){return e.values(this._edgeObjs)},s.prototype.setPath=function(u,f){var p=this,h=arguments;return e.reduce(u,function(v,g){return h.length>1?p.setEdge(v,g,f):p.setEdge(v,g),g}),this},s.prototype.setEdge=function(){var u,f,p,h,v=!1,g=arguments[0];typeof g=="object"&&g!==null&&"v"in g?(u=g.v,f=g.w,p=g.name,arguments.length===2&&(h=arguments[1],v=!0)):(u=g,f=arguments[1],p=arguments[3],arguments.length>2&&(h=arguments[2],v=!0)),u=""+u,f=""+f,e.isUndefined(p)||(p=""+p);var _=l(this._isDirected,u,f,p);if(e.has(this._edgeLabels,_))return v&&(this._edgeLabels[_]=h),this;if(!e.isUndefined(p)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(f),this._edgeLabels[_]=v?h:this._defaultEdgeLabelFn(u,f,p);var x=c(this._isDirected,u,f,p);return u=x.v,f=x.w,Object.freeze(x),this._edgeObjs[_]=x,i(this._preds[f],u),i(this._sucs[u],f),this._in[f][_]=x,this._out[u][_]=x,this._edgeCount++,this},s.prototype.edge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return this._edgeLabels[h]},s.prototype.hasEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p);return e.has(this._edgeLabels,h)},s.prototype.removeEdge=function(u,f,p){var h=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,u,f,p),v=this._edgeObjs[h];return v&&(u=v.v,f=v.w,delete this._edgeLabels[h],delete this._edgeObjs[h],a(this._preds[f],u),a(this._sucs[u],f),delete this._in[f][h],delete this._out[u][h],this._edgeCount--),this},s.prototype.inEdges=function(u,f){var p=this._in[u];if(p){var h=e.values(p);return f?e.filter(h,function(v){return v.v===f}):h}},s.prototype.outEdges=function(u,f){var p=this._out[u];if(p){var h=e.values(p);return f?e.filter(h,function(v){return v.w===f}):h}},s.prototype.nodeEdges=function(u,f){var p=this.inEdges(u,f);if(p)return p.concat(this.outEdges(u,f))};function i(u,f){u[f]?u[f]++:u[f]=1}function a(u,f){--u[f]||delete u[f]}function l(u,f,p,h){var v=""+f,g=""+p;if(!u&&v>g){var _=v;v=g,g=_}return v+r+g+r+(e.isUndefined(h)?t:h)}function c(u,f,p,h){var v=""+f,g=""+p;if(!u&&v>g){var _=v;v=g,g=_}var x={v,w:g};return h&&(x.name=h),x}function d(u,f){return l(u,f.v,f.w,f.name)}return Yh}var Xh,Aj;function OL(){return Aj||(Aj=1,Xh="2.1.8"),Xh}var Qh,Ij;function DL(){return Ij||(Ij=1,Qh={Graph:Ty(),version:OL()}),Qh}var Zh,Pj;function LL(){if(Pj)return Zh;Pj=1;var e=_n(),t=Ty();Zh={write:n,read:i};function n(a){var l={options:{directed:a.isDirected(),multigraph:a.isMultigraph(),compound:a.isCompound()},nodes:r(a),edges:s(a)};return e.isUndefined(a.graph())||(l.value=e.clone(a.graph())),l}function r(a){return e.map(a.nodes(),function(l){var c=a.node(l),d=a.parent(l),u={v:l};return e.isUndefined(c)||(u.value=c),e.isUndefined(d)||(u.parent=d),u})}function s(a){return e.map(a.edges(),function(l){var c=a.edge(l),d={v:l.v,w:l.w};return e.isUndefined(l.name)||(d.name=l.name),e.isUndefined(c)||(d.value=c),d})}function i(a){var l=new t(a.options).setGraph(a.value);return e.each(a.nodes,function(c){l.setNode(c.v,c.value),c.parent&&l.setParent(c.v,c.parent)}),e.each(a.edges,function(c){l.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),l}return Zh}var Jh,Mj;function zL(){if(Mj)return Jh;Mj=1;var e=_n();Jh=t;function t(n){var r={},s=[],i;function a(l){e.has(r,l)||(r[l]=!0,i.push(l),e.each(n.successors(l),a),e.each(n.predecessors(l),a))}return e.each(n.nodes(),function(l){i=[],a(l),i.length&&s.push(i)}),s}return Jh}var em,Oj;function _4(){if(Oj)return em;Oj=1;var e=_n();em=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(n){return n.key})},t.prototype.has=function(n){return e.has(this._keyIndices,n)},t.prototype.priority=function(n){var r=this._keyIndices[n];if(r!==void 0)return this._arr[r].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(n,r){var s=this._keyIndices;if(n=String(n),!e.has(s,n)){var i=this._arr,a=i.length;return s[n]=a,i.push({key:n,priority:r}),this._decrease(a),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var n=this._arr.pop();return delete this._keyIndices[n.key],this._heapify(0),n.key},t.prototype.decrease=function(n,r){var s=this._keyIndices[n];if(r>this._arr[s].priority)throw new Error("New priority is greater than current priority. Key: "+n+" Old: "+this._arr[s].priority+" New: "+r);this._arr[s].priority=r,this._decrease(s)},t.prototype._heapify=function(n){var r=this._arr,s=2*n,i=s+1,a=n;s<r.length&&(a=r[s].priority<r[a].priority?s:a,i<r.length&&(a=r[i].priority<r[a].priority?i:a),a!==n&&(this._swap(n,a),this._heapify(a)))},t.prototype._decrease=function(n){for(var r=this._arr,s=r[n].priority,i;n!==0&&(i=n>>1,!(r[i].priority<s));)this._swap(n,i),n=i},t.prototype._swap=function(n,r){var s=this._arr,i=this._keyIndices,a=s[n],l=s[r];s[n]=l,s[r]=a,i[l.key]=n,i[a.key]=r},em}var tm,Dj;function w4(){if(Dj)return tm;Dj=1;var e=_n(),t=_4();tm=r;var n=e.constant(1);function r(i,a,l,c){return s(i,String(a),l||n,c||function(d){return i.outEdges(d)})}function s(i,a,l,c){var d={},u=new t,f,p,h=function(v){var g=v.v!==f?v.v:v.w,_=d[g],x=l(v),y=p.distance+x;if(x<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+v+" Weight: "+x);y<_.distance&&(_.distance=y,_.predecessor=f,u.decrease(g,y))};for(i.nodes().forEach(function(v){var g=v===a?0:Number.POSITIVE_INFINITY;d[v]={distance:g},u.add(v,g)});u.size()>0&&(f=u.removeMin(),p=d[f],p.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(h);return d}return tm}var nm,Lj;function FL(){if(Lj)return nm;Lj=1;var e=w4(),t=_n();nm=n;function n(r,s,i){return t.transform(r.nodes(),function(a,l){a[l]=e(r,l,s,i)},{})}return nm}var rm,zj;function j4(){if(zj)return rm;zj=1;var e=_n();rm=t;function t(n){var r=0,s=[],i={},a=[];function l(c){var d=i[c]={onStack:!0,lowlink:r,index:r++};if(s.push(c),n.successors(c).forEach(function(p){e.has(i,p)?i[p].onStack&&(d.lowlink=Math.min(d.lowlink,i[p].index)):(l(p),d.lowlink=Math.min(d.lowlink,i[p].lowlink))}),d.lowlink===d.index){var u=[],f;do f=s.pop(),i[f].onStack=!1,u.push(f);while(c!==f);a.push(u)}}return n.nodes().forEach(function(c){e.has(i,c)||l(c)}),a}return rm}var sm,Fj;function $L(){if(Fj)return sm;Fj=1;var e=_n(),t=j4();sm=n;function n(r){return e.filter(t(r),function(s){return s.length>1||s.length===1&&r.hasEdge(s[0],s[0])})}return sm}var im,$j;function qL(){if($j)return im;$j=1;var e=_n();im=n;var t=e.constant(1);function n(s,i,a){return r(s,i||t,a||function(l){return s.outEdges(l)})}function r(s,i,a){var l={},c=s.nodes();return c.forEach(function(d){l[d]={},l[d][d]={distance:0},c.forEach(function(u){d!==u&&(l[d][u]={distance:Number.POSITIVE_INFINITY})}),a(d).forEach(function(u){var f=u.v===d?u.w:u.v,p=i(u);l[d][f]={distance:p,predecessor:d}})}),c.forEach(function(d){var u=l[d];c.forEach(function(f){var p=l[f];c.forEach(function(h){var v=p[d],g=u[h],_=p[h],x=v.distance+g.distance;x<_.distance&&(_.distance=x,_.predecessor=g.predecessor)})})}),l}return im}var om,qj;function S4(){if(qj)return om;qj=1;var e=_n();om=t,t.CycleException=n;function t(r){var s={},i={},a=[];function l(c){if(e.has(i,c))throw new n;e.has(s,c)||(i[c]=!0,s[c]=!0,e.each(r.predecessors(c),l),delete i[c],a.push(c))}if(e.each(r.sinks(),l),e.size(s)!==r.nodeCount())throw new n;return a}function n(){}return n.prototype=new Error,om}var am,Bj;function BL(){if(Bj)return am;Bj=1;var e=S4();am=t;function t(n){try{e(n)}catch(r){if(r instanceof e.CycleException)return!1;throw r}return!0}return am}var lm,Wj;function k4(){if(Wj)return lm;Wj=1;var e=_n();lm=t;function t(r,s,i){e.isArray(s)||(s=[s]);var a=(r.isDirected()?r.successors:r.neighbors).bind(r),l=[],c={};return e.each(s,function(d){if(!r.hasNode(d))throw new Error("Graph does not have node: "+d);n(r,d,i==="post",c,a,l)}),l}function n(r,s,i,a,l,c){e.has(a,s)||(a[s]=!0,i||c.push(s),e.each(l(s),function(d){n(r,d,i,a,l,c)}),i&&c.push(s))}return lm}var cm,Hj;function WL(){if(Hj)return cm;Hj=1;var e=k4();cm=t;function t(n,r){return e(n,r,"post")}return cm}var um,Vj;function HL(){if(Vj)return um;Vj=1;var e=k4();um=t;function t(n,r){return e(n,r,"pre")}return um}var dm,Uj;function VL(){if(Uj)return dm;Uj=1;var e=_n(),t=Ty(),n=_4();dm=r;function r(s,i){var a=new t,l={},c=new n,d;function u(p){var h=p.v===d?p.w:p.v,v=c.priority(h);if(v!==void 0){var g=i(p);g<v&&(l[h]=d,c.decrease(h,g))}}if(s.nodeCount()===0)return a;e.each(s.nodes(),function(p){c.add(p,Number.POSITIVE_INFINITY),a.setNode(p)}),c.decrease(s.nodes()[0],0);for(var f=!1;c.size()>0;){if(d=c.removeMin(),e.has(l,d))a.setEdge(d,l[d]);else{if(f)throw new Error("Input graph is not connected: "+s);f=!0}s.nodeEdges(d).forEach(u)}return a}return dm}var fm,Gj;function UL(){return Gj||(Gj=1,fm={components:zL(),dijkstra:w4(),dijkstraAll:FL(),findCycles:$L(),floydWarshall:qL(),isAcyclic:BL(),postorder:WL(),preorder:HL(),prim:VL(),tarjan:j4(),topsort:S4()}),fm}var pm,Kj;function GL(){if(Kj)return pm;Kj=1;var e=DL();return pm={Graph:e.Graph,json:LL(),alg:UL(),version:e.version},pm}var gc;if(typeof py=="function")try{gc=GL()}catch{}gc||(gc=window.graphlib);var Dn=gc,hm,Yj;function KL(){if(Yj)return hm;Yj=1;var e=XE(),t=1,n=4;function r(s){return e(s,t|n)}return hm=r,hm}var mm,Xj;function wu(){if(Xj)return mm;Xj=1;var e=Pi(),t=yr(),n=pu(),r=bn();function s(i,a,l){if(!r(l))return!1;var c=typeof a;return(c=="number"?t(l)&&n(a,l.length):c=="string"&&a in l)?e(l[a],i):!1}return mm=s,mm}var gm,Qj;function YL(){if(Qj)return gm;Qj=1;var e=_u(),t=Pi(),n=wu(),r=As(),s=Object.prototype,i=s.hasOwnProperty,a=e(function(l,c){l=Object(l);var d=-1,u=c.length,f=u>2?c[2]:void 0;for(f&&n(c[0],c[1],f)&&(u=1);++d<u;)for(var p=c[d],h=r(p),v=-1,g=h.length;++v<g;){var _=h[v],x=l[_];(x===void 0||t(x,s[_])&&!i.call(l,_))&&(l[_]=p[_])}return l});return gm=a,gm}var xm,Zj;function XL(){if(Zj)return xm;Zj=1;var e=br(),t=yr(),n=ts();function r(s){return function(i,a,l){var c=Object(i);if(!t(i)){var d=e(a,3);i=n(i),a=function(f){return d(c[f],f,c)}}var u=s(i,a,l);return u>-1?c[d?i[u]:u]:void 0}}return xm=r,xm}var vm,Jj;function QL(){if(Jj)return vm;Jj=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return vm=t,vm}var ym,e2;function ZL(){if(e2)return ym;e2=1;var e=QL(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return ym=n,ym}var bm,t2;function JL(){if(t2)return bm;t2=1;var e=ZL(),t=bn(),n=Li(),r=NaN,s=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,a=/^0o[0-7]+$/i,l=parseInt;function c(d){if(typeof d=="number")return d;if(n(d))return r;if(t(d)){var u=typeof d.valueOf=="function"?d.valueOf():d;d=t(u)?u+"":u}if(typeof d!="string")return d===0?d:+d;d=e(d);var f=i.test(d);return f||a.test(d)?l(d.slice(2),f?2:8):s.test(d)?r:+d}return bm=c,bm}var _m,n2;function N4(){if(n2)return _m;n2=1;var e=JL(),t=1/0,n=17976931348623157e292;function r(s){if(!s)return s===0?s:0;if(s=e(s),s===t||s===-t){var i=s<0?-1:1;return i*n}return s===s?s:0}return _m=r,_m}var wm,r2;function ez(){if(r2)return wm;r2=1;var e=N4();function t(n){var r=e(n),s=r%1;return r===r?s?r-s:r:0}return wm=t,wm}var jm,s2;function tz(){if(s2)return jm;s2=1;var e=v4(),t=br(),n=ez(),r=Math.max;function s(i,a,l){var c=i==null?0:i.length;if(!c)return-1;var d=l==null?0:n(l);return d<0&&(d=r(c+d,0)),e(i,t(a,3),d)}return jm=s,jm}var Sm,i2;function nz(){if(i2)return Sm;i2=1;var e=XL(),t=tz(),n=e(t);return Sm=n,Sm}var km,o2;function C4(){if(o2)return km;o2=1;var e=Ey();function t(n){var r=n==null?0:n.length;return r?e(n,1):[]}return km=t,km}var Nm,a2;function rz(){if(a2)return Nm;a2=1;var e=Sy(),t=QE(),n=As();function r(s,i){return s==null?s:e(s,t(i),n)}return Nm=r,Nm}var Cm,l2;function sz(){if(l2)return Cm;l2=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return Cm=e,Cm}var Em,c2;function iz(){if(c2)return Em;c2=1;var e=du(),t=ky(),n=br();function r(s,i){var a={};return i=n(i,3),t(s,function(l,c,d){e(a,c,i(l,c,d))}),a}return Em=r,Em}var Tm,u2;function Ry(){if(u2)return Tm;u2=1;var e=Li();function t(n,r,s){for(var i=-1,a=n.length;++i<a;){var l=n[i],c=r(l);if(c!=null&&(d===void 0?c===c&&!e(c):s(c,d)))var d=c,u=l}return u}return Tm=t,Tm}var Rm,d2;function oz(){if(d2)return Rm;d2=1;function e(t,n){return t>n}return Rm=e,Rm}var Am,f2;function az(){if(f2)return Am;f2=1;var e=Ry(),t=oz(),n=Is();function r(s){return s&&s.length?e(s,n,t):void 0}return Am=r,Am}var Im,p2;function E4(){if(p2)return Im;p2=1;var e=du(),t=Pi();function n(r,s,i){(i!==void 0&&!t(r[s],i)||i===void 0&&!(s in r))&&e(r,s,i)}return Im=n,Im}var Pm,h2;function lz(){if(h2)return Pm;h2=1;var e=Ts(),t=gu(),n=Xn(),r="[object Object]",s=Function.prototype,i=Object.prototype,a=s.toString,l=i.hasOwnProperty,c=a.call(Object);function d(u){if(!n(u)||e(u)!=r)return!1;var f=t(u);if(f===null)return!0;var p=l.call(f,"constructor")&&f.constructor;return typeof p=="function"&&p instanceof p&&a.call(p)==c}return Pm=d,Pm}var Mm,m2;function T4(){if(m2)return Mm;m2=1;function e(t,n){if(!(n==="constructor"&&typeof t[n]=="function")&&n!="__proto__")return t[n]}return Mm=e,Mm}var Om,g2;function cz(){if(g2)return Om;g2=1;var e=Sa(),t=As();function n(r){return e(r,t(r))}return Om=n,Om}var Dm,x2;function uz(){if(x2)return Dm;x2=1;var e=E4(),t=zE(),n=GE(),r=FE(),s=YE(),i=ka(),a=ft(),l=y4(),c=Oi(),d=ja(),u=bn(),f=lz(),p=Na(),h=T4(),v=cz();function g(_,x,y,b,j,N,E){var S=h(_,y),k=h(x,y),w=E.get(k);if(w){e(_,y,w);return}var R=N?N(S,k,y+"",_,x,E):void 0,T=R===void 0;if(T){var I=a(k),D=!I&&c(k),C=!I&&!D&&p(k);R=k,I||D||C?a(S)?R=S:l(S)?R=r(S):D?(T=!1,R=t(k,!0)):C?(T=!1,R=n(k,!0)):R=[]:f(k)||i(k)?(R=S,i(S)?R=v(S):(!u(S)||d(S))&&(R=s(k))):T=!1}T&&(E.set(k,R),j(R,k,b,N,E),E.delete(k)),e(_,y,R)}return Dm=g,Dm}var Lm,v2;function dz(){if(v2)return Lm;v2=1;var e=uu(),t=E4(),n=Sy(),r=uz(),s=bn(),i=As(),a=T4();function l(c,d,u,f,p){c!==d&&n(d,function(h,v){if(p||(p=new e),s(h))r(c,d,v,u,l,f,p);else{var g=f?f(a(c,v),h,v+"",c,d,p):void 0;g===void 0&&(g=h),t(c,v,g)}},i)}return Lm=l,Lm}var zm,y2;function fz(){if(y2)return zm;y2=1;var e=_u(),t=wu();function n(r){return e(function(s,i){var a=-1,l=i.length,c=l>1?i[l-1]:void 0,d=l>2?i[2]:void 0;for(c=r.length>3&&typeof c=="function"?(l--,c):void 0,d&&t(i[0],i[1],d)&&(c=l<3?void 0:c,l=1),s=Object(s);++a<l;){var u=i[a];u&&r(s,u,a,c)}return s})}return zm=n,zm}var Fm,b2;function pz(){if(b2)return Fm;b2=1;var e=dz(),t=fz(),n=t(function(r,s,i){e(r,s,i)});return Fm=n,Fm}var $m,_2;function R4(){if(_2)return $m;_2=1;function e(t,n){return t<n}return $m=e,$m}var qm,w2;function hz(){if(w2)return qm;w2=1;var e=Ry(),t=R4(),n=Is();function r(s){return s&&s.length?e(s,n,t):void 0}return qm=r,qm}var Bm,j2;function mz(){if(j2)return Bm;j2=1;var e=Ry(),t=br(),n=R4();function r(s,i){return s&&s.length?e(s,t(i,2),n):void 0}return Bm=r,Bm}var Wm,S2;function gz(){if(S2)return Wm;S2=1;var e=On(),t=function(){return e.Date.now()};return Wm=t,Wm}var Hm,k2;function xz(){if(k2)return Hm;k2=1;var e=fu(),t=yu(),n=pu(),r=bn(),s=Ca();function i(a,l,c,d){if(!r(a))return a;l=t(l,a);for(var u=-1,f=l.length,p=f-1,h=a;h!=null&&++u<f;){var v=s(l[u]),g=c;if(v==="__proto__"||v==="constructor"||v==="prototype")return a;if(u!=p){var _=h[v];g=d?d(_,v,h):void 0,g===void 0&&(g=r(_)?_:n(l[u+1])?[]:{})}e(h,v,g),h=h[v]}return a}return Hm=i,Hm}var Vm,N2;function vz(){if(N2)return Vm;N2=1;var e=bu(),t=xz(),n=yu();function r(s,i,a){for(var l=-1,c=i.length,d={};++l<c;){var u=i[l],f=e(s,u);a(f,u)&&t(d,n(u,s),f)}return d}return Vm=r,Vm}var Um,C2;function yz(){if(C2)return Um;C2=1;var e=vz(),t=l4();function n(r,s){return e(r,s,function(i,a){return t(r,a)})}return Um=n,Um}var Gm,E2;function bz(){if(E2)return Gm;E2=1;var e=C4(),t=g4(),n=x4();function r(s){return n(t(s,void 0,e),s+"")}return Gm=r,Gm}var Km,T2;function _z(){if(T2)return Km;T2=1;var e=yz(),t=bz(),n=t(function(r,s){return r==null?{}:e(r,s)});return Km=n,Km}var Ym,R2;function wz(){if(R2)return Ym;R2=1;var e=Math.ceil,t=Math.max;function n(r,s,i,a){for(var l=-1,c=t(e((s-r)/(i||1)),0),d=Array(c);c--;)d[a?c:++l]=r,r+=i;return d}return Ym=n,Ym}var Xm,A2;function jz(){if(A2)return Xm;A2=1;var e=wz(),t=wu(),n=N4();function r(s){return function(i,a,l){return l&&typeof l!="number"&&t(i,a,l)&&(a=l=void 0),i=n(i),a===void 0?(a=i,i=0):a=n(a),l=l===void 0?i<a?1:-1:n(l),e(i,a,l,s)}}return Xm=r,Xm}var Qm,I2;function Sz(){if(I2)return Qm;I2=1;var e=jz(),t=e();return Qm=t,Qm}var Zm,P2;function kz(){if(P2)return Zm;P2=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return Zm=e,Zm}var Jm,M2;function Nz(){if(M2)return Jm;M2=1;var e=Li();function t(n,r){if(n!==r){var s=n!==void 0,i=n===null,a=n===n,l=e(n),c=r!==void 0,d=r===null,u=r===r,f=e(r);if(!d&&!f&&!l&&n>r||l&&c&&u&&!d&&!f||i&&c&&u||!s&&u||!a)return 1;if(!i&&!l&&!f&&n<r||f&&s&&a&&!i&&!l||d&&s&&a||!c&&a||!u)return-1}return 0}return Jm=t,Jm}var eg,O2;function Cz(){if(O2)return eg;O2=1;var e=Nz();function t(n,r,s){for(var i=-1,a=n.criteria,l=r.criteria,c=a.length,d=s.length;++i<c;){var u=e(a[i],l[i]);if(u){if(i>=d)return u;var f=s[i];return u*(f=="desc"?-1:1)}}return n.index-r.index}return eg=t,eg}var tg,D2;function Ez(){if(D2)return tg;D2=1;var e=vu(),t=bu(),n=br(),r=p4(),s=kz(),i=hu(),a=Cz(),l=Is(),c=ft();function d(u,f,p){f.length?f=e(f,function(g){return c(g)?function(_){return t(_,g.length===1?g[0]:g)}:g}):f=[l];var h=-1;f=e(f,i(n));var v=r(u,function(g,_,x){var y=e(f,function(b){return b(g)});return{criteria:y,index:++h,value:g}});return s(v,function(g,_){return a(g,_,p)})}return tg=d,tg}var ng,L2;function Tz(){if(L2)return ng;L2=1;var e=Ey(),t=Ez(),n=_u(),r=wu(),s=n(function(i,a){if(i==null)return[];var l=a.length;return l>1&&r(i,a[0],a[1])?a=[]:l>2&&r(a[0],a[1],a[2])&&(a=[a[0]]),t(i,e(a,1),[])});return ng=s,ng}var rg,z2;function Rz(){if(z2)return rg;z2=1;var e=o4(),t=0;function n(r){var s=++t;return e(r)+s}return rg=n,rg}var sg,F2;function Az(){if(F2)return sg;F2=1;function e(t,n,r){for(var s=-1,i=t.length,a=n.length,l={};++s<i;){var c=s<a?n[s]:void 0;r(l,t[s],c)}return l}return sg=e,sg}var ig,$2;function Iz(){if($2)return ig;$2=1;var e=fu(),t=Az();function n(r,s){return t(r||[],s||[],e)}return ig=n,ig}var xc;if(typeof py=="function")try{xc={cloneDeep:KL(),constant:jy(),defaults:YL(),each:JE(),filter:u4(),find:nz(),flatten:C4(),forEach:ZE(),forIn:rz(),has:d4(),isUndefined:f4(),last:sz(),map:h4(),mapValues:iz(),max:az(),merge:pz(),min:hz(),minBy:mz(),now:gz(),pick:_z(),range:Sz(),reduce:m4(),sortBy:Tz(),uniqueId:Rz(),values:b4(),zipObject:Iz()}}catch{}xc||(xc=window._);var et=xc,Pz=ju;function ju(){var e={};e._next=e._prev=e,this._sentinel=e}ju.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return A4(t),t};ju.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&A4(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};ju.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,Mz)),n=n._prev;return"["+e.join(", ")+"]"};function A4(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function Mz(e,t){if(e!=="_next"&&e!=="_prev")return t}var or=et,Oz=Dn.Graph,Dz=Pz,Lz=Fz,zz=or.constant(1);function Fz(e,t){if(e.nodeCount()<=1)return[];var n=qz(e,t||zz),r=$z(n.graph,n.buckets,n.zeroIdx);return or.flatten(or.map(r,function(s){return e.outEdges(s.v,s.w)}),!0)}function $z(e,t,n){for(var r=[],s=t[t.length-1],i=t[0],a;e.nodeCount();){for(;a=i.dequeue();)og(e,t,n,a);for(;a=s.dequeue();)og(e,t,n,a);if(e.nodeCount()){for(var l=t.length-2;l>0;--l)if(a=t[l].dequeue(),a){r=r.concat(og(e,t,n,a,!0));break}}}return r}function og(e,t,n,r,s){var i=s?[]:void 0;return or.forEach(e.inEdges(r.v),function(a){var l=e.edge(a),c=e.node(a.v);s&&i.push({v:a.v,w:a.w}),c.out-=l,Wx(t,n,c)}),or.forEach(e.outEdges(r.v),function(a){var l=e.edge(a),c=a.w,d=e.node(c);d.in-=l,Wx(t,n,d)}),e.removeNode(r.v),i}function qz(e,t){var n=new Oz,r=0,s=0;or.forEach(e.nodes(),function(l){n.setNode(l,{v:l,in:0,out:0})}),or.forEach(e.edges(),function(l){var c=n.edge(l.v,l.w)||0,d=t(l),u=c+d;n.setEdge(l.v,l.w,u),s=Math.max(s,n.node(l.v).out+=d),r=Math.max(r,n.node(l.w).in+=d)});var i=or.range(s+r+3).map(function(){return new Dz}),a=r+1;return or.forEach(n.nodes(),function(l){Wx(i,a,n.node(l))}),{graph:n,buckets:i,zeroIdx:a}}function Wx(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var hs=et,Bz=Lz,Wz={run:Hz,undo:Uz};function Hz(e){var t=e.graph().acyclicer==="greedy"?Bz(e,n(e)):Vz(e);hs.forEach(t,function(r){var s=e.edge(r);e.removeEdge(r),s.forwardName=r.name,s.reversed=!0,e.setEdge(r.w,r.v,s,hs.uniqueId("rev"))});function n(r){return function(s){return r.edge(s).weight}}}function Vz(e){var t=[],n={},r={};function s(i){hs.has(r,i)||(r[i]=!0,n[i]=!0,hs.forEach(e.outEdges(i),function(a){hs.has(n,a.w)?t.push(a):s(a.w)}),delete n[i])}return hs.forEach(e.nodes(),s),t}function Uz(e){hs.forEach(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}var qe=et,I4=Dn.Graph,Yt={addDummyNode:P4,simplify:Gz,asNonCompoundGraph:Kz,successorWeights:Yz,predecessorWeights:Xz,intersectRect:Qz,buildLayerMatrix:Zz,normalizeRanks:Jz,removeEmptyRanks:eF,addBorderNode:tF,maxRank:M4,partition:nF,time:rF,notime:sF};function P4(e,t,n,r){var s;do s=qe.uniqueId(r);while(e.hasNode(s));return n.dummy=t,e.setNode(s,n),s}function Gz(e){var t=new I4().setGraph(e.graph());return qe.forEach(e.nodes(),function(n){t.setNode(n,e.node(n))}),qe.forEach(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},s=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+s.weight,minlen:Math.max(r.minlen,s.minlen)})}),t}function Kz(e){var t=new I4({multigraph:e.isMultigraph()}).setGraph(e.graph());return qe.forEach(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),qe.forEach(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t}function Yz(e){var t=qe.map(e.nodes(),function(n){var r={};return qe.forEach(e.outEdges(n),function(s){r[s.w]=(r[s.w]||0)+e.edge(s).weight}),r});return qe.zipObject(e.nodes(),t)}function Xz(e){var t=qe.map(e.nodes(),function(n){var r={};return qe.forEach(e.inEdges(n),function(s){r[s.v]=(r[s.v]||0)+e.edge(s).weight}),r});return qe.zipObject(e.nodes(),t)}function Qz(e,t){var n=e.x,r=e.y,s=t.x-n,i=t.y-r,a=e.width/2,l=e.height/2;if(!s&&!i)throw new Error("Not possible to find intersection inside of the rectangle");var c,d;return Math.abs(i)*a>Math.abs(s)*l?(i<0&&(l=-l),c=l*s/i,d=l):(s<0&&(a=-a),c=a,d=a*i/s),{x:n+c,y:r+d}}function Zz(e){var t=qe.map(qe.range(M4(e)+1),function(){return[]});return qe.forEach(e.nodes(),function(n){var r=e.node(n),s=r.rank;qe.isUndefined(s)||(t[s][r.order]=n)}),t}function Jz(e){var t=qe.min(qe.map(e.nodes(),function(n){return e.node(n).rank}));qe.forEach(e.nodes(),function(n){var r=e.node(n);qe.has(r,"rank")&&(r.rank-=t)})}function eF(e){var t=qe.min(qe.map(e.nodes(),function(i){return e.node(i).rank})),n=[];qe.forEach(e.nodes(),function(i){var a=e.node(i).rank-t;n[a]||(n[a]=[]),n[a].push(i)});var r=0,s=e.graph().nodeRankFactor;qe.forEach(n,function(i,a){qe.isUndefined(i)&&a%s!==0?--r:r&&qe.forEach(i,function(l){e.node(l).rank+=r})})}function tF(e,t,n,r){var s={width:0,height:0};return arguments.length>=4&&(s.rank=n,s.order=r),P4(e,"border",s,t)}function M4(e){return qe.max(qe.map(e.nodes(),function(t){var n=e.node(t).rank;if(!qe.isUndefined(n))return n}))}function nF(e,t){var n={lhs:[],rhs:[]};return qe.forEach(e,function(r){t(r)?n.lhs.push(r):n.rhs.push(r)}),n}function rF(e,t){var n=qe.now();try{return t()}finally{console.log(e+" time: "+(qe.now()-n)+"ms")}}function sF(e,t){return t()}var O4=et,iF=Yt,oF={run:aF,undo:cF};function aF(e){e.graph().dummyChains=[],O4.forEach(e.edges(),function(t){lF(e,t)})}function lF(e,t){var n=t.v,r=e.node(n).rank,s=t.w,i=e.node(s).rank,a=t.name,l=e.edge(t),c=l.labelRank;if(i!==r+1){e.removeEdge(t);var d,u,f;for(f=0,++r;r<i;++f,++r)l.points=[],u={width:0,height:0,edgeLabel:l,edgeObj:t,rank:r},d=iF.addDummyNode(e,"edge",u,"_d"),r===c&&(u.width=l.width,u.height=l.height,u.dummy="edge-label",u.labelpos=l.labelpos),e.setEdge(n,d,{weight:l.weight},a),f===0&&e.graph().dummyChains.push(d),n=d;e.setEdge(n,s,{weight:l.weight},a)}}function cF(e){O4.forEach(e.graph().dummyChains,function(t){var n=e.node(t),r=n.edgeLabel,s;for(e.setEdge(n.edgeObj,r);n.dummy;)s=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=s,n=e.node(t)})}var ol=et,Su={longestPath:uF,slack:dF};function uF(e){var t={};function n(r){var s=e.node(r);if(ol.has(t,r))return s.rank;t[r]=!0;var i=ol.min(ol.map(e.outEdges(r),function(a){return n(a.w)-e.edge(a).minlen}));return(i===Number.POSITIVE_INFINITY||i===void 0||i===null)&&(i=0),s.rank=i}ol.forEach(e.sources(),n)}function dF(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var vc=et,fF=Dn.Graph,yc=Su.slack,D4=pF;function pF(e){var t=new fF({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});for(var s,i;hF(t,e)<r;)s=mF(t,e),i=t.hasNode(s.v)?yc(e,s):-yc(e,s),gF(t,e,i);return t}function hF(e,t){function n(r){vc.forEach(t.nodeEdges(r),function(s){var i=s.v,a=r===i?s.w:i;!e.hasNode(a)&&!yc(t,s)&&(e.setNode(a,{}),e.setEdge(r,a,{}),n(a))})}return vc.forEach(e.nodes(),n),e.nodeCount()}function mF(e,t){return vc.minBy(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return yc(t,n)})}function gF(e,t,n){vc.forEach(e.nodes(),function(r){t.node(r).rank+=n})}var gr=et,xF=D4,vF=Su.slack,yF=Su.longestPath,bF=Dn.alg.preorder,_F=Dn.alg.postorder,wF=Yt.simplify,jF=Ps;Ps.initLowLimValues=Iy;Ps.initCutValues=Ay;Ps.calcCutValue=L4;Ps.leaveEdge=F4;Ps.enterEdge=$4;Ps.exchangeEdges=q4;function Ps(e){e=wF(e),yF(e);var t=xF(e);Iy(t),Ay(t,e);for(var n,r;n=F4(t);)r=$4(t,e,n),q4(t,e,n,r)}function Ay(e,t){var n=_F(e,e.nodes());n=n.slice(0,n.length-1),gr.forEach(n,function(r){SF(e,t,r)})}function SF(e,t,n){var r=e.node(n),s=r.parent;e.edge(n,s).cutvalue=L4(e,t,n)}function L4(e,t,n){var r=e.node(n),s=r.parent,i=!0,a=t.edge(n,s),l=0;return a||(i=!1,a=t.edge(s,n)),l=a.weight,gr.forEach(t.nodeEdges(n),function(c){var d=c.v===n,u=d?c.w:c.v;if(u!==s){var f=d===i,p=t.edge(c).weight;if(l+=f?p:-p,NF(e,n,u)){var h=e.edge(n,u).cutvalue;l+=f?-h:h}}}),l}function Iy(e,t){arguments.length<2&&(t=e.nodes()[0]),z4(e,{},1,t)}function z4(e,t,n,r,s){var i=n,a=e.node(r);return t[r]=!0,gr.forEach(e.neighbors(r),function(l){gr.has(t,l)||(n=z4(e,t,n,l,r))}),a.low=i,a.lim=n++,s?a.parent=s:delete a.parent,n}function F4(e){return gr.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function $4(e,t,n){var r=n.v,s=n.w;t.hasEdge(r,s)||(r=n.w,s=n.v);var i=e.node(r),a=e.node(s),l=i,c=!1;i.lim>a.lim&&(l=a,c=!0);var d=gr.filter(t.edges(),function(u){return c===q2(e,e.node(u.v),l)&&c!==q2(e,e.node(u.w),l)});return gr.minBy(d,function(u){return vF(t,u)})}function q4(e,t,n,r){var s=n.v,i=n.w;e.removeEdge(s,i),e.setEdge(r.v,r.w,{}),Iy(e),Ay(e,t),kF(e,t)}function kF(e,t){var n=gr.find(e.nodes(),function(s){return!t.node(s).parent}),r=bF(e,n);r=r.slice(1),gr.forEach(r,function(s){var i=e.node(s).parent,a=t.edge(s,i),l=!1;a||(a=t.edge(i,s),l=!0),t.node(s).rank=t.node(i).rank+(l?a.minlen:-a.minlen)})}function NF(e,t,n){return e.hasEdge(t,n)}function q2(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}var CF=Su,B4=CF.longestPath,EF=D4,TF=jF,RF=AF;function AF(e){switch(e.graph().ranker){case"network-simplex":B2(e);break;case"tight-tree":PF(e);break;case"longest-path":IF(e);break;default:B2(e)}}var IF=B4;function PF(e){B4(e),EF(e)}function B2(e){TF(e)}var Hx=et,MF=OF;function OF(e){var t=LF(e);Hx.forEach(e.graph().dummyChains,function(n){for(var r=e.node(n),s=r.edgeObj,i=DF(e,t,s.v,s.w),a=i.path,l=i.lca,c=0,d=a[c],u=!0;n!==s.w;){if(r=e.node(n),u){for(;(d=a[c])!==l&&e.node(d).maxRank<r.rank;)c++;d===l&&(u=!1)}if(!u){for(;c<a.length-1&&e.node(d=a[c+1]).minRank<=r.rank;)c++;d=a[c]}e.setParent(n,d),n=e.successors(n)[0]}})}function DF(e,t,n,r){var s=[],i=[],a=Math.min(t[n].low,t[r].low),l=Math.max(t[n].lim,t[r].lim),c,d;c=n;do c=e.parent(c),s.push(c);while(c&&(t[c].low>a||l>t[c].lim));for(d=c,c=r;(c=e.parent(c))!==d;)i.push(c);return{path:s.concat(i.reverse()),lca:d}}function LF(e){var t={},n=0;function r(s){var i=n;Hx.forEach(e.children(s),r),t[s]={low:i,lim:n++}}return Hx.forEach(e.children(),r),t}var ar=et,Vx=Yt,zF={run:FF,cleanup:BF};function FF(e){var t=Vx.addDummyNode(e,"root",{},"_root"),n=$F(e),r=ar.max(ar.values(n))-1,s=2*r+1;e.graph().nestingRoot=t,ar.forEach(e.edges(),function(a){e.edge(a).minlen*=s});var i=qF(e)+1;ar.forEach(e.children(),function(a){W4(e,t,s,i,r,n,a)}),e.graph().nodeRankFactor=s}function W4(e,t,n,r,s,i,a){var l=e.children(a);if(!l.length){a!==t&&e.setEdge(t,a,{weight:0,minlen:n});return}var c=Vx.addBorderNode(e,"_bt"),d=Vx.addBorderNode(e,"_bb"),u=e.node(a);e.setParent(c,a),u.borderTop=c,e.setParent(d,a),u.borderBottom=d,ar.forEach(l,function(f){W4(e,t,n,r,s,i,f);var p=e.node(f),h=p.borderTop?p.borderTop:f,v=p.borderBottom?p.borderBottom:f,g=p.borderTop?r:2*r,_=h!==v?1:s-i[a]+1;e.setEdge(c,h,{weight:g,minlen:_,nestingEdge:!0}),e.setEdge(v,d,{weight:g,minlen:_,nestingEdge:!0})}),e.parent(a)||e.setEdge(t,c,{weight:0,minlen:s+i[a]})}function $F(e){var t={};function n(r,s){var i=e.children(r);i&&i.length&&ar.forEach(i,function(a){n(a,s+1)}),t[r]=s}return ar.forEach(e.children(),function(r){n(r,1)}),t}function qF(e){return ar.reduce(e.edges(),function(t,n){return t+e.edge(n).weight},0)}function BF(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,ar.forEach(e.edges(),function(n){var r=e.edge(n);r.nestingEdge&&e.removeEdge(n)})}var ag=et,WF=Yt,HF=VF;function VF(e){function t(n){var r=e.children(n),s=e.node(n);if(r.length&&ag.forEach(r,t),ag.has(s,"minRank")){s.borderLeft=[],s.borderRight=[];for(var i=s.minRank,a=s.maxRank+1;i<a;++i)W2(e,"borderLeft","_bl",n,s,i),W2(e,"borderRight","_br",n,s,i)}}ag.forEach(e.children(),t)}function W2(e,t,n,r,s,i){var a={width:0,height:0,rank:i,borderType:t},l=s[t][i-1],c=WF.addDummyNode(e,"border",a,n);s[t][i]=c,e.setParent(c,r),l&&e.setEdge(l,c,{weight:1})}var Wn=et,UF={adjust:GF,undo:KF};function GF(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&H4(e)}function KF(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&YF(e),(t==="lr"||t==="rl")&&(XF(e),H4(e))}function H4(e){Wn.forEach(e.nodes(),function(t){H2(e.node(t))}),Wn.forEach(e.edges(),function(t){H2(e.edge(t))})}function H2(e){var t=e.width;e.width=e.height,e.height=t}function YF(e){Wn.forEach(e.nodes(),function(t){lg(e.node(t))}),Wn.forEach(e.edges(),function(t){var n=e.edge(t);Wn.forEach(n.points,lg),Wn.has(n,"y")&&lg(n)})}function lg(e){e.y=-e.y}function XF(e){Wn.forEach(e.nodes(),function(t){cg(e.node(t))}),Wn.forEach(e.edges(),function(t){var n=e.edge(t);Wn.forEach(n.points,cg),Wn.has(n,"x")&&cg(n)})}function cg(e){var t=e.x;e.x=e.y,e.y=t}var Zn=et,QF=ZF;function ZF(e){var t={},n=Zn.filter(e.nodes(),function(l){return!e.children(l).length}),r=Zn.max(Zn.map(n,function(l){return e.node(l).rank})),s=Zn.map(Zn.range(r+1),function(){return[]});function i(l){if(!Zn.has(t,l)){t[l]=!0;var c=e.node(l);s[c.rank].push(l),Zn.forEach(e.successors(l),i)}}var a=Zn.sortBy(n,function(l){return e.node(l).rank});return Zn.forEach(a,i),s}var jr=et,JF=e$;function e$(e,t){for(var n=0,r=1;r<t.length;++r)n+=t$(e,t[r-1],t[r]);return n}function t$(e,t,n){for(var r=jr.zipObject(n,jr.map(n,function(d,u){return u})),s=jr.flatten(jr.map(t,function(d){return jr.sortBy(jr.map(e.outEdges(d),function(u){return{pos:r[u.w],weight:e.edge(u).weight}}),"pos")}),!0),i=1;i<n.length;)i<<=1;var a=2*i-1;i-=1;var l=jr.map(new Array(a),function(){return 0}),c=0;return jr.forEach(s.forEach(function(d){var u=d.pos+i;l[u]+=d.weight;for(var f=0;u>0;)u%2&&(f+=l[u+1]),u=u-1>>1,l[u]+=d.weight;c+=d.weight*f})),c}var V2=et,n$=r$;function r$(e,t){return V2.map(t,function(n){var r=e.inEdges(n);if(r.length){var s=V2.reduce(r,function(i,a){var l=e.edge(a),c=e.node(a.v);return{sum:i.sum+l.weight*c.order,weight:i.weight+l.weight}},{sum:0,weight:0});return{v:n,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:n}})}var en=et,s$=i$;function i$(e,t){var n={};en.forEach(e,function(s,i){var a=n[s.v]={indegree:0,in:[],out:[],vs:[s.v],i};en.isUndefined(s.barycenter)||(a.barycenter=s.barycenter,a.weight=s.weight)}),en.forEach(t.edges(),function(s){var i=n[s.v],a=n[s.w];!en.isUndefined(i)&&!en.isUndefined(a)&&(a.indegree++,i.out.push(n[s.w]))});var r=en.filter(n,function(s){return!s.indegree});return o$(r)}function o$(e){var t=[];function n(i){return function(a){a.merged||(en.isUndefined(a.barycenter)||en.isUndefined(i.barycenter)||a.barycenter>=i.barycenter)&&a$(i,a)}}function r(i){return function(a){a.in.push(i),--a.indegree===0&&e.push(a)}}for(;e.length;){var s=e.pop();t.push(s),en.forEach(s.in.reverse(),n(s)),en.forEach(s.out,r(s))}return en.map(en.filter(t,function(i){return!i.merged}),function(i){return en.pick(i,["vs","i","barycenter","weight"])})}function a$(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}var yo=et,l$=Yt,c$=u$;function u$(e,t){var n=l$.partition(e,function(u){return yo.has(u,"barycenter")}),r=n.lhs,s=yo.sortBy(n.rhs,function(u){return-u.i}),i=[],a=0,l=0,c=0;r.sort(d$(!!t)),c=U2(i,s,c),yo.forEach(r,function(u){c+=u.vs.length,i.push(u.vs),a+=u.barycenter*u.weight,l+=u.weight,c=U2(i,s,c)});var d={vs:yo.flatten(i,!0)};return l&&(d.barycenter=a/l,d.weight=l),d}function U2(e,t,n){for(var r;t.length&&(r=yo.last(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}function d$(e){return function(t,n){return t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}}var Pr=et,f$=n$,p$=s$,h$=c$,m$=V4;function V4(e,t,n,r){var s=e.children(t),i=e.node(t),a=i?i.borderLeft:void 0,l=i?i.borderRight:void 0,c={};a&&(s=Pr.filter(s,function(v){return v!==a&&v!==l}));var d=f$(e,s);Pr.forEach(d,function(v){if(e.children(v.v).length){var g=V4(e,v.v,n,r);c[v.v]=g,Pr.has(g,"barycenter")&&x$(v,g)}});var u=p$(d,n);g$(u,c);var f=h$(u,r);if(a&&(f.vs=Pr.flatten([a,f.vs,l],!0),e.predecessors(a).length)){var p=e.node(e.predecessors(a)[0]),h=e.node(e.predecessors(l)[0]);Pr.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+p.order+h.order)/(f.weight+2),f.weight+=2}return f}function g$(e,t){Pr.forEach(e,function(n){n.vs=Pr.flatten(n.vs.map(function(r){return t[r]?t[r].vs:r}),!0)})}function x$(e,t){Pr.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var bo=et,v$=Dn.Graph,y$=b$;function b$(e,t,n){var r=_$(e),s=new v$({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(i){return e.node(i)});return bo.forEach(e.nodes(),function(i){var a=e.node(i),l=e.parent(i);(a.rank===t||a.minRank<=t&&t<=a.maxRank)&&(s.setNode(i),s.setParent(i,l||r),bo.forEach(e[n](i),function(c){var d=c.v===i?c.w:c.v,u=s.edge(d,i),f=bo.isUndefined(u)?0:u.weight;s.setEdge(d,i,{weight:e.edge(c).weight+f})}),bo.has(a,"minRank")&&s.setNode(i,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]}))}),s}function _$(e){for(var t;e.hasNode(t=bo.uniqueId("_root")););return t}var w$=et,j$=S$;function S$(e,t,n){var r={},s;w$.forEach(n,function(i){for(var a=e.parent(i),l,c;a;){if(l=e.parent(a),l?(c=r[l],r[l]=a):(c=s,s=a),c&&c!==a){t.setEdge(c,a);return}a=l}})}var Ur=et,k$=QF,N$=JF,C$=m$,E$=y$,T$=j$,R$=Dn.Graph,G2=Yt,A$=I$;function I$(e){var t=G2.maxRank(e),n=K2(e,Ur.range(1,t+1),"inEdges"),r=K2(e,Ur.range(t-1,-1,-1),"outEdges"),s=k$(e);Y2(e,s);for(var i=Number.POSITIVE_INFINITY,a,l=0,c=0;c<4;++l,++c){P$(l%2?n:r,l%4>=2),s=G2.buildLayerMatrix(e);var d=N$(e,s);d<i&&(c=0,a=Ur.cloneDeep(s),i=d)}Y2(e,a)}function K2(e,t,n){return Ur.map(t,function(r){return E$(e,r,n)})}function P$(e,t){var n=new R$;Ur.forEach(e,function(r){var s=r.graph().root,i=C$(r,s,n,t);Ur.forEach(i.vs,function(a,l){r.node(a).order=l}),T$(r,n,i.vs)})}function Y2(e,t){Ur.forEach(t,function(n){Ur.forEach(n,function(r,s){e.node(r).order=s})})}var ye=et,M$=Dn.Graph,O$=Yt,D$={positionX:G$};function L$(e,t){var n={};function r(s,i){var a=0,l=0,c=s.length,d=ye.last(i);return ye.forEach(i,function(u,f){var p=F$(e,u),h=p?e.node(p).order:c;(p||u===d)&&(ye.forEach(i.slice(l,f+1),function(v){ye.forEach(e.predecessors(v),function(g){var _=e.node(g),x=_.order;(x<a||h<x)&&!(_.dummy&&e.node(v).dummy)&&U4(n,g,v)})}),l=f+1,a=h)}),i}return ye.reduce(t,r),n}function z$(e,t){var n={};function r(i,a,l,c,d){var u;ye.forEach(ye.range(a,l),function(f){u=i[f],e.node(u).dummy&&ye.forEach(e.predecessors(u),function(p){var h=e.node(p);h.dummy&&(h.order<c||h.order>d)&&U4(n,p,u)})})}function s(i,a){var l=-1,c,d=0;return ye.forEach(a,function(u,f){if(e.node(u).dummy==="border"){var p=e.predecessors(u);p.length&&(c=e.node(p[0]).order,r(a,d,f,l,c),d=f,l=c)}r(a,d,a.length,c,i.length)}),a}return ye.reduce(t,s),n}function F$(e,t){if(e.node(t).dummy)return ye.find(e.predecessors(t),function(n){return e.node(n).dummy})}function U4(e,t,n){if(t>n){var r=t;t=n,n=r}var s=e[t];s||(e[t]=s={}),s[n]=!0}function $$(e,t,n){if(t>n){var r=t;t=n,n=r}return ye.has(e[t],n)}function q$(e,t,n,r){var s={},i={},a={};return ye.forEach(t,function(l){ye.forEach(l,function(c,d){s[c]=c,i[c]=c,a[c]=d})}),ye.forEach(t,function(l){var c=-1;ye.forEach(l,function(d){var u=r(d);if(u.length){u=ye.sortBy(u,function(g){return a[g]});for(var f=(u.length-1)/2,p=Math.floor(f),h=Math.ceil(f);p<=h;++p){var v=u[p];i[d]===d&&c<a[v]&&!$$(n,d,v)&&(i[v]=d,i[d]=s[d]=s[v],c=a[v])}}})}),{root:s,align:i}}function B$(e,t,n,r,s){var i={},a=W$(e,t,n,s),l=s?"borderLeft":"borderRight";function c(f,p){for(var h=a.nodes(),v=h.pop(),g={};v;)g[v]?f(v):(g[v]=!0,h.push(v),h=h.concat(p(v))),v=h.pop()}function d(f){i[f]=a.inEdges(f).reduce(function(p,h){return Math.max(p,i[h.v]+a.edge(h))},0)}function u(f){var p=a.outEdges(f).reduce(function(v,g){return Math.min(v,i[g.w]-a.edge(g))},Number.POSITIVE_INFINITY),h=e.node(f);p!==Number.POSITIVE_INFINITY&&h.borderType!==l&&(i[f]=Math.max(i[f],p))}return c(d,a.predecessors.bind(a)),c(u,a.successors.bind(a)),ye.forEach(r,function(f){i[f]=i[n[f]]}),i}function W$(e,t,n,r){var s=new M$,i=e.graph(),a=K$(i.nodesep,i.edgesep,r);return ye.forEach(t,function(l){var c;ye.forEach(l,function(d){var u=n[d];if(s.setNode(u),c){var f=n[c],p=s.edge(f,u);s.setEdge(f,u,Math.max(a(e,d,c),p||0))}c=d})}),s}function H$(e,t){return ye.minBy(ye.values(t),function(n){var r=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;return ye.forIn(n,function(i,a){var l=Y$(e,a)/2;r=Math.max(i+l,r),s=Math.min(i-l,s)}),r-s})}function V$(e,t){var n=ye.values(t),r=ye.min(n),s=ye.max(n);ye.forEach(["u","d"],function(i){ye.forEach(["l","r"],function(a){var l=i+a,c=e[l],d;if(c!==t){var u=ye.values(c);d=a==="l"?r-ye.min(u):s-ye.max(u),d&&(e[l]=ye.mapValues(c,function(f){return f+d}))}})})}function U$(e,t){return ye.mapValues(e.ul,function(n,r){if(t)return e[t.toLowerCase()][r];var s=ye.sortBy(ye.map(e,r));return(s[1]+s[2])/2})}function G$(e){var t=O$.buildLayerMatrix(e),n=ye.merge(L$(e,t),z$(e,t)),r={},s;ye.forEach(["u","d"],function(a){s=a==="u"?t:ye.values(t).reverse(),ye.forEach(["l","r"],function(l){l==="r"&&(s=ye.map(s,function(f){return ye.values(f).reverse()}));var c=(a==="u"?e.predecessors:e.successors).bind(e),d=q$(e,s,n,c),u=B$(e,s,d.root,d.align,l==="r");l==="r"&&(u=ye.mapValues(u,function(f){return-f})),r[a+l]=u})});var i=H$(e,r);return V$(r,i),U$(r,e.graph().align)}function K$(e,t,n){return function(r,s,i){var a=r.node(s),l=r.node(i),c=0,d;if(c+=a.width/2,ye.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":d=-a.width/2;break;case"r":d=a.width/2;break}if(d&&(c+=n?d:-d),d=0,c+=(a.dummy?t:e)/2,c+=(l.dummy?t:e)/2,c+=l.width/2,ye.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":d=l.width/2;break;case"r":d=-l.width/2;break}return d&&(c+=n?d:-d),d=0,c}}function Y$(e,t){return e.node(t).width}var _o=et,G4=Yt,X$=D$.positionX,Q$=Z$;function Z$(e){e=G4.asNonCompoundGraph(e),J$(e),_o.forEach(X$(e),function(t,n){e.node(n).x=t})}function J$(e){var t=G4.buildLayerMatrix(e),n=e.graph().ranksep,r=0;_o.forEach(t,function(s){var i=_o.max(_o.map(s,function(a){return e.node(a).height}));_o.forEach(s,function(a){e.node(a).y=r+i/2}),r+=i+n})}var Ce=et,X2=Wz,Q2=oF,eq=RF,tq=Yt.normalizeRanks,nq=MF,rq=Yt.removeEmptyRanks,Z2=zF,sq=HF,J2=UF,iq=A$,oq=Q$,Xr=Yt,aq=Dn.Graph,lq=cq;function cq(e,t){var n=t&&t.debugTiming?Xr.time:Xr.notime;n("layout",function(){var r=n("  buildLayoutGraph",function(){return bq(e)});n("  runLayout",function(){uq(r,n)}),n("  updateInputGraph",function(){dq(e,r)})})}function uq(e,t){t("    makeSpaceForEdgeLabels",function(){_q(e)}),t("    removeSelfEdges",function(){Rq(e)}),t("    acyclic",function(){X2.run(e)}),t("    nestingGraph.run",function(){Z2.run(e)}),t("    rank",function(){eq(Xr.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){wq(e)}),t("    removeEmptyRanks",function(){rq(e)}),t("    nestingGraph.cleanup",function(){Z2.cleanup(e)}),t("    normalizeRanks",function(){tq(e)}),t("    assignRankMinMax",function(){jq(e)}),t("    removeEdgeLabelProxies",function(){Sq(e)}),t("    normalize.run",function(){Q2.run(e)}),t("    parentDummyChains",function(){nq(e)}),t("    addBorderSegments",function(){sq(e)}),t("    order",function(){iq(e)}),t("    insertSelfEdges",function(){Aq(e)}),t("    adjustCoordinateSystem",function(){J2.adjust(e)}),t("    position",function(){oq(e)}),t("    positionSelfEdges",function(){Iq(e)}),t("    removeBorderNodes",function(){Tq(e)}),t("    normalize.undo",function(){Q2.undo(e)}),t("    fixupEdgeLabelCoords",function(){Cq(e)}),t("    undoCoordinateSystem",function(){J2.undo(e)}),t("    translateGraph",function(){kq(e)}),t("    assignNodeIntersects",function(){Nq(e)}),t("    reversePoints",function(){Eq(e)}),t("    acyclic.undo",function(){X2.undo(e)})}function dq(e,t){Ce.forEach(e.nodes(),function(n){var r=e.node(n),s=t.node(n);r&&(r.x=s.x,r.y=s.y,t.children(n).length&&(r.width=s.width,r.height=s.height))}),Ce.forEach(e.edges(),function(n){var r=e.edge(n),s=t.edge(n);r.points=s.points,Ce.has(s,"x")&&(r.x=s.x,r.y=s.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var fq=["nodesep","edgesep","ranksep","marginx","marginy"],pq={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},hq=["acyclicer","ranker","rankdir","align"],mq=["width","height"],gq={width:0,height:0},xq=["minlen","weight","width","height","labeloffset"],vq={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},yq=["labelpos"];function bq(e){var t=new aq({multigraph:!0,compound:!0}),n=dg(e.graph());return t.setGraph(Ce.merge({},pq,ug(n,fq),Ce.pick(n,hq))),Ce.forEach(e.nodes(),function(r){var s=dg(e.node(r));t.setNode(r,Ce.defaults(ug(s,mq),gq)),t.setParent(r,e.parent(r))}),Ce.forEach(e.edges(),function(r){var s=dg(e.edge(r));t.setEdge(r,Ce.merge({},vq,ug(s,xq),Ce.pick(s,yq)))}),t}function _q(e){var t=e.graph();t.ranksep/=2,Ce.forEach(e.edges(),function(n){var r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function wq(e){Ce.forEach(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),s=e.node(t.w),i={rank:(s.rank-r.rank)/2+r.rank,e:t};Xr.addDummyNode(e,"edge-proxy",i,"_ep")}})}function jq(e){var t=0;Ce.forEach(e.nodes(),function(n){var r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=Ce.max(t,r.maxRank))}),e.graph().maxRank=t}function Sq(e){Ce.forEach(e.nodes(),function(t){var n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function kq(e){var t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,s=0,i=e.graph(),a=i.marginx||0,l=i.marginy||0;function c(d){var u=d.x,f=d.y,p=d.width,h=d.height;t=Math.min(t,u-p/2),n=Math.max(n,u+p/2),r=Math.min(r,f-h/2),s=Math.max(s,f+h/2)}Ce.forEach(e.nodes(),function(d){c(e.node(d))}),Ce.forEach(e.edges(),function(d){var u=e.edge(d);Ce.has(u,"x")&&c(u)}),t-=a,r-=l,Ce.forEach(e.nodes(),function(d){var u=e.node(d);u.x-=t,u.y-=r}),Ce.forEach(e.edges(),function(d){var u=e.edge(d);Ce.forEach(u.points,function(f){f.x-=t,f.y-=r}),Ce.has(u,"x")&&(u.x-=t),Ce.has(u,"y")&&(u.y-=r)}),i.width=n-t+a,i.height=s-r+l}function Nq(e){Ce.forEach(e.edges(),function(t){var n=e.edge(t),r=e.node(t.v),s=e.node(t.w),i,a;n.points?(i=n.points[0],a=n.points[n.points.length-1]):(n.points=[],i=s,a=r),n.points.unshift(Xr.intersectRect(r,i)),n.points.push(Xr.intersectRect(s,a))})}function Cq(e){Ce.forEach(e.edges(),function(t){var n=e.edge(t);if(Ce.has(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function Eq(e){Ce.forEach(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}function Tq(e){Ce.forEach(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),r=e.node(n.borderTop),s=e.node(n.borderBottom),i=e.node(Ce.last(n.borderLeft)),a=e.node(Ce.last(n.borderRight));n.width=Math.abs(a.x-i.x),n.height=Math.abs(s.y-r.y),n.x=i.x+n.width/2,n.y=r.y+n.height/2}}),Ce.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function Rq(e){Ce.forEach(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function Aq(e){var t=Xr.buildLayerMatrix(e);Ce.forEach(t,function(n){var r=0;Ce.forEach(n,function(s,i){var a=e.node(s);a.order=i+r,Ce.forEach(a.selfEdges,function(l){Xr.addDummyNode(e,"selfedge",{width:l.label.width,height:l.label.height,rank:a.rank,order:i+ ++r,e:l.e,label:l.label},"_se")}),delete a.selfEdges})})}function Iq(e){Ce.forEach(e.nodes(),function(t){var n=e.node(t);if(n.dummy==="selfedge"){var r=e.node(n.e.v),s=r.x+r.width/2,i=r.y,a=n.x-s,l=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:s+2*a/3,y:i-l},{x:s+5*a/6,y:i-l},{x:s+a,y:i},{x:s+5*a/6,y:i+l},{x:s+2*a/3,y:i+l}],n.label.x=n.x,n.label.y=n.y}})}function ug(e,t){return Ce.mapValues(Ce.pick(e,t),Number)}function dg(e){var t={};return Ce.forEach(e,function(n,r){t[r.toLowerCase()]=n}),t}var al=et,Pq=Yt,Mq=Dn.Graph,Oq={debugOrdering:Dq};function Dq(e){var t=Pq.buildLayerMatrix(e),n=new Mq({compound:!0,multigraph:!0}).setGraph({});return al.forEach(e.nodes(),function(r){n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank)}),al.forEach(e.edges(),function(r){n.setEdge(r.v,r.w,{},r.name)}),al.forEach(t,function(r,s){var i="layer"+s;n.setNode(i,{rank:"same"}),al.reduce(r,function(a,l){return n.setEdge(a,l,{style:"invis"}),l})}),n}var Lq="0.8.5",zq={graphlib:Dn,layout:lq,debug:Oq,util:{time:Yt.time,notime:Yt.notime},version:Lq};const bc=nv(zq),_c={intake_gate:{color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",borderColor:"rgba(245, 158, 11, 0.5)",label:"Intake Gate"},task:{color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",borderColor:"rgba(59, 130, 246, 0.5)",label:"Task"},qa:{color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",borderColor:"rgba(139, 92, 246, 0.5)",label:"QA"},pgc:{color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",borderColor:"rgba(6, 182, 212, 0.5)",label:"PGC"},gate:{color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",borderColor:"rgba(249, 115, 22, 0.5)",label:"Gate"},end:{color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",borderColor:"rgba(16, 185, 129, 0.5)",label:"End"}},Fq={color:"#ef4444",bgColor:"rgba(239, 68, 68, 0.15)",borderColor:"rgba(239, 68, 68, 0.5)",label:"End"},$q=220,qq=110;function eS(e){if(!e||!e.nodes)return{nodes:[],edges:[]};const t=e.entry_node_ids||[],n=e.nodes.map(s=>{const i=_c[s.type]||_c.task,l=s.type==="end"&&["blocked","abandoned"].includes(s.terminal_outcome)?Fq:i;return{id:s.node_id,type:"workflowNode",position:s._position||{x:0,y:0},data:{...s,config:l,isEntry:t.includes(s.node_id)}}}),r=(e.edges||[]).map(s=>{const i=s.non_advancing||!s.to_node_id,a=s.conditions&&s.conditions.length>0;let l=s.label||s.outcome;if(a){const c=s.conditions[0],d={eq:"=",ne:"!=",lt:"<",lte:"<=",gt:">",gte:">="}[c.operator]||c.operator;l=`${l} (${c.type} ${d} ${c.value})`}return{id:s.edge_id,source:s.from_node_id,target:s.to_node_id||s.from_node_id,type:"smoothstep",animated:i,label:l,data:{...s},style:{stroke:i?"#6b7280":"#64748b",strokeWidth:2,strokeDasharray:i?"5,5":void 0},labelStyle:{fontSize:10,fill:"var(--text-muted)"},labelBgStyle:{fill:"var(--bg-panel)",fillOpacity:.9},markerEnd:s.to_node_id?{type:"arrowclosed",color:"#64748b"}:void 0}});return{nodes:n,edges:r}}function wc(e,t,n="TB",r=$q,s=qq){const i=new bc.graphlib.Graph;return i.setDefaultEdgeLabel(()=>({})),i.setGraph({rankdir:n,nodesep:60,ranksep:80,marginx:40,marginy:40}),e.forEach(a=>{i.setNode(a.id,{width:r,height:s})}),t.forEach(a=>{a.target!==a.source&&i.setEdge(a.source,a.target)}),bc.layout(i),e.map(a=>{const l=i.node(a.id);return l?{...a,position:{x:l.x-r/2,y:l.y-s/2}}:a})}function Bq(e,t){const n=new Set(t.map(i=>i.id||i.node_id));let r=1,s=`${e}_${r}`;for(;n.has(s);)r++,s=`${e}_${r}`;return s}function Wq(e,t,n){const r=new Set(n.map(a=>a.id||a.edge_id));let s=1,i=`${e}_to_${t}`;for(;r.has(i);)s++,i=`${e}_to_${t}_${s}`;return i}function Hq(e,t={x:100,y:100}){const r={node_id:e+"_new",type:e,description:""};return e==="end"&&(r.terminal_outcome="stabilized"),(e==="task"||e==="pgc")&&(r.task_ref="",r.includes={}),e==="qa"&&(r.requires_qa=!0,r.qa_mode="semantic"),r}const jc={action:{color:"#1d4ed8",bgColor:"#eff6ff",borderColor:"#3b82f6",label:"Action"},gate:{color:"#b45309",bgColor:"#fef3c7",borderColor:"#f59e0b",label:"Gate"},escalation:{color:"#b91c1c",bgColor:"#fee2e2",borderColor:"#ef4444",label:"Escalation"},parallel_fork:{color:"#6d28d9",bgColor:"#ede9fe",borderColor:"#8b5cf6",label:"Fork"},parallel_join:{color:"#6d28d9",bgColor:"#ede9fe",borderColor:"#8b5cf6",label:"Join"},start:{color:"#047857",bgColor:"#d1fae5",borderColor:"#10b981",label:"Start"},end:{color:"#374151",bgColor:"#f3f4f6",borderColor:"#6b7280",label:"End"}},Sc={normal:{stroke:"#64748b",strokeWidth:2},error:{stroke:"#ef4444",strokeWidth:2,strokeDasharray:"6,3"},retry:{stroke:"#f97316",strokeWidth:2,strokeDasharray:"6,3",animated:!0},parallel:{stroke:"#8b5cf6",strokeWidth:2}},Vq=160,Uq=80;function Gq({data:e}){const{config:t,showLineage:n}=e,r=e.type==="end",s=e.type==="start",i=n&&(e.dcw_ref||e.task_ref||e.operation_ref||e.gate_profile),a=e.component,l=e.output,c=a||l;return o.jsxs("div",{style:{background:t.bgColor,border:`2px solid ${t.borderColor}`,borderRadius:8,padding:"10px 14px",minWidth:260,maxWidth:360,boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[!s&&o.jsx(yn,{type:"target",position:ce.Top,style:{background:t.borderColor,width:8,height:8,border:"2px solid white"}}),o.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:t.color,letterSpacing:"0.05em",marginBottom:4},children:t.label}),o.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#1e293b",lineHeight:"18px",marginBottom:6},children:e.label}),e.actor&&o.jsx("div",{style:{fontSize:11,color:"#4f46e5",fontWeight:500,marginBottom:4},children:e.actor}),c&&o.jsxs("div",{style:{marginTop:6,paddingTop:6,borderTop:"1px solid #e2e8f0",display:"flex",flexDirection:"column",gap:4},children:[a&&o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[o.jsx("span",{style:{fontSize:9,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.03em",flexShrink:0,marginTop:2,width:60},children:"Component"}),o.jsx("span",{style:{fontSize:11,color:"#0d9488",fontWeight:500,lineHeight:1.4},children:a})]}),l&&o.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[o.jsx("span",{style:{fontSize:9,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.03em",flexShrink:0,marginTop:2,width:60},children:"Output"}),o.jsx("span",{style:{fontSize:11,color:"#7c3aed",fontWeight:500,lineHeight:1.4},children:l})]})]}),i&&o.jsxs("div",{style:{marginTop:8,paddingTop:8,borderTop:"1px dashed #cbd5e1"},children:[e.dcw_ref&&o.jsx(fg,{label:"DCW",value:e.dcw_ref}),e.task_ref&&o.jsx(fg,{label:"Task",value:e.task_ref}),e.operation_ref&&o.jsx(fg,{label:"Op",value:e.operation_ref}),e.gate_profile&&o.jsxs("div",{style:{fontSize:9,color:"#64748b",marginTop:3},children:[o.jsx("span",{style:{fontWeight:600},children:"Gate:"})," ",Array.isArray(e.gate_profile)?e.gate_profile.join(" -> "):e.gate_profile]})]}),!r&&o.jsx(yn,{type:"source",position:ce.Bottom,style:{background:t.borderColor,width:8,height:8,border:"2px solid white"}})]})}function fg({label:e,value:t}){const n=t.length>30?"..."+t.slice(-27):t;return o.jsxs("div",{style:{fontSize:9,color:"#64748b",marginTop:3,fontFamily:"monospace"},title:t,children:[o.jsxs("span",{style:{fontWeight:600,fontFamily:"inherit"},children:[e,":"]})," ",n]})}const K4=m.memo(Gq),Kq={archWorkflowNode:K4};function Yq(e){if(!Array.isArray(e)||e.length===0)return{nodes:[],edges:[]};const n=[...e].sort((s,i)=>(s.step||s.order||0)-(i.step||i.order||0)).map((s,i)=>({node_id:`step_${i+1}`,type:"action",label:s.action||`Step ${i+1}`,actor:s.actor,description:s.description,inputs:s.inputs,outputs:s.outputs,notes:s.notes})),r=[];for(let s=0;s<n.length-1;s++)r.push({edge_id:`e_${s+1}_${s+2}`,from_node_id:n[s].node_id,to_node_id:n[s+1].node_id,type:"normal"});return{nodes:n,edges:r}}function Xq(e,t){const n=e.map(i=>{const a=jc[i.type]||jc.action;return{id:i.node_id,type:"archWorkflowNode",position:{x:0,y:0},data:{...i,config:a}}}),r=t.map(i=>{const a=i.type||"normal",l=Sc[a]||Sc.normal;return{id:i.edge_id,source:i.from_node_id,target:i.to_node_id,type:"smoothstep",animated:l.animated||!1,label:i.label,style:{stroke:l.stroke,strokeWidth:l.strokeWidth,strokeDasharray:l.strokeDasharray},labelStyle:{fontSize:9,fill:"var(--text-muted, #64748b)"},labelBgStyle:{fill:"var(--bg-panel, #ffffff)",fillOpacity:.9},markerEnd:{type:"arrowclosed",color:l.stroke}}});return{nodes:wc(n,r,"TB",Vq,Uq),edges:r}}function tS({block:e}){const{data:t}=e;if(!t||!t.name)return null;const[n,r]=m.useState(!1),{graphNodes:s,graphEdges:i,isV1:a}=m.useMemo(()=>{const d=Array.isArray(t.nodes)&&t.nodes.length>0,u=Array.isArray(t.steps)&&t.steps.length>0;if(d)return{graphNodes:t.nodes,graphEdges:t.edges||[],isV1:!1};if(u){const{nodes:f,edges:p}=Yq(t.steps);return{graphNodes:f,graphEdges:p,isV1:!0}}return{graphNodes:[],graphEdges:[],isV1:!1}},[t.nodes,t.edges,t.steps]),l=m.useMemo(()=>s.length===0?null:Xq(s,i),[s,i]),c=n?600:350;return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[o.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.description&&o.jsx("p",{style:{margin:"0 0 8px",fontSize:13,color:"#475569"},children:t.description}),t.trigger&&o.jsxs("p",{style:{margin:"0 0 8px",fontSize:13,color:"#6b7280",fontStyle:"italic"},children:["Trigger: ",t.trigger]}),l&&l.nodes.length>0?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{height:c,border:"1px solid #e5e7eb",borderRadius:6,background:"#ffffff",overflow:"hidden",transition:"height 0.2s ease"},children:o.jsx(Ii,{children:o.jsx(wa,{nodes:l.nodes,edges:l.edges,nodeTypes:Kq,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,panOnScroll:!0,zoomOnScroll:!1,fitView:!0,fitViewOptions:{padding:.2},proOptions:{hideAttribution:!0},minZoom:.3,maxZoom:1.5})})}),o.jsx("button",{onClick:()=>r(d=>!d),style:{marginTop:6,padding:"3px 10px",fontSize:11,color:"#6366f1",background:"none",border:"1px solid #e5e7eb",borderRadius:4,cursor:"pointer"},children:n?"Collapse":"Expand"})]}):o.jsx("p",{style:{margin:0,fontSize:13,color:"#9ca3af",fontStyle:"italic"},children:"No workflow steps defined."})]})}function Qq({block:e}){const{data:t}=e;if(!t||!t.name)return null;const n=Array.isArray(t.acceptance_criteria)?t.acceptance_criteria:[];return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[o.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.target&&o.jsx("p",{style:{margin:"0 0 6px",fontSize:13,color:"#475569"},children:t.target}),t.rationale&&o.jsx("p",{style:{margin:"0 0 8px",fontSize:12,color:"#6b7280",fontStyle:"italic"},children:t.rationale}),n.length>0&&o.jsxs("div",{children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:4},children:"Acceptance Criteria"}),o.jsx("ul",{style:{margin:0,paddingLeft:18},children:n.map((r,s)=>o.jsx("li",{style:{fontSize:13,color:"#374151",lineHeight:1.5},children:r},s))})]})]})}function Zq({block:e}){const{data:t}=e,n=(t==null?void 0:t.name)||(t==null?void 0:t.entity_name);if(!t||!n)return null;const r=Array.isArray(t.fields)?t.fields:[],s=Array.isArray(t.primary_keys)?t.primary_keys:[],i=Array.isArray(t.relationships)?t.relationships:[];return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[o.jsx("h4",{style:{margin:"0 0 4px",fontSize:15,fontWeight:600,color:"#1e293b"},children:n}),t.description&&o.jsx("p",{style:{margin:"0 0 10px",fontSize:13,color:"#475569"},children:t.description}),r.length>0&&o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[o.jsx("thead",{children:o.jsxs("tr",{style:{borderBottom:"2px solid #e2e8f0"},children:[o.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Field"}),o.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Type"}),o.jsx("th",{style:{textAlign:"center",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Required"}),o.jsx("th",{style:{textAlign:"left",padding:"4px 8px",color:"#6b7280",fontWeight:600,fontSize:11,textTransform:"uppercase"},children:"Notes"})]})}),o.jsx("tbody",{children:r.map((a,l)=>o.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[o.jsxs("td",{style:{padding:"4px 8px",fontFamily:"monospace",color:"#1e293b",fontWeight:s.includes(a.name)?600:400},children:[a.name,s.includes(a.name)?" (PK)":""]}),o.jsx("td",{style:{padding:"4px 8px",color:"#6366f1",fontFamily:"monospace"},children:a.type}),o.jsx("td",{style:{padding:"4px 8px",textAlign:"center"},children:a.required?"Yes":"No"}),o.jsx("td",{style:{padding:"4px 8px",color:"#6b7280"},children:Array.isArray(a.notes)?a.notes.join("; "):a.notes||a.description||""})]},l))})]}),i.length>0&&o.jsxs("div",{style:{marginTop:8},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.04em",marginBottom:4},children:"Relationships"}),o.jsx("ul",{style:{margin:0,paddingLeft:18},children:i.map((a,l)=>o.jsx("li",{style:{fontSize:13,color:"#374151",lineHeight:1.5},children:typeof a=="string"?a:`${a.type||""} ${a.target||""} ${a.description||""}`.trim()},l))})]})]})}function Jq({block:e}){const{data:t}=e;if(!t||!t.name)return null;const n=Array.isArray(t.endpoints)?t.endpoints:[],r={GET:{bg:"#d1fae5",color:"#065f46"},POST:{bg:"#dbeafe",color:"#1e40af"},PUT:{bg:"#fef3c7",color:"#92400e"},PATCH:{bg:"#fef3c7",color:"#92400e"},DELETE:{bg:"#fee2e2",color:"#991b1b"}};return o.jsxs("div",{style:{marginBottom:12,padding:"14px 16px",background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[o.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1e293b"},children:t.name}),t.type&&o.jsx("span",{style:{fontSize:11,padding:"2px 8px",background:"#f0fdf4",color:"#166534",borderRadius:4},children:t.type}),t.protocol&&o.jsx("span",{style:{fontSize:11,padding:"2px 8px",background:"#eff6ff",color:"#1e40af",borderRadius:4},children:t.protocol})]}),t.description&&o.jsx("p",{style:{margin:"0 0 8px",fontSize:13,color:"#475569"},children:t.description}),(t.authentication||t.authorization)&&o.jsxs("div",{style:{marginBottom:8,fontSize:12,color:"#6b7280"},children:[t.authentication&&o.jsxs("span",{children:["Auth: ",t.authentication]}),t.authentication&&t.authorization&&o.jsx("span",{children:" | "}),t.authorization&&o.jsxs("span",{children:["Authz: ",t.authorization]})]}),n.length>0&&o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:n.map((s,i)=>{const a=r[s.method]||{bg:"#f3f4f6",color:"#374151"};return o.jsxs("div",{style:{padding:"8px 10px",background:"#ffffff",borderRadius:6,border:"1px solid #e5e7eb"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{style:{fontSize:11,fontWeight:700,padding:"2px 6px",borderRadius:3,background:a.bg,color:a.color,fontFamily:"monospace"},children:s.method}),o.jsx("code",{style:{fontSize:13,color:"#1e293b"},children:s.path})]}),s.description&&o.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:s.description})]},i)})})]})}function eB({block:e}){const{type:t,data:n}=e;return o.jsxs("div",{style:{padding:"12px 16px",background:"#f8fafc",borderRadius:6,border:"1px solid #e2e8f0",marginBottom:12},children:[o.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginBottom:8,fontFamily:"monospace"},children:t}),o.jsx("pre",{style:{fontSize:12,color:"#475569",margin:0,whiteSpace:"pre-wrap",wordBreak:"break-word"},children:JSON.stringify(n,null,2)})]})}function tB({block:e}){const{data:t}=e,n=t.items||[],[r,s]=m.useState({});if(n.length===0)return null;const i=a=>{s(l=>({...l,[a]:!l[a]}))};return o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:n.map((a,l)=>{const c=r[l],d=a.why_it_matters||a.impact_if_unresolved;return o.jsxs("div",{style:{background:"#fefce8",border:"1px solid #fef08a",borderRadius:6,borderLeft:"3px solid #eab308",overflow:"hidden"},children:[o.jsxs("button",{onClick:()=>d&&i(l),style:{width:"100%",padding:"10px 12px",background:"transparent",border:"none",cursor:d?"pointer":"default",display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:8,textAlign:"left"},children:[o.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#854d0e",lineHeight:1.4},children:a.question||a.value||a.text||"Unknown"}),d&&o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"#a16207",strokeWidth:"2",style:{flexShrink:0,marginTop:2,transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s"},children:o.jsx("path",{d:"M3 5l4 4 4-4"})})]}),c&&d&&o.jsxs("div",{style:{padding:"0 12px 12px",borderTop:"1px solid #fde68a",marginTop:0},children:[a.why_it_matters&&o.jsxs("div",{style:{marginTop:10},children:[o.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Why it matters"}),o.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:a.why_it_matters})]}),a.impact_if_unresolved&&o.jsxs("div",{style:{marginTop:10},children:[o.jsx("div",{style:{fontSize:10,fontWeight:600,color:"#a16207",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:3},children:"Impact if unresolved"}),o.jsx("div",{style:{fontSize:12,color:"#713f12",lineHeight:1.5},children:a.impact_if_unresolved})]})]})]},l)})})}function nB({block:e}){const{data:t}=e,{description:n,user_statement:r}=t;return o.jsxs("div",{style:{marginBottom:12},children:[n&&o.jsx("div",{style:{paddingLeft:16,borderLeft:"4px solid #8b5cf6",color:"#374151",marginBottom:16,fontSize:14,lineHeight:1.6},children:n}),r&&o.jsxs("blockquote",{style:{paddingLeft:16,borderLeft:"4px solid #d1d5db",color:"#6b7280",fontStyle:"italic",margin:0,fontSize:13,lineHeight:1.5},children:['"',r,'"']})]})}function rB({block:e}){const{data:t}=e,{category:n,confidence:r,rationale:s}=t;return o.jsxs("div",{style:{marginBottom:12},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:8},children:[o.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:"#ede9fe",color:"#6d28d9"},children:n}),r&&o.jsxs("span",{style:{fontSize:13,color:"#6b7280"},children:["Confidence: ",r]})]}),s&&o.jsx("p",{style:{margin:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:s})]})}function sB({block:e}){const{data:t}=e,{explicit:n=[],inferred:r=[]}=t,s=n&&n.length>0,i=r&&r.length>0;return!s&&!i?null:o.jsxs("div",{style:{marginBottom:12},children:[s&&o.jsxs("div",{style:{marginBottom:i?16:0},children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Explicit"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((a,l)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[o.jsx("span",{style:{color:"#f59e0b"},children:""}),o.jsx("span",{children:a})]},l))})]}),i&&o.jsxs("div",{children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Inferred"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((a,l)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[o.jsx("span",{style:{color:"#3b82f6"},children:""}),o.jsx("span",{children:a})]},l))})]})]})}function iB({block:e}){const{data:t}=e,{questions:n=[],missing_context:r=[],assumptions_made:s=[]}=t,i=n&&n.length>0,a=r&&r.length>0,l=s&&s.length>0;return!i&&!a&&!l?null:o.jsxs("div",{style:{marginBottom:12},children:[i&&o.jsxs("div",{style:{marginBottom:a||l?16:0},children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Questions"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:n.map((c,d)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[o.jsx("span",{style:{color:"#3b82f6"},children:""}),o.jsx("span",{children:c})]},d))})]}),a&&o.jsxs("div",{style:{marginBottom:l?16:0},children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Missing Context"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:r.map((c,d)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[o.jsx("span",{style:{color:"#f59e0b"},children:""}),o.jsx("span",{children:c})]},d))})]}),l&&o.jsxs("div",{children:[o.jsx("h4",{style:{fontSize:12,fontWeight:500,color:"#6b7280",marginBottom:8,marginTop:0},children:"Assumptions"}),o.jsx("ul",{style:{margin:0,paddingLeft:20,listStyle:"none"},children:s.map((c,d)=>o.jsxs("li",{style:{display:"flex",alignItems:"flex-start",gap:8,marginBottom:6,fontSize:13,color:"#374151"},children:[o.jsx("span",{style:{color:"#6b7280"},children:""}),o.jsx("span",{children:c})]},d))})]})]})}function oB({block:e}){const{data:t}=e,{status:n,rationale:r,next_action:s}=t,a={qualified:{bg:"#d1fae5",text:"#065f46"},not_ready:{bg:"#fef3c7",text:"#92400e"},out_of_scope:{bg:"#fee2e2",text:"#991b1b"},redirect:{bg:"#e0e7ff",text:"#3730a3"}}[n]||{bg:"#f3f4f6",text:"#374151"};return o.jsxs("div",{style:{marginBottom:12},children:[n&&o.jsx("div",{style:{marginBottom:12},children:o.jsx("span",{style:{padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:500,background:a.bg,color:a.text},children:n})}),r&&o.jsx("p",{style:{margin:0,marginBottom:s?12:0,fontSize:13,color:"#6b7280",lineHeight:1.5},children:r}),s&&o.jsx("div",{style:{padding:12,borderRadius:8,background:"#ecfdf5",border:"1px solid #a7f3d0"},children:o.jsxs("span",{style:{fontSize:13,fontWeight:500,color:"#065f46"},children:["Next: ",s]})})]})}const aB={"schema:ParagraphBlockV1":D8,"schema:StringListBlockV1":Kb,"schema:IndicatorBlockV1":z8,"schema:OpenQuestionV1":IE,"schema:OpenQuestionsBlockV1":F8,"schema:RisksBlockV1":Yb,"schema:DependenciesBlockV1":Yb,"schema:ArchComponentBlockV1":B8,"schema:WorkflowBlockV1":tS,"schema:WorkflowBlockV2":tS,"schema:QualityAttributeBlockV1":Qq,"schema:DataModelBlockV1":Zq,"schema:InterfaceBlockV1":Jq,"schema:SummaryBlockV1":$8,"schema:EpicSummaryBlockV1":Xb,"schema:StorySummaryBlockV1":q8,"schema:EpicStoriesCardBlockV1":Xb,"schema:StoriesBlockV1":Kb,"schema:UnknownsBlockV1":tB,"schema:IntakeSummaryBlockV1":nB,"schema:IntakeProjectTypeBlockV1":rB,"schema:IntakeConstraintsBlockV1":sB,"schema:IntakeOpenGapsBlockV1":iB,"schema:IntakeOutcomeBlockV1":oB};function lB(e){return aB[e]||eB}function cB(e,t){const n=lB(e.type);return o.jsx(n,{block:e},e.key||t)}function Y4({renderModel:e,variant:t="full",hideHeader:n=!1,onSectionClick:r,className:s=""}){var _;const[i,a]=m.useState(new Set(((_=e==null?void 0:e.sections)==null?void 0:_.map(x=>x.section_id))||[]));if(!e)return o.jsx("div",{style:{padding:20,textAlign:"center",color:"#6b7280"},children:"No render model available"});const{title:l,subtitle:c,sections:d=[],metadata:u}=e;if(u!=null&&u.fallback&&e.raw_content)return o.jsx(hB,{title:l,content:e.raw_content,reason:u.reason});const f=x=>{a(y=>{const b=new Set(y);return b.has(x)?b.delete(x):b.add(x),b})},p=t==="compact"||t==="sidecar",v=t==="sidecar"?d.filter(x=>x.viewer_tab==="overview"||!x.viewer_tab):d,g=(()=>{if(!l)return"Document";const x=l.indexOf(": ");return x>-1?l.slice(x+2):l})();return o.jsxs("div",{className:s,children:[t==="full"&&!n&&o.jsxs("div",{style:{marginBottom:24},children:[o.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:g}),c&&o.jsx("p",{style:{margin:"8px 0 0",fontSize:14,color:"#6b7280"},children:c})]}),o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:p?12:20},children:v.map(x=>o.jsx(pB,{section:x,isExpanded:i.has(x.section_id),onToggle:()=>f(x.section_id),onClick:()=>r==null?void 0:r(x),variant:t},x.section_id))}),v.length===0&&o.jsx("div",{style:{padding:32,textAlign:"center",color:"#9ca3af",background:"#f9fafb",borderRadius:8},children:"No content sections available"})]})}function uB(e){if(!e||!e.data)return"";const{type:t,data:n}=e;switch(t){case"schema:ParagraphBlockV1":return n.text||"";case"schema:StringListBlockV1":return(n.items||[]).map(r=>typeof r=="string"?`- ${r}`:`- ${r.text||""}`).join(`
`);case"schema:IndicatorBlockV1":return`${n.label||""}: ${n.value||""}`;case"schema:OpenQuestionV1":return`Q: ${n.question||""}
A: ${n.answer||"No answer yet"}`;case"schema:OpenQuestionsBlockV1":return(n.questions||[]).map(r=>`Q: ${r.question||""}
A: ${r.answer||"No answer yet"}`).join(`

`);case"schema:RisksBlockV1":case"schema:DependenciesBlockV1":return(n.items||[]).map(r=>`- ${r.title||r.name||""}: ${r.description||""}`).join(`
`);case"schema:SummaryBlockV1":return n.summary||n.text||"";case"schema:EpicSummaryBlockV1":case"schema:StorySummaryBlockV1":return[n.title||"",n.description||n.summary||""].filter(Boolean).join(`

`);case"schema:UnknownsBlockV1":return(n.items||n.unknowns||[]).map(r=>typeof r=="string"?`- ${r}`:`- ${r.description||r.text||""}`).join(`
`);case"schema:IntakeSummaryBlockV1":return n.summary||"";case"schema:IntakeProjectTypeBlockV1":return`Project Type: ${n.project_type||n.type||""}`;case"schema:IntakeConstraintsBlockV1":return(n.constraints||[]).map(r=>`- ${r}`).join(`
`);case"schema:IntakeOpenGapsBlockV1":return(n.gaps||n.open_gaps||[]).map(r=>`- ${r}`).join(`
`);case"schema:IntakeOutcomeBlockV1":return`Outcome: ${n.outcome||n.status||""}`;default:return n.text?n.text:n.content?n.content:n.summary?n.summary:n.items&&Array.isArray(n.items)?n.items.map(r=>typeof r=="string"?`- ${r}`:`- ${JSON.stringify(r)}`).join(`
`):""}}function dB({size:e=14}){return o.jsxs("svg",{width:e,height:e,viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"5",y:"5",width:"9",height:"9",rx:"1"}),o.jsx("path",{d:"M2 11V3a1 1 0 011-1h8"})]})}function fB({size:e=14}){return o.jsx("svg",{width:e,height:e,viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:o.jsx("path",{d:"M3 8l4 4 6-7"})})}function pB({section:e,isExpanded:t,onToggle:n,onClick:r,variant:s}){const[i,a]=m.useState(!1),{section_id:l,title:c,description:d,blocks:u=[],sidecar_max_items:f}=e,p=s==="compact"||s==="sidecar",h=s==="sidecar";if(u.length===0)return null;const v=async x=>{x.stopPropagation();const y=u.map(uB).filter(Boolean).join(`

`);try{await navigator.clipboard.writeText(y),a(!0),setTimeout(()=>a(!1),2e3)}catch(b){console.error("Failed to copy:",b)}},g=h&&f&&u.length>f?u.slice(0,f):u,_=h&&f&&u.length>f;return o.jsxs("div",{style:{background:"#ffffff",borderRadius:8,border:"1px solid #e5e7eb",overflow:"hidden"},children:[o.jsxs("button",{onClick:n,style:{width:"100%",padding:p?"10px 14px":"14px 18px",background:"#f9fafb",border:"none",borderBottom:t?"1px solid #e5e7eb":"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"left"},children:[o.jsxs("div",{children:[o.jsxs("h3",{style:{margin:0,fontSize:p?13:15,fontWeight:600,color:"#111827"},children:[c,_&&o.jsxs("span",{style:{fontWeight:400,color:"#6b7280",marginLeft:6},children:["(showing ",f," of ",u.length,")"]})]}),d&&!p&&o.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#6b7280"},children:d})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[o.jsx("button",{onClick:v,title:i?"Copied!":"Copy section",style:{padding:4,background:"none",border:"none",cursor:"pointer",color:i?"#10b981":"#9ca3af",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,transition:"color 0.2s"},children:i?o.jsx(fB,{size:14}):o.jsx(dB,{size:14})}),o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"#9ca3af",transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:o.jsx("path",{d:"M4 6l4 4 4-4"})})]})]}),t&&o.jsxs("div",{style:{padding:p?12:18},children:[g.map((x,y)=>cB(x,y)),_&&o.jsxs("div",{style:{marginTop:8,padding:"8px 12px",background:"#f3f4f6",borderRadius:4,fontSize:12,color:"#6b7280",textAlign:"center"},children:["+",u.length-f," more in full view"]})]})]})}function hB({title:e,content:t,reason:n}){return o.jsxs("div",{children:[o.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,marginBottom:16,fontSize:12,color:"#92400e"},children:["Displaying raw content (reason: ",n||"unknown",")"]}),o.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},onWheel:r=>r.stopPropagation(),children:o.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace"},children:JSON.stringify(t,null,2)})})]})}function mB({workflow:e,onClose:t,spawnedDocuments:n}){var s,i,a,l;m.useEffect(()=>{const c=d=>{d.key==="Escape"&&t()};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[t]);const r=((s=e==null?void 0:e.block)==null?void 0:s.data)||{};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-end",style:{background:"rgba(0,0,0,0.4)"},onClick:c=>c.target===c.currentTarget&&t(),children:o.jsxs("div",{className:"h-full w-full max-w-2xl flex flex-col shadow-2xl",style:{background:"#ffffff"},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-base font-semibold",style:{color:"#1e293b"},children:"Workflow Audit"}),o.jsx("p",{className:"text-sm",style:{color:"#64748b"},children:e.name})]}),o.jsx("button",{onClick:t,className:"p-1.5 rounded hover:bg-gray-200 transition-colors",children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),o.jsxs("div",{className:"flex-1 overflow-auto p-4",style:{background:"#f8fafc"},onWheel:c=>c.stopPropagation(),children:[o.jsxs("div",{className:"mb-4 flex gap-4",children:[o.jsx(pg,{label:"Nodes",value:((i=r.nodes)==null?void 0:i.length)||((a=r.steps)==null?void 0:a.length)||0}),o.jsx(pg,{label:"Edges",value:((l=r.edges)==null?void 0:l.length)||0}),r.trigger&&o.jsx(pg,{label:"Trigger",value:r.trigger,isText:!0})]}),(r.nodes||r.steps)&&o.jsxs("div",{className:"mb-4",children:[o.jsx("h4",{className:"text-sm font-semibold mb-2",style:{color:"#475569"},children:r.nodes?"Nodes":"Steps"}),o.jsx("div",{className:"rounded border overflow-hidden",style:{borderColor:"#e2e8f0"},children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{style:{background:"#f1f5f9"},children:[o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"ID"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Type"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Station"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Label"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Actor"})]})}),o.jsx("tbody",{children:(r.nodes||r.steps).map((c,d)=>o.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[o.jsx("td",{className:"px-3 py-2 font-mono text-xs",style:{color:"#6366f1"},children:c.node_id||`step_${d+1}`}),o.jsx("td",{className:"px-3 py-2",children:o.jsx(nS,{type:c.type||"action"})}),o.jsx("td",{className:"px-3 py-2",children:c.station?o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium rounded",style:{background:"#f0fdf4",color:"#166534"},children:c.station.label}):"-"}),o.jsx("td",{className:"px-3 py-2",style:{color:"#1e293b"},children:c.label||c.action||"-"}),o.jsx("td",{className:"px-3 py-2",style:{color:"#64748b"},children:c.actor||"-"})]},c.node_id||d))})]})})]}),r.edges&&r.edges.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsx("h4",{className:"text-sm font-semibold mb-2",style:{color:"#475569"},children:"Edges"}),o.jsx("div",{className:"rounded border overflow-hidden",style:{borderColor:"#e2e8f0"},children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{style:{background:"#f1f5f9"},children:[o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"From"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"To"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Type"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Label"})]})}),o.jsx("tbody",{children:r.edges.map((c,d)=>o.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[o.jsx("td",{className:"px-3 py-2 font-mono text-xs",style:{color:"#6366f1"},children:c.from_node_id}),o.jsx("td",{className:"px-3 py-2 font-mono text-xs",style:{color:"#6366f1"},children:c.to_node_id}),o.jsx("td",{className:"px-3 py-2",children:o.jsx(gB,{type:c.type||"normal"})}),o.jsx("td",{className:"px-3 py-2",style:{color:"#64748b"},children:c.label||"-"})]},c.edge_id||d))})]})})]}),n&&n.length>0&&o.jsxs("div",{className:"mb-4",children:[o.jsx("h4",{className:"text-sm font-semibold mb-2",style:{color:"#475569"},children:"Spawned Documents"}),o.jsx("div",{className:"rounded border overflow-hidden",style:{borderColor:"#e2e8f0"},children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{style:{background:"#f1f5f9"},children:[o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Idempotency Key"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Type"}),o.jsx("th",{className:"px-3 py-2 text-left font-medium",style:{color:"#64748b"},children:"Title"})]})}),o.jsx("tbody",{children:n.map((c,d)=>o.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[o.jsx("td",{className:"px-3 py-2 font-mono text-xs",style:{color:"#6366f1"},children:c.instance_id||"-"}),o.jsx("td",{className:"px-3 py-2",children:o.jsx(nS,{type:c.doc_type_id||"epic"})}),o.jsx("td",{className:"px-3 py-2",style:{color:"#1e293b"},children:c.title||c.name||"-"})]},c.instance_id||d))})]})})]}),o.jsxs("details",{className:"rounded border",style:{borderColor:"#e2e8f0"},children:[o.jsx("summary",{className:"px-3 py-2 cursor-pointer text-sm font-medium",style:{background:"#f1f5f9",color:"#64748b"},children:"Raw JSON"}),o.jsx("div",{className:"p-3 overflow-auto",style:{background:"#ffffff"},children:o.jsx("pre",{className:"text-xs font-mono whitespace-pre-wrap",style:{color:"#374151",lineHeight:1.5},children:JSON.stringify(r,null,2)})})]})]})]})})}function pg({label:e,value:t,isText:n=!1}){return o.jsxs("div",{className:"px-3 py-1.5 rounded",style:{background:"#e0e7ff",color:"#4338ca"},children:[o.jsxs("span",{className:"text-xs font-medium",children:[e,": "]}),o.jsx("span",{className:`text-sm font-semibold ${n?"":"tabular-nums"}`,children:t})]})}function nS({type:e}){const t={start:{bg:"#dcfce7",color:"#166534"},end:{bg:"#fee2e2",color:"#991b1b"},action:{bg:"#dbeafe",color:"#1e40af"},gate:{bg:"#fef3c7",color:"#92400e"},decision:{bg:"#fef3c7",color:"#92400e"},error:{bg:"#fee2e2",color:"#991b1b"}},n=t[e]||t.action;return o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium rounded",style:{background:n.bg,color:n.color},children:e})}function gB({type:e}){const t={normal:{bg:"#f1f5f9",color:"#64748b"},error:{bg:"#fee2e2",color:"#991b1b"},retry:{bg:"#fef3c7",color:"#92400e"},conditional:{bg:"#e0e7ff",color:"#4338ca"}},n=t[e]||t.normal;return o.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium rounded",style:{background:n.bg,color:n.color},children:e})}const xB={archWorkflowNode:K4},vB=300,yB=140;function bB(e){if(!Array.isArray(e)||e.length===0)return{nodes:[],edges:[]};const n=[...e].sort((s,i)=>(s.step||s.order||0)-(i.step||i.order||0)).map((s,i)=>({...s,node_id:`step_${i+1}`,type:s.type||"action",label:s.action||s.label||`Step ${i+1}`})),r=[];for(let s=0;s<n.length-1;s++)r.push({edge_id:`e_${s+1}_${s+2}`,from_node_id:n[s].node_id,to_node_id:n[s+1].node_id,type:"normal"});return{nodes:n,edges:r}}function _B(e,t,n=!1){const r=e.map(a=>{const l=jc[a.type]||jc.action;return{id:a.node_id,type:"archWorkflowNode",position:{x:0,y:0},data:{...a,config:l,showLineage:n}}}),s=t.map(a=>{const l=a.type||"normal",c=Sc[l]||Sc.normal;return{id:a.edge_id,source:a.from_node_id,target:a.to_node_id,type:"smoothstep",animated:c.animated||!1,label:a.label,style:{stroke:c.stroke,strokeWidth:c.strokeWidth,strokeDasharray:c.strokeDasharray},labelStyle:{fontSize:10,fill:"var(--text-muted, #64748b)"},labelBgStyle:{fill:"var(--bg-panel, #ffffff)",fillOpacity:.9},markerEnd:{type:"arrowclosed",color:c.stroke}}});return{nodes:wc(r,s,"TB",vB,yB),edges:s}}function wB({workflows:e}){var u;const[t,n]=m.useState(((u=e[0])==null?void 0:u.id)||null),[r,s]=m.useState(!1),[i,a]=m.useState(!1),l=e.find(f=>f.id===t),c=m.useMemo(()=>{var _;if(!((_=l==null?void 0:l.block)!=null&&_.data))return null;const f=l.block.data,p=Array.isArray(f.nodes)&&f.nodes.length>0,h=Array.isArray(f.steps)&&f.steps.length>0;let v,g;if(p)v=f.nodes,g=f.edges||[];else if(h){const x=bB(f.steps);v=x.nodes,g=x.edges}else return null;return _B(v,g,r)},[l,r]),d=f=>{const p=e.findIndex(h=>h.id===t);f.key==="ArrowDown"&&p<e.length-1?(f.preventDefault(),n(e[p+1].id)):f.key==="ArrowUp"&&p>0&&(f.preventDefault(),n(e[p-1].id))};return o.jsxs("div",{className:"flex h-full",onKeyDown:d,tabIndex:0,children:[o.jsx("div",{className:"flex-shrink-0 border-r overflow-y-auto",style:{width:220,background:"#f8fafc",borderColor:"#e2e8f0"},onWheel:f=>f.stopPropagation(),children:o.jsxs("div",{className:"p-3",children:[o.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wider mb-2",style:{color:"#64748b"},children:["Workflows (",e.length,")"]}),e.map(f=>{const p=f.id===t;return o.jsxs("button",{onClick:()=>n(f.id),className:"w-full text-left p-2.5 rounded-md mb-1 transition-colors",style:{background:p?"#eef2ff":"transparent",borderLeft:p?"3px solid #4f46e5":"3px solid transparent"},children:[o.jsx("div",{className:"text-sm font-medium truncate",style:{color:p?"#4f46e5":"#1e293b"},children:f.name}),o.jsxs("div",{className:"text-xs mt-0.5",style:{color:"#64748b"},children:[f.nodeCount," steps"]})]},f.id)})]})}),o.jsx("div",{className:"flex-1 flex flex-col min-w-0",children:l?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex-shrink-0 px-4 py-3 border-b",style:{borderColor:"#e2e8f0"},children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold",style:{color:"#1e293b"},children:l.name}),l.description&&o.jsx("p",{className:"text-sm mt-0.5",style:{color:"#64748b"},children:l.description}),l.trigger&&o.jsxs("p",{className:"text-sm mt-1 italic",style:{color:"#9ca3af"},children:["Trigger: ",l.trigger]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>s(f=>!f),className:"px-3 py-1.5 text-xs font-medium rounded transition-colors",style:{background:r?"#eef2ff":"#f1f5f9",color:r?"#4f46e5":"#64748b",border:`1px solid ${r?"#c7d2fe":"#e2e8f0"}`},children:r?"Hide Lineage":"Show Lineage"}),o.jsx("button",{onClick:()=>a(!0),className:"px-3 py-1.5 text-xs font-medium rounded transition-colors",style:{background:"#f1f5f9",color:"#64748b",border:"1px solid #e2e8f0"},children:"Audit"})]})]})}),o.jsx("div",{className:"flex-1 min-h-0",style:{background:"#ffffff"},children:c&&c.nodes.length>0?o.jsx(Ii,{children:o.jsx(wa,{nodes:c.nodes,edges:c.edges,nodeTypes:xB,nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!1,panOnScroll:!0,zoomOnScroll:!0,fitView:!0,fitViewOptions:{padding:.15},proOptions:{hideAttribution:!0},minZoom:.2,maxZoom:2})}):o.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"#9ca3af"},children:"No workflow steps defined"})})]}):o.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"#9ca3af"},children:"Select a workflow from the list"})}),i&&l&&o.jsx(mB,{workflow:l,onClose:()=>a(!1)})]})}function jB({components:e}){var a,l,c,d;const[t,n]=m.useState(((a=e[0])==null?void 0:a.id)||null),r=e.find(u=>u.id===t),s=u=>{const f=e.findIndex(p=>p.id===t);u.key==="ArrowDown"&&f<e.length-1?(u.preventDefault(),n(e[f+1].id)):u.key==="ArrowUp"&&f>0&&(u.preventDefault(),n(e[f-1].id))},i=(u,f)=>({fontSize:12,padding:"3px 10px",background:u,color:f,borderRadius:4,fontWeight:500});return o.jsxs("div",{className:"flex h-full",onKeyDown:s,tabIndex:0,children:[o.jsx("div",{className:"flex-shrink-0 border-r overflow-y-auto",style:{width:220,background:"#f8fafc",borderColor:"#e2e8f0"},onWheel:u=>u.stopPropagation(),children:o.jsxs("div",{className:"p-3",children:[o.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wider mb-2",style:{color:"#64748b"},children:["Components (",e.length,")"]}),e.map(u=>{const f=u.id===t;return o.jsxs("button",{onClick:()=>n(u.id),className:"w-full text-left p-2.5 rounded-md mb-1 transition-colors",style:{background:f?"#eef2ff":"transparent",borderLeft:f?"3px solid #4f46e5":"3px solid transparent"},children:[o.jsx("div",{className:"text-sm font-medium truncate",style:{color:f?"#4f46e5":"#1e293b"},children:u.name}),u.layer&&o.jsx("div",{className:"text-xs mt-0.5",style:{color:"#64748b"},children:u.layer})]},u.id)})]})}),o.jsx("div",{className:"flex-1 flex flex-col min-w-0 overflow-y-auto",onWheel:u=>u.stopPropagation(),children:r?o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("h2",{className:"text-xl font-semibold",style:{color:"#1e293b"},children:r.name}),r.layer&&o.jsx("span",{style:i("#f0fdf4","#166534"),children:r.layer}),r.mvpPhase&&o.jsx("span",{style:i("#eff6ff","#1e40af"),children:r.mvpPhase})]}),r.purpose&&o.jsx("p",{className:"text-base",style:{color:"#475569",lineHeight:1.6},children:r.purpose})]}),r.technology&&o.jsx(ll,{title:"Technology",children:o.jsx("p",{style:{color:"#374151",fontSize:14},children:r.technology})}),((l=r.responsibilities)==null?void 0:l.length)>0&&o.jsx(ll,{title:"Responsibilities",children:o.jsx("ul",{className:"list-disc pl-5 space-y-1",children:r.responsibilities.map((u,f)=>o.jsx("li",{style:{color:"#374151",fontSize:14},children:u},f))})}),((c=r.interfaces)==null?void 0:c.length)>0&&o.jsx(ll,{title:"Interfaces",children:o.jsx("div",{className:"flex flex-wrap gap-2",children:r.interfaces.map((u,f)=>o.jsx("span",{style:i("#e0e7ff","#3730a3"),children:u},f))})}),((d=r.dependencies)==null?void 0:d.length)>0&&o.jsx(ll,{title:"Dependencies",children:o.jsx("div",{className:"flex flex-wrap gap-2",children:r.dependencies.map((u,f)=>o.jsx("span",{style:i("#fef3c7","#92400e"),children:u},f))})})]}):o.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"#9ca3af"},children:"Select a component from the list"})})]})}function ll({title:e,children:t}){return o.jsxs("div",{className:"mb-5",children:[o.jsx("div",{className:"text-xs font-semibold uppercase tracking-wider mb-2",style:{color:"#6b7280"},children:e}),t]})}const SB=new Set(["data_model","data_models"]),kB=new Set(["interfaces","api_interfaces"]),NB=new Set(["quality_attributes"]),CB=new Set(["workflows"]),EB=new Set(["components"]);function TB({renderModel:e,projectId:t,projectCode:n,docTypeId:r,executionId:s,onClose:i}){const[a,l]=m.useState("overview"),c=m.useMemo(()=>{const S={workflows:[],components:[],dataModels:[],interfaces:[],quality:[],overview:[]};return e!=null&&e.sections&&e.sections.forEach(k=>{const w=k.section_id;CB.has(w)?S.workflows.push(k):EB.has(w)?S.components.push(k):SB.has(w)?S.dataModels.push(k):kB.has(w)?S.interfaces.push(k):NB.has(w)?S.quality.push(k):S.overview.push(k)}),S},[e==null?void 0:e.sections]),d=m.useMemo(()=>{if(!c.workflows.length)return[];const S=c.workflows[0];return S!=null&&S.blocks?S.blocks.map((k,w)=>{var R,T,I,D,C,M,P;return{id:k.block_id||`wf-${w}`,name:((R=k.data)==null?void 0:R.name)||`Workflow ${w+1}`,description:(T=k.data)==null?void 0:T.description,trigger:(I=k.data)==null?void 0:I.trigger,nodeCount:((C=(D=k.data)==null?void 0:D.nodes)==null?void 0:C.length)||((P=(M=k.data)==null?void 0:M.steps)==null?void 0:P.length)||0,block:k}}):[]},[c.workflows]),u=m.useMemo(()=>{if(!c.components.length)return[];const S=c.components[0];return S!=null&&S.blocks?S.blocks.map((k,w)=>{const R=k.data||{};return{id:k.block_id||`comp-${w}`,name:R.name||`Component ${w+1}`,purpose:R.purpose,layer:R.layer,mvpPhase:R.mvp_phase,technology:R.technology||(Array.isArray(R.technology_choices)?R.technology_choices.join(", "):null),interfaces:R.interfaces||[],dependencies:R.dependencies||R.depends_on_components||[],responsibilities:R.responsibilities||[],block:k}}):[]},[c.components]),f=m.useMemo(()=>e?{...e,sections:c.overview}:null,[e,c.overview]),p=m.useMemo(()=>e?{...e,sections:c.dataModels}:null,[e,c.dataModels]),h=m.useMemo(()=>e?{...e,sections:c.interfaces}:null,[e,c.interfaces]),v=m.useMemo(()=>e?{...e,sections:c.quality}:null,[e,c.quality]),g=m.useMemo(()=>{var S,k,w,R,T,I;return[{id:"overview",label:"Overview",count:null,disabled:!1},{id:"components",label:"Components",count:u.length||null,disabled:!u.length},{id:"workflows",label:"Workflows",count:d.length||null,disabled:!d.length},{id:"dataModels",label:"Data Models",count:((k=(S=c.dataModels[0])==null?void 0:S.blocks)==null?void 0:k.length)||null,disabled:!c.dataModels.length},{id:"interfaces",label:"APIs",count:((R=(w=c.interfaces[0])==null?void 0:w.blocks)==null?void 0:R.length)||null,disabled:!c.interfaces.length},{id:"quality",label:"Quality",count:((I=(T=c.quality[0])==null?void 0:T.blocks)==null?void 0:I.length)||null,disabled:!c.quality.length}]},[u,d,c]),_=(e==null?void 0:e.metadata)||{},x=s?`/admin/executions/${s}`:"/admin/executions",y=(()=>{const S=(e==null?void 0:e.title)||"Document",k=S.indexOf(": ");return k>-1?S.slice(k+2):S})(),b=S=>{if(!S)return null;try{return new Date(S).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return null}},j=b(_.created_at),N=b(_.updated_at),E=_.lifecycle_state;return o.jsxs("div",{className:"flex flex-col h-full",style:{background:"#ffffff"},children:[o.jsxs("div",{className:"px-5 py-3 border-b",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:[o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",style:{marginBottom:4},children:[n&&o.jsx("a",{href:x,target:"_blank",rel:"noopener noreferrer",title:s?`View execution ${s}`:"Open Admin Executions",style:{padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em",textDecoration:"none",cursor:"pointer"},children:n}),o.jsx("span",{style:{padding:"2px 8px",background:"#eef2ff",color:"#4f46e5",fontSize:11,fontWeight:600,borderRadius:4},children:"Technical Architecture"}),E&&o.jsx("span",{style:{padding:"2px 8px",background:E==="complete"?"#dcfce7":"#fef3c7",color:E==="complete"?"#166534":"#92400e",fontSize:11,fontWeight:600,borderRadius:4},children:E})]}),o.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700,color:"#111827",lineHeight:1.3},children:y}),j&&o.jsxs("div",{style:{marginTop:2,fontSize:12,color:"#9ca3af"},children:["Generated ",j,N&&N!==j&&o.jsxs("span",{children:["  Updated ",N]})]})]}),o.jsx("div",{className:"flex items-center gap-1 px-4 border-b",style:{background:"#ffffff",borderColor:"#e2e8f0",minHeight:40},children:g.map(S=>{const k=a===S.id;return o.jsxs("button",{onClick:()=>!S.disabled&&l(S.id),disabled:S.disabled,className:"relative px-4 py-2 text-sm font-medium transition-colors",style:{color:k?"#4f46e5":S.disabled?"#9ca3af":"#64748b",background:"transparent",border:"none",cursor:S.disabled?"not-allowed":"pointer"},children:[S.label,S.count!==null&&o.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 text-xs rounded-full",style:{background:k?"#eef2ff":"#f1f5f9",color:k?"#4f46e5":"#64748b"},children:S.count}),k&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{background:"#4f46e5"}})]},S.id)})}),o.jsx("div",{className:"flex-1 overflow-hidden",style:{minHeight:0},children:a==="workflows"&&d.length>0?o.jsx(wB,{workflows:d}):a==="components"&&u.length>0?o.jsx(jB,{components:u}):a==="dataModels"?o.jsx(cl,{renderModel:p,sections:c.dataModels}):a==="interfaces"?o.jsx(cl,{renderModel:h,sections:c.interfaces}):a==="quality"?o.jsx(cl,{renderModel:v,sections:c.quality}):o.jsx(cl,{renderModel:f,sections:c.overview})},a)]})}function cl({renderModel:e,sections:t}){return o.jsx("div",{className:"h-full overflow-y-auto p-6",onWheel:n=>n.stopPropagation(),children:e&&t.length>0?o.jsx(Y4,{renderModel:e,variant:"full",hideHeader:!0}):o.jsx("div",{className:"text-center py-12 text-gray-500",children:"No content available for this tab"})})}function RB({projectId:e,projectCode:t,docTypeId:n,instanceId:r,onClose:s}){var S,k,w;const[i,a]=m.useState(null),[l,c]=m.useState(null),[d,u]=m.useState({}),[f,p]=m.useState(null),[h,v]=m.useState(null),[g,_]=m.useState(!0),[x,y]=m.useState(null);if(m.useEffect(()=>{async function R(){var T;try{_(!0),y(null),Ke.getDocumentPgc(e,n,r).then(D=>{D!=null&&D.has_pgc&&v(D)}).catch(()=>{});try{const D=await Ke.getDocumentRenderModel(e,n,r);if(D!=null&&D.metadata&&u(D.metadata),D!=null&&D.title&&p(D.title),D&&D.sections&&D.sections.length>0){a(D),c(null);return}if((T=D==null?void 0:D.metadata)!=null&&T.fallback&&D.raw_content){a(null),c(D.raw_content);return}}catch(D){console.log("RenderModel not available, falling back to raw document:",D.message)}const I=await Ke.getDocument(e,n,r);a(null),c((I==null?void 0:I.content)||null)}catch(I){y(I.message),console.error("Failed to fetch document:",I)}finally{_(!1)}}R()},[e,n,r]),m.useEffect(()=>{const R=T=>{T.key==="Escape"&&s()};return window.addEventListener("keydown",R),()=>window.removeEventListener("keydown",R)},[s]),g)return o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},children:o.jsx("div",{style:{color:"white",fontSize:14},children:"Loading..."})});const b=(i==null?void 0:i.metadata)||d,j=b.execution_id,N=j?`/admin/executions/${j}`:"/admin/executions";return n==="technical_architecture"&&i?o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:R=>R.target===R.currentTarget&&s(),children:o.jsxs("div",{className:"relative w-full max-w-6xl h-[90vh] overflow-hidden rounded-lg shadow-2xl flex flex-col",style:{background:"#ffffff"},children:[o.jsx("button",{onClick:s,className:"absolute top-2 right-3 z-10 p-1.5 rounded-lg hover:bg-gray-200 transition-colors",style:{background:"rgba(255,255,255,0.9)"},children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})}),o.jsx(TB,{renderModel:i,projectId:e,projectCode:t,docTypeId:n,executionId:j,pgcContext:h,onClose:s})]})}):o.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center",style:{background:"rgba(0,0,0,0.8)"},onClick:R=>R.target===R.currentTarget&&s(),children:o.jsxs("div",{className:"relative w-full max-w-4xl max-h-[90vh] overflow-hidden rounded-lg shadow-2xl",style:{background:"#ffffff"},children:[o.jsx(AB,{title:(i==null?void 0:i.title)||f,projectCode:t,adminUrl:N,executionId:j,metadata:b,onClose:s}),((S=b==null?void 0:b.spawned_children)==null?void 0:S.count)>0&&o.jsx(IB,{children:b.spawned_children}),o.jsxs("div",{className:"overflow-y-auto p-6",style:{maxHeight:((k=b==null?void 0:b.spawned_children)==null?void 0:k.count)>0?"calc(90vh - 130px)":"calc(90vh - 80px)"},onWheel:R=>R.stopPropagation(),children:[x&&o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{className:"text-red-500",children:x})}),i&&o.jsx(Y4,{renderModel:i,variant:"full",hideHeader:!0}),l&&!i&&o.jsx(PB,{content:l,docTypeId:n}),!i&&!l&&!x&&o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{className:"text-gray-500",children:"No content available"})}),h&&((w=h.clarifications)==null?void 0:w.length)>0&&o.jsx(LB,{pgcContext:h})]})]})})}function AB({title:e,projectCode:t,adminUrl:n,executionId:r,metadata:s,onClose:i}){const a=(()=>{if(!e)return"Document";const h=e.indexOf(": ");return h>-1?e.slice(h+2):e})(),l=(s==null?void 0:s.document_type_name)||(s!=null&&s.document_type?s.document_type.replace(/_/g," ").replace(/\b\w/g,h=>h.toUpperCase()):null),c=h=>{if(!h)return null;try{return new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return null}},d=c(s==null?void 0:s.created_at),u=c(s==null?void 0:s.updated_at),f=s==null?void 0:s.version,p=s==null?void 0:s.lifecycle_state;return o.jsx("div",{className:"sticky top-0 px-6 py-4 border-b",style:{background:"#f8fafc",borderColor:"#e2e8f0"},children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{style:{flex:1,minWidth:0},children:[o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",style:{marginBottom:6},children:[t&&o.jsx("a",{href:n,target:"_blank",rel:"noopener noreferrer",title:r?`View execution ${r}`:"Open Admin Executions",style:{padding:"2px 8px",background:"#10b981",color:"white",fontSize:11,fontWeight:600,borderRadius:4,letterSpacing:"0.05em",textDecoration:"none",cursor:"pointer"},children:t}),l&&o.jsx("span",{style:{padding:"2px 8px",background:"#eef2ff",color:"#4f46e5",fontSize:11,fontWeight:600,borderRadius:4},children:l}),p&&o.jsx("span",{style:{padding:"2px 8px",background:p==="complete"?"#dcfce7":"#fef3c7",color:p==="complete"?"#166534":"#92400e",fontSize:11,fontWeight:600,borderRadius:4},children:p}),f&&f>1&&o.jsxs("span",{style:{padding:"2px 8px",background:"#f3f4f6",color:"#6b7280",fontSize:11,fontWeight:600,borderRadius:4},children:["v",f]})]}),o.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"#111827",lineHeight:1.3},children:a}),d&&o.jsxs("div",{style:{marginTop:4,fontSize:12,color:"#9ca3af"},children:["Generated ",d,u&&u!==d&&o.jsxs("span",{children:["  Updated ",u]})]})]}),o.jsx("button",{onClick:i,className:"p-2 rounded-lg hover:bg-gray-200 transition-colors",style:{flexShrink:0,marginLeft:12},children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]})})}function IB({children:e}){const{count:t,items:n}=e;return o.jsxs("div",{className:"flex items-center gap-3 flex-wrap px-6 py-3",style:{background:"#f0fdf4",borderBottom:"1px solid #bbf7d0"},children:[o.jsxs("span",{style:{fontSize:13,color:"#166534",fontWeight:600},children:["This plan produced ",t," Epic document",t!==1?"s":""]}),o.jsx("div",{className:"flex items-center gap-1.5 flex-wrap",children:n.map(r=>o.jsx("span",{title:r.title||r.name,style:{padding:"2px 8px",background:"#dcfce7",color:"#15803d",fontSize:11,fontWeight:500,borderRadius:4,whiteSpace:"nowrap"},children:r.name||r.epic_id},r.epic_id))})]})}function PB({content:e,docTypeId:t}){if(!e)return o.jsx("p",{className:"text-gray-500",children:"No content available"});const n=e.project_name||e.title||e.name,r={preliminary_summary:{title:"Summary",icon:"S",color:"#7c3aed",render:"summary"},stakeholder_questions:{title:"Stakeholder Questions",icon:"?",color:"#dc2626",render:"questions"},unknowns:{title:"Unknowns to Resolve",icon:"?",color:"#d97706"},early_decision_points:{title:"Early Decision Points",icon:"D",color:"#7c3aed"},risks:{title:"Risks",icon:"!",color:"#dc2626"},known_constraints:{title:"Known Constraints",icon:"C",color:"#6b7280"},assumptions:{title:"Assumptions",icon:"A",color:"#d97706"},mvp_guardrails:{title:"MVP Guardrails",icon:"G",color:"#059669"},recommendations_for_pm:{title:"Recommendations for PM",icon:"R",color:"#2563eb"},pgc_clarifications:{title:"PGC Clarifications",icon:"Q",color:"#7c3aed",render:"clarifications"}},s=new Set(["project_name","title","name","meta","description","summary"]),i=Object.keys(e).filter(l=>!s.has(l)&&(Array.isArray(e[l])||typeof e[l]=="object"&&e[l]!==null));return i.length>0?o.jsxs("div",{className:"space-y-6",children:[n&&o.jsxs("div",{style:{borderBottom:"2px solid #7c3aed",paddingBottom:12},children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:n}),o.jsx("span",{className:"text-xs font-mono text-gray-400",children:t})]}),Object.entries(r).map(([l,c])=>{const d=e[l];return d?c.render==="summary"&&typeof d=="object"&&!Array.isArray(d)?o.jsx(MB,{data:d,config:c},l):c.render==="questions"&&Array.isArray(d)?o.jsx(OB,{data:d,config:c},l):c.render==="clarifications"&&Array.isArray(d)?o.jsx(DB,{data:d,config:c},l):Array.isArray(d)?o.jsx(iS,{data:d,config:c},l):null:null}),i.filter(l=>!r[l]).map(l=>{const c=e[l];return Array.isArray(c)?o.jsx(iS,{data:c,config:{title:oa(l),icon:"#",color:"#6b7280"}},l):typeof c=="object"&&c!==null?o.jsx(FB,{data:c,label:oa(l)},l):null}),o.jsxs("details",{style:{borderRadius:8,border:"1px solid #e2e8f0"},children:[o.jsx("summary",{style:{padding:"12px 16px",cursor:"pointer",fontSize:13,fontWeight:600,color:"#6b7280",background:"#f8fafc",borderRadius:8},children:"Raw Data (JSON)"}),o.jsx("div",{style:{padding:16,overflow:"auto"},children:o.jsx("pre",{style:{margin:0,fontSize:11,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.5},children:JSON.stringify(e,null,2)})})]})]}):o.jsx($B,{content:e,docTypeId:t,title:n})}function MB({data:e,config:t}){const n=[{key:"problem_understanding",label:"Problem Understanding"},{key:"architectural_intent",label:"Architectural Intent"},{key:"proposed_system_shape",label:"Proposed System Shape"}];return o.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[o.jsx(ku,{config:t}),o.jsxs("div",{style:{padding:16},className:"space-y-3",children:[n.map(r=>e[r.key]?o.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:r.label}),o.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,lineHeight:1.6},children:e[r.key]})]},r.key):null),Object.entries(e).filter(([r])=>!n.some(s=>s.key===r)).map(([r,s])=>typeof s=="string"?o.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:oa(r)}),o.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,lineHeight:1.6},children:s})]},r):null)]})]})}function OB({data:e,config:t}){const n=e.filter(s=>s.blocking),r=e.filter(s=>!s.blocking);return o.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[o.jsx(ku,{config:t,count:e.length}),o.jsxs("div",{style:{padding:16},className:"space-y-3",children:[n.length>0&&o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#dc2626",marginBottom:8,textTransform:"uppercase"},children:"Blocking"}),n.map((s,i)=>o.jsx(rS,{q:s,borderColor:"#dc2626"},s.id||i))]}),r.length>0&&o.jsxs("div",{children:[n.length>0&&o.jsx("div",{style:{fontSize:11,fontWeight:700,color:"#6b7280",marginBottom:8,textTransform:"uppercase"},children:"Non-blocking"}),r.map((s,i)=>o.jsx(rS,{q:s,borderColor:"#d1d5db"},s.id||i))]})]})]})}function rS({q:e,borderColor:t}){return o.jsxs("div",{style:{borderLeft:`3px solid ${t}`,paddingLeft:12,marginBottom:8},children:[o.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2},children:[e.id&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:e.id}),e.directed_to&&o.jsx("span",{style:{fontSize:11,padding:"1px 6px",background:"#f3f4f6",borderRadius:4,color:"#6b7280"},children:e.directed_to.replace(/_/g," ")})]}),o.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:0,fontWeight:500},children:e.question||e.text||qB(e)}),e.notes&&o.jsx("p",{style:{fontSize:12,color:"#6b7280",margin:"4px 0 0"},children:e.notes})]})}function DB({data:e,config:t}){const n={exclusion:{bg:"#fee2e2",color:"#991b1b"},requirement:{bg:"#dbeafe",color:"#1e40af"},selection:{bg:"#f3f4f6",color:"#4b5563"},preference:{bg:"#f0fdf4",color:"#166534"}};return o.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[o.jsx(ku,{config:t,count:e.length}),o.jsx("div",{style:{padding:16},className:"space-y-3",children:e.map((r,s)=>{const i=n[r.constraint_kind]||n.selection;return o.jsxs("div",{style:{borderLeft:`3px solid ${t.color}`,paddingLeft:12,marginBottom:8},children:[o.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2,flexWrap:"wrap"},children:[r.question_id&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:r.question_id}),r.binding&&o.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:"#dbeafe",color:"#1e40af",borderRadius:4,fontWeight:600},children:"BINDING"}),r.constraint_kind&&o.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:i.bg,color:i.color,borderRadius:4},children:r.constraint_kind}),r.binding_source&&o.jsxs("span",{style:{fontSize:10,color:"#9ca3af"},children:["via ",r.binding_source]})]}),o.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:"2px 0",fontWeight:500},children:r.question}),r.why_it_matters&&o.jsx("p",{style:{fontSize:12,color:"#6b7280",margin:"4px 0",fontStyle:"italic"},children:r.why_it_matters}),r.answer&&o.jsxs("div",{style:{marginTop:4,display:"flex",alignItems:"baseline",gap:6},children:[o.jsx("span",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Answer:"}),o.jsx("span",{style:{fontSize:13,color:"#059669",fontWeight:500},children:r.answer})]})]},r.question_id||s)})})]})}function LB({pgcContext:e}){const{clarifications:t}=e,n=t.filter(s=>s.binding),r=t.filter(s=>!s.binding);return o.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8,marginTop:24},children:[o.jsxs("div",{className:"flex items-center gap-2",style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0"},children:[o.jsx("span",{style:{width:24,height:24,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700,background:"#7c3aed15",color:"#7c3aed"},children:"Q"}),o.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1f2937"},children:"Pre-Generation Clarifications"}),o.jsx("span",{style:{marginLeft:"auto",fontSize:12,color:"#9ca3af"},children:t.length})]}),o.jsxs("div",{style:{padding:16},className:"space-y-4",children:[n.length>0&&o.jsxs("div",{children:[o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#1e40af",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:["Binding Constraints (",n.length,")"]}),n.map((s,i)=>o.jsx(sS,{item:s},s.question_id||i))]}),r.length>0&&o.jsxs("div",{children:[n.length>0&&o.jsxs("div",{style:{fontSize:11,fontWeight:700,color:"#6b7280",marginBottom:8,marginTop:12,textTransform:"uppercase",letterSpacing:"0.05em"},children:["Informational (",r.length,")"]}),r.map((s,i)=>o.jsx(sS,{item:s},s.question_id||i))]})]})]})}function sS({item:e}){const t={exclusion:{bg:"#fee2e2",color:"#991b1b"},requirement:{bg:"#dbeafe",color:"#1e40af"},selection:{bg:"#f3f4f6",color:"#4b5563"},preference:{bg:"#f0fdf4",color:"#166534"}},n=t[e.constraint_kind]||t.selection;return o.jsxs("div",{style:{borderLeft:`3px solid ${e.binding?"#3b82f6":"#d1d5db"}`,paddingLeft:12,marginBottom:12},children:[o.jsxs("div",{className:"flex items-center gap-2",style:{marginBottom:2,flexWrap:"wrap"},children:[e.question_id&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:e.question_id}),e.binding&&o.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:"#dbeafe",color:"#1e40af",borderRadius:4,fontWeight:600},children:"BINDING"}),e.constraint_kind&&o.jsx("span",{style:{fontSize:10,padding:"1px 5px",background:n.bg,color:n.color,borderRadius:4},children:e.constraint_kind}),e.binding_source&&o.jsxs("span",{style:{fontSize:10,color:"#9ca3af"},children:["via ",e.binding_source]})]}),o.jsx("p",{style:{fontSize:14,color:"#1f2937",margin:"2px 0",fontWeight:500},children:e.question}),e.why_it_matters&&o.jsx("p",{style:{fontSize:12,color:"#6b7280",margin:"4px 0",fontStyle:"italic"},children:e.why_it_matters}),e.answer&&o.jsxs("div",{style:{marginTop:4,display:"flex",alignItems:"baseline",gap:6},children:[o.jsx("span",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Answer:"}),o.jsx("span",{style:{fontSize:13,color:"#059669",fontWeight:500},children:e.answer})]})]})}function iS({data:e,config:t}){return!e||e.length===0?null:o.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[o.jsx(ku,{config:t,count:e.length}),o.jsx("div",{style:{padding:16},children:o.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},className:"space-y-2",children:e.map((n,r)=>o.jsxs("li",{className:"flex items-start gap-2",style:{fontSize:14,color:"#374151"},children:[o.jsx("span",{style:{color:t.color,marginTop:2,flexShrink:0,fontSize:12},children:t.icon==="!"?"":""}),o.jsx("div",{style:{flex:1},children:typeof n=="string"?o.jsx("span",{children:n}):typeof n=="object"&&n!==null?o.jsx(zB,{item:n}):o.jsx("span",{children:String(n)})})]},typeof n=="object"&&n.id||r))})})]})}function zB({item:e}){const n=["constraint","assumption","guardrail","recommendation","description","question","text","statement","name","title"].find(h=>e[h]&&typeof e[h]=="string"),r=n?e[n]:null,s=e.id,i=e.confidence,a=e.constraint_type,l=e.validation_approach,c=e.impact_on_planning||e.impact_if_unresolved,d=e.mitigation_direction,u=e.likelihood,f=e.why_it_matters||e.why_early,p=e.recommendation_direction;return r?o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s&&o.jsx("span",{style:{fontFamily:"monospace",fontSize:11,color:"#9ca3af"},children:s}),o.jsx("span",{style:{fontWeight:500},children:r}),a&&o.jsx("span",{style:{fontSize:11,padding:"1px 6px",background:"#f3f4f6",borderRadius:4,color:"#6b7280"},children:a}),i&&o.jsx("span",{style:{fontSize:11,padding:"1px 6px",borderRadius:4,fontWeight:600,background:i==="high"?"#dcfce7":i==="medium"?"#fef3c7":"#fee2e2",color:i==="high"?"#166534":i==="medium"?"#92400e":"#991b1b"},children:i}),u&&o.jsxs("span",{style:{fontSize:11,padding:"1px 6px",background:"#fee2e2",borderRadius:4,color:"#991b1b"},children:[u,"/",e.impact||"?"]})]}),l&&o.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Validation: ",l]}),f&&o.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Why: ",f]}),c&&o.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Impact: ",c]}),d&&o.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"2px 0 0"},children:["Mitigation: ",d]}),p&&o.jsxs("p",{style:{fontSize:12,color:"#059669",margin:"2px 0 0"},children:["Recommendation: ",p]})]}):o.jsx("span",{style:{fontSize:13,color:"#374151"},children:Object.entries(e).map(([h,v],g)=>o.jsxs("span",{children:[g>0&&"  ",o.jsxs("span",{style:{fontWeight:500},children:[oa(h),":"]})," ",typeof v=="string"?v:JSON.stringify(v)]},h))})}function FB({data:e,label:t}){return o.jsxs("div",{style:{background:"#fff",border:"1px solid #e2e8f0",borderRadius:8},children:[o.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0",fontWeight:600,fontSize:14,color:"#1f2937"},children:t}),o.jsx("div",{style:{padding:16},children:Object.entries(e).map(([n,r])=>o.jsxs("div",{style:{marginBottom:8},children:[o.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#6b7280",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:oa(n)}),o.jsx("div",{style:{fontSize:14,color:"#1f2937"},children:typeof r=="string"?r:typeof r=="object"?JSON.stringify(r,null,2):String(r)})]},n))})]})}function ku({config:e,count:t}){return o.jsxs("div",{className:"flex items-center gap-2",style:{padding:"12px 16px",borderBottom:"1px solid #e2e8f0"},children:[o.jsx("span",{style:{width:24,height:24,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,fontWeight:700,background:`${e.color}15`,color:e.color},children:e.icon}),o.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"#1f2937"},children:e.title}),t!==void 0&&o.jsx("span",{style:{marginLeft:"auto",fontSize:12,color:"#9ca3af"},children:t})]})}function $B({content:e,docTypeId:t,title:n}){return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:13,color:"#92400e"},children:["No view definition configured for ",o.jsx("strong",{children:t})," - displaying raw content"]}),n&&o.jsx("div",{style:{padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:o.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n})}),o.jsx("div",{style:{background:"#f8fafc",borderRadius:8,padding:16,overflow:"auto"},onWheel:r=>r.stopPropagation(),children:o.jsx("pre",{style:{margin:0,fontSize:12,color:"#374151",whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"monospace",lineHeight:1.6},children:JSON.stringify(e,null,2)})})]})}function qB(e){if(typeof e=="string")return e;if(typeof e!="object"||e===null)return String(e);for(const t of Object.values(e))if(typeof t=="string"&&t.length>10)return t;return JSON.stringify(e)}function oa(e){return e.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}const BB="/api/v1/admin";class WB extends Error{constructor(t,n,r){super(t),this.name="AdminApiError",this.status=n,this.data=r,this.errorCode=r==null?void 0:r.error_code}}function HB(){const e=document.cookie.match(/(?:^|;\s*)csrf=([^;]*)/);return e?decodeURIComponent(e[1]):null}async function Re(e,t={}){var i;const n=`${BB}${e}`,r={headers:{"Content-Type":"application/json",...t.headers},credentials:"same-origin",...t};if(t.method&&t.method!=="GET"){const a=HB();a&&(r.headers["X-CSRF-Token"]=a)}const s=await fetch(n,r);if(!s.ok){const a=await s.json().catch(()=>({})),l=((i=a.detail)==null?void 0:i.message)||a.detail||`Request failed: ${s.status}`;throw new WB(l,s.status,a.detail||a)}return s.status===204?null:s.json()}const _e={getCurrentWorkspace:async()=>{try{return await Re("/workspaces/current")}catch(e){if(e.status===404&&e.errorCode==="NO_WORKSPACE")return null;throw e}},createWorkspace:()=>Re("/workspaces",{method:"POST"}),getWorkspaceState:e=>Re(`/workspaces/${e}/state`),closeWorkspace:(e,t=!1)=>Re(`/workspaces/${e}?force=${t}`,{method:"DELETE"}),getArtifact:(e,t)=>Re(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`),writeArtifact:(e,t,n)=>Re(`/workspaces/${e}/artifacts/${encodeURIComponent(t)}`,{method:"PUT",body:JSON.stringify({content:n})}),getPreview:(e,t,n="execution")=>Re(`/workspaces/${e}/preview/${encodeURIComponent(t)}?mode=${n}`),getDiff:(e,t=null)=>{const n=t?`?artifact_id=${encodeURIComponent(t)}`:"";return Re(`/workspaces/${e}/diff${n}`)},commit:(e,t)=>Re(`/workspaces/${e}/commit`,{method:"POST",body:JSON.stringify({message:t})}),discard:e=>Re(`/workspaces/${e}/discard`,{method:"POST"}),getDocumentTypes:()=>Re("/workbench/document-types"),getDocumentType:(e,t=null)=>{const n=t?`?version=${t}`:"";return Re(`/workbench/document-types/${e}${n}`)},getDocumentTypeVersions:e=>Re(`/workbench/document-types/${e}/versions`),getPromptFragments:()=>Re("/workbench/prompt-fragments"),getRoles:()=>Re("/workbench/roles"),getTemplates:()=>Re("/workbench/templates"),getSchemas:()=>Re("/workbench/schemas"),getSchema:(e,t=null)=>{const n=t?`?version=${t}`:"";return Re(`/workbench/schemas/${e}${n}`)},getRole:(e,t=null)=>{const n=t?`?version=${t}`:"";return Re(`/workbench/roles/${e}${n}`)},getTemplate:(e,t=null)=>{const n=t?`?version=${t}`:"";return Re(`/workbench/templates/${e}${n}`)},getWorkflows:()=>Re("/workbench/workflows"),getOrchestrationWorkflows:()=>Re("/workbench/orchestration-workflows"),getWorkflow:(e,t=null)=>{const n=t?`?version=${t}`:"";return Re(`/workbench/workflows/${e}${n}`)},createOrchestrationWorkflow:(e,t)=>Re(`/workspaces/${e}/orchestration-workflows`,{method:"POST",body:JSON.stringify(t)}),deleteOrchestrationWorkflow:(e,t)=>Re(`/workspaces/${e}/orchestration-workflows/${t}`,{method:"DELETE"}),createDocumentType:(e,t)=>Re(`/workspaces/${e}/document-types`,{method:"POST",body:JSON.stringify(t)}),deleteDocumentType:(e,t)=>Re(`/workspaces/${e}/document-types/${t}`,{method:"DELETE"}),createDcwWorkflow:(e,t)=>Re(`/workspaces/${e}/dcw-workflows`,{method:"POST",body:JSON.stringify(t)}),createRolePrompt:(e,t)=>Re(`/workspaces/${e}/role-prompts`,{method:"POST",body:JSON.stringify(t)}),createTemplate:(e,t)=>Re(`/workspaces/${e}/templates`,{method:"POST",body:JSON.stringify(t)}),createStandaloneSchema:(e,t)=>Re(`/workspaces/${e}/schemas`,{method:"POST",body:JSON.stringify(t)}),getActiveReleases:()=>Re("/workbench/active-releases"),invalidateCache:()=>Re("/workbench/invalidate-cache",{method:"POST"}),getMechanicalOpTypes:()=>Re("/workbench/mechanical-ops/types"),getMechanicalOpType:e=>Re(`/workbench/mechanical-ops/types/${e}`),getMechanicalOpCategories:()=>Re("/workbench/mechanical-ops/categories"),getMechanicalOps:()=>Re("/workbench/mechanical-ops"),getMechanicalOp:(e,t=null)=>{const n=t?`?version=${t}`:"";return Re(`/workbench/mechanical-ops/${e}${n}`)}};function VB({projectId:e}){const[t,n]=m.useState(null),[r,s]=m.useState(!0),[i,a]=m.useState(null),[l,c]=m.useState(!1),[d,u]=m.useState([]),[f,p]=m.useState(!1),[h,v]=m.useState(!1),[g,_]=m.useState(null),[x,y]=m.useState(!1),[b,j]=m.useState(!1),N=m.useCallback(async()=>{try{const C=((await _e.getOrchestrationWorkflows()).workflows||[]).filter(P=>P.workflow_id!=="intake_and_route"),M=C.find(P=>P.workflow_id==="software_product_development")||C[0];if(M){const P=await Ke.createWorkflowInstance(e,M.workflow_id,M.active_version);n(P)}}catch(D){console.error("Failed to auto-assign workflow:",D)}},[e]),E=m.useCallback(async()=>{if(e){s(!0),a(null);try{const D=await Ke.getWorkflowInstance(e);n(D)}catch(D){D.status===404?(n(null),await N()):a(D.message)}finally{s(!1)}}},[e,N]);m.useEffect(()=>{E()},[E]);const S=async()=>{c(!0),p(!0);try{const C=((await _e.getOrchestrationWorkflows()).workflows||[]).filter(M=>M.workflow_id!=="intake_and_route");u(C)}catch{u([])}finally{p(!1)}},k=async D=>{v(!0);try{const C=await Ke.createWorkflowInstance(e,D.workflow_id,D.active_version);n(C),c(!1)}catch(C){a(C.message)}finally{v(!1)}},w=async()=>{if(t&&(j(!b),!g)){y(!0);try{const D=await Ke.getWorkflowDrift(e);_(D)}catch(D){_({error:D.message})}finally{y(!1)}}};if(r)return o.jsx("div",{className:"p-4 text-xs",style:{color:"var(--text-muted)"},children:"Loading workflow..."});if(i&&!t)return o.jsx("div",{className:"p-4 text-xs",style:{color:"var(--status-error, #ef4444)"},children:i});if(!t)return o.jsxs("div",{className:"p-4",children:[o.jsx("div",{className:"text-xs mb-3",style:{color:"var(--text-muted)"},children:"No workflow assigned to this project."}),l?o.jsx(UB,{workflows:d,loading:f,assigning:h,onSelect:k,onCancel:()=>c(!1)}):o.jsx("button",{onClick:S,className:"text-xs px-3 py-1.5 rounded font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",border:"none",cursor:"pointer"},children:"Assign Workflow"})]});const R=t.effective_workflow||{},T=R.steps||[],I=t.base_workflow_ref||{};return o.jsxs("div",{className:"p-4 space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:R.name||I.workflow_id||"Workflow"}),o.jsx(GB,{status:t.status})]}),o.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["From ",I.workflow_id," v",I.version,I.pow_class?` (${I.pow_class})`:""]})]}),o.jsx("button",{onClick:w,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:"pointer"},children:x?"Checking...":b?"Hide Drift":"Check Drift"})]}),b&&g&&o.jsx(KB,{drift:g}),o.jsxs("div",{children:[o.jsxs("div",{className:"text-xs font-semibold uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:["Steps (",T.length,")"]}),T.length===0?o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No steps defined"}):o.jsx("div",{className:"space-y-1",children:T.map((D,C)=>o.jsx(YB,{step:D,index:C},D.step_id||C))})]}),i&&o.jsx("div",{className:"text-xs",style:{color:"var(--status-error, #ef4444)"},children:i})]})}function UB({workflows:e,loading:t,assigning:n,onSelect:r,onCancel:s}){const i=e.filter(l=>(l.pow_class||"reference")==="reference"),a=e.filter(l=>l.pow_class==="template");return o.jsxs("div",{className:"rounded p-3 space-y-2",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"text-xs font-semibold",style:{color:"var(--text-primary)"},children:"Select a workflow to assign:"}),t?o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Loading..."}):o.jsxs(o.Fragment,{children:[i.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Reference Workflows"}),i.map(l=>o.jsxs("button",{onClick:()=>r(l),disabled:n,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:n?"default":"pointer",opacity:n?.5:1},children:[o.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),o.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps"]})]},l.workflow_id))]}),a.length>0&&o.jsxs("div",{children:[o.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Template Workflows"}),a.map(l=>o.jsxs("button",{onClick:()=>r(l),disabled:n,className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-secondary)",cursor:n?"default":"pointer",opacity:n?.5:1},children:[o.jsx("div",{className:"font-medium",children:l.name||l.workflow_id}),o.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",l.active_version,"  ",l.step_count," steps",l.derived_from_label?`  from ${l.derived_from_label}`:""]})]},l.workflow_id))]}),i.length===0&&a.length===0&&o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No workflows available"})]}),o.jsx("button",{onClick:s,className:"text-xs px-2 py-1 hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer"},children:"Cancel"})]})}function GB({status:e}){const t={active:{bg:"var(--action-primary)",color:"#000"},completed:{bg:"#22c55e",color:"#000"},archived:{bg:"var(--text-muted)",color:"#000"}},n=t[e]||t.active;return o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:n.bg,color:n.color},children:e})}function KB({drift:e}){return e.error?o.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--status-error, #ef4444)"},children:["Drift check failed: ",e.error]}):o.jsxs("div",{className:"text-xs p-2 rounded space-y-1",style:{background:"var(--bg-panel)",border:`1px solid ${e.is_drifted?"var(--status-warning, #f59e0b)":"var(--border-panel)"}`},children:[o.jsxs("div",{className:"flex items-center gap-2 font-semibold",children:[o.jsx("span",{style:{color:e.is_drifted?"var(--status-warning, #f59e0b)":"#22c55e"},children:e.is_drifted?"Drifted":"In Sync"}),o.jsxs("span",{style:{color:"var(--text-muted)"},children:["vs ",e.base_workflow_id," v",e.base_version]})]}),e.is_drifted&&o.jsxs("div",{style:{color:"var(--text-secondary)"},children:[e.steps_added.length>0&&o.jsxs("div",{children:["+ Steps added: ",e.steps_added.join(", ")]}),e.steps_removed.length>0&&o.jsxs("div",{children:["- Steps removed: ",e.steps_removed.join(", ")]}),e.steps_reordered&&o.jsx("div",{children:"~ Steps reordered"}),e.metadata_changed&&o.jsx("div",{children:"~ Metadata changed"})]})]})}function YB({step:e,index:t}){return o.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 rounded text-xs",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("span",{className:"font-mono font-semibold",style:{color:"var(--text-muted)",minWidth:20,textAlign:"right"},children:t+1}),o.jsxs("div",{style:{flex:1},children:[o.jsx("div",{style:{color:"var(--text-primary)"},children:e.step_id||`Step ${t+1}`}),e.produces&&o.jsxs("div",{style:{color:"var(--text-muted)"},children:["produces: ",e.produces]})]}),e.scope&&o.jsx("span",{className:"px-1 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-muted)",fontSize:10},children:e.scope})]})}const hg=(e,t,n=null)=>{const r=new bc.graphlib.Graph;return r.setGraph({rankdir:"TB",align:"UL",nodesep:20,ranksep:70,marginx:100,marginy:30,ranker:"longest-path"}),r.setDefaultEdgeLabel(()=>({})),e.forEach(s=>{r.setNode(s.id,{width:s.data.width??280,height:s.data.height??90})}),t.forEach(s=>{r.setEdge(s.source,s.target)}),bc.layout(r),{nodes:e.map(s=>{const i=r.node(s.id),a={x:i.x-(s.data.width??280)/2,y:i.y-(s.data.height??90)/2},l=n==null?void 0:n[s.id];return{...s,targetPosition:ce.Top,sourcePosition:ce.Bottom,position:l||a}}),edges:t}},mg=(e,t,n)=>{let r=[],s=[],i=null,a=null,l=[];const c=n.theme||"industrial";return e.forEach((d,u)=>{var v,g,_;if((d.level||1)!==1)return;const f=280;let p=95;((v=d.stations)==null?void 0:v.length)>0&&(p+=35);const h=t===d.id;if(r.push({id:d.id,type:"documentNode",data:{...d,width:f,height:p,isExpanded:h,...n},connectable:!1,position:{x:0,y:0},zIndex:h?1e3:0}),i){const x=(g=e[u-1])==null?void 0:g.state;s.push({id:"e-"+i+"-"+d.id,source:i,target:d.id,type:"smoothstep",animated:x==="active",style:{stroke:AE(x,c),strokeWidth:3}})}((_=d.children)==null?void 0:_.length)>0&&(a=d.id,l=d.children),i=d.id}),{nodes:r,edges:s,epicBacklogId:a,epicChildren:l}},gg=(e,t,n,r,s)=>{const{nodes:i,edges:a}=e;if(!t||!n.length)return{nodes:i,edges:a};const l=i.find(b=>b.id===t);if(!l)return{nodes:i,edges:a};const c=l.position.x,d=l.position.y+(l.data.height||95),u=l.data.state,f=s.theme||"industrial",p=AE(u,f),h=u==="active",v=Sn.EPIC_HEIGHT+Sn.EPIC_GAP_Y,g=Math.ceil(n.length/Sn.EPICS_PER_ROW),_=c+280*.15,x=50,y={};n.forEach((b,j)=>{const N=Math.floor(j/Sn.EPICS_PER_ROW);y[N]||(y[N]=[]),y[N].push({epic:b,idx:j})});for(let b=0;b<g;b++){const j=y[b]||[];if(j.length===0)continue;const N=d+Sn.EPIC_OFFSET_Y+b*v,E=`junction-row-${b}`;i.push({id:E,type:"waypoint",position:{x:_,y:N-x},draggable:!1,connectable:!1,selectable:!1}),b===0?a.push({id:`e-spine-drop-${b}`,source:t,target:E,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}):a.push({id:`e-spine-${b-1}-to-${b}`,source:`junction-row-${b-1}`,target:E,type:"straight",animated:h,style:{stroke:p,strokeWidth:2}}),j.forEach(({epic:S,idx:k})=>{const w=k%Sn.EPICS_PER_ROW,R=c+Sn.EPIC_OFFSET_X+w*(Sn.EPIC_WIDTH+Sn.EPIC_GAP_X),T=N,I=r===S.id;i.push({id:S.id,type:"documentNode",data:{...S,width:Sn.EPIC_WIDTH,height:Sn.EPIC_HEIGHT,isExpanded:I,...s},draggable:!1,connectable:!1,position:{x:R,y:T},targetPosition:ce.Top,sourcePosition:ce.Bottom,zIndex:I?1e3:0}),a.push({id:`e-branch-${S.id}`,source:E,target:S.id,type:"smoothstep",pathOptions:{borderRadius:20},animated:h,style:{stroke:p,strokeWidth:2}})})}return{nodes:i,edges:a}},XB={produced:"produced",in_production:"in_production",ready_for_production:"ready_for_production",requirements_not_met:"requirements_not_met",awaiting_operator:"awaiting_operator",halted:"halted",queued:"ready_for_production",blocked:"requirements_not_met",assembling:"in_production",binding:"in_production",auditing:"in_production",remediating:"in_production",stabilized:"produced"};function QB(e){const t={};for(const n of e.projects)t[n.id]={id:n.id,projectId:n.project_id,name:n.name,description:n.description||"",status:n.status==="active"?"active":n.is_archived?"complete":"queued",icon:n.icon,createdAt:n.created_at,isArchived:n.is_archived||!1,metadata:n.metadata||{}};return t}function ZB(e,t=[]){const n=[],r=[],s={};for(const i of e.tracks){const a=JB(i,t);if((i.scope||"project")==="project")r.push({...a,mayOwn:i.may_own||[],childDocType:i.child_doc_type});else{const c=i.document_type;s[c]||(s[c]=[]),s[c].push({...a,sequence:i.sequence})}}for(const i of r)i.childDocType&&s[i.childDocType]&&(i.children=s[i.childDocType].sort((a,l)=>(a.sequence??999)-(l.sequence??999)).map(a=>({...a,level:2,docTypeId:a.docTypeId,instanceId:a.instanceId}))),n.push(i);return n}function JB(e,t=[]){var a,l,c;const n=XB[e.state]||"ready_for_production";e.state;const r=t.find(d=>d.document_type===e.document_type);let s=null;e.stations&&e.stations.length>0&&(s=e9(e.stations,e.state,e.station));let i=null;if(r){const d=r.questions||((l=(a=r.payload)==null?void 0:a.data)==null?void 0:l.questions)||(Array.isArray((c=r.payload)==null?void 0:c.data)?r.payload.data:null);d&&Array.isArray(d)&&(i=d.map((u,f)=>({id:u.id||`q${f+1}`,text:u.question||u.text||u,required:u.required!==!1,choices:u.choices||null,answer_type:u.answer_type||"text",why_it_matters:u.why_it_matters||null,priority:u.priority||null,blocking:u.blocking!==!1,default:u.default||null,constraint_kind:u.constraint_kind||null})))}return{id:e.identifier||e.document_type,docTypeId:e.document_type,instanceId:e.instance_id||null,name:e.document_name||t9(e.document_type),desc:e.description||"",state:n,intent:"mandatory",level:1,stations:s,questions:i,interruptId:r==null?void 0:r.id,blockedBy:e.blocked_by||[]}}function e9(e,t,n){return!e||e.length===0?null:e.map(r=>({id:r.station,label:r.label||r.station.toUpperCase(),state:r.state||"pending",needs_input:r.needs_input||!1}))}function t9(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function n9({includeArchived:e=!1}={}){const[t,n]=m.useState({}),[r,s]=m.useState(!0),[i,a]=m.useState(null),l=m.useCallback(async()=>{s(!0),a(null);try{const d=await Ke.getProjects({includeArchived:e}),u=QB(d);n(u)}catch(d){a(d.message),console.error("Failed to fetch projects:",d)}finally{s(!1)}},[e]),c=m.useCallback(async d=>{try{const u=await Ke.createProject({name:d,description:""});return n(f=>({...f,[u.id]:{id:u.id,projectId:u.project_id,name:u.name,description:u.description||"",status:"active",icon:u.icon,createdAt:u.created_at}})),u}catch(u){throw a(u.message),console.error("Failed to create project:",u),u}},[]);return m.useEffect(()=>{l()},[l]),{projects:t,loading:r,error:i,addProject:c,refresh:l}}function r9(e){const[t,n]=m.useState([]),[r,s]=m.useState("idle"),[i,a]=m.useState([]),[l,c]=m.useState(!0),[d,u]=m.useState(null),[f,p]=m.useState(!1),[h,v]=m.useState(null),g=m.useRef(null),_=m.useRef(null),x=m.useCallback(async()=>{if(e)try{c(!0),u(null);const[S,k]=await Promise.all([Ke.getProductionStatus(e),Ke.getProjectInterrupts(e).catch(()=>[])]);a(k),s(S.line_state),n(ZB(S,k))}catch(S){u(S.message),console.error("Failed to fetch production status:",S)}finally{c(!1)}},[e]),y=m.useCallback(()=>{if(!e)return;g.current&&g.current.close();const S=P8(e);g.current=S,S.addEventListener("connected",()=>{p(!0),u(null),console.log(`SSE connected for project ${e}`)}),S.addEventListener("station_transition",k=>{try{const w=JSON.parse(k.data);console.log("Station transition:",w),x()}catch(w){console.error("Failed to parse station_transition:",w)}}),S.addEventListener("line_stopped",k=>{try{const w=JSON.parse(k.data);console.log("Line stopped:",w),s("stopped"),x()}catch(w){console.error("Failed to parse line_stopped:",w)}}),S.addEventListener("production_complete",k=>{try{const w=JSON.parse(k.data);console.log("Production complete:",w),s("complete"),x()}catch(w){console.error("Failed to parse production_complete:",w)}}),S.addEventListener("interrupt_resolved",k=>{try{const w=JSON.parse(k.data);console.log("Interrupt resolved:",w),x()}catch(w){console.error("Failed to parse interrupt_resolved:",w)}}),S.addEventListener("track_started",k=>{try{const w=JSON.parse(k.data);console.log("Track started:",w),s("active"),x()}catch(w){console.error("Failed to parse track_started:",w)}}),S.addEventListener("track_stabilized",k=>{try{const w=JSON.parse(k.data);console.log("Track stabilized:",w),x()}catch(w){console.error("Failed to parse track_stabilized:",w)}}),S.addEventListener("children_updated",k=>{try{const w=JSON.parse(k.data);console.log("Children updated:",w),x()}catch(w){console.error("Failed to parse children_updated:",w)}}),S.addEventListener("stations_declared",k=>{try{const w=JSON.parse(k.data);console.log("Stations declared:",w);const{document_type:R,stations:T}=w;n(I=>{const D=I.some(M=>M.id===R);console.log("stations_declared raw stations:",T);const C=T.map(M=>({id:M.id,label:M.label,state:M.state,phases:M.phases||[],phase:null}));return console.log("stations_declared processed:",C),D?I.map(M=>M.id===R?{...M,state:"in_production",stations:C}:M):[...I,{id:R,name:R.replace(/_/g," ").replace(/\b\w/g,M=>M.toUpperCase()),state:"in_production",stations:C}]})}catch(w){console.error("Failed to parse stations_declared:",w)}}),S.addEventListener("station_changed",k=>{try{const w=JSON.parse(k.data);console.log("Station changed:",w);const{document_type:R,station_id:T,state:I}=w;n(D=>D.map(C=>C.id!==R||!C.stations?C:{...C,stations:C.stations.map(M=>M.id===T?{...M,state:I}:M)}))}catch(w){console.error("Failed to parse station_changed:",w)}}),S.addEventListener("internal_step",k=>{try{const w=JSON.parse(k.data);console.log("Internal step:",w);const{document_type:R,station_id:T,step:I}=w;n(D=>D.map(C=>C.id!==R||!C.stations?C:{...C,stations:C.stations.map(M=>M.id===T?{...M,currentStep:I}:M)}))}catch(w){console.error("Failed to parse internal_step:",w)}}),S.onerror=k=>{console.error("SSE error:",k),p(!1),u("Connection lost"),S.close(),_.current=setTimeout(()=>{console.log("Attempting SSE reconnect..."),y()},3e3)}},[e,x]),b=m.useCallback(()=>{_.current&&clearTimeout(_.current),g.current&&(g.current.close(),g.current=null),p(!1)},[]),j=m.useCallback(async(S,k)=>{try{await Ke.resolveInterrupt(S,{answers:k})}catch(w){throw console.error("Failed to resolve interrupt:",w),w}},[]),N=m.useCallback(async(S=null)=>{var k;try{v(null),await Ke.startProduction(e,S),s("active")}catch(w){console.error("Failed to start production:",w);const R=((k=w.data)==null?void 0:k.message)||w.message||"Failed to start production";throw v({type:"error",message:R}),S&&n(T=>T.map(I=>I.id===S?{...I,state:"ready_for_production",stations:null}:I)),s("idle"),x(),w}},[e,x]),E=m.useCallback(()=>{v(null)},[]);return m.useEffect(()=>(x(),y(),()=>b()),[x,y,b]),{data:t,lineState:r,interrupts:i,loading:l,error:d,connected:f,notification:h,dismissNotification:E,refresh:x,resolveInterrupt:j,startProduction:N}}const oS="combine-theme";function X4(e="industrial"){const[t,n]=m.useState(()=>{if(typeof window>"u")return e;const i=localStorage.getItem(oS);return i&&Ir.includes(i)?i:e});m.useEffect(()=>{localStorage.setItem(oS,t)},[t]);const r=m.useCallback(i=>{Ir.includes(i)&&n(i)},[]),s=m.useCallback(()=>{n(i=>{const a=Ir.indexOf(i);return Ir[(a+1)%Ir.length]})},[]);return{theme:t,setTheme:r,cycleTheme:s}}function s9(){const[e,t]=m.useState(null),[n,r]=m.useState("idle"),[s,i]=m.useState([]),[a,l]=m.useState(null),[c,d]=m.useState(null),[u,f]=m.useState({}),[p,h]=m.useState(0),[v,g]=m.useState([]),[_,x]=m.useState(!1),[y,b]=m.useState(null),[j,N]=m.useState(null),[E,S]=m.useState(null),[k,w]=m.useState(!1),[R,T]=m.useState(!1),[I,D]=m.useState(null),[C,M]=m.useState(null),P=m.useRef(null),F=m.useRef(!0);m.useEffect(()=>(F.current=!0,()=>{F.current=!1,P.current&&P.current.close()}),[]);const O=m.useCallback(H=>{F.current&&(r(H.phase),i(H.messages||[]),l(H.pending_prompt),d(H.pending_choices),f(H.interpretation||{}),h(H.confidence||0),g(H.missing_fields||[]),x(H.can_initialize||!1),b(H.gate_outcome),N(H.project),D(H.intake_classification),M(H.intake_gate_phase))},[]),A=m.useCallback(async()=>{S(null),w(!0);try{const H=await Ke.startIntake();if(!F.current)return;t(H.execution_id),O(H)}catch(H){if(!F.current)return;S(H.message||"Failed to start intake")}finally{F.current&&w(!1)}},[]),z=m.useCallback(async H=>{if(!e||!H.trim())return;S(null),T(!0);const q={role:"user",content:H};i(Q=>[...Q,q]);try{const Q=await Ke.submitIntakeMessage(e,H);if(!F.current)return;O(Q)}catch(Q){if(!F.current)return;i(se=>se.filter(ie=>ie!==q)),S(Q.message||"Failed to submit message")}finally{F.current&&T(!1)}},[e,O]),$=m.useCallback(async(H,q)=>{if(e){S(null),f(Q=>({...Q,[H]:{value:q,source:"user",locked:!0}}));try{const Q=await Ke.updateIntakeField(e,H,q);if(!F.current)return;O(Q)}catch(Q){if(!F.current)return;S(Q.message||"Failed to update field");const se=await Ke.getIntakeState(e);F.current&&O(se)}}},[e,O]),B=m.useCallback(async()=>{if(!(!e||!_)){S(null),w(!0);try{const H=await Ke.initializeIntake(e);if(!F.current)return;O(H),H.phase==="generating"&&U()}catch(H){if(!F.current)return;S(H.message||"Failed to initialize project"),w(!1)}}},[e,_,O]),U=m.useCallback(()=>{P.current&&P.current.close();const H=M8(e);P.current=H,H.addEventListener("started",q=>{if(!F.current)return;const Q=JSON.parse(q.data);console.log("Intake started:",Q)}),H.addEventListener("progress",q=>{if(!F.current)return;const Q=JSON.parse(q.data);console.log("Intake progress:",Q.current_node)}),H.addEventListener("complete",async q=>{if(!F.current)return;const Q=JSON.parse(q.data);console.log("Intake complete:",Q),H.close(),P.current=null,r("complete"),b(Q.gate_outcome),N(Q.project),w(!1)}),H.addEventListener("error",q=>{if(F.current&&H.readyState!==EventSource.CLOSED){try{const Q=JSON.parse(q.data);S(Q.message||"Generation failed")}catch{S("Connection lost during generation")}H.close(),P.current=null,w(!1)}}),H.onerror=()=>{F.current&&H.readyState===EventSource.CLOSED&&(P.current=null,w(!1))}},[e]),G=m.useCallback(()=>{P.current&&(P.current.close(),P.current=null),t(null),r("idle"),i([]),l(null),d(null),f({}),h(0),g([]),x(!1),b(null),N(null),S(null),w(!1),T(!1)},[]);return{executionId:e,phase:n,messages:s,pendingPrompt:a,pendingChoices:c,interpretation:u,confidence:p,missingFields:v,canInitialize:_,gateOutcome:y,project:j,error:E,loading:k,submitting:R,intakeClassification:I,intakeGatePhase:C,startIntake:A,submitMessage:z,updateField:$,lockAndGenerate:B,reset:G}}const Q4=m.createContext(null);function i9({children:e}){const[t,n]=m.useState(null),[r,s]=m.useState(!0),[i,a]=m.useState(null);m.useEffect(()=>{l()},[]);const l=m.useCallback(async()=>{s(!0),a(null);try{const f=await Ke.getMe();f&&f.user?n(f.user):n(null)}catch(f){console.error("Auth check failed:",f),a(f.message),n(null)}finally{s(!1)}},[]),c=m.useCallback(f=>{window.location.href=O8(f)},[]),d=m.useCallback(async()=>{try{await Ke.logout(),n(null),window.location.href="/"}catch(f){console.error("Logout failed:",f),n(null)}},[]),u={user:t,loading:r,error:i,isAuthenticated:!!t,isAdmin:(t==null?void 0:t.is_admin)||!1,login:c,logout:d,checkAuth:l};return o.jsx(Q4.Provider,{value:u,children:e})}function zi(){const e=m.useContext(Q4);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}function o9(){const[e,t]=m.useState(null),[n,r]=m.useState(null),[s,i]=m.useState(!0),[a,l]=m.useState(null),c=m.useCallback(async()=>{i(!0),l(null);try{let u=await _e.getCurrentWorkspace();u||(u=await _e.createWorkspace()),t(u.workspace_id),r(u.branch)}catch(u){l(u.message),console.error("Failed to initialize workspace:",u)}finally{i(!1)}},[]),d=m.useCallback(async(u=!1)=>{if(e)try{await _e.closeWorkspace(e,u),t(null),r(null)}catch(f){throw f}},[e]);return m.useEffect(()=>{c()},[c]),{workspaceId:e,branch:n,loading:s,error:a,closeWorkspace:d,reinitialize:c}}function a9(e,t=1e4){var u,f;const[n,r]=m.useState(null),[s,i]=m.useState(!0),[a,l]=m.useState(null),c=m.useRef(null),d=m.useCallback(async()=>{if(!e){r(null),i(!1);return}try{const p=await _e.getWorkspaceState(e);r(p),l(null)}catch(p){l(p.message),console.error("Failed to fetch workspace state:",p)}finally{i(!1)}},[e]);return m.useEffect(()=>{e&&(i(!0),d())},[e,d]),m.useEffect(()=>{if(!(!e||!t))return c.current=setInterval(d,t),()=>{c.current&&clearInterval(c.current)}},[e,t,d]),{state:n,loading:s,error:a,refresh:d,isDirty:(n==null?void 0:n.is_dirty)??!1,modifiedArtifacts:(n==null?void 0:n.modified_artifacts)??[],tier1Passed:((u=n==null?void 0:n.tier1)==null?void 0:u.passed)??!0,tier1Results:((f=n==null?void 0:n.tier1)==null?void 0:f.results)??[],expiresAt:n!=null&&n.expires_at?new Date(n.expires_at):null}}function l9(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{r(!0),i(null);try{const l=await _e.getDocumentTypes();t(l.document_types||[])}catch(l){i(l.message),console.error("Failed to fetch document types:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{a()},[a]),{documentTypes:e,loading:n,error:s,refresh:a}}function c9(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{r(!0),i(null);try{const l=await _e.getRoles();t(l.roles||[])}catch(l){i(l.message),console.error("Failed to fetch roles:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{a()},[a]),{roles:e,loading:n,error:s,refresh:a}}function Ea(e,t,{debounceMs:n=500,onSave:r}={}){const[s,i]=m.useState(""),[a,l]=m.useState(""),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[v,g]=m.useState(null),_=m.useRef(null),x=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){i(""),l(""),d(!1);return}d(!0),f(null);try{const k=await _e.getArtifact(e,t);i(k.content),l(k.content)}catch(k){f(k.message),console.error("Failed to load artifact:",k)}finally{d(!1)}},[e,t]),b=m.useCallback(async k=>{if(!(!e||!t)){h(!0),f(null);try{const w=await _e.writeArtifact(e,t,k);g(w),l(k),r&&r(w)}catch(w){f(w.message),console.error("Failed to save artifact:",w)}finally{h(!1)}}},[e,t,r]),j=m.useCallback(k=>{x.current=k,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{x.current!==null&&(b(x.current),x.current=null)},n)},[b,n]),N=m.useCallback(k=>{i(k),k!==a&&j(k)},[a,j]),E=m.useCallback(()=>{_.current&&clearTimeout(_.current),x.current=null,i(a)},[a]),S=m.useCallback(()=>{_.current&&clearTimeout(_.current),s!==a&&b(s)},[s,a,b]);return m.useEffect(()=>(y(),()=>{_.current&&clearTimeout(_.current)}),[y]),{content:s,originalContent:a,loading:c,error:u,saving:p,lastSaveResult:v,isDirty:s!==a,updateContent:N,reset:E,saveNow:S,reload:y}}const u9={documentNode:T8,waypoint:R8},d9={industrial:"Industrial",light:"Light",blueprint:"Blueprint"};function f9({projectId:e,projectCode:t,projectName:n,isArchived:r,savedLayout:s,autoExpandNodeId:i,theme:a,onThemeChange:l,onProjectUpdate:c,onProjectArchive:d,onProjectUnarchive:u,onProjectDelete:f}){const{data:p,lineState:h,loading:v,error:g,connected:_,notification:x,dismissNotification:y,resolveInterrupt:b,startProduction:j}=r9(e),[N,E]=m.useState([]),[S,k]=m.useState(null),[w,R]=m.useState(null),[T,I]=m.useState(null),[D,C]=m.useState(!1),[M,P]=m.useState(""),[F,O]=m.useState(!1),[A,z]=m.useState(!1),[$,B]=m.useState(!1),U=iu(),G=m.useRef((s==null?void 0:s.node_positions)||null),H=m.useRef((s==null?void 0:s.viewport)||null),q=m.useRef(null),Q=m.useRef(!1);m.useEffect(()=>{p.length>0&&E(p)},[p]),m.useEffect(()=>{i&&N.length>0&&setTimeout(()=>{k(i),R("questions")},300)},[i,N.length]),m.useEffect(()=>{k(null),R(null)},[e]),m.useEffect(()=>()=>{q.current&&clearTimeout(q.current)},[]);const se=m.useCallback(()=>{const oe=Ir.indexOf(a);l(Ir[(oe+1)%Ir.length])},[a,l]),ie=m.useCallback(()=>{q.current&&clearTimeout(q.current),q.current=setTimeout(()=>{const oe={node_positions:G.current,viewport:H.current};Ke.saveFloorLayout(e,oe).catch(me=>console.error("Failed to save floor layout:",me))},800)},[e]),Z=m.useCallback((oe,me)=>{const fe={...G.current||{}};fe[me.id]=me.position,G.current=fe,ie()},[ie]),Se=m.useCallback((oe,me)=>{me&&(H.current=me,ie())},[ie]),xe=m.useCallback(()=>{P(n||""),C(!0)},[n]),be=m.useCallback(async()=>{if(!M.trim()||M===n){C(!1);return}z(!0);try{await c(e,{name:M.trim()}),C(!1)}catch(oe){console.error("Failed to update name:",oe)}finally{z(!1)}},[M,n,e,c]),ve=m.useCallback(()=>{C(!1),P("")},[]),ae=m.useCallback(async()=>{z(!0);try{r?await u(e):await d(e)}catch(oe){console.error("Failed to toggle archive:",oe)}finally{z(!1)}},[e,r,d,u]),Y=m.useCallback(async()=>{z(!0);try{await f(e),O(!1)}catch(oe){console.error("Failed to delete:",oe)}finally{z(!1)}},[e,f]),te=m.useCallback(oe=>{const me=U.getNode(oe);if(me){const V=window.innerWidth,ge=-me.position.x*.9+V/2-400,pe=-me.position.y*.9+120;U.setViewport({x:ge,y:pe,zoom:.9},{duration:800})}},[U]),ee=m.useMemo(()=>({onExpand:(oe,me)=>{k(oe),R(me)},onCollapse:()=>{k(null),R(null),setTimeout(()=>U.fitView({padding:.2,duration:300}),50)},onViewFullDocument:oe=>{I(oe)},onStartProduction:async oe=>{console.log("Starting production for:",oe),E(me=>me.map(fe=>fe.id===oe?{...fe,_prevState:fe.state,state:"in_production"}:fe));try{await j(oe)}catch{E(fe=>fe.map(V=>V.id===oe?{...V,state:V._prevState||"ready_for_production",stations:null}:V))}},onSubmitQuestions:async(oe,me)=>{console.log("Submitted:",oe,me),k(null),R(null),E(V=>{const ge=pe=>pe.map(ze=>ze.id===oe&&ze.stations?{...ze,state:"in_production",stations:ze.stations.map(We=>We.id==="pgc"?{...We,state:"complete",needs_input:!1}:We.id==="asm"?{...We,state:"active"}:We)}:ze.children?{...ze,children:ge(ze.children)}:ze);return ge(V)});const fe=N.find(V=>V.id===oe);if(fe!=null&&fe.interruptId)try{await b(fe.interruptId,me)}catch(V){console.error("Failed to submit answers:",V)}}}),[U,N,b,j]),{layoutNodes:ke,layoutEdges:we}=m.useMemo(()=>{if(N.length===0)return{layoutNodes:[],layoutEdges:[]};const oe={...ee,expandType:w,theme:a,onZoomToNode:te,projectId:e,projectCode:t},{nodes:me,edges:fe,epicBacklogId:V,epicChildren:ge}=mg(N,S,oe),pe=hg(me,fe,G.current),{nodes:ze,edges:We}=gg(pe,V,ge,S,oe);return{layoutNodes:ze.map(Ue=>({...Ue,data:{...Ue.data,expandType:Ue.id===S?w:null}})),layoutEdges:We}},[N,S,w,ee,a,te,e,t]),[Ee,Ne,ne]=NE(ke),[je,Ve,ct]=CE(we);m.useEffect(()=>{if(N.length===0)return;const oe={...ee,expandType:w,theme:a,onZoomToNode:te,projectId:e,projectCode:t},{nodes:me,edges:fe,epicBacklogId:V,epicChildren:ge}=mg(N,S,oe),pe=hg(me,fe,G.current),{nodes:ze,edges:We}=gg(pe,V,ge,S,oe),st=ze.map(Ue=>({...Ue,data:{...Ue.data,expandType:Ue.id===S?w:null}}));Ne(st),Ve(We)},[N,S,w,ee,Ne,Ve,a,te,e,t]),m.useEffect(()=>{!Q.current&&H.current&&Ee.length>0&&(Q.current=!0,setTimeout(()=>{U.setViewport(H.current,{duration:0})},100))},[Ee.length,U]);const Be=m.useCallback(()=>{G.current=null,H.current=null,Ke.saveFloorLayout(e,null).catch(Ue=>console.error("Failed to clear floor layout:",Ue));const oe={...ee,expandType:w,theme:a,onZoomToNode:te,projectId:e,projectCode:t},{nodes:me,edges:fe,epicBacklogId:V,epicChildren:ge}=mg(N,S,oe),pe=hg(me,fe,null),{nodes:ze,edges:We}=gg(pe,V,ge,S,oe),st=ze.map(Ue=>({...Ue,data:{...Ue.data,expandType:Ue.id===S?w:null}}));Ne(st),Ve(We),setTimeout(()=>U.fitView({padding:.2,duration:300}),50)},[e,ee,w,a,te,t,N,S,Ne,Ve,U]),Ie=m.useCallback((oe,me)=>{},[]);return v&&N.length===0?o.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",children:[o.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-12 mx-auto mb-4 animate-pulse"}),o.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading production line..."})]})}):g&&N.length===0?o.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:o.jsx("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:o.jsx("p",{className:"text-red-500 mb-4",children:g})})}):o.jsxs("div",{className:"w-full h-full",children:[o.jsxs(wa,{nodes:Ee,edges:je,onNodesChange:ne,onEdgesChange:ct,onNodeClick:Ie,onNodeDragStop:Z,onMoveEnd:Se,nodeTypes:u9,nodesDraggable:!0,nodesConnectable:!1,edgesUpdatable:!1,edgesFocusable:!1,zoomOnScroll:!0,fitView:!H.current,fitViewOptions:{padding:.2},minZoom:.3,maxZoom:1.5,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},children:[o.jsx(Hr,{position:"top-left",children:o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:o.jsxs("div",{className:"flex items-center justify-between gap-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Production Line"}),o.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[h==="active"&&o.jsx("span",{className:"text-amber-500",children:" Active"}),h==="stopped"&&o.jsx("span",{className:"text-red-500",children:" Stopped"}),h==="complete"&&o.jsx("span",{className:"text-emerald-500",children:" Complete"}),h==="idle"&&o.jsx("span",{children:" Idle"}),!_&&o.jsx("span",{className:"ml-2 text-red-400",children:"(Disconnected)"})]})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("button",{onClick:Be,className:"subway-button p-1.5 rounded-md transition-colors",title:"Reset layout",children:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M3 12a9 9 0 019-9 9.75 9.75 0 016.74 2.74L21 8"}),o.jsx("path",{d:"M21 3v5h-5"}),o.jsx("path",{d:"M21 12a9 9 0 01-9 9 9.75 9.75 0 01-6.74-2.74L3 16"}),o.jsx("path",{d:"M3 21v-5h5"})]})}),o.jsx("button",{onClick:se,className:"subway-button px-3 py-1.5 rounded-md text-xs font-medium transition-colors",children:d9[a]})]})]})}),o.jsx("div",{className:"subway-panel backdrop-blur rounded-lg px-4 py-3 border",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{background:"var(--state-active-bg)"},children:o.jsx("svg",{className:"w-5 h-5 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-xs font-mono",style:{color:"var(--text-muted)"},children:t||"No Project"}),D?o.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o.jsx("input",{type:"text",value:M,onChange:oe=>P(oe.target.value),onKeyDown:oe=>{oe.key==="Enter"&&be(),oe.key==="Escape"&&ve()},className:"flex-1 px-2 py-1 text-sm rounded border bg-transparent",style:{color:"var(--text-primary)",borderColor:"var(--border-panel)"},autoFocus:!0,disabled:A}),o.jsx("button",{onClick:be,disabled:A,className:"p-1 rounded hover:bg-white/10",title:"Save",children:o.jsx("svg",{className:"w-4 h-4 text-emerald-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M5 13l4 4L19 7"})})}),o.jsx("button",{onClick:ve,disabled:A,className:"p-1 rounded hover:bg-white/10",title:"Cancel",children:o.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M6 18L18 6M6 6l12 12"})})})]}):o.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--text-primary)"},children:n||"Untitled Project"})]}),!D&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:xe,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Edit name",children:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),o.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),o.jsx("button",{onClick:ae,disabled:A,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:r?"#f59e0b":"var(--text-muted)"},title:r?"Unarchive project":"Archive project",children:o.jsxs("svg",{className:"w-4 h-4 relative",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 8v13H3V8M1 3h22v5H1zM10 12h4"}),r&&o.jsx("path",{d:"M4 20L20 4",strokeWidth:"2.5",stroke:"currentColor"})]})}),o.jsx("button",{onClick:()=>O(!0),disabled:A||!r,className:`p-1.5 rounded transition-colors ${r?"hover:bg-red-500/20":""}`,style:{color:"var(--text-muted)",opacity:r?1:.3,cursor:r?"pointer":"not-allowed"},title:r?"Delete project":"Archive project first to delete",children:o.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),o.jsxs("div",{className:"subway-panel backdrop-blur rounded-lg border overflow-hidden",children:[o.jsxs("button",{onClick:()=>B(!$),className:"w-full flex items-center justify-between px-4 py-2 text-xs font-semibold hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-primary)",cursor:"pointer"},children:[o.jsx("span",{children:"Workflow"}),o.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:$?"":""})]}),$&&o.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:o.jsx(VB,{projectId:e})})]})]})}),o.jsx(RE,{position:"top-right",nodeColor:oe=>{var ge;const me=(ge=oe.data)==null?void 0:ge.state,fe=document.querySelector('[class*="theme-"]')||document.body,V=getComputedStyle(fe);return["produced","stabilized","ready","complete"].includes(me)?V.getPropertyValue("--state-stabilized-bg").trim():["requirements_not_met","blocked","halted","failed"].includes(me)?V.getPropertyValue("--state-blocked-bg").trim():["in_production","active","queued","awaiting_operator"].includes(me)?V.getPropertyValue("--state-active-bg").trim():(["ready_for_production","waiting","pending_acceptance"].includes(me),V.getPropertyValue("--state-ready-bg").trim())},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),o.jsx(Hr,{position:"bottom-left",children:o.jsxs("div",{className:"subway-panel flex gap-4 text-[10px] backdrop-blur px-4 py-2.5 rounded-lg border",children:[o.jsx("span",{style:{color:"var(--text-muted)"},className:"font-medium",children:"STATE:"}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-stabilized-bg)"}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:"Stabilized"})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-ready-bg)"}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:"Ready"})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-active-bg)"}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:"In Progress"})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{background:"var(--state-blocked-bg)"}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:"Blocked"})]})]})}),o.jsx(Hr,{position:"bottom-right",children:o.jsx("div",{className:"subway-panel text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Scroll to zoom | Drag to pan | Drag nodes to rearrange"})})]}),x&&o.jsxs("div",{className:"fixed top-6 left-1/2 -translate-x-1/2 z-50 flex items-center gap-3 px-5 py-3 rounded-lg shadow-lg border",style:{background:x.type==="error"?"#fef2f2":"#f0fdf4",borderColor:x.type==="error"?"#fecaca":"#bbf7d0",maxWidth:500,animation:"fadeIn 0.2s ease-out"},children:[o.jsx("span",{style:{fontSize:18,color:x.type==="error"?"#dc2626":"#16a34a",flexShrink:0},children:x.type==="error"?"":""}),o.jsx("span",{style:{fontSize:13,color:"#1f2937",lineHeight:1.4},children:x.message}),o.jsx("button",{onClick:y,style:{marginLeft:"auto",background:"none",border:"none",color:"#9ca3af",fontSize:18,cursor:"pointer",padding:"0 2px",lineHeight:1,flexShrink:0},children:""})]}),T&&o.jsx(RB,{projectId:e,projectCode:t,docTypeId:typeof T=="object"?T.docTypeId:T,instanceId:typeof T=="object"?T.instanceId:void 0,onClose:()=>I(null)}),F&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:o.jsxs("div",{className:"rounded-lg p-6 max-w-sm mx-4",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Delete Project?"}),o.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:["This will permanently delete ",o.jsx("strong",{children:n})," and all its documents. This action cannot be undone."]}),o.jsxs("div",{className:"flex gap-3 justify-end",children:[o.jsx("button",{onClick:()=>O(!1),disabled:A,className:"px-4 py-2 rounded text-sm font-medium transition-colors",style:{color:"var(--text-muted)"},children:"Cancel"}),o.jsx("button",{onClick:Y,disabled:A,className:"px-4 py-2 rounded text-sm font-medium bg-red-500 text-white hover:bg-red-600 transition-colors",children:A?"Deleting...":"Delete"})]})]})})]})}/*! js-yaml 4.1.1 https://github.com/nodeca/js-yaml @license MIT */function Z4(e){return typeof e>"u"||e===null}function p9(e){return typeof e=="object"&&e!==null}function h9(e){return Array.isArray(e)?e:Z4(e)?[]:[e]}function m9(e,t){var n,r,s,i;if(t)for(i=Object.keys(t),n=0,r=i.length;n<r;n+=1)s=i[n],e[s]=t[s];return e}function g9(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}function x9(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var v9=Z4,y9=p9,b9=h9,_9=g9,w9=x9,j9=m9,gt={isNothing:v9,isObject:y9,toArray:b9,repeat:_9,isNegativeZero:w9,extend:j9};function J4(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}function aa(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=J4(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}aa.prototype=Object.create(Error.prototype);aa.prototype.constructor=aa;aa.prototype.toString=function(t){return this.name+": "+J4(this,t)};var Lt=aa;function xg(e,t,n,r,s){var i="",a="",l=Math.floor(s/2)-1;return r-t>l&&(i=" ... ",t=r-l+i.length),n-r>l&&(a=" ...",n=r+l-a.length),{str:i+e.slice(t,n).replace(/\t/g,"")+a,pos:r-t+i.length}}function vg(e,t){return gt.repeat(" ",t-e.length)+e}function S9(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],s=[],i,a=-1;i=n.exec(e.buffer);)s.push(i.index),r.push(i.index+i[0].length),e.position<=i.index&&a<0&&(a=r.length-2);a<0&&(a=r.length-1);var l="",c,d,u=Math.min(e.line+t.linesAfter,s.length).toString().length,f=t.maxLength-(t.indent+u+3);for(c=1;c<=t.linesBefore&&!(a-c<0);c++)d=xg(e.buffer,r[a-c],s[a-c],e.position-(r[a]-r[a-c]),f),l=gt.repeat(" ",t.indent)+vg((e.line-c+1).toString(),u)+" | "+d.str+`
`+l;for(d=xg(e.buffer,r[a],s[a],e.position,f),l+=gt.repeat(" ",t.indent)+vg((e.line+1).toString(),u)+" | "+d.str+`
`,l+=gt.repeat("-",t.indent+u+3+d.pos)+`^
`,c=1;c<=t.linesAfter&&!(a+c>=s.length);c++)d=xg(e.buffer,r[a+c],s[a+c],e.position-(r[a]-r[a+c]),f),l+=gt.repeat(" ",t.indent)+vg((e.line+c+1).toString(),u)+" | "+d.str+`
`;return l.replace(/\n$/,"")}var k9=S9,N9=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],C9=["scalar","sequence","mapping"];function E9(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}function T9(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(N9.indexOf(n)===-1)throw new Lt('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=E9(t.styleAliases||null),C9.indexOf(this.kind)===-1)throw new Lt('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var Ct=T9;function aS(e,t){var n=[];return e[t].forEach(function(r){var s=n.length;n.forEach(function(i,a){i.tag===r.tag&&i.kind===r.kind&&i.multi===r.multi&&(s=a)}),n[s]=r}),n}function R9(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(s){s.multi?(e.multi[s.kind].push(s),e.multi.fallback.push(s)):e[s.kind][s.tag]=e.fallback[s.tag]=s}for(t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}function Ux(e){return this.extend(e)}Ux.prototype.extend=function(t){var n=[],r=[];if(t instanceof Ct)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new Lt("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(i){if(!(i instanceof Ct))throw new Lt("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(i.loadKind&&i.loadKind!=="scalar")throw new Lt("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(i.multi)throw new Lt("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(i){if(!(i instanceof Ct))throw new Lt("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var s=Object.create(Ux.prototype);return s.implicit=(this.implicit||[]).concat(n),s.explicit=(this.explicit||[]).concat(r),s.compiledImplicit=aS(s,"implicit"),s.compiledExplicit=aS(s,"explicit"),s.compiledTypeMap=R9(s.compiledImplicit,s.compiledExplicit),s};var e3=Ux,t3=new Ct("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),n3=new Ct("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),r3=new Ct("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),s3=new e3({explicit:[t3,n3,r3]});function A9(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}function I9(){return null}function P9(e){return e===null}var i3=new Ct("tag:yaml.org,2002:null",{kind:"scalar",resolve:A9,construct:I9,predicate:P9,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function M9(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}function O9(e){return e==="true"||e==="True"||e==="TRUE"}function D9(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var o3=new Ct("tag:yaml.org,2002:bool",{kind:"scalar",resolve:M9,construct:O9,predicate:D9,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function L9(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function z9(e){return 48<=e&&e<=55}function F9(e){return 48<=e&&e<=57}function $9(e){if(e===null)return!1;var t=e.length,n=0,r=!1,s;if(!t)return!1;if(s=e[n],(s==="-"||s==="+")&&(s=e[++n]),s==="0"){if(n+1===t)return!0;if(s=e[++n],s==="b"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(s!=="0"&&s!=="1")return!1;r=!0}return r&&s!=="_"}if(s==="x"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!L9(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}if(s==="o"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!z9(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}}if(s==="_")return!1;for(;n<t;n++)if(s=e[n],s!=="_"){if(!F9(e.charCodeAt(n)))return!1;r=!0}return!(!r||s==="_")}function q9(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}function B9(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!gt.isNegativeZero(e)}var a3=new Ct("tag:yaml.org,2002:int",{kind:"scalar",resolve:$9,construct:q9,predicate:B9,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),W9=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function H9(e){return!(e===null||!W9.test(e)||e[e.length-1]==="_")}function V9(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}var U9=/^[-+]?[0-9]+e/;function G9(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(gt.isNegativeZero(e))return"-0.0";return n=e.toString(10),U9.test(n)?n.replace("e",".e"):n}function K9(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||gt.isNegativeZero(e))}var l3=new Ct("tag:yaml.org,2002:float",{kind:"scalar",resolve:H9,construct:V9,predicate:K9,represent:G9,defaultStyle:"lowercase"}),c3=s3.extend({implicit:[i3,o3,a3,l3]}),u3=c3,d3=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),f3=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function Y9(e){return e===null?!1:d3.exec(e)!==null||f3.exec(e)!==null}function X9(e){var t,n,r,s,i,a,l,c=0,d=null,u,f,p;if(t=d3.exec(e),t===null&&(t=f3.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,s=+t[3],!t[4])return new Date(Date.UTC(n,r,s));if(i=+t[4],a=+t[5],l=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(u=+t[10],f=+(t[11]||0),d=(u*60+f)*6e4,t[9]==="-"&&(d=-d)),p=new Date(Date.UTC(n,r,s,i,a,l,c)),d&&p.setTime(p.getTime()-d),p}function Q9(e){return e.toISOString()}var p3=new Ct("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:Y9,construct:X9,instanceOf:Date,represent:Q9});function Z9(e){return e==="<<"||e===null}var h3=new Ct("tag:yaml.org,2002:merge",{kind:"scalar",resolve:Z9}),Py=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function J9(e){if(e===null)return!1;var t,n,r=0,s=e.length,i=Py;for(n=0;n<s;n++)if(t=i.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}function e7(e){var t,n,r=e.replace(/[\r\n=]/g,""),s=r.length,i=Py,a=0,l=[];for(t=0;t<s;t++)t%4===0&&t&&(l.push(a>>16&255),l.push(a>>8&255),l.push(a&255)),a=a<<6|i.indexOf(r.charAt(t));return n=s%4*6,n===0?(l.push(a>>16&255),l.push(a>>8&255),l.push(a&255)):n===18?(l.push(a>>10&255),l.push(a>>2&255)):n===12&&l.push(a>>4&255),new Uint8Array(l)}function t7(e){var t="",n=0,r,s,i=e.length,a=Py;for(r=0;r<i;r++)r%3===0&&r&&(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]),n=(n<<8)+e[r];return s=i%3,s===0?(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]):s===2?(t+=a[n>>10&63],t+=a[n>>4&63],t+=a[n<<2&63],t+=a[64]):s===1&&(t+=a[n>>2&63],t+=a[n<<4&63],t+=a[64],t+=a[64]),t}function n7(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var m3=new Ct("tag:yaml.org,2002:binary",{kind:"scalar",resolve:J9,construct:e7,predicate:n7,represent:t7}),r7=Object.prototype.hasOwnProperty,s7=Object.prototype.toString;function i7(e){if(e===null)return!0;var t=[],n,r,s,i,a,l=e;for(n=0,r=l.length;n<r;n+=1){if(s=l[n],a=!1,s7.call(s)!=="[object Object]")return!1;for(i in s)if(r7.call(s,i))if(!a)a=!0;else return!1;if(!a)return!1;if(t.indexOf(i)===-1)t.push(i);else return!1}return!0}function o7(e){return e!==null?e:[]}var g3=new Ct("tag:yaml.org,2002:omap",{kind:"sequence",resolve:i7,construct:o7}),a7=Object.prototype.toString;function l7(e){if(e===null)return!0;var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1){if(r=a[t],a7.call(r)!=="[object Object]"||(s=Object.keys(r),s.length!==1))return!1;i[t]=[s[0],r[s[0]]]}return!0}function c7(e){if(e===null)return[];var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1)r=a[t],s=Object.keys(r),i[t]=[s[0],r[s[0]]];return i}var x3=new Ct("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:l7,construct:c7}),u7=Object.prototype.hasOwnProperty;function d7(e){if(e===null)return!0;var t,n=e;for(t in n)if(u7.call(n,t)&&n[t]!==null)return!1;return!0}function f7(e){return e!==null?e:{}}var v3=new Ct("tag:yaml.org,2002:set",{kind:"mapping",resolve:d7,construct:f7}),My=u3.extend({implicit:[p3,h3],explicit:[m3,g3,x3,v3]}),Qr=Object.prototype.hasOwnProperty,kc=1,y3=2,b3=3,Nc=4,yg=1,p7=2,lS=3,h7=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,m7=/[\x85\u2028\u2029]/,g7=/[,\[\]\{\}]/,_3=/^(?:!|!!|![a-z\-]+!)$/i,w3=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function cS(e){return Object.prototype.toString.call(e)}function Gn(e){return e===10||e===13}function ys(e){return e===9||e===32}function Vt(e){return e===9||e===32||e===10||e===13}function si(e){return e===44||e===91||e===93||e===123||e===125}function x7(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}function v7(e){return e===120?2:e===117?4:e===85?8:0}function y7(e){return 48<=e&&e<=57?e-48:-1}function uS(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function b7(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}function j3(e,t,n){t==="__proto__"?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:n}):e[t]=n}var S3=new Array(256),k3=new Array(256);for(var Fs=0;Fs<256;Fs++)S3[Fs]=uS(Fs)?1:0,k3[Fs]=uS(Fs);function _7(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||My,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function N3(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=k9(n),new Lt(t,n)}function he(e,t){throw N3(e,t)}function Cc(e,t){e.onWarning&&e.onWarning.call(null,N3(e,t))}var dS={YAML:function(t,n,r){var s,i,a;t.version!==null&&he(t,"duplication of %YAML directive"),r.length!==1&&he(t,"YAML directive accepts exactly one argument"),s=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),s===null&&he(t,"ill-formed argument of the YAML directive"),i=parseInt(s[1],10),a=parseInt(s[2],10),i!==1&&he(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=a<2,a!==1&&a!==2&&Cc(t,"unsupported YAML version of the document")},TAG:function(t,n,r){var s,i;r.length!==2&&he(t,"TAG directive accepts exactly two arguments"),s=r[0],i=r[1],_3.test(s)||he(t,"ill-formed tag handle (first argument) of the TAG directive"),Qr.call(t.tagMap,s)&&he(t,'there is a previously declared suffix for "'+s+'" tag handle'),w3.test(i)||he(t,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch{he(t,"tag prefix is malformed: "+i)}t.tagMap[s]=i}};function Gr(e,t,n,r){var s,i,a,l;if(t<n){if(l=e.input.slice(t,n),r)for(s=0,i=l.length;s<i;s+=1)a=l.charCodeAt(s),a===9||32<=a&&a<=1114111||he(e,"expected valid JSON character");else h7.test(l)&&he(e,"the stream contains non-printable characters");e.result+=l}}function fS(e,t,n,r){var s,i,a,l;for(gt.isObject(n)||he(e,"cannot merge mappings; the provided source object is unacceptable"),s=Object.keys(n),a=0,l=s.length;a<l;a+=1)i=s[a],Qr.call(t,i)||(j3(t,i,n[i]),r[i]=!0)}function ii(e,t,n,r,s,i,a,l,c){var d,u;if(Array.isArray(s))for(s=Array.prototype.slice.call(s),d=0,u=s.length;d<u;d+=1)Array.isArray(s[d])&&he(e,"nested arrays are not supported inside keys"),typeof s=="object"&&cS(s[d])==="[object Object]"&&(s[d]="[object Object]");if(typeof s=="object"&&cS(s)==="[object Object]"&&(s="[object Object]"),s=String(s),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(i))for(d=0,u=i.length;d<u;d+=1)fS(e,t,i[d],n);else fS(e,t,i,n);else!e.json&&!Qr.call(n,s)&&Qr.call(t,s)&&(e.line=a||e.line,e.lineStart=l||e.lineStart,e.position=c||e.position,he(e,"duplicated mapping key")),j3(t,s,i),delete n[s];return t}function Oy(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):he(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function dt(e,t,n){for(var r=0,s=e.input.charCodeAt(e.position);s!==0;){for(;ys(s);)s===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),s=e.input.charCodeAt(++e.position);if(t&&s===35)do s=e.input.charCodeAt(++e.position);while(s!==10&&s!==13&&s!==0);if(Gn(s))for(Oy(e),s=e.input.charCodeAt(e.position),r++,e.lineIndent=0;s===32;)e.lineIndent++,s=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&Cc(e,"deficient indentation"),r}function Nu(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||Vt(n)))}function Dy(e,t){t===1?e.result+=" ":t>1&&(e.result+=gt.repeat(`
`,t-1))}function w7(e,t,n){var r,s,i,a,l,c,d,u,f=e.kind,p=e.result,h;if(h=e.input.charCodeAt(e.position),Vt(h)||si(h)||h===35||h===38||h===42||h===33||h===124||h===62||h===39||h===34||h===37||h===64||h===96||(h===63||h===45)&&(s=e.input.charCodeAt(e.position+1),Vt(s)||n&&si(s)))return!1;for(e.kind="scalar",e.result="",i=a=e.position,l=!1;h!==0;){if(h===58){if(s=e.input.charCodeAt(e.position+1),Vt(s)||n&&si(s))break}else if(h===35){if(r=e.input.charCodeAt(e.position-1),Vt(r))break}else{if(e.position===e.lineStart&&Nu(e)||n&&si(h))break;if(Gn(h))if(c=e.line,d=e.lineStart,u=e.lineIndent,dt(e,!1,-1),e.lineIndent>=t){l=!0,h=e.input.charCodeAt(e.position);continue}else{e.position=a,e.line=c,e.lineStart=d,e.lineIndent=u;break}}l&&(Gr(e,i,a,!1),Dy(e,e.line-c),i=a=e.position,l=!1),ys(h)||(a=e.position+1),h=e.input.charCodeAt(++e.position)}return Gr(e,i,a,!1),e.result?!0:(e.kind=f,e.result=p,!1)}function j7(e,t){var n,r,s;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=s=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(Gr(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,s=e.position;else return!0;else Gn(n)?(Gr(e,r,s,!0),Dy(e,dt(e,!1,t)),r=s=e.position):e.position===e.lineStart&&Nu(e)?he(e,"unexpected end of the document within a single quoted scalar"):(e.position++,s=e.position);he(e,"unexpected end of the stream within a single quoted scalar")}function S7(e,t){var n,r,s,i,a,l;if(l=e.input.charCodeAt(e.position),l!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(l=e.input.charCodeAt(e.position))!==0;){if(l===34)return Gr(e,n,e.position,!0),e.position++,!0;if(l===92){if(Gr(e,n,e.position,!0),l=e.input.charCodeAt(++e.position),Gn(l))dt(e,!1,t);else if(l<256&&S3[l])e.result+=k3[l],e.position++;else if((a=v7(l))>0){for(s=a,i=0;s>0;s--)l=e.input.charCodeAt(++e.position),(a=x7(l))>=0?i=(i<<4)+a:he(e,"expected hexadecimal character");e.result+=b7(i),e.position++}else he(e,"unknown escape sequence");n=r=e.position}else Gn(l)?(Gr(e,n,r,!0),Dy(e,dt(e,!1,t)),n=r=e.position):e.position===e.lineStart&&Nu(e)?he(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}he(e,"unexpected end of the stream within a double quoted scalar")}function k7(e,t){var n=!0,r,s,i,a=e.tag,l,c=e.anchor,d,u,f,p,h,v=Object.create(null),g,_,x,y;if(y=e.input.charCodeAt(e.position),y===91)u=93,h=!1,l=[];else if(y===123)u=125,h=!0,l={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),y=e.input.charCodeAt(++e.position);y!==0;){if(dt(e,!0,t),y=e.input.charCodeAt(e.position),y===u)return e.position++,e.tag=a,e.anchor=c,e.kind=h?"mapping":"sequence",e.result=l,!0;n?y===44&&he(e,"expected the node content, but found ','"):he(e,"missed comma between flow collection entries"),_=g=x=null,f=p=!1,y===63&&(d=e.input.charCodeAt(e.position+1),Vt(d)&&(f=p=!0,e.position++,dt(e,!0,t))),r=e.line,s=e.lineStart,i=e.position,Ci(e,t,kc,!1,!0),_=e.tag,g=e.result,dt(e,!0,t),y=e.input.charCodeAt(e.position),(p||e.line===r)&&y===58&&(f=!0,y=e.input.charCodeAt(++e.position),dt(e,!0,t),Ci(e,t,kc,!1,!0),x=e.result),h?ii(e,l,v,_,g,x,r,s,i):f?l.push(ii(e,null,v,_,g,x,r,s,i)):l.push(g),dt(e,!0,t),y=e.input.charCodeAt(e.position),y===44?(n=!0,y=e.input.charCodeAt(++e.position)):n=!1}he(e,"unexpected end of the stream within a flow collection")}function N7(e,t){var n,r,s=yg,i=!1,a=!1,l=t,c=0,d=!1,u,f;if(f=e.input.charCodeAt(e.position),f===124)r=!1;else if(f===62)r=!0;else return!1;for(e.kind="scalar",e.result="";f!==0;)if(f=e.input.charCodeAt(++e.position),f===43||f===45)yg===s?s=f===43?lS:p7:he(e,"repeat of a chomping mode identifier");else if((u=y7(f))>=0)u===0?he(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?he(e,"repeat of an indentation width identifier"):(l=t+u-1,a=!0);else break;if(ys(f)){do f=e.input.charCodeAt(++e.position);while(ys(f));if(f===35)do f=e.input.charCodeAt(++e.position);while(!Gn(f)&&f!==0)}for(;f!==0;){for(Oy(e),e.lineIndent=0,f=e.input.charCodeAt(e.position);(!a||e.lineIndent<l)&&f===32;)e.lineIndent++,f=e.input.charCodeAt(++e.position);if(!a&&e.lineIndent>l&&(l=e.lineIndent),Gn(f)){c++;continue}if(e.lineIndent<l){s===lS?e.result+=gt.repeat(`
`,i?1+c:c):s===yg&&i&&(e.result+=`
`);break}for(r?ys(f)?(d=!0,e.result+=gt.repeat(`
`,i?1+c:c)):d?(d=!1,e.result+=gt.repeat(`
`,c+1)):c===0?i&&(e.result+=" "):e.result+=gt.repeat(`
`,c):e.result+=gt.repeat(`
`,i?1+c:c),i=!0,a=!0,c=0,n=e.position;!Gn(f)&&f!==0;)f=e.input.charCodeAt(++e.position);Gr(e,n,e.position,!1)}return!0}function pS(e,t){var n,r=e.tag,s=e.anchor,i=[],a,l=!1,c;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=i),c=e.input.charCodeAt(e.position);c!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,he(e,"tab characters must not be used in indentation")),!(c!==45||(a=e.input.charCodeAt(e.position+1),!Vt(a))));){if(l=!0,e.position++,dt(e,!0,-1)&&e.lineIndent<=t){i.push(null),c=e.input.charCodeAt(e.position);continue}if(n=e.line,Ci(e,t,b3,!1,!0),i.push(e.result),dt(e,!0,-1),c=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&c!==0)he(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return l?(e.tag=r,e.anchor=s,e.kind="sequence",e.result=i,!0):!1}function C7(e,t,n){var r,s,i,a,l,c,d=e.tag,u=e.anchor,f={},p=Object.create(null),h=null,v=null,g=null,_=!1,x=!1,y;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=f),y=e.input.charCodeAt(e.position);y!==0;){if(!_&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,he(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),i=e.line,(y===63||y===58)&&Vt(r))y===63?(_&&(ii(e,f,p,h,v,null,a,l,c),h=v=g=null),x=!0,_=!0,s=!0):_?(_=!1,s=!0):he(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,y=r;else{if(a=e.line,l=e.lineStart,c=e.position,!Ci(e,n,y3,!1,!0))break;if(e.line===i){for(y=e.input.charCodeAt(e.position);ys(y);)y=e.input.charCodeAt(++e.position);if(y===58)y=e.input.charCodeAt(++e.position),Vt(y)||he(e,"a whitespace character is expected after the key-value separator within a block mapping"),_&&(ii(e,f,p,h,v,null,a,l,c),h=v=g=null),x=!0,_=!1,s=!1,h=e.tag,v=e.result;else if(x)he(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=d,e.anchor=u,!0}else if(x)he(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=d,e.anchor=u,!0}if((e.line===i||e.lineIndent>t)&&(_&&(a=e.line,l=e.lineStart,c=e.position),Ci(e,t,Nc,!0,s)&&(_?v=e.result:g=e.result),_||(ii(e,f,p,h,v,g,a,l,c),h=v=g=null),dt(e,!0,-1),y=e.input.charCodeAt(e.position)),(e.line===i||e.lineIndent>t)&&y!==0)he(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return _&&ii(e,f,p,h,v,null,a,l,c),x&&(e.tag=d,e.anchor=u,e.kind="mapping",e.result=f),x}function E7(e){var t,n=!1,r=!1,s,i,a;if(a=e.input.charCodeAt(e.position),a!==33)return!1;if(e.tag!==null&&he(e,"duplication of a tag property"),a=e.input.charCodeAt(++e.position),a===60?(n=!0,a=e.input.charCodeAt(++e.position)):a===33?(r=!0,s="!!",a=e.input.charCodeAt(++e.position)):s="!",t=e.position,n){do a=e.input.charCodeAt(++e.position);while(a!==0&&a!==62);e.position<e.length?(i=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):he(e,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!Vt(a);)a===33&&(r?he(e,"tag suffix cannot contain exclamation marks"):(s=e.input.slice(t-1,e.position+1),_3.test(s)||he(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),g7.test(i)&&he(e,"tag suffix cannot contain flow indicator characters")}i&&!w3.test(i)&&he(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch{he(e,"tag name is malformed: "+i)}return n?e.tag=i:Qr.call(e.tagMap,s)?e.tag=e.tagMap[s]+i:s==="!"?e.tag="!"+i:s==="!!"?e.tag="tag:yaml.org,2002:"+i:he(e,'undeclared tag handle "'+s+'"'),!0}function T7(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&he(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Vt(n)&&!si(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&he(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function R7(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Vt(r)&&!si(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&he(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),Qr.call(e.anchorMap,n)||he(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],dt(e,!0,-1),!0}function Ci(e,t,n,r,s){var i,a,l,c=1,d=!1,u=!1,f,p,h,v,g,_;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,i=a=l=Nc===n||b3===n,r&&dt(e,!0,-1)&&(d=!0,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)),c===1)for(;E7(e)||T7(e);)dt(e,!0,-1)?(d=!0,l=i,e.lineIndent>t?c=1:e.lineIndent===t?c=0:e.lineIndent<t&&(c=-1)):l=!1;if(l&&(l=d||s),(c===1||Nc===n)&&(kc===n||y3===n?g=t:g=t+1,_=e.position-e.lineStart,c===1?l&&(pS(e,_)||C7(e,_,g))||k7(e,g)?u=!0:(a&&N7(e,g)||j7(e,g)||S7(e,g)?u=!0:R7(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&he(e,"alias node should not have any properties")):w7(e,g,kc===n)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):c===0&&(u=l&&pS(e,_))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&he(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),f=0,p=e.implicitTypes.length;f<p;f+=1)if(v=e.implicitTypes[f],v.resolve(e.result)){e.result=v.construct(e.result),e.tag=v.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Qr.call(e.typeMap[e.kind||"fallback"],e.tag))v=e.typeMap[e.kind||"fallback"][e.tag];else for(v=null,h=e.typeMap.multi[e.kind||"fallback"],f=0,p=h.length;f<p;f+=1)if(e.tag.slice(0,h[f].tag.length)===h[f].tag){v=h[f];break}v||he(e,"unknown tag !<"+e.tag+">"),e.result!==null&&v.kind!==e.kind&&he(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+v.kind+'", not "'+e.kind+'"'),v.resolve(e.result,e.tag)?(e.result=v.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):he(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}function A7(e){var t=e.position,n,r,s,i=!1,a;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(a=e.input.charCodeAt(e.position))!==0&&(dt(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||a!==37));){for(i=!0,a=e.input.charCodeAt(++e.position),n=e.position;a!==0&&!Vt(a);)a=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),s=[],r.length<1&&he(e,"directive name must not be less than one character in length");a!==0;){for(;ys(a);)a=e.input.charCodeAt(++e.position);if(a===35){do a=e.input.charCodeAt(++e.position);while(a!==0&&!Gn(a));break}if(Gn(a))break;for(n=e.position;a!==0&&!Vt(a);)a=e.input.charCodeAt(++e.position);s.push(e.input.slice(n,e.position))}a!==0&&Oy(e),Qr.call(dS,r)?dS[r](e,r,s):Cc(e,'unknown document directive "'+r+'"')}if(dt(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,dt(e,!0,-1)):i&&he(e,"directives end mark is expected"),Ci(e,e.lineIndent-1,Nc,!1,!0),dt(e,!0,-1),e.checkLineBreaks&&m7.test(e.input.slice(t,e.position))&&Cc(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&Nu(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,dt(e,!0,-1));return}if(e.position<e.length-1)he(e,"end of the stream or a document separator is expected");else return}function C3(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new _7(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,he(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)A7(n);return n.documents}function I7(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=C3(e,n);if(typeof t!="function")return r;for(var s=0,i=r.length;s<i;s+=1)t(r[s])}function P7(e,t){var n=C3(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new Lt("expected a single document in the stream, but found more")}}var M7=I7,O7=P7,E3={loadAll:M7,load:O7},T3=Object.prototype.toString,R3=Object.prototype.hasOwnProperty,Ly=65279,D7=9,la=10,L7=13,z7=32,F7=33,$7=34,Gx=35,q7=37,B7=38,W7=39,H7=42,A3=44,V7=45,Ec=58,U7=61,G7=62,K7=63,Y7=64,I3=91,P3=93,X7=96,M3=123,Q7=124,O3=125,Ot={};Ot[0]="\\0";Ot[7]="\\a";Ot[8]="\\b";Ot[9]="\\t";Ot[10]="\\n";Ot[11]="\\v";Ot[12]="\\f";Ot[13]="\\r";Ot[27]="\\e";Ot[34]='\\"';Ot[92]="\\\\";Ot[133]="\\N";Ot[160]="\\_";Ot[8232]="\\L";Ot[8233]="\\P";var Z7=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],J7=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function eW(e,t){var n,r,s,i,a,l,c;if(t===null)return{};for(n={},r=Object.keys(t),s=0,i=r.length;s<i;s+=1)a=r[s],l=String(t[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),c=e.compiledTypeMap.fallback[a],c&&R3.call(c.styleAliases,l)&&(l=c.styleAliases[l]),n[a]=l;return n}function tW(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new Lt("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+gt.repeat("0",r-t.length)+t}var nW=1,ca=2;function rW(e){this.schema=e.schema||My,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=gt.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=eW(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?ca:nW,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function hS(e,t){for(var n=gt.repeat(" ",t),r=0,s=-1,i="",a,l=e.length;r<l;)s=e.indexOf(`
`,r),s===-1?(a=e.slice(r),r=l):(a=e.slice(r,s+1),r=s+1),a.length&&a!==`
`&&(i+=n),i+=a;return i}function Kx(e,t){return`
`+gt.repeat(" ",e.indent*t)}function sW(e,t){var n,r,s;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(s=e.implicitTypes[n],s.resolve(t))return!0;return!1}function Tc(e){return e===z7||e===D7}function ua(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Ly||65536<=e&&e<=1114111}function mS(e){return ua(e)&&e!==Ly&&e!==L7&&e!==la}function gS(e,t,n){var r=mS(e),s=r&&!Tc(e);return(n?r:r&&e!==A3&&e!==I3&&e!==P3&&e!==M3&&e!==O3)&&e!==Gx&&!(t===Ec&&!s)||mS(t)&&!Tc(t)&&e===Gx||t===Ec&&s}function iW(e){return ua(e)&&e!==Ly&&!Tc(e)&&e!==V7&&e!==K7&&e!==Ec&&e!==A3&&e!==I3&&e!==P3&&e!==M3&&e!==O3&&e!==Gx&&e!==B7&&e!==H7&&e!==F7&&e!==Q7&&e!==U7&&e!==G7&&e!==W7&&e!==$7&&e!==q7&&e!==Y7&&e!==X7}function oW(e){return!Tc(e)&&e!==Ec}function wo(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}function D3(e){var t=/^\n* /;return t.test(e)}var L3=1,Yx=2,z3=3,F3=4,Ws=5;function aW(e,t,n,r,s,i,a,l){var c,d=0,u=null,f=!1,p=!1,h=r!==-1,v=-1,g=iW(wo(e,0))&&oW(wo(e,e.length-1));if(t||a)for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=wo(e,c),!ua(d))return Ws;g=g&&gS(d,u,l),u=d}else{for(c=0;c<e.length;d>=65536?c+=2:c++){if(d=wo(e,c),d===la)f=!0,h&&(p=p||c-v-1>r&&e[v+1]!==" ",v=c);else if(!ua(d))return Ws;g=g&&gS(d,u,l),u=d}p=p||h&&c-v-1>r&&e[v+1]!==" "}return!f&&!p?g&&!a&&!s(e)?L3:i===ca?Ws:Yx:n>9&&D3(e)?Ws:a?i===ca?Ws:Yx:p?F3:z3}function lW(e,t,n,r,s){e.dump=function(){if(t.length===0)return e.quotingType===ca?'""':"''";if(!e.noCompatMode&&(Z7.indexOf(t)!==-1||J7.test(t)))return e.quotingType===ca?'"'+t+'"':"'"+t+"'";var i=e.indent*Math.max(1,n),a=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-i),l=r||e.flowLevel>-1&&n>=e.flowLevel;function c(d){return sW(e,d)}switch(aW(t,l,e.indent,a,c,e.quotingType,e.forceQuotes&&!r,s)){case L3:return t;case Yx:return"'"+t.replace(/'/g,"''")+"'";case z3:return"|"+xS(t,e.indent)+vS(hS(t,i));case F3:return">"+xS(t,e.indent)+vS(hS(cW(t,a),i));case Ws:return'"'+uW(t)+'"';default:throw new Lt("impossible error: invalid scalar style")}}()}function xS(e,t){var n=D3(e)?String(t):"",r=e[e.length-1]===`
`,s=r&&(e[e.length-2]===`
`||e===`
`),i=s?"+":r?"":"-";return n+i+`
`}function vS(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function cW(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var d=e.indexOf(`
`);return d=d!==-1?d:e.length,n.lastIndex=d,yS(e.slice(0,d),t)}(),s=e[0]===`
`||e[0]===" ",i,a;a=n.exec(e);){var l=a[1],c=a[2];i=c[0]===" ",r+=l+(!s&&!i&&c!==""?`
`:"")+yS(c,t),s=i}return r}function yS(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,s=0,i,a=0,l=0,c="";r=n.exec(e);)l=r.index,l-s>t&&(i=a>s?a:l,c+=`
`+e.slice(s,i),s=i+1),a=l;return c+=`
`,e.length-s>t&&a>s?c+=e.slice(s,a)+`
`+e.slice(a+1):c+=e.slice(s),c.slice(1)}function uW(e){for(var t="",n=0,r,s=0;s<e.length;n>=65536?s+=2:s++)n=wo(e,s),r=Ot[n],!r&&ua(n)?(t+=e[s],n>=65536&&(t+=e[s+1])):t+=r||tW(n);return t}function dW(e,t,n){var r="",s=e.tag,i,a,l;for(i=0,a=n.length;i<a;i+=1)l=n[i],e.replacer&&(l=e.replacer.call(n,String(i),l)),(xr(e,t,l,!1,!1)||typeof l>"u"&&xr(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=s,e.dump="["+r+"]"}function bS(e,t,n,r){var s="",i=e.tag,a,l,c;for(a=0,l=n.length;a<l;a+=1)c=n[a],e.replacer&&(c=e.replacer.call(n,String(a),c)),(xr(e,t+1,c,!0,!0,!1,!0)||typeof c>"u"&&xr(e,t+1,null,!0,!0,!1,!0))&&((!r||s!=="")&&(s+=Kx(e,t)),e.dump&&la===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=i,e.dump=s||"[]"}function fW(e,t,n){var r="",s=e.tag,i=Object.keys(n),a,l,c,d,u;for(a=0,l=i.length;a<l;a+=1)u="",r!==""&&(u+=", "),e.condenseFlow&&(u+='"'),c=i[a],d=n[c],e.replacer&&(d=e.replacer.call(n,c,d)),xr(e,t,c,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),xr(e,t,d,!1,!1)&&(u+=e.dump,r+=u));e.tag=s,e.dump="{"+r+"}"}function pW(e,t,n,r){var s="",i=e.tag,a=Object.keys(n),l,c,d,u,f,p;if(e.sortKeys===!0)a.sort();else if(typeof e.sortKeys=="function")a.sort(e.sortKeys);else if(e.sortKeys)throw new Lt("sortKeys must be a boolean or a function");for(l=0,c=a.length;l<c;l+=1)p="",(!r||s!=="")&&(p+=Kx(e,t)),d=a[l],u=n[d],e.replacer&&(u=e.replacer.call(n,d,u)),xr(e,t+1,d,!0,!0,!0)&&(f=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,f&&(e.dump&&la===e.dump.charCodeAt(0)?p+="?":p+="? "),p+=e.dump,f&&(p+=Kx(e,t)),xr(e,t+1,u,!0,f)&&(e.dump&&la===e.dump.charCodeAt(0)?p+=":":p+=": ",p+=e.dump,s+=p));e.tag=i,e.dump=s||"{}"}function _S(e,t,n){var r,s,i,a,l,c;for(s=n?e.explicitTypes:e.implicitTypes,i=0,a=s.length;i<a;i+=1)if(l=s[i],(l.instanceOf||l.predicate)&&(!l.instanceOf||typeof t=="object"&&t instanceof l.instanceOf)&&(!l.predicate||l.predicate(t))){if(n?l.multi&&l.representName?e.tag=l.representName(t):e.tag=l.tag:e.tag="?",l.represent){if(c=e.styleMap[l.tag]||l.defaultStyle,T3.call(l.represent)==="[object Function]")r=l.represent(t,c);else if(R3.call(l.represent,c))r=l.represent[c](t,c);else throw new Lt("!<"+l.tag+'> tag resolver accepts not "'+c+'" style');e.dump=r}return!0}return!1}function xr(e,t,n,r,s,i,a){e.tag=null,e.dump=n,_S(e,n,!1)||_S(e,n,!0);var l=T3.call(e.dump),c=r,d;r&&(r=e.flowLevel<0||e.flowLevel>t);var u=l==="[object Object]"||l==="[object Array]",f,p;if(u&&(f=e.duplicates.indexOf(n),p=f!==-1),(e.tag!==null&&e.tag!=="?"||p||e.indent!==2&&t>0)&&(s=!1),p&&e.usedDuplicates[f])e.dump="*ref_"+f;else{if(u&&p&&!e.usedDuplicates[f]&&(e.usedDuplicates[f]=!0),l==="[object Object]")r&&Object.keys(e.dump).length!==0?(pW(e,t,e.dump,s),p&&(e.dump="&ref_"+f+e.dump)):(fW(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!a&&t>0?bS(e,t-1,e.dump,s):bS(e,t,e.dump,s),p&&(e.dump="&ref_"+f+e.dump)):(dW(e,t,e.dump),p&&(e.dump="&ref_"+f+" "+e.dump));else if(l==="[object String]")e.tag!=="?"&&lW(e,e.dump,t,i,c);else{if(l==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new Lt("unacceptable kind of an object to dump "+l)}e.tag!==null&&e.tag!=="?"&&(d=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?d="!"+d:d.slice(0,18)==="tag:yaml.org,2002:"?d="!!"+d.slice(18):d="!<"+d+">",e.dump=d+" "+e.dump)}return!0}function hW(e,t){var n=[],r=[],s,i;for(Xx(e,n,r),s=0,i=r.length;s<i;s+=1)t.duplicates.push(n[r[s]]);t.usedDuplicates=new Array(i)}function Xx(e,t,n){var r,s,i;if(e!==null&&typeof e=="object")if(s=t.indexOf(e),s!==-1)n.indexOf(s)===-1&&n.push(s);else if(t.push(e),Array.isArray(e))for(s=0,i=e.length;s<i;s+=1)Xx(e[s],t,n);else for(r=Object.keys(e),s=0,i=r.length;s<i;s+=1)Xx(e[r[s]],t,n)}function mW(e,t){t=t||{};var n=new rW(t);n.noRefs||hW(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),xr(n,0,r,!0,!0)?n.dump+`
`:""}var gW=mW,xW={dump:gW};function zy(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var vW=Ct,yW=e3,bW=s3,_W=c3,wW=u3,jW=My,SW=E3.load,kW=E3.loadAll,NW=xW.dump,CW=Lt,EW={binary:m3,float:l3,map:r3,null:i3,pairs:x3,set:v3,timestamp:p3,bool:o3,int:a3,merge:h3,omap:g3,seq:n3,str:t3},TW=zy("safeLoad","load"),RW=zy("safeLoadAll","loadAll"),AW=zy("safeDump","dump"),Fy={Type:vW,Schema:yW,FAILSAFE_SCHEMA:bW,JSON_SCHEMA:_W,CORE_SCHEMA:wW,DEFAULT_SCHEMA:jW,load:SW,loadAll:kW,dump:NW,YAMLException:CW,types:EW,safeLoad:TW,safeLoadAll:RW,safeDump:AW};function wS({messages:e,pendingPrompt:t,introContent:n}){const r=m.useRef(null);return m.useEffect(()=>{var s;(s=r.current)==null||s.scrollIntoView({behavior:"smooth"})},[e,t]),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",onWheel:s=>s.stopPropagation(),children:[n,e.map((s,i)=>o.jsx("div",{className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:o.jsx("div",{className:`max-w-[85%] rounded-lg px-3 py-2 text-sm ${s.role==="user"?"bg-emerald-500/20 text-emerald-100 rounded-br-sm":"bg-violet-500/20 text-violet-100 rounded-bl-sm"}`,children:s.content})},i)),t&&o.jsx("div",{className:"flex justify-start",children:o.jsx("div",{className:"max-w-[85%] rounded-lg px-3 py-2 text-sm bg-violet-500/20 text-violet-100 rounded-bl-sm",children:t})}),o.jsx("div",{ref:r})]})}function IW({onSubmit:e,disabled:t,placeholder:n}){const[r,s]=m.useState(""),i=m.useRef(null);m.useEffect(()=>{var c;t||(c=i.current)==null||c.focus()},[t]);const a=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),r.trim()&&!t&&(e(r.trim()),s("")))},l=()=>{r.trim()&&!t&&(e(r.trim()),s(""))};return o.jsxs("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("textarea",{ref:i,value:r,onChange:c=>s(c.target.value),onKeyDown:a,disabled:t,placeholder:n||"Type your message...",rows:2,className:"flex-1 rounded-lg px-3 py-2 text-sm resize-none",style:{background:"var(--bg-input)",border:"1px solid var(--border-input)",color:"var(--text-primary)"}}),o.jsx("button",{onClick:l,disabled:t||!r.trim(),className:`px-4 rounded-lg font-medium text-sm transition-colors ${t||!r.trim()?"bg-slate-600 text-slate-400 cursor-not-allowed":"bg-violet-500 text-white hover:bg-violet-400"}`,children:"Send"})]}),o.jsx("p",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:"Press Enter to send, Shift+Enter for newline"})]})}const jS={qualified:{icon:"check",iconBg:"bg-emerald-500/20",iconColor:"text-emerald-400",title:"Project Created",description:"Your project is ready for PM Discovery."},not_ready:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Not Ready",description:"Additional information is needed before proceeding."},out_of_scope:{icon:"x",iconBg:"bg-slate-500/20",iconColor:"text-slate-400",title:"Out of Scope",description:"This request is outside the scope of The Combine."},redirect:{icon:"arrow",iconBg:"bg-blue-500/20",iconColor:"text-blue-400",title:"Redirected",description:"This request has been redirected to a different engagement type."},blocked:{icon:"warning",iconBg:"bg-amber-500/20",iconColor:"text-amber-400",title:"Blocked",description:"The workflow could not complete due to validation issues."}};function PW({type:e,className:t}){switch(e){case"check":return o.jsx("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polyline",{points:"20 6 9 17 4 12"})});case"warning":return o.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M12 9v4M12 17h.01"}),o.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"})]});case"x":return o.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]});case"arrow":return o.jsxs("svg",{className:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),o.jsx("polyline",{points:"12 5 19 12 12 19"})]});default:return null}}function MW({gateOutcome:e,project:t,onViewProject:n,onClose:r}){const s=jS[e]||jS.blocked,i=e==="qualified";return o.jsxs("div",{className:"p-6 text-center",children:[o.jsx("div",{className:`w-16 h-16 rounded-full ${s.iconBg} flex items-center justify-center mx-auto mb-4`,children:o.jsx(PW,{type:s.icon,className:`w-8 h-8 ${s.iconColor}`})}),o.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:s.title}),o.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:s.description}),i&&t&&o.jsxs("div",{className:"rounded-lg p-3 mb-4",style:{background:"var(--bg-input)"},children:[o.jsx("p",{className:"text-xs font-mono mb-1",style:{color:"var(--text-muted)"},children:t.project_id}),o.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:t.name})]}),o.jsxs("div",{className:"flex gap-2 justify-center",children:[i&&t&&o.jsx("button",{onClick:n,className:"px-4 py-2 rounded-lg text-sm font-medium bg-emerald-500 text-white hover:bg-emerald-400 transition-colors",children:"View Project"}),o.jsx("button",{onClick:r,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Close"})]})]})}function OW({operation:e,context:t,onSubmit:n,onCancel:r}){var _;const[s,i]=m.useState("confirm"),[a,l]=m.useState(!1),[c,d]=m.useState((t==null?void 0:t.project_type)||""),[u,f]=m.useState(""),h=((e==null?void 0:e.config)||{}).entry_prompt||"Review the intake classification.",v=[{value:"greenfield",label:"Greenfield (New Project)"},{value:"enhancement",label:"Enhancement (Existing Project)"},{value:"migration",label:"Migration"},{value:"integration",label:"Integration"},{value:"unknown",label:"Unknown / Other"}],g=()=>{l(!0);const x={confirmed:s==="confirm",timestamp:new Date().toISOString()};s==="correct"&&(x.corrected_project_type=c),u.trim()&&(x.notes=u.trim()),n(x)};return o.jsxs("div",{className:"flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-green, #22c55e)",color:"#fff"},children:"Intake"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Concierge Entry"}),o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Confirm or correct the intake classification"})]})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",onWheel:x=>x.stopPropagation(),children:o.jsxs("div",{className:"max-w-2xl space-y-6",children:[o.jsx("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:o.jsx("div",{className:"text-sm",style:{color:"var(--text-primary)"},children:h})}),o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Confirmation requested"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Classification Result"}),o.jsxs("div",{className:"p-4 rounded space-y-3",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Intent Classification"}),o.jsx("span",{className:"px-3 py-1 rounded font-semibold",style:{background:"var(--accent-primary, #3b82f6)",color:"#fff",fontSize:12},children:((_=t==null?void 0:t.project_type)==null?void 0:_.replace(/_/g," ").toUpperCase())||"Unknown"})]}),(t==null?void 0:t.artifact_type)&&o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Artifact Type"}),o.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.artifact_type.replace(/_/g," ")})]}),(t==null?void 0:t.audience)&&o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Audience"}),o.jsx("span",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.audience})]}),(t==null?void 0:t.intake_summary)&&o.jsxs("div",{children:[o.jsx("span",{className:"text-sm block mb-1",style:{color:"var(--text-muted)"},children:"Summary"}),o.jsx("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.intake_summary})]}),(t==null?void 0:t.classification_rationale)&&o.jsxs("div",{children:[o.jsx("span",{className:"text-sm block mb-1",style:{color:"var(--text-muted)"},children:"Rationale"}),o.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:t.classification_rationale})]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Your Decision"}),o.jsxs("div",{className:"flex gap-3",children:[o.jsxs("button",{onClick:()=>i("confirm"),className:"flex-1 p-4 rounded text-left",style:{background:s==="confirm"?"rgba(34, 197, 94, 0.1)":"var(--bg-panel)",border:s==="confirm"?"2px solid #22c55e":"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Confirm"}),o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"The classification is correct"})]}),o.jsxs("button",{onClick:()=>i("correct"),className:"flex-1 p-4 rounded text-left",style:{background:s==="correct"?"rgba(249, 115, 22, 0.1)":"var(--bg-panel)",border:s==="correct"?"2px solid #f97316":"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Correct"}),o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"I need to change the classification before proceeding"})]})]})]}),s==="correct"&&o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Correct Intent Classification"}),o.jsxs("select",{value:c,onChange:x=>d(x.target.value),className:"w-full p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[o.jsx("option",{value:"",children:"Select intent classification..."}),v.map(x=>o.jsx("option",{value:x.value,children:x.label},x.value))]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Notes (Optional)"}),o.jsx("textarea",{value:u,onChange:x=>f(x.target.value),placeholder:"Add any additional context or notes...",className:"w-full p-3 rounded text-sm",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:80,resize:"vertical"}})]})]})}),o.jsxs("div",{className:"px-4 py-3 border-t flex justify-end gap-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[r&&o.jsx("button",{onClick:r,className:"px-4 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:"Cancel"}),o.jsxs("button",{onClick:g,disabled:a||s==="correct"&&!c,className:"px-4 py-2 rounded text-sm font-semibold flex items-center gap-2",style:{background:s==="confirm"?"#22c55e":"#f97316",color:"#fff",opacity:a||s==="correct"&&!c?.5:1},children:[a&&o.jsxs("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s==="confirm"?"Confirm Classification":"Submit Correction"]})]})]})}function DW({onClose:e,onComplete:t}){const{phase:n,messages:r,pendingPrompt:s,gateOutcome:i,project:a,error:l,loading:c,submitting:d,intakeClassification:u,intakeGatePhase:f,startIntake:p,submitMessage:h,reset:v}=s9(),[g,_]=m.useState(null);m.useEffect(()=>(p(),fetch("/content/concierge-intro.yaml").then(E=>E.text()).then(E=>_(Fy.load(E))).catch(E=>console.error("Failed to load intro content:",E)),()=>v()),[]);const x=()=>{v(),e()},y=()=>{a&&t&&t(a),x()},b=E=>{h(JSON.stringify(E))},j=()=>{const E=[{id:"describe",label:"Describe"},{id:"confirm",label:"Confirm"},{id:"complete",label:"Done"}];let S=n;f==="awaiting_confirmation"&&(S="confirm"),(S==="review"||S==="generating")&&(S="complete");const k=E.findIndex(w=>w.id===S);return o.jsx("div",{className:"flex items-center gap-1 text-[10px]",children:E.map((w,R)=>o.jsxs("div",{className:"flex items-center",children:[o.jsx("span",{className:`px-2 py-0.5 rounded ${R===k?"bg-violet-500/30 text-violet-300":R<k?"text-emerald-400":"text-slate-500"}`,children:w.label}),R<E.length-1&&o.jsx("span",{className:"mx-1 text-slate-600",children:"/"})]},w.id))})},N=()=>{var E;if(c&&n==="idle")return o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsx("div",{className:"w-8 h-8 border-2 border-t-violet-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})});if(f==="awaiting_confirmation"&&u)return o.jsx(OW,{operation:{config:{entry_prompt:s}},context:u,onSubmit:b,onCancel:x});switch(n){case"describe":const S=g?o.jsxs("div",{className:"mb-4 pb-4 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsx("h3",{className:"text-base font-semibold mb-3",style:{color:"var(--text-primary)"},children:g.title}),o.jsx("div",{className:"text-sm space-y-3",style:{color:"var(--text-secondary)"},children:(E=g.paragraphs)==null?void 0:E.map((k,w)=>o.jsx("p",{children:k},w))}),g.call_to_action&&o.jsx("p",{className:"text-sm font-medium mt-4",style:{color:"var(--text-primary)"},children:g.call_to_action})]}):null;return o.jsxs(o.Fragment,{children:[o.jsx(wS,{messages:r,pendingPrompt:s,introContent:S}),o.jsx(IW,{onSubmit:h,disabled:d,placeholder:"Describe what you want to build..."})]});case"complete":return o.jsxs(o.Fragment,{children:[o.jsx(wS,{messages:r}),o.jsx(MW,{gateOutcome:i,project:a,onViewProject:y,onClose:x})]});default:return null}};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:"rgba(0, 0, 0, 0.6)"},children:o.jsxs("div",{className:"flex flex-col w-full max-w-lg h-[80vh] rounded-xl shadow-2xl tray-slide",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},onWheel:E=>E.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 rounded-lg bg-violet-500/20 flex items-center justify-center",children:o.jsx("svg",{className:"w-4 h-4 text-violet-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"})})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"New Project"}),j()]})]}),o.jsx("button",{onClick:x,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),l&&o.jsx("div",{className:"px-4 py-2 bg-red-500/20 text-red-300 text-sm",children:l}),N()]})})}function LW({onClose:e}){const{user:t,logout:n,isAdmin:r}=zi(),[s,i]=m.useState(null),[a,l]=m.useState([]),[c,d]=m.useState(!1),[u,f]=m.useState(null);m.useEffect(()=>{s==="linked"&&p()},[s]);const p=async()=>{try{d(!0);const N=await fetch("/auth/accounts",{credentials:"include"});if(N.ok){const E=await N.json();l(E.identities||[])}}catch(N){console.error("Failed to load accounts:",N)}finally{d(!1)}},h=N=>{window.location.href=`/auth/accounts/link/${N}`},v=async N=>{var E;if(a.length<=1){f({type:"error",text:"Cannot unlink your only account"});return}if(confirm(`Unlink your ${N} account?`))try{const S=(E=document.cookie.split("; ").find(w=>w.startsWith("csrf=")||w.startsWith("__Host-csrf=")))==null?void 0:E.split("=")[1],k=await fetch(`/auth/accounts/${N}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":S||""}});if(k.ok)f({type:"success",text:"Account unlinked"}),await p();else{const w=await k.json();throw new Error(w.detail||"Failed to unlink")}}catch(S){f({type:"error",text:S.message})}},g=async()=>{await n(),e()},_=N=>{i(s===N?null:N),f(null)},x={google:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),microsoft:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 23 23",children:[o.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),o.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),o.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),o.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]})},y=[{id:"account",label:"Account",icon:"user",future:!1},{id:"linked",label:"Linked Accounts",icon:"link",future:!1},{id:"team",label:"Team / Org",icon:"users",future:!0},{id:"billing",label:"Billing",icon:"credit-card",future:!0},{id:"preferences",label:"Preferences",icon:"settings",future:!0}],b=N=>{const E={user:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),link:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),o.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]}),users:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"9",cy:"7",r:"4"}),o.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),o.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"credit-card":o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),o.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]}),settings:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})};return E[N]||E.user},j=N=>{switch(N){case"account":return o.jsxs("div",{className:"px-4 py-3 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Email"}),o.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.email)||"-"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Member since"}),o.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:t!=null&&t.user_created_at?new Date(t.user_created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"}):"-"})]})]});case"linked":return o.jsxs("div",{className:"px-4 py-3",children:[u&&o.jsx("div",{className:`mb-3 px-3 py-2 rounded text-xs ${u.type==="error"?"bg-red-500/20 text-red-300":"bg-emerald-500/20 text-emerald-300"}`,children:u.text}),c?o.jsx("div",{className:"flex items-center justify-center py-4",children:o.jsx("div",{className:"w-5 h-5 border-2 border-t-blue-500 border-r-transparent border-b-transparent border-l-transparent rounded-full animate-spin"})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"space-y-2 mb-4",children:a.map(E=>o.jsxs("div",{className:"flex items-center justify-between p-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[x[E.provider_id],o.jsx("span",{className:"text-xs",style:{color:"var(--text-primary)"},children:E.provider_email})]}),o.jsx("button",{onClick:()=>v(E.provider_id),disabled:a.length<=1,className:`text-xs px-2 py-1 rounded ${a.length<=1?"text-slate-600 cursor-not-allowed":"text-red-400 hover:bg-red-500/20"}`,children:"Unlink"})]},E.provider_id))}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs uppercase tracking-wide mb-2",style:{color:"var(--text-muted)"},children:"Link another"}),o.jsxs("button",{onClick:()=>h("google"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[x.google,"Google"]}),o.jsxs("button",{onClick:()=>h("microsoft"),className:"w-full flex items-center gap-2 p-2 rounded text-xs hover:bg-white/5",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:[x.microsoft,"Microsoft"]})]})]})]});default:return o.jsx("div",{className:"px-4 py-3 text-xs",style:{color:"var(--text-muted)"},children:"Coming soon"})}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 z-40",style:{background:"rgba(0, 0, 0, 0.3)"},onClick:e}),o.jsxs("div",{className:"fixed top-12 bottom-0 z-50 w-72 flex flex-col shadow-2xl",style:{left:"240px",background:"var(--bg-panel)",borderRight:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"px-4 py-4 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t!=null&&t.avatar_url?o.jsx("img",{src:t.avatar_url,alt:t.name,className:"w-10 h-10 rounded-full"}):o.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)"},children:[o.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),o.jsxs("div",{className:"flex-1 overflow-hidden",children:[o.jsx("div",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:(t==null?void 0:t.name)||"User"}),o.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(t==null?void 0:t.email)||""})]}),o.jsx("button",{onClick:e,className:"p-1.5 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},children:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),o.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),o.jsx("div",{className:"text-xs px-2 py-1 rounded inline-block",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Plan: Individual"})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[r&&o.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:o.jsx("span",{className:"text-[10px] uppercase tracking-wide font-medium",style:{color:"var(--text-muted)"},children:"Administration"})}),o.jsxs("a",{href:"/admin",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[o.jsx("span",{style:{color:"var(--amber-400, #fbbf24)"},children:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"})]})}),o.jsx("span",{className:"text-sm",children:"Admin Panel"})]}),o.jsxs("a",{href:"/admin/workbench",className:"w-full flex items-center gap-3 px-4 py-3 transition-colors hover:bg-white/5",style:{color:"var(--text-primary)",textDecoration:"none"},children:[o.jsx("span",{style:{color:"var(--purple-400, #a78bfa)"},children:o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),o.jsx("polyline",{points:"14 2 14 8 20 8"}),o.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),o.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),o.jsx("line",{x1:"10",y1:"9",x2:"8",y2:"9"})]})}),o.jsx("span",{className:"text-sm",children:"Prompt Workbench"})]})]}),y.map(N=>o.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[o.jsxs("button",{onClick:()=>!N.future&&_(N.id),className:`w-full flex items-center gap-3 px-4 py-3 transition-colors ${N.future?"cursor-not-allowed opacity-50":"hover:bg-white/5"}`,style:{color:"var(--text-primary)"},disabled:N.future,children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:b(N.icon)}),o.jsx("span",{className:"flex-1 text-sm text-left",children:N.label}),N.future?o.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Soon"}):o.jsx("svg",{className:"w-4 h-4 transition-transform",style:{color:"var(--text-muted)",transform:s===N.id?"rotate(90deg)":"rotate(0deg)"},viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polyline",{points:"9 18 15 12 9 6"})})]}),s===N.id&&!N.future&&o.jsx("div",{style:{background:"var(--bg-canvas)",borderTop:"1px solid var(--border-panel)"},children:j(N.id)})]},N.id))]}),o.jsx("div",{className:"p-4 border-t",style:{borderColor:"var(--border-panel)"},children:o.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 px-4 py-2 rounded text-sm transition-colors hover:bg-white/5",style:{color:"var(--text-muted)"},children:[o.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),o.jsx("polyline",{points:"16 17 21 12 16 7"}),o.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Sign Out"]})})]})]})}const De={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function zW(){return o.jsx("header",{className:"h-16 flex items-center justify-center border-b",style:{background:De.bg,borderColor:De.border},children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-8"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-bold tracking-[0.2em]",style:{color:De.textPrimary},children:"THE COMBINE"}),o.jsx("span",{className:"text-xs tracking-wide ml-4",style:{color:De.textMuted},children:"Industrial AI for Knowledge Work"})]})]})})}function FW(){return o.jsxs("section",{className:"text-center max-w-2xl mx-auto",children:[o.jsx("h1",{className:"text-3xl font-semibold mb-6 leading-tight",style:{color:De.textPrimary},children:"Turn complex intent into governed, repeatable artifacts."}),o.jsx("p",{className:"text-lg leading-relaxed mb-6",style:{color:De.textSecondary},children:"The Combine applies manufacturing discipline to AI knowledge work. Every output is traceable. Every decision is auditable. Production over prompting."}),o.jsxs("a",{href:"/learn",className:"text-sm transition-colors inline-flex items-center gap-1",style:{color:De.textMuted},onMouseOver:e=>e.currentTarget.style.color=De.textSecondary,onMouseOut:e=>e.currentTarget.style.color=De.textMuted,children:["Learn how The Combine works",o.jsx("span",{"aria-hidden":"true",children:""})]})]})}function $W(){const e=[{icon:o.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Express Intent",description:"Describe what you need"},{icon:o.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 00-3.7-3.7 48.678 48.678 0 00-7.324 0 4.006 4.006 0 00-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3l-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 003.7 3.7 48.656 48.656 0 007.324 0 4.006 4.006 0 003.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3l-3 3",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Line Assembles",description:"Stations configure"},{icon:o.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Gates Enforce",description:"Validation required"},{icon:o.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:o.jsx("path",{d:"M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z",strokeLinecap:"round",strokeLinejoin:"round"})}),title:"Artifacts Stabilize",description:"Versioned, ready"}];return o.jsx("section",{className:"max-w-4xl mx-auto",children:o.jsx("div",{className:"flex items-start justify-between gap-4",children:e.map((t,n)=>o.jsxs("div",{className:"flex-1 text-center group",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-10 h-10 rounded-full mb-3",style:{background:De.bgElevated,border:`1px solid ${De.border}`,color:De.textMuted},children:t.icon}),o.jsx("h3",{className:"text-sm font-medium mb-1",style:{color:De.textPrimary},children:t.title}),o.jsx("p",{className:"text-xs",style:{color:De.textMuted},children:t.description}),n<e.length-1&&o.jsx("div",{className:"absolute top-5 -right-2 hidden md:block",style:{color:De.border}})]},n))})})}function qW(){const e=["Auditable outputs","Traceable decisions","Validated delivery","Human accountability"];return o.jsx("section",{className:"text-center",children:o.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-2",children:e.map((t,n)=>o.jsx("span",{className:"text-xs",style:{color:De.textMuted},children:t},n))})})}function BW({onLogin:e}){return o.jsxs("section",{className:"text-center",children:[o.jsx("p",{className:"text-sm font-medium mb-4",style:{color:De.textSecondary},children:"Ready?"}),o.jsxs("div",{className:"inline-flex flex-col gap-3",children:[o.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:De.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=De.accentHover,onMouseOut:t=>t.currentTarget.style.background=De.accent,children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),o.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:De.bg,border:`1px solid ${De.border}`,color:De.textPrimary},onMouseOver:t=>t.currentTarget.style.background=De.bgElevated,onMouseOut:t=>t.currentTarget.style.background=De.bg,children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[o.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),o.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),o.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),o.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function WW(){return o.jsxs("footer",{className:"py-6 flex items-center justify-center gap-6",children:[o.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:De.textSubtle},onMouseOver:e=>e.currentTarget.style.color=De.textMuted,onMouseOut:e=>e.currentTarget.style.color=De.textSubtle,children:"Terms"}),o.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:De.textSubtle},onMouseOver:e=>e.currentTarget.style.color=De.textMuted,onMouseOut:e=>e.currentTarget.style.color=De.textSubtle,children:"Privacy"}),o.jsx("span",{className:"text-xs",style:{color:De.border},children:" 2026 The Combine"})]})}function HW(){const{login:e}=zi();return o.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:De.bg},children:[o.jsx(zW,{}),o.jsx("main",{className:"flex-1 flex flex-col justify-center px-8 py-12",children:o.jsxs("div",{className:"space-y-12",children:[o.jsx(FW,{}),o.jsx($W,{}),o.jsx(qW,{}),o.jsx(BW,{onLogin:e})]})}),o.jsx(WW,{})]})}const Pe={bg:"#0f172a",bgElevated:"#1e293b",border:"#334155",textPrimary:"#f8fafc",textSecondary:"#94a3b8",textMuted:"#64748b",textSubtle:"#475569",accent:"#3b82f6",accentHover:"#2563eb"};function VW(){return o.jsxs("header",{className:"h-16 flex items-center justify-between px-6 border-b",style:{background:Pe.bg,borderColor:Pe.border},children:[o.jsxs("a",{href:"/",className:"flex items-center gap-3 transition-colors",style:{color:Pe.textMuted},onMouseOver:e=>e.currentTarget.style.color=Pe.textSecondary,onMouseOut:e=>e.currentTarget.style.color=Pe.textMuted,children:[o.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7",strokeLinecap:"round",strokeLinejoin:"round"})}),o.jsx("span",{className:"text-sm",children:"Back"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6"}),o.jsx("span",{className:"text-sm font-bold tracking-[0.15em]",style:{color:Pe.textPrimary},children:"THE COMBINE"})]}),o.jsx("div",{className:"w-16"})," "]})}function ss({title:e,children:t}){return o.jsxs("section",{className:"mb-16",children:[e&&o.jsx("h2",{className:"text-xl font-semibold mb-6",style:{color:Pe.textPrimary},children:e}),t]})}function vt({children:e,className:t=""}){return o.jsx("p",{className:`text-base leading-relaxed mb-4 ${t}`,style:{color:Pe.textSecondary},children:e})}function no({children:e}){return o.jsx("p",{className:"text-base leading-relaxed mb-4 pl-4",style:{color:Pe.textPrimary,borderLeft:`2px solid ${Pe.border}`},children:e})}function ul({items:e}){return o.jsx("ul",{className:"space-y-2 mb-4",children:e.map((t,n)=>o.jsxs("li",{className:"text-base flex items-start gap-3",style:{color:Pe.textSecondary},children:[o.jsx("span",{style:{color:Pe.textMuted},children:"-"}),t]},n))})}function dl({number:e,title:t,children:n}){return o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-baseline gap-3 mb-2",children:[o.jsxs("span",{className:"text-sm font-mono",style:{color:Pe.textMuted},children:[e,"."]}),o.jsx("h3",{className:"text-base font-medium",style:{color:Pe.textPrimary},children:t})]}),o.jsx("div",{className:"pl-7",children:o.jsx(vt,{children:n})})]})}function fl({title:e,children:t}){return o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-base font-medium mb-2",style:{color:Pe.textPrimary},children:e}),o.jsx(vt,{className:"mb-0",children:t})]})}function UW({onLogin:e}){return o.jsxs("section",{className:"text-center py-12 rounded-lg",style:{background:Pe.bgElevated,border:`1px solid ${Pe.border}`},children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",style:{color:Pe.textPrimary},children:"When You're Ready"}),o.jsx(vt,{className:"max-w-md mx-auto mb-2",children:"You don't need to prepare anything."}),o.jsx(vt,{className:"max-w-md mx-auto mb-2",children:"You don't need to know the workflow in advance."}),o.jsx(vt,{className:"max-w-md mx-auto mb-8",children:"You start by stating intent  the system handles the rest."}),o.jsxs("div",{className:"inline-flex flex-col gap-3",children:[o.jsxs("button",{onClick:()=>e("google"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Pe.accent,color:"#ffffff"},onMouseOver:t=>t.currentTarget.style.background=Pe.accentHover,onMouseOut:t=>t.currentTarget.style.background=Pe.accent,children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#ffffff",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#ffffff",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#ffffff",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#ffffff",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),o.jsxs("button",{onClick:()=>e("microsoft"),className:"w-64 flex items-center justify-center gap-3 px-4 py-3 rounded font-medium transition-colors",style:{background:Pe.bg,border:`1px solid ${Pe.border}`,color:Pe.textPrimary},onMouseOver:t=>t.currentTarget.style.background=Pe.bgElevated,onMouseOut:t=>t.currentTarget.style.background=Pe.bg,children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",children:[o.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),o.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),o.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),o.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Continue with Microsoft"]})]})]})}function GW(){return o.jsxs("footer",{className:"py-8 text-center",children:[o.jsx("p",{className:"text-sm mb-6",style:{color:Pe.textMuted},children:"The Combine does not replace human judgment. It makes it visible."}),o.jsxs("div",{className:"flex items-center justify-center gap-6",children:[o.jsx("a",{href:"/terms",className:"text-xs transition-colors",style:{color:Pe.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Pe.textMuted,onMouseOut:e=>e.currentTarget.style.color=Pe.textSubtle,children:"Terms"}),o.jsx("a",{href:"/privacy",className:"text-xs transition-colors",style:{color:Pe.textSubtle},onMouseOver:e=>e.currentTarget.style.color=Pe.textMuted,onMouseOut:e=>e.currentTarget.style.color=Pe.textSubtle,children:"Privacy"}),o.jsx("span",{className:"text-xs",style:{color:Pe.border},children:" 2026 The Combine"})]})]})}function KW(){const{login:e}=zi();return o.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:Pe.bg},children:[o.jsx(VW,{}),o.jsx("main",{className:"flex-1 px-6 py-12",children:o.jsxs("article",{className:"max-w-2xl mx-auto",children:[o.jsx("h1",{className:"text-3xl font-semibold mb-12 text-center",style:{color:Pe.textPrimary},children:"Learn More"}),o.jsxs(ss,{title:"What The Combine Is",children:[o.jsx(vt,{children:"The Combine is an AI-assisted production system for knowledge work."}),o.jsx(vt,{children:"It applies manufacturing discipline to work that is normally informal, fragile, and difficult to audit  system design, architecture, requirements, analysis, and planning."}),o.jsx(no,{children:"Instead of prompts and chat history, The Combine produces governed artifacts."}),o.jsx(no,{children:"Instead of experimentation without memory, it runs repeatable production lines."})]}),o.jsxs(ss,{title:"Why It Exists",children:[o.jsx(vt,{children:"Most AI tools optimize for speed and creativity. That works well for drafts and exploration."}),o.jsx(vt,{children:"It breaks down when the work must be:"}),o.jsx(ul,{items:["Auditable","Traceable","Reviewed","Approved","Reused","Defended"]}),o.jsx(vt,{children:"The Combine exists for situations where quality, accountability, and repeatability matter more than cleverness."})]}),o.jsxs(ss,{title:'Why "The Combine"',children:[o.jsx(vt,{children:"The Combine takes its name from the combine harvester  one of the most important industrial inventions of the 20th century."}),o.jsx(vt,{children:"Before the combine, harvesting was fragmented, manual, and inconsistent. Separate steps. Separate tools. High variability. Heavy dependence on individual skill."}),o.jsx(vt,{children:"The combine harvester changed that by integrating many steps into a single, governed production line  increasing consistency, traceability, and scale without removing human oversight."}),o.jsx(vt,{children:"The Combine applies the same philosophy to AI-driven knowledge work."}),o.jsx(vt,{children:"Instead of scattered prompts, fragile documents, and unrepeatable decisions, it assembles intent through a structured line:"}),o.jsx(ul,{items:["Inputs are clarified","Work moves through defined stations","Quality gates enforce discipline","Outputs stabilize into reusable artifacts"]}),o.jsx(vt,{children:"This is not automation for speed. It is industrialization for reliability."}),o.jsx(no,{children:"As with the original combine, the breakthrough is not intelligence, but integration."})]}),o.jsxs(ss,{title:"How It Works",children:[o.jsx(dl,{number:1,title:"You express intent",children:"You describe what you want to build. The system listens, asks clarifying questions, and confirms scope and constraints."}),o.jsx(dl,{number:2,title:"A production line is assembled",children:"Based on your intent, The Combine configures a sequence of specialized stations  each responsible for producing a specific artifact."}),o.jsx(dl,{number:3,title:"Quality gates enforce discipline",children:"Artifacts move forward only when they meet defined criteria. Nothing proceeds without validation."}),o.jsx(dl,{number:4,title:"Outputs stabilize",children:"Approved artifacts are versioned, bound, and ready for use  not just today, but later."})]}),o.jsxs(ss,{title:"What Makes It Different",children:[o.jsx(fl,{title:"Production over prompting",children:"Work progresses through defined stages, not conversations."}),o.jsx(fl,{title:"Human accountability remains central",children:"AI assists, but humans approve. Nothing ships without oversight."}),o.jsx(fl,{title:"Every decision is traceable",children:"Why something exists, who approved it, and what assumptions were made are always visible."}),o.jsx(fl,{title:"Designed for real-world constraints",children:"Compliance, audits, handoffs, and change management are first-class concerns."})]}),o.jsxs(ss,{title:"What The Combine Is Not",children:[o.jsx(ul,{items:["A chat interface","A creative writing tool","An autonomous agent that acts without approval","A system that hides its reasoning or decisions"]}),o.jsx(vt,{children:"If you want improvisation, there are better tools."}),o.jsx(no,{children:"If you need defensible outcomes, this is what The Combine is built for."})]}),o.jsxs(ss,{title:"Who It's For",children:[o.jsx(vt,{children:"The Combine is designed for people responsible for outcomes, including:"}),o.jsx(ul,{items:["Architects and technical leaders","Product and delivery leaders","Compliance-conscious teams","Organizations that need repeatable, explainable AI support"]}),o.jsx(no,{children:`If the phrase "nothing ships without validation" resonates, you're in the right place.`})]}),o.jsx(UW,{onLogin:e})]})}),o.jsx(GW,{})]})}function $3(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{r(!0),i(null);try{const l=await _e.getTemplates();t(l.templates||[])}catch(l){i(l.message),console.error("Failed to fetch templates:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{a()},[a]),{templates:e,loading:n,error:s,refresh:a}}function YW(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{r(!0),i(null);try{const l=await _e.getOrchestrationWorkflows();t(l.workflows||[])}catch(l){i(l.message),console.error("Failed to fetch orchestration workflows:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{a()},[a]),{workflows:e,loading:n,error:s,refresh:a}}function q3(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[s,i]=m.useState(null),a=m.useCallback(async()=>{r(!0),i(null);try{const l=await _e.getSchemas();t(l.schemas||[])}catch(l){i(l.message),console.error("Failed to fetch schemas:",l)}finally{r(!1)}},[]);return m.useEffect(()=>{a()},[a]),{schemas:e,loading:n,error:s,refresh:a}}function B3(){const[e,t]=m.useState([]),[n,r]=m.useState(!0),[s,i]=m.useState(null);m.useEffect(()=>{let f=!0;async function p(){r(!0),i(null);try{const h=await _e.getPromptFragments();f&&t(h.fragments||[])}catch(h){console.error("Failed to fetch prompt fragments:",h),f&&i(h.message||"Failed to load prompt fragments")}finally{f&&r(!1)}}return p(),()=>{f=!1}},[]);const a=m.useMemo(()=>{const f={all:e,role:[],task:[],qa:[],pgc:[],questions:[],reflection:[]};for(const p of e){const h=p.kind;f[h]&&f[h].push(p)}return f},[e]),l=m.useMemo(()=>({all:e.length,role:a.role.length,task:a.task.length,qa:a.qa.length,pgc:a.pgc.length,questions:a.questions.length,reflection:a.reflection.length}),[e,a]),c=m.useCallback(f=>!f||f==="all"?e:a[f]||[],[e,a]),d=m.useMemo(()=>{const f=[{id:"all",label:"All",count:l.all},{id:"role",label:"Roles",count:l.role},{id:"task",label:"Tasks",count:l.task},{id:"qa",label:"QA",count:l.qa},{id:"pgc",label:"PGC",count:l.pgc}];return l.questions>0&&f.push({id:"questions",label:"Questions",count:l.questions}),l.reflection>0&&f.push({id:"reflection",label:"Reflection",count:l.reflection}),f},[l]),u=m.useCallback(async()=>{r(!0),i(null);try{const f=await _e.getPromptFragments();t(f.fragments||[])}catch(f){console.error("Failed to refresh prompt fragments:",f),i(f.message||"Failed to refresh")}finally{r(!1)}},[]);return{fragments:e,loading:n,error:s,fragmentsByKind:a,kindCounts:l,kindOptions:d,filterByKind:c,refresh:u}}const bg="doctype-browser-collapsed";function W3(e,t){const[n,r]=m.useState(()=>{try{const i=JSON.parse(localStorage.getItem(bg)||"{}");return e in i?i[e]:t}catch{return t}}),s=m.useCallback(i=>{const a=typeof i=="function"?i(n):i;r(a);try{const l=JSON.parse(localStorage.getItem(bg)||"{}");l[e]=a,localStorage.setItem(bg,JSON.stringify(l))}catch{}},[e,n]);return[n,s]}function SS({title:e,defaultOpen:t=!0,children:n}){const[r,s]=W3(`group:${e}`,t);return o.jsxs("div",{children:[o.jsxs("button",{onClick:()=>s(!r),className:"w-full px-4 py-2.5 flex items-center justify-between text-left",style:{background:"var(--bg-group-header)",border:"none",borderBottom:"1px solid var(--border-panel)",cursor:"pointer"},children:[o.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:e}),o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",transform:r?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block"},children:""})]}),r&&n]})}function kS({title:e,action:t,defaultOpen:n=!0,dotColor:r,children:s}){const[i,a]=W3(`sub:${e}`,n);return o.jsxs("div",{children:[o.jsxs("div",{className:"px-4 py-1.5 flex items-center justify-between",style:{background:"var(--bg-subsection-header)",borderBottom:"1px solid var(--border-panel)",paddingLeft:"1.25rem"},children:[o.jsxs("button",{onClick:()=>a(!i),className:"flex items-center gap-1.5",style:{background:"transparent",border:"none",cursor:"pointer",padding:0},children:[o.jsx("span",{style:{color:"var(--text-muted)",transform:i?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),r&&o.jsx("span",{style:{color:r,fontSize:8},children:""}),o.jsx("span",{style:{color:"var(--text-secondary)",fontSize:12,fontWeight:600,letterSpacing:"0.02em"},children:e})]}),t]}),i&&s]})}function NS({selected:e,onClick:t,label:n,sublabel:r,badge:s}){return o.jsxs("button",{onClick:t,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:e?"var(--bg-selected)":"transparent",color:e?"var(--text-primary)":"var(--text-secondary)",borderLeft:e?"2px solid var(--action-primary)":"2px solid transparent"},children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"font-medium truncate",children:n}),s&&o.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:s})]}),r&&o.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:r})]})}function CS({loading:e,empty:t,emptyMessage:n="None found"}){return e?o.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?o.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:n}):null}function XW({documentTypes:e=[],roles:t=[],templates:n=[],workflows:r=[],promptFragments:s=[],promptFragmentKindOptions:i=[],schemas:a=[],loading:l=!1,rolesLoading:c=!1,templatesLoading:d=!1,workflowsLoading:u=!1,promptFragmentsLoading:f=!1,schemasLoading:p=!1,selectedDocType:h=null,docTypeSource:v=null,selectedRole:g=null,selectedTemplate:_=null,selectedWorkflow:x=null,selectedFragment:y=null,selectedSchema:b=null,onSelectDocType:j,onSelectRole:N,onSelectTemplate:E,onSelectWorkflow:S,onSelectFragment:k,onSelectStandaloneSchema:w,onCreateWorkflow:R,onCreateDocType:T,onCreateFragment:I,onCreateTemplate:D,onCreateSchema:C,onSelectTask:M,onSelectSchema:P,workspaceState:F=null}){var Ne;const[O,A]=m.useState(null),[z,$]=m.useState(null),[B,U]=m.useState(""),[G,H]=m.useState(!1),[q,Q]=m.useState(!1),[se,ie]=m.useState(""),[Z,Se]=m.useState(!1),xe=[...e].sort((ne,je)=>(ne.display_name||"").localeCompare(je.display_name||"")),be=r.filter(ne=>(ne.pow_class||"reference")==="reference"),ve=ne=>{const je=ne.pow_class||"reference";return je==="reference"?"ref":je==="template"?"tpl":"inst"},ae=e.filter(ne=>ne.active_version).length+r.filter(ne=>ne.active_version).length,Y=((Ne=F==null?void 0:F.modified_artifacts)==null?void 0:Ne.length)??0,te=(F==null?void 0:F.is_dirty)??!1,ee=()=>{A(null),$(null),U("")},ke=()=>{Q(!1),ie("")},we=async()=>{const ne=se.trim().toLowerCase().replace(/\s+/g,"_");if(!(!ne||!/^[a-z][a-z0-9_]*$/.test(ne))){Se(!0);try{await(T==null?void 0:T({doc_type_id:ne})),ke()}catch{}finally{Se(!1)}}},Ee=async()=>{const ne=B.trim().toLowerCase().replace(/\s+/g,"_");if(!(!ne||!/^[a-z][a-z0-9_]*$/.test(ne))){H(!0);try{const je={workflow_id:ne,pow_class:"template"};z&&(je.derived_from={workflow_id:z.workflow_id,version:z.active_version},je.source_version=z.active_version),await(R==null?void 0:R(je)),ee()}catch{}finally{H(!1)}}};return o.jsx("div",{className:"w-60 flex flex-col border-r h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[o.jsxs(SS,{title:"Production Workflows",defaultOpen:!0,children:[o.jsxs(kS,{title:"Project Orchestration (POWs)",dotColor:"var(--dot-green)",action:R&&o.jsx("button",{onClick:()=>A(O?null:"choose"),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new workflow",children:"+ New"}),children:[O==="choose"&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsxs("button",{onClick:()=>A("from_reference"),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-1 hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:"pointer"},disabled:be.length===0,children:["From Reference",be.length===0?" (none available)":""]}),o.jsx("button",{onClick:()=>A("blank"),className:"w-full text-left text-xs px-2 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:"Blank Workflow"}),o.jsx("button",{onClick:ee,className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]}),O==="from_reference"&&!z&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Select reference to fork:"}),be.map(ne=>o.jsxs("button",{onClick:()=>$(ne),className:"w-full text-left text-xs px-2 py-1.5 rounded mb-0.5 hover:opacity-80",style:{background:"transparent",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer"},children:[o.jsx("div",{className:"font-medium",children:ne.name||ne.workflow_id.replace(/_/g," ").replace(/\b\w/g,je=>je.toUpperCase())}),o.jsxs("div",{style:{color:"var(--text-muted)"},children:["v",ne.active_version]})]},ne.workflow_id)),o.jsx("button",{onClick:()=>A("choose"),className:"w-full text-center text-xs px-2 py-1 mt-1 hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Back"})]}),(O==="blank"||O==="from_reference"&&z)&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[z&&o.jsxs("div",{className:"text-xs mb-1.5 px-2 py-1 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["Forking: ",z.name||z.workflow_id," v",z.active_version]}),o.jsx("input",{type:"text",value:B,onChange:ne=>U(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&Ee(),ne.key==="Escape"&&ee()},placeholder:"workflow_id (snake_case)",autoFocus:!0,disabled:G,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:Ee,disabled:G||!B.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:G?"wait":"pointer",opacity:!B.trim()||G?.5:1},children:G?"Creating...":"Create"}),o.jsx("button",{onClick:ee,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),o.jsx(CS,{loading:u,empty:!u&&r.length===0,emptyMessage:"No workflows"}),!u&&r.length>0&&o.jsx("div",{className:"py-1",children:r.map(ne=>o.jsx(NS,{selected:(x==null?void 0:x.workflow_id)===ne.workflow_id,onClick:()=>S==null?void 0:S(ne),label:ne.name||ne.workflow_id.replace(/_/g," ").replace(/\b\w/g,je=>je.toUpperCase()),sublabel:`v${ne.active_version}`,badge:ve(ne)},ne.workflow_id))})]}),o.jsxs(kS,{title:"Document Creation (DCWs)",dotColor:"var(--dot-blue)",action:T&&o.jsx("button",{onClick:()=>Q(!q),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new document type",children:"+ New"}),children:[q&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsx("input",{type:"text",value:se,onChange:ne=>ie(ne.target.value),onKeyDown:ne=>{ne.key==="Enter"&&we(),ne.key==="Escape"&&ke()},placeholder:"doc_type_id (snake_case)",autoFocus:!0,disabled:Z,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:we,disabled:Z||!se.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:Z?"wait":"pointer",opacity:!se.trim()||Z?.5:1},children:Z?"Creating...":"Create"}),o.jsx("button",{onClick:ke,className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),o.jsx(CS,{loading:l,empty:!l&&e.length===0,emptyMessage:"No document workflows"}),!l&&xe.length>0&&o.jsx("div",{className:"py-1",children:xe.map(ne=>o.jsx(NS,{selected:v==="docworkflow"&&(h==null?void 0:h.doc_type_id)===ne.doc_type_id,onClick:()=>j==null?void 0:j(ne),label:ne.display_name,badge:`v${ne.active_version}`},ne.doc_type_id))})]})]}),o.jsxs(SS,{title:"Governance",defaultOpen:!1,children:[o.jsx("div",{className:"px-4 py-3",children:o.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"font-semibold uppercase tracking-wide mb-1",children:"Active Releases"}),o.jsxs("div",{children:[ae," active ",ae===1?"release":"releases"]})]})}),F&&o.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Git Status"}),te&&o.jsxs("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--action-primary)"},children:[Y," dirty"]})]})]})]})})}function QW({kinds:e=[],selectedKind:t="all",onSelect:n}){return o.jsx("div",{className:"flex flex-wrap gap-1.5 px-4 py-2",style:{background:"var(--bg-canvas)"},children:e.map(({id:r,label:s,count:i})=>{const a=t===r;return o.jsxs("button",{onClick:()=>n==null?void 0:n(r),className:"px-2.5 py-1 rounded-full text-xs font-medium transition-all",style:{background:a?"var(--action-primary)":"var(--bg-panel)",color:a?"#000":"var(--text-secondary)",border:a?"none":"1px solid var(--border-panel)",cursor:"pointer"},children:[s,i!==void 0&&o.jsxs("span",{style:{marginLeft:4,opacity:a?.7:.6},children:["(",i,")"]})]},r)})})}function pl({title:e,count:t,dotColor:n,defaultOpen:r=!1,action:s,children:i}){const[a,l]=m.useState(r);return o.jsxs("div",{style:{borderBottom:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center",style:{background:"var(--bg-subsection-header)"},children:[o.jsxs("button",{onClick:()=>l(!a),className:"flex-1 px-4 py-2.5 flex items-center justify-between text-sm hover:opacity-80 transition-opacity",style:{background:"transparent",border:"none",color:"var(--text-secondary)",cursor:"pointer",textAlign:"left"},children:[o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx("span",{style:{color:"var(--text-muted)",transform:a?"rotate(0deg)":"rotate(-90deg)",transition:"transform 150ms ease",display:"inline-block",fontSize:9},children:""}),o.jsx("span",{style:{color:n,fontSize:10},children:""}),o.jsx("span",{className:"font-semibold",children:e})]}),o.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)"},children:t})]}),s&&o.jsx("div",{className:"pr-3",children:s})]}),a&&o.jsx("div",{style:{background:"var(--bg-panel)"},children:i})]})}function ro({onClick:e,label:t,sublabel:n,badge:r,isSelected:s}){return o.jsxs("button",{onClick:e,className:"w-full px-4 py-2 text-left text-sm hover:opacity-80 transition-opacity",style:{background:s?"var(--bg-selected, rgba(99, 102, 241, 0.15))":"transparent",border:"none",borderLeft:s?"3px solid var(--action-primary)":"3px solid transparent",color:s?"var(--text-primary)":"var(--text-secondary)",cursor:"pointer"},children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"font-medium truncate",children:t}),r&&o.jsx("span",{style:{fontSize:9,fontFamily:"monospace",color:"var(--text-muted)",flexShrink:0,marginLeft:8},children:r})]}),n&&o.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:n})]})}function hl({loading:e,empty:t,emptyMessage:n="None found"}){return e?o.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):t?o.jsx("div",{className:"px-4 py-3 text-sm",style:{color:"var(--text-muted)"},children:n}):null}function ZW({isOpen:e,onClose:t,promptFragments:n=[],promptFragmentKindOptions:r=[],templates:s=[],schemas:i=[],documentTypes:a=[],mechanicalOpTypes:l=[],mechanicalOps:c=[],promptFragmentsLoading:d=!1,templatesLoading:u=!1,schemasLoading:f=!1,mechanicalOpsLoading:p=!1,selectedFragment:h=null,selectedTemplate:v=null,selectedSchema:g=null,selectedMechanicalOp:_=null,onSelectFragment:x,onSelectTemplate:y,onSelectSchema:b,onSelectStandaloneSchema:j,onSelectMechanicalOp:N,onCreateFragment:E,onCreateTemplate:S,onCreateSchema:k}){const[w,R]=m.useState("all"),[T,I]=m.useState(!1),[D,C]=m.useState("role"),[M,P]=m.useState(""),[F,O]=m.useState(!1),[A,z]=m.useState(!1),[$,B]=m.useState(""),[U,G]=m.useState(!1),[H,q]=m.useState(!1),[Q,se]=m.useState(""),[ie,Z]=m.useState(!1),Se=w==="all"?n:n.filter(Y=>Y.kind===w);m.useEffect(()=>{e||(I(!1),z(!1),q(!1),P(""),B(""),se(""))},[e]);const xe=m.useCallback((Y,te)=>{Y==null||Y(te)},[]),be=async()=>{const Y=M.trim().toLowerCase().replace(/\s+/g,"_");if(!(!Y||!/^[a-z][a-z0-9_]*$/.test(Y))){O(!0);try{await(E==null?void 0:E({role_id:Y,kind:D})),I(!1),P("")}catch{}finally{O(!1)}}},ve=async()=>{const Y=$.trim().toLowerCase().replace(/\s+/g,"_");if(!(!Y||!/^[a-z][a-z0-9_]*$/.test(Y))){G(!0);try{await(S==null?void 0:S({template_id:Y})),z(!1),B("")}catch{}finally{G(!1)}}},ae=async()=>{const Y=Q.trim().toLowerCase().replace(/\s+/g,"_");if(!(!Y||!/^[a-z][a-z0-9_]*$/.test(Y))){Z(!0);try{await(k==null?void 0:k({schema_id:Y})),q(!1),se("")}catch{}finally{Z(!1)}}};return e?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.15)",zIndex:40,pointerEvents:"none"}}),o.jsxs("div",{className:"fixed right-0 top-0 h-full flex flex-col",style:{width:320,background:"var(--bg-panel)",borderLeft:"1px solid var(--border-panel)",boxShadow:"-4px 0 20px rgba(0, 0, 0, 0.2)",zIndex:50,animation:"slideInFromRight 200ms ease-out"},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)"},children:[o.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Building Blocks"}),o.jsx("button",{onClick:t,className:"text-lg hover:opacity-80",style:{background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",lineHeight:1,padding:"2px 6px"},title:"Close",children:""})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[o.jsxs(pl,{title:"Prompt Fragments",count:n.length,dotColor:"#f59e0b",defaultOpen:!0,action:E&&o.jsx("button",{onClick:()=>I(!T),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new prompt fragment",children:"+ New"}),children:[T&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"block text-xs mb-1",style:{color:"var(--text-muted)"},children:"Kind"}),o.jsx("select",{value:D,onChange:Y=>C(Y.target.value),className:"w-full text-xs px-2 py-1.5 rounded",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},children:o.jsx("option",{value:"role",children:"Role"})})]}),o.jsx("input",{type:"text",value:M,onChange:Y=>P(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&be(),Y.key==="Escape"&&I(!1)},placeholder:"fragment_id (snake_case)",autoFocus:!0,disabled:F,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:be,disabled:F||!M.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:F?"wait":"pointer",opacity:!M.trim()||F?.5:1},children:F?"Creating...":"Create"}),o.jsx("button",{onClick:()=>I(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),r.length>0&&o.jsx(QW,{kinds:r,selectedKind:w,onSelect:R}),o.jsx(hl,{loading:d,empty:!d&&Se.length===0,emptyMessage:w==="all"?"No prompt fragments":`No ${w} fragments`}),!d&&Se.length>0&&o.jsx("div",{className:"py-1",children:Se.map(Y=>o.jsx(ro,{onClick:()=>xe(x,Y),label:Y.name||Y.fragment_id,sublabel:`${Y.kind}  v${Y.version}`,badge:Y.kind,isSelected:(h==null?void 0:h.fragment_id)===Y.fragment_id},Y.fragment_id))})]}),o.jsxs(pl,{title:"Templates",count:s.length,dotColor:"var(--dot-green)",action:S&&o.jsx("button",{onClick:()=>z(!A),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new template",children:"+ New"}),children:[A&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsx("input",{type:"text",value:$,onChange:Y=>B(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&ve(),Y.key==="Escape"&&z(!1)},placeholder:"template_id (snake_case)",autoFocus:!0,disabled:U,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:ve,disabled:U||!$.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:U?"wait":"pointer",opacity:!$.trim()||U?.5:1},children:U?"Creating...":"Create"}),o.jsx("button",{onClick:()=>z(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),o.jsx(hl,{loading:u,empty:!u&&s.length===0,emptyMessage:"No templates"}),!u&&s.length>0&&o.jsx("div",{className:"py-1",children:s.map(Y=>o.jsx(ro,{onClick:()=>xe(y,Y),label:Y.name||Y.template_id.replace(/_/g," ").replace(/\b\w/g,te=>te.toUpperCase()),sublabel:`v${Y.active_version}`,isSelected:(v==null?void 0:v.template_id)===Y.template_id},Y.template_id))})]}),o.jsxs(pl,{title:"Schemas",count:i.length||a.length,dotColor:"var(--dot-blue)",action:k&&o.jsx("button",{onClick:()=>q(!H),className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},title:"Create new schema",children:"+ New"}),children:[H&&o.jsxs("div",{className:"px-4 py-2",style:{background:"var(--bg-canvas)"},children:[o.jsx("input",{type:"text",value:Q,onChange:Y=>se(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&ae(),Y.key==="Escape"&&q(!1)},placeholder:"schema_id (snake_case)",autoFocus:!0,disabled:ie,className:"w-full text-xs px-2 py-1.5 rounded mb-1.5",style:{background:"var(--bg-input, var(--bg-panel))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"}}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:ae,disabled:ie||!Q.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:ie?"wait":"pointer",opacity:!Q.trim()||ie?.5:1},children:ie?"Creating...":"Create"}),o.jsx("button",{onClick:()=>q(!1),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"transparent",color:"var(--text-muted)",border:"none",cursor:"pointer"},children:"Cancel"})]})]}),o.jsx(hl,{loading:f,empty:!f&&i.length===0&&a.length===0,emptyMessage:"No schemas"}),!f&&i.length>0&&o.jsx("div",{className:"py-1",children:i.map(Y=>o.jsx(ro,{onClick:()=>xe(j,Y),label:Y.title||Y.schema_id,sublabel:`v${Y.active_version}`,isSelected:(g==null?void 0:g.schema_id)===Y.schema_id},`standalone-${Y.schema_id}`))}),i.length===0&&a.length>0&&o.jsx("div",{className:"py-1",children:a.map(Y=>o.jsx(ro,{onClick:()=>xe(b,{doc_type_id:Y.doc_type_id,display_name:Y.display_name,active_version:Y.active_version}),label:Y.display_name,sublabel:`from ${Y.doc_type_id}`},`schema-${Y.doc_type_id}`))})]}),o.jsxs(pl,{title:"Mechanical Ops",count:c.length,dotColor:"var(--dot-purple, #a855f7)",children:[o.jsx(hl,{loading:p,empty:!p&&c.length===0&&l.length===0,emptyMessage:"No mechanical operations"}),!p&&l.length>0&&o.jsx("div",{className:"py-1",children:l.map(Y=>{const te=c.filter(ee=>ee.type===Y.type_id);return o.jsxs("div",{children:[o.jsxs("div",{className:"px-4 py-1.5 text-xs font-semibold flex items-center gap-2",style:{color:"var(--text-muted)"},children:[o.jsx("span",{style:{fontSize:10},children:""}),o.jsx("span",{children:Y.name}),o.jsxs("span",{style:{fontFamily:"monospace",fontSize:9},children:["(",te.length,")"]})]}),te.length>0?te.map(ee=>o.jsx(ro,{onClick:()=>xe(N,ee),label:ee.name,sublabel:`v${ee.active_version}`,badge:ee.type,isSelected:(_==null?void 0:_.op_id)===ee.op_id},ee.op_id)):o.jsx("div",{className:"px-6 py-1 text-xs italic",style:{color:"var(--text-muted)"},children:"No instances"})]},Y.type_id)})}),!p&&l.length===0&&c.length===0&&o.jsx("div",{className:"px-4 py-2 text-xs",style:{color:"var(--text-muted)"},children:"Operation types not loaded"})]})]})]}),o.jsx("style",{children:`
                @keyframes slideInFromRight {
                    from {
                        transform: translateX(100%);
                    }
                    to {
                        transform: translateX(0);
                    }
                }
            `})]}):null}function nr({content:e,onChange:t,loading:n=!1,saving:r=!1,isDirty:s=!1,error:i=null,readOnly:a=!1,placeholder:l="Enter prompt content...",isJson:c=!1}){const d=m.useCallback(()=>{if(!(!e||!c))try{const u=JSON.parse(e),f=JSON.stringify(u,null,2);t==null||t(f)}catch(u){console.warn("Invalid JSON, cannot format:",u.message)}},[e,c,t]);return o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[a&&o.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"}),!a&&s&&o.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[c&&!a&&o.jsx("button",{onClick:d,className:"px-2 py-0.5 rounded text-xs hover:opacity-80",style:{background:"var(--bg-button)",color:"var(--text-muted)"},children:"Format JSON"}),n&&o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."}),r&&o.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),!r&&!n&&s&&o.jsx("span",{style:{color:"var(--action-success)"},children:"Saved"}),i&&o.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",i]})]})]}),o.jsx("div",{className:"flex-1 relative",children:n?o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading content..."})}):o.jsx("textarea",{value:e,onChange:u=>t==null?void 0:t(u.target.value),placeholder:l,readOnly:a,className:"w-full h-full p-4 resize-none font-mono text-sm",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",border:"none",outline:"none"},spellCheck:!1})})]})}function JW({workspaceId:e,artifactId:t}){const[n,r]=m.useState(null),[s,i]=m.useState(!0),[a,l]=m.useState(null);return m.useEffect(()=>{if(!e||!t){r(null),i(!1);return}(async()=>{i(!0),l(null);try{const d=await _e.getPreview(e,t);r(d)}catch(d){l(d.message),console.error("Failed to load preview:",d)}finally{i(!1)}})()},[e,t]),o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Resolved Prompt (for execution)"}),o.jsx("span",{className:"px-2 py-0.5 rounded",style:{background:"var(--border-panel)",color:"var(--text-muted)"},children:"Read-only"})]}),(n==null?void 0:n.provenance)&&o.jsxs("div",{className:"space-y-1 font-mono",style:{color:"var(--text-muted)"},children:[n.provenance.role&&o.jsxs("div",{children:["Role: ",n.provenance.role]}),n.provenance.schema&&o.jsxs("div",{children:["Schema: ",n.provenance.schema]}),n.provenance.package&&o.jsxs("div",{children:["Package: ",n.provenance.package]})]})]}),o.jsx("div",{className:"flex-1 relative overflow-auto",children:s?o.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading preview..."})}):a?o.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-4 rounded",style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--state-error-bg)"},children:[o.jsx("div",{className:"font-medium mb-2",style:{color:"var(--state-error-text)"},children:"Preview Failed"}),o.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:a})]})}):o.jsx("pre",{className:"p-4 font-mono text-sm whitespace-pre-wrap",style:{background:"var(--bg-canvas)",color:"var(--text-primary)",margin:0},children:(n==null?void 0:n.resolved_prompt)||"No preview available"})})]})}function eH({workspaceId:e,docType:t,roles:n=[],onSave:r}){const[s,i]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(!1),[u,f]=m.useState(null),[p,h]=m.useState(!1);m.useEffect(()=>{var b,j,N;t&&(i({display_name:t.display_name||"",description:t.description||"",authority_level:t.authority_level||"elaborative",creation_mode:t.creation_mode||"llm_generated",production_mode:t.production_mode||"",scope:t.scope||"project",role_prompt_ref:t.role_prompt_ref||"",template_ref:t.template_ref||"",required_inputs:t.required_inputs||[],optional_inputs:t.optional_inputs||[],creates_children:t.creates_children||[],parent_doc_type:t.parent_doc_type||"",ui_icon:((b=t.ui)==null?void 0:b.icon)||"",ui_category:((j=t.ui)==null?void 0:j.category)||"",ui_display_order:((N=t.ui)==null?void 0:N.display_order)||0}),h(!1),f(null))},[t]);const v=m.useCallback((b,j)=>{i(N=>({...N,[b]:j})),h(!0)},[]),g=m.useCallback((b,j)=>{const N=j.split(",").map(E=>E.trim()).filter(E=>E);i(E=>({...E,[b]:N})),h(!0)},[]),_=m.useCallback(b=>{if(!b)return"";const j=n.find(N=>N.role_id===b);return j?`prompt:role:${b}:${j.active_version}`:""},[n]),x=m.useCallback(b=>{if(!b)return"";const j=b.split(":");return j.length>=3&&j[0]==="prompt"&&j[1]==="role"?j[2]:""},[]),y=m.useCallback(async()=>{if(!(!e||!t||!s)){d(!0),f(null);try{const b=t.version||t.active_version,j=`doctype:${t.doc_type_id}:${b}:manifest`,N=tH(t.doc_type_id,b,s),E=await _e.writeArtifact(e,j,N);h(!1),r==null||r(j,E)}catch(b){console.error("Failed to save package:",b),f(b.message)}finally{d(!1)}}},[e,t,s,r]);return!t||!s?o.jsx("div",{className:"flex items-center justify-center h-full",style:{color:"var(--text-muted)"},children:"Loading package configuration..."}):o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 text-xs border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsx("div",{className:"flex items-center gap-2",children:p&&o.jsx("span",{style:{color:"var(--text-muted)"},children:"Modified"})}),o.jsxs("div",{className:"flex items-center gap-2",children:[c&&o.jsx("span",{style:{color:"var(--state-active-text)"},children:"Saving..."}),u&&o.jsxs("span",{style:{color:"var(--state-error-text)"},children:["Error: ",u]}),o.jsx("button",{onClick:y,disabled:!p||c,className:"px-3 py-1 rounded text-xs",style:{background:p?"var(--action-primary)":"var(--bg-panel)",color:p?"#000":"var(--text-muted)",opacity:p&&!c?1:.5},children:"Save Package"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"max-w-2xl space-y-6",children:[o.jsxs(so,{title:"Identity",children:[o.jsx(Zt,{label:"Display Name",children:o.jsx("input",{type:"text",value:s.display_name,onChange:b=>v("display_name",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Zt,{label:"Description",children:o.jsx("textarea",{value:s.description,onChange:b=>v("description",b.target.value),rows:3,className:"w-full px-3 py-2 rounded text-sm resize-none",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),o.jsxs(so,{title:"Classification",children:[o.jsx(Zt,{label:"Authority Level",children:o.jsxs("select",{value:s.authority_level,onChange:b=>v("authority_level",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"descriptive",children:"Descriptive"}),o.jsx("option",{value:"prescriptive",children:"Prescriptive"}),o.jsx("option",{value:"constructive",children:"Constructive"}),o.jsx("option",{value:"elaborative",children:"Elaborative"})]})}),o.jsx(Zt,{label:"Creation Mode",children:o.jsxs("select",{value:s.creation_mode,onChange:b=>v("creation_mode",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"llm_generated",children:"LLM Generated"}),o.jsx("option",{value:"constructed",children:"Constructed"}),o.jsx("option",{value:"extracted",children:"Extracted"})]})}),o.jsx(Zt,{label:"Scope",children:o.jsxs("select",{value:s.scope,onChange:b=>v("scope",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"project",children:"Project"}),o.jsx("option",{value:"epic",children:"Epic"}),o.jsx("option",{value:"feature",children:"Feature"})]})})]}),o.jsx(so,{title:"Shared References",children:o.jsxs(Zt,{label:"Role Prompt",children:[o.jsxs("select",{value:x(s.role_prompt_ref),onChange:b=>v("role_prompt_ref",_(b.target.value)),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"",children:"None"}),n.map(b=>o.jsx("option",{value:b.role_id,children:b.role_id.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())},b.role_id))]}),s.role_prompt_ref&&o.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:s.role_prompt_ref})]})}),o.jsxs(so,{title:"Dependencies",children:[o.jsx(Zt,{label:"Required Inputs",hint:"Comma-separated doc type IDs",children:o.jsx("input",{type:"text",value:s.required_inputs.join(", "),onChange:b=>g("required_inputs",b.target.value),placeholder:"e.g., project_discovery, technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Zt,{label:"Optional Inputs",hint:"Comma-separated doc type IDs",children:o.jsx("input",{type:"text",value:s.optional_inputs.join(", "),onChange:b=>g("optional_inputs",b.target.value),placeholder:"e.g., technical_architecture",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Zt,{label:"Parent Doc Type",children:o.jsx("input",{type:"text",value:s.parent_doc_type,onChange:b=>v("parent_doc_type",b.target.value),placeholder:"e.g., implementation_plan",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Zt,{label:"Creates Children",hint:"Comma-separated doc type IDs",children:o.jsx("input",{type:"text",value:s.creates_children.join(", "),onChange:b=>g("creates_children",b.target.value),placeholder:"e.g., feature, story",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]}),o.jsxs(so,{title:"UI Configuration",children:[o.jsx(Zt,{label:"Icon",children:o.jsx("input",{type:"text",value:s.ui_icon,onChange:b=>v("ui_icon",b.target.value),placeholder:"e.g., search, package, map",className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})}),o.jsx(Zt,{label:"Category",children:o.jsxs("select",{value:s.ui_category,onChange:b=>v("ui_category",b.target.value),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"},children:[o.jsx("option",{value:"",children:"Select category..."}),o.jsx("option",{value:"intake",children:"Intake"}),o.jsx("option",{value:"architecture",children:"Architecture"}),o.jsx("option",{value:"planning",children:"Planning"}),o.jsx("option",{value:"execution",children:"Execution"})]})}),o.jsx(Zt,{label:"Display Order",children:o.jsx("input",{type:"number",value:s.ui_display_order,onChange:b=>v("ui_display_order",parseInt(b.target.value)||0),className:"w-full px-3 py-2 rounded text-sm",style:{background:"var(--bg-panel)",color:"var(--text-primary)",border:"1px solid var(--border-panel)"}})})]})]})})]})}function so({title:e,children:t}){return o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold mb-3 uppercase tracking-wide",style:{color:"var(--text-muted)"},children:e}),o.jsx("div",{className:"space-y-4",children:t})]})}function Zt({label:e,hint:t,children:n}){return o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm mb-1",style:{color:"var(--text-secondary)"},children:[e,t&&o.jsxs("span",{className:"ml-2 text-xs",style:{color:"var(--text-muted)"},children:["(",t,")"]})]}),n]})}function tH(e,t,n){return[`# ${n.display_name} Package`,`# Version ${t}`,"",`doc_type_id: ${e}`,`display_name: "${n.display_name}"`,`version: "${t}"`,"description: >",`  ${n.description.replace(/\n/g,`
  `)}`,"","# Classification",`authority_level: ${n.authority_level}`,`creation_mode: ${n.creation_mode}`,n.production_mode?`production_mode: ${n.production_mode}`:"production_mode: null",`scope: ${n.scope}`,"","# Dependencies",`required_inputs: [${n.required_inputs.map(s=>`"${s}"`).join(", ")}]`,`optional_inputs: [${n.optional_inputs.map(s=>`"${s}"`).join(", ")}]`,`creates_children: [${n.creates_children.map(s=>`"${s}"`).join(", ")}]`,`parent_doc_type: ${n.parent_doc_type?`"${n.parent_doc_type}"`:"null"}`,"","# Shared artifact references",`role_prompt_ref: ${n.role_prompt_ref?`"${n.role_prompt_ref}"`:"null"}`,`template_ref: ${n.template_ref?`"${n.template_ref}"`:"null"}`,"","# Packaged artifacts","artifacts:",'  task_prompt: "prompts/task.prompt.txt"',"  qa_prompt: null","  reflection_prompt: null","  pgc_context: null","  questions_prompt: null",'  schema: "schemas/output.schema.json"',"","# Tests","tests:","  fixtures: []","  golden_traces: []","","# Gating rules","gating_rules:","  lifecycle_states: []","  design_status: []","  acceptance_required: false","  accepted_by: []","","# UI configuration","ui:",`  icon: ${n.ui_icon||"file"}`,`  category: ${n.ui_category||"other"}`,`  display_order: ${n.ui_display_order||0}`,""].join(`
`)}function H3(e,t,{debounceMs:n=1e3,onSave:r}={}){const[s,i]=m.useState(null),[a,l]=m.useState(null),[c,d]=m.useState(!0),[u,f]=m.useState(null),[p,h]=m.useState(!1),[v,g]=m.useState(null),_=m.useRef(null),x=m.useRef(null),y=m.useCallback(async()=>{if(!e||!t){i(null),l(null),d(!1);return}d(!0),f(null);try{const S=await _e.getArtifact(e,t),k=JSON.parse(S.content);i(k),l(k)}catch(S){f(S.message),console.error("Failed to load workflow artifact:",S)}finally{d(!1)}},[e,t]),b=m.useCallback(async S=>{if(!(!e||!t)){h(!0),f(null);try{const k=JSON.stringify(S,null,2),w=await _e.writeArtifact(e,t,k);g(w),l(S),r&&r(w)}catch(k){f(k.message),console.error("Failed to save workflow:",k)}finally{h(!1)}}},[e,t,r]),j=m.useCallback(S=>{x.current=S,_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{x.current!==null&&(b(x.current),x.current=null)},n)},[b,n]),N=m.useCallback(S=>{i(S),j(S)},[j]),E=m.useCallback(()=>{_.current&&clearTimeout(_.current),s&&b(s)},[s,b]);return m.useEffect(()=>(y(),()=>{_.current&&clearTimeout(_.current)}),[y]),{workflowJson:s,originalJson:a,loading:c,error:u,saving:p,lastSaveResult:v,isDirty:s!==a,updateWorkflow:N,saveNow:E,reload:y}}function nH({data:e,selected:t}){const{config:n,isEntry:r}=e,s=e.type==="end";return o.jsxs("div",{style:{background:n.bgColor,border:`2px solid ${t?n.color:n.borderColor}`,borderRadius:8,padding:"8px 12px",minWidth:180,maxWidth:220,boxShadow:t?`0 0 0 3px ${n.color}60, 0 0 20px ${n.color}80, 0 0 40px ${n.color}40`:"none",transition:"box-shadow 0.2s, border-color 0.2s"},children:[o.jsx(yn,{type:"target",position:ce.Top,style:{background:n.color,width:8,height:8,border:"none"}}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:4},children:[o.jsx("span",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",color:n.color,letterSpacing:"0.05em"},children:n.label}),r&&o.jsx("span",{style:{fontSize:8,padding:"1px 5px",borderRadius:3,background:n.color,color:"#fff",fontWeight:700,letterSpacing:"0.05em"},children:"ENTRY"})]}),o.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-primary)",marginBottom:2},children:e.node_id}),e.description&&o.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"14px",maxHeight:"28px"},children:e.description}),o.jsxs("div",{style:{display:"flex",gap:4,marginTop:4,flexWrap:"wrap"},children:[e.produces&&o.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(59,130,246,0.2)",color:"#3b82f6"},children:e.produces}),e.terminal_outcome&&o.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:e.terminal_outcome==="stabilized"?"rgba(16,185,129,0.2)":"rgba(239,68,68,0.2)",color:e.terminal_outcome==="stabilized"?"#10b981":"#ef4444"},children:e.terminal_outcome}),e.requires_qa&&o.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.2)",color:"#8b5cf6"},children:"QA"}),e.qa_mode&&o.jsx("span",{style:{fontSize:8,padding:"1px 4px",borderRadius:3,background:"rgba(139,92,246,0.1)",color:"#8b5cf6"},children:e.qa_mode})]}),!s&&o.jsx(yn,{type:"source",position:ce.Bottom,style:{background:n.color,width:8,height:8,border:"none"}})]})}const rH=m.memo(nH),sH={workflowNode:rH},iH=[{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"gate",label:"Gate"},{value:"end",label:"End"},{value:"intake_gate",label:"Intake Gate"}];function oH({workflowJson:e,onWorkflowChange:t,selectedNodeId:n,selectedEdgeId:r,onNodeSelect:s,onEdgeSelect:i}){const a=iu(),[l,c,d]=NE([]),[u,f,p]=CE([]),[h,v]=m.useState(!1),g=m.useRef(!1);m.useEffect(()=>{if(!e){c([]),f([]);return}let{nodes:w,edges:R}=eS(e);(!w.some(I=>I.position.x!==0||I.position.y!==0)||!g.current)&&(w=wc(w,R),g.current=!0),c(w),f(R)},[e,c,f]),m.useEffect(()=>{c(w=>w.map(R=>({...R,selected:R.id===n})))},[n,c]);const _=m.useCallback(w=>{if(!e)return;const T={edge_id:Wq(w.source,w.target,e.edges||[]),from_node_id:w.source,to_node_id:w.target,outcome:"success",label:"",kind:"auto"},I={...e,edges:[...e.edges||[],T]};t(I)},[e,t]),x=m.useCallback((w,R)=>{if(!e)return;const T=e.nodes.map(I=>I.node_id===R.id?{...I,_position:R.position}:I);t({...e,nodes:T})},[e,t]),y=m.useCallback((w,R)=>{s==null||s(R.id)},[s]),b=m.useCallback((w,R)=>{i==null||i(R.id)},[i]),j=m.useCallback(()=>{s==null||s(null),i==null||i(null)},[s,i]),N=m.useCallback(w=>{if(w.key==="Delete"||w.key==="Backspace"){if(n&&e){const R={...e,nodes:e.nodes.filter(T=>T.node_id!==n),edges:e.edges.filter(T=>T.from_node_id!==n&&T.to_node_id!==n),entry_node_ids:(e.entry_node_ids||[]).filter(T=>T!==n)};t(R),s==null||s(null)}else if(r&&e){const R={...e,edges:e.edges.filter(T=>T.edge_id!==r)};t(R),i==null||i(null)}}},[n,r,e,t,s,i]),E=m.useCallback(w=>{if(!e)return;const R=Bq(w,e.nodes||[]),T=Hq(w);T.node_id=R;const I=a.getViewport(),D=(-I.x+window.innerWidth/2)/I.zoom,C=(-I.y+window.innerHeight/2)/I.zoom;T._position={x:D-110,y:C-50};const M={...e,nodes:[...e.nodes||[],T]};t(M),v(!1),s==null||s(R)},[e,t,a,s]),S=m.useCallback(()=>{if(!e)return;let{nodes:w,edges:R}=eS(e);w=wc(w,R);const T=e.nodes.map(I=>{const D=w.find(C=>C.id===I.node_id);return D?{...I,_position:D.position}:I});t({...e,nodes:T}),setTimeout(()=>{a.fitView({padding:.2,duration:300})},50)},[e,t,a]),k=m.useCallback(()=>{a.fitView({padding:.2,duration:300})},[a]);return o.jsx("div",{className:"flex-1 relative",onKeyDown:N,tabIndex:0,style:{outline:"none"},children:o.jsxs(wa,{nodes:l,edges:u,onNodesChange:d,onEdgesChange:p,onConnect:_,onNodeDragStop:x,onNodeClick:y,onEdgeClick:b,onPaneClick:j,nodeTypes:sH,fitView:!0,fitViewOptions:{padding:.2},minZoom:.2,maxZoom:2,style:{background:"var(--bg-canvas)"},proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"smoothstep"},deleteKeyCode:null,children:[o.jsx(Hr,{position:"top-left",children:o.jsxs("div",{className:"flex gap-2 px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:()=>v(!h),className:"px-2.5 py-1.5 rounded text-xs font-medium transition-colors hover:opacity-80",style:{background:"var(--action-primary)",color:"#000"},children:"+ Add Node"}),h&&o.jsx("div",{className:"absolute top-full left-0 mt-1 rounded-lg border shadow-xl z-10",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)",minWidth:140},children:iH.map(w=>{const R=_c[w.value]||{};return o.jsxs("button",{onClick:()=>E(w.value),className:"w-full px-3 py-2 text-left text-xs hover:opacity-80 transition-colors flex items-center gap-2",style:{color:"var(--text-primary)"},children:[o.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),w.label]},w.value)})})]}),o.jsx("button",{onClick:S,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Auto Layout"}),o.jsx("button",{onClick:k,className:"px-2.5 py-1.5 rounded text-xs transition-colors",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Fit View"})]})}),o.jsx(RE,{position:"bottom-right",nodeColor:w=>{var T;const R=(T=w.data)==null?void 0:T.config;return(R==null?void 0:R.color)||"#475569"},maskColor:"rgba(11, 17, 32, 0.85)",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:8},pannable:!0,zoomable:!0}),o.jsx(Hr,{position:"bottom-left",children:o.jsx("div",{className:"flex gap-3 text-[10px] px-3 py-2 rounded-lg border backdrop-blur",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:Object.entries(_c).map(([w,R])=>o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{background:R.color}}),o.jsx("span",{style:{color:"var(--text-muted)"},children:R.label})]},w))})}),o.jsx(Hr,{position:"top-right",children:o.jsx("div",{className:"text-[10px] px-2 py-1 rounded",style:{color:"var(--text-muted)"},children:"Drag to connect | Delete to remove | Scroll to zoom"})})]})})}const aH=[{value:"intake_gate",label:"Intake Gate"},{value:"task",label:"Task"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC Gate"},{value:"gate",label:"Gate"},{value:"end",label:"End"}],ES=[{value:"LLM",label:"LLM",description:"AI-powered interaction"},{value:"MECH",label:"Mechanical",description:"Deterministic operation"},{value:"UI",label:"UI",description:"Operator entry"}],TS=[{value:"intake",label:"Intake Gate",produces:"pgc_clarifications.intake"},{value:"discovery",label:"Discovery Gate",produces:"pgc_clarifications.discovery"},{value:"plan",label:"Plan Gate",produces:"pgc_clarifications.plan"},{value:"architecture",label:"Architecture Gate",produces:"pgc_clarifications.architecture"},{value:"epic",label:"Epic Gate",produces:"pgc_clarifications.epic"},{value:"remediation",label:"Remediation Gate",produces:"pgc_clarifications.remediation"},{value:"compliance",label:"Compliance Gate",produces:"pgc_clarifications.compliance"}],lH=["semantic","structural","hybrid"],cH=["stabilized","blocked","abandoned"],$e={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},St={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},uH={fontSize:10,fontWeight:700,color:"var(--text-primary)",textTransform:"uppercase",letterSpacing:"0.05em",padding:"6px 0",borderBottom:"1px solid var(--border-panel)",marginBottom:8};function _g(e){return e?`prompt:template:${e.template_id}:${e.active_version||e.version||"1.0.0"}`:""}function wg(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"&&t[1]==="template"?t[2]:e}function $s(e){var s;if(!e)return"";const t=e.kind||"role",n=((s=e.fragment_id)==null?void 0:s.replace(`${t}:`,""))||e.id||"",r=e.version||e.active_version||"1.0.0";return`prompt:${t}:${n}:${r}`}function qs(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="prompt"?t[2]:e}function ml(e){if(!e)return"";const t=e.active_version||e.version||"1.0.0";return`schema:${e.schema_id}:${t}`}function gl(e){if(!e)return null;const t=e.split(":");return t.length>=2&&t[0]==="schema"?t[1]:e}function jg({title:e,defaultOpen:t=!1,isOpen:n,onToggle:r,children:s,badge:i}){const[a,l]=m.useState(t),c=n!==void 0,d=c?n:a,u=()=>{c&&r?r():l(!a)};return o.jsxs("div",{className:"border rounded",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("button",{onClick:u,className:"w-full px-2 py-1.5 flex items-center justify-between text-left hover:bg-white/5 transition-colors",style:{background:"var(--bg-canvas)"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{color:"var(--text-muted)",transform:d?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.15s ease"},children:o.jsx("path",{d:"M9 18l6-6-6-6"})}),o.jsx("span",{style:{...St,marginBottom:0},children:e})]}),i&&o.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded",style:{background:"var(--action-primary)",color:"#fff"},children:i})]}),d&&o.jsx("div",{className:"p-2 border-t",style:{borderColor:"var(--border-panel)"},children:s})]})}function Sg(e){return e?`mech:${e.type}:${e.op_id}:${e.active_version||e.version||"1.0.0"}`:""}function Bs(e){if(!e)return null;const t=e.split(":");return t.length>=3&&t[0]==="mech"?t[2]:e}function dH({node:e,onChange:t,onDelete:n,templates:r=[],schemas:s=[],roleFragments:i=[],taskFragments:a=[],pgcFragments:l=[],mechanicalOpTypes:c=[],mechanicalOps:d=[]}){var we,Ee,Ne,ne,je,Ve,ct,Be,Ie,oe,me,fe,V,ge,pe,ze,We,st,Ue;const[u,f]=m.useState(e),[p,h]=m.useState("A");m.useEffect(()=>{f(e),h("A")},[e]);const v=(L,W)=>{const K={...u,[L]:W};f(K),t(K)},g=(L,W)=>{const K={...u.includes,[L]:W},re={...u,includes:K};f(re),t(re)},_=L=>{const W={...u.includes};delete W[L];const K={...u,includes:W};f(K),t(K)},x=()=>{const L={...u.includes,NEW_KEY:""},W={...u,includes:L};f(W),t(W)},y=L=>{const W={...u,internals:L};f(W),t(W)},b=(L,W)=>{const K=u.internals||E(),re={...K.question_generation,[L]:W};y({...K,question_generation:re})},j=(L,W)=>{const K=u.internals||E(),re={...K.question_generation.includes,[L]:W},Fe={...K.question_generation,includes:re};y({...K,question_generation:Fe})},N=(L,W)=>{const K=u.internals||E(),re={...K.clarification_merge,[L]:W};y({...K,clarification_merge:re})},E=()=>({question_generation:{template_ref:"",includes:{ROLE_PROMPT:"",TASK_PROMPT:"",PGC_CONTEXT:""},output_schema_ref:"schema:clarification_question_set:2.0.0"},operator_entry:{renders:"question_set",captures:"pgc_answers"},clarification_merge:{template_ref:"",output_schema_ref:"schema:pgc_clarifications:1.0.0"}});if(!u)return null;const S=u.type==="pgc",k=wg(u.task_ref),w=u.includes||{},R=w.ROLE_PROMPT||"",T=w.TASK_PROMPT||"",I=w.OUTPUT_SCHEMA||"",D=w.PGC_CONTEXT||"",C=qs(R),M=qs(T),P=gl(I),F=qs(D),O=Object.entries(w).filter(([L])=>!["ROLE_PROMPT","TASK_PROMPT","OUTPUT_SCHEMA","PGC_CONTEXT"].includes(L)),A=u.internals||E(),z=wg((we=A.question_generation)==null?void 0:we.template_ref),$=qs((Ne=(Ee=A.question_generation)==null?void 0:Ee.includes)==null?void 0:Ne.ROLE_PROMPT),B=qs((je=(ne=A.question_generation)==null?void 0:ne.includes)==null?void 0:je.TASK_PROMPT),U=qs((ct=(Ve=A.question_generation)==null?void 0:Ve.includes)==null?void 0:ct.PGC_CONTEXT),G=gl((Be=A.question_generation)==null?void 0:Be.output_schema_ref),H=wg((Ie=A.clarification_merge)==null?void 0:Ie.template_ref),q=gl((oe=A.clarification_merge)==null?void 0:oe.output_schema_ref),Q=L=>{const W=L.target.value;if(!W){v("task_ref","");return}const K=r.find(re=>re.template_id===W);K&&v("task_ref",_g(K))},se=L=>{const W=L.target.value;if(!W){_("ROLE_PROMPT");return}const K=i.find(re=>re.fragment_id===`role:${W}`||re.id===W);K&&g("ROLE_PROMPT",$s(K))},ie=L=>{const W=L.target.value;if(!W){_("TASK_PROMPT");return}const K=a.find(re=>re.fragment_id===`task:${W}`||re.id===W);K&&g("TASK_PROMPT",$s(K))},Z=L=>{const W=L.target.value;if(!W){_("OUTPUT_SCHEMA");return}const K=s.find(re=>re.schema_id===W);K&&g("OUTPUT_SCHEMA",ml(K))},Se=L=>{const W=L.target.value;if(!W){_("PGC_CONTEXT");return}const K=l.find(re=>re.fragment_id===`pgc:${W}`||re.id===W);K&&g("PGC_CONTEXT",$s(K))},xe=L=>{const W=L.target.value,K=TS.find(pt=>pt.value===W),re=(K==null?void 0:K.produces)||`pgc_clarifications.${W}`,Fe={...u,gate_kind:W,produces:re};f(Fe),t(Fe)},be=L=>{const W=L.target.value;if(!W){b("template_ref","");return}const K=r.find(re=>re.template_id===W);K&&b("template_ref",_g(K))},ve=L=>{const W=L.target.value;if(!W){j("ROLE_PROMPT","");return}const K=i.find(re=>re.fragment_id===`role:${W}`||re.id===W);K&&j("ROLE_PROMPT",$s(K))},ae=L=>{const W=L.target.value;if(!W){j("TASK_PROMPT","");return}const K=a.find(re=>re.fragment_id===`task:${W}`||re.id===W);K&&j("TASK_PROMPT",$s(K))},Y=L=>{const W=L.target.value;if(!W){j("PGC_CONTEXT","");return}const K=l.find(re=>re.fragment_id===`pgc:${W}`||re.id===W);K&&j("PGC_CONTEXT",$s(K))},te=L=>{const W=L.target.value;if(!W){b("output_schema_ref","");return}const K=s.find(re=>re.schema_id===W);K&&b("output_schema_ref",ml(K))},ee=L=>{const W=L.target.value;if(!W){N("template_ref","");return}const K=r.find(re=>re.template_id===W);K&&N("template_ref",_g(K))},ke=L=>{const W=L.target.value;if(!W){N("output_schema_ref","");return}const K=s.find(re=>re.schema_id===W);K&&N("output_schema_ref",ml(K))};return o.jsxs("div",{className:"w-72 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[o.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:S?"PGC Gate Properties":"Node Properties"}),o.jsx("button",{onClick:()=>n(u.node_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete node",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),o.jsxs("div",{className:"p-3 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:St,children:"Node ID"}),o.jsx("input",{type:"text",value:u.node_id||"",onChange:L=>v("node_id",L.target.value),style:$e})]}),o.jsxs("div",{children:[o.jsx("label",{style:St,children:"Type"}),o.jsx("select",{value:u.type||"task",onChange:L=>v("type",L.target.value),style:$e,children:aH.map(L=>o.jsx("option",{value:L.value,children:L.label},L.value))})]}),S&&o.jsxs("div",{children:[o.jsx("label",{style:St,children:"Gate Kind"}),o.jsx("select",{value:u.gate_kind||"discovery",onChange:xe,style:$e,children:TS.map(L=>o.jsx("option",{value:L.value,children:L.label},L.value))})]}),o.jsxs("div",{children:[o.jsx("label",{style:St,children:"Description"}),o.jsx("textarea",{value:u.description||"",onChange:L=>v("description",L.target.value),rows:2,style:{...$e,resize:"vertical"}})]}),(S||["task","intake_gate"].includes(u.type))&&o.jsxs("div",{children:[o.jsx("label",{style:St,children:"Produces"}),o.jsx("input",{type:"text",value:u.produces||"",onChange:L=>v("produces",L.target.value),placeholder:S?"pgc_clarifications.discovery":"document_type",style:$e})]}),S&&o.jsxs("div",{className:"mt-4",children:[o.jsx("div",{style:uH,children:"Gate Internals"}),o.jsx(jg,{title:"Pass A: Question Generation",isOpen:p==="A",onToggle:()=>h(p==="A"?null:"A"),badge:"LLM",children:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),o.jsxs("select",{value:z||"",onChange:be,style:{...$e,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Template --"}),r.map(L=>o.jsx("option",{value:L.template_id,children:L.name||L.template_id.replace(/_/g," ")},L.template_id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),o.jsxs("select",{value:$||"",onChange:ve,style:{...$e,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Role --"}),i.map(L=>{var K;const W=((K=L.fragment_id)==null?void 0:K.replace("role:",""))||L.id;return o.jsx("option",{value:W,children:L.name||(W==null?void 0:W.replace(/_/g," "))},L.fragment_id||L.id)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),o.jsxs("select",{value:B||"",onChange:ae,style:{...$e,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Task --"}),a.map(L=>{var K;const W=((K=L.fragment_id)==null?void 0:K.replace("task:",""))||L.id;return o.jsx("option",{value:W,children:L.name||(W==null?void 0:W.replace(/_/g," "))},L.fragment_id||L.id)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),o.jsxs("select",{value:U||"",onChange:Y,style:{...$e,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(L=>{var K;const W=((K=L.fragment_id)==null?void 0:K.replace("pgc:",""))||L.id;return o.jsx("option",{value:W,children:L.name||(W==null?void 0:W.replace(/_/g," "))},L.fragment_id||L.id)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),o.jsxs("select",{value:G||"",onChange:te,style:{...$e,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(L=>o.jsx("option",{value:L.schema_id,children:L.title||L.schema_id.replace(/_/g," ")},L.schema_id))]})]})]})}),o.jsx("div",{className:"mt-2",children:o.jsx(jg,{title:"Entry: Operator Answers",badge:"UI",children:o.jsxs("div",{className:"space-y-2 text-xs",style:{color:"var(--text-muted)"},children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Renders:"}),o.jsx("span",{className:"font-mono",children:((me=A.operator_entry)==null?void 0:me.renders)||"question_set"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Captures:"}),o.jsx("span",{className:"font-mono",children:((fe=A.operator_entry)==null?void 0:fe.captures)||"pgc_answers"})]}),o.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Questions rendered in UI. User provides answers."})]})})}),o.jsx("div",{className:"mt-2",children:o.jsx(jg,{title:"Pass B: Clarification Merge",isOpen:p==="B",onToggle:()=>h(p==="B"?null:"B"),badge:((V=A.clarification_merge)==null?void 0:V.internal_type)||"LLM",children:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Internal Type"}),o.jsxs("select",{value:((ge=A.clarification_merge)==null?void 0:ge.internal_type)||"LLM",onChange:L=>N("internal_type",L.target.value),style:{...$e,fontSize:11},children:[o.jsx("option",{value:"LLM",children:"LLM"}),o.jsx("option",{value:"MECH",children:"Mechanical"})]})]}),(((pe=A.clarification_merge)==null?void 0:pe.internal_type)||"LLM")==="LLM"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Template"}),o.jsxs("select",{value:H||"",onChange:ee,style:{...$e,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Template --"}),r.map(L=>o.jsx("option",{value:L.template_id,children:L.name||L.template_id.replace(/_/g," ")},L.template_id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),o.jsxs("select",{value:q||"",onChange:ke,style:{...$e,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(L=>o.jsx("option",{value:L.schema_id,children:L.title||L.schema_id.replace(/_/g," ")},L.schema_id))]})]})]}),((ze=A.clarification_merge)==null?void 0:ze.internal_type)==="MECH"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"Operation"}),o.jsxs("select",{value:Bs((We=A.clarification_merge)==null?void 0:We.op_ref)||"",onChange:L=>{const W=L.target.value;if(!W){N("op_ref","");return}const K=d.find(re=>re.op_id===W);K&&N("op_ref",Sg(K))},style:{...$e,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Operation --"}),d.filter(L=>L.type==="merger").map(L=>o.jsx("option",{value:L.op_id,children:L.name},L.op_id))]})]}),((st=A.clarification_merge)==null?void 0:st.op_ref)&&(()=>{const L=Bs(A.clarification_merge.op_ref),W=d.find(K=>K.op_id===L);return W?o.jsxs("div",{className:"p-2 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:8,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:W.type}),o.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&o.jsx("div",{style:{color:"var(--text-muted)"},children:W.description})]}):null})(),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),o.jsxs("select",{value:q||"",onChange:ke,style:{...$e,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(L=>o.jsx("option",{value:L.schema_id,children:L.title||L.schema_id.replace(/_/g," ")},L.schema_id))]})]})]}),o.jsx("div",{className:"text-[10px] mt-2 p-2 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Merges questions + answers into structured clarifications artifact."})]})})})]}),u.type==="task"&&o.jsxs("div",{children:[o.jsx("label",{style:St,children:"Internal Type"}),o.jsx("select",{value:u.internal_type||"LLM",onChange:L=>v("internal_type",L.target.value),style:$e,children:ES.map(L=>o.jsx("option",{value:L.value,children:L.label},L.value))}),o.jsx("div",{className:"mt-1 text-xs",style:{color:"var(--text-muted)"},children:(Ue=ES.find(L=>L.value===(u.internal_type||"LLM")))==null?void 0:Ue.description})]}),["task","qa","intake_gate"].includes(u.type)&&(u.internal_type||"LLM")==="LLM"&&o.jsxs("div",{children:[o.jsx("label",{style:St,children:"Interaction Template"}),o.jsxs("select",{value:k||"",onChange:Q,style:$e,children:[o.jsx("option",{value:"",children:"-- Select Template --"}),r.map(L=>o.jsx("option",{value:L.template_id,children:L.name||L.template_id.replace(/_/g," ")},L.template_id))]}),u.task_ref&&o.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.task_ref,children:u.task_ref})]}),u.type==="task"&&u.internal_type==="MECH"&&o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:St,children:"Mechanical Operation"}),o.jsxs("select",{value:Bs(u.op_ref)||"",onChange:L=>{const W=L.target.value;if(!W){v("op_ref","");return}const K=d.find(re=>re.op_id===W);K&&v("op_ref",Sg(K))},style:$e,children:[o.jsx("option",{value:"",children:"-- Select Operation --"}),c.map(L=>{const W=d.filter(K=>K.type===L.type_id);return W.length===0?null:o.jsx("optgroup",{label:L.name,children:W.map(K=>o.jsx("option",{value:K.op_id,children:K.name},K.op_id))},L.type_id)})]}),u.op_ref&&o.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const L=Bs(u.op_ref),W=d.find(re=>re.op_id===L),K=W?c.find(re=>re.type_id===W.type):null;return W?o.jsxs("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(K==null?void 0:K.name)||W.type}),o.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&o.jsx("div",{style:{color:"var(--text-muted)"},children:W.description})]}):null})(),o.jsxs("div",{children:[o.jsx("label",{style:St,children:"Output Schema"}),o.jsxs("select",{value:gl(u.output_schema_ref)||"",onChange:L=>{const W=L.target.value;if(!W){v("output_schema_ref","");return}const K=s.find(re=>re.schema_id===W);K&&v("output_schema_ref",ml(K))},style:$e,children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(L=>o.jsx("option",{value:L.schema_id,children:L.title||L.schema_id.replace(/_/g," ")},L.schema_id))]})]})]}),u.type==="task"&&u.internal_type==="UI"&&o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:St,children:"Entry Operation"}),o.jsxs("select",{value:Bs(u.op_ref)||"",onChange:L=>{const W=L.target.value;if(!W){v("op_ref","");return}const K=d.find(re=>re.op_id===W);K&&v("op_ref",Sg(K))},style:$e,children:[o.jsx("option",{value:"",children:"-- Select Entry Operation --"}),d.filter(L=>L.type==="entry").map(L=>o.jsx("option",{value:L.op_id,children:L.name},L.op_id))]}),u.op_ref&&o.jsx("div",{className:"mt-1 text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:u.op_ref,children:u.op_ref})]}),u.op_ref&&(()=>{const L=Bs(u.op_ref),W=d.find(re=>re.op_id===L);if(!W)return null;const K=W.config||{};return o.jsxs("div",{className:"p-2 rounded text-xs space-y-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,background:"var(--dot-orange, #f97316)",color:"#fff"},children:"Entry"}),o.jsx("span",{style:{color:"var(--text-primary)",fontWeight:600},children:W.name})]}),W.description&&o.jsx("div",{style:{color:"var(--text-muted)"},children:W.description}),o.jsxs("div",{className:"pt-2 border-t space-y-1",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Renders:"}),o.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:K.renders||"-"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Captures:"}),o.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:K.captures||"-"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Layout:"}),o.jsx("span",{className:"font-mono",style:{color:"var(--text-secondary)"},children:K.layout||"form"})]})]}),K.entry_prompt&&o.jsxs("div",{className:"p-2 rounded mt-2",style:{background:"var(--bg-panel)"},children:[o.jsx("div",{className:"text-[10px] uppercase mb-1",style:{color:"var(--text-muted)"},children:"Entry Prompt"}),o.jsx("div",{style:{color:"var(--text-primary)"},children:K.entry_prompt})]})]})})(),!u.op_ref&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"p-2 rounded text-xs",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:"Select an Entry operation above, or define custom renders/captures below."}),o.jsxs("div",{children:[o.jsx("label",{style:St,children:"Renders"}),o.jsx("input",{type:"text",value:u.renders||"",onChange:L=>v("renders",L.target.value),placeholder:"e.g., question_set",style:$e})]}),o.jsxs("div",{children:[o.jsx("label",{style:St,children:"Captures"}),o.jsx("input",{type:"text",value:u.captures||"",onChange:L=>v("captures",L.target.value),placeholder:"e.g., user_answers",style:$e})]})]})]}),u.type==="qa"&&o.jsxs("div",{children:[o.jsx("label",{style:St,children:"QA Mode"}),o.jsx("select",{value:u.qa_mode||"semantic",onChange:L=>v("qa_mode",L.target.value),style:$e,children:lH.map(L=>o.jsx("option",{value:L,children:L},L))})]}),u.type==="end"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{style:St,children:"Terminal Outcome"}),o.jsx("select",{value:u.terminal_outcome||"stabilized",onChange:L=>v("terminal_outcome",L.target.value),style:$e,children:cH.map(L=>o.jsx("option",{value:L,children:L},L))})]}),o.jsxs("div",{children:[o.jsx("label",{style:St,children:"Gate Outcome"}),o.jsx("input",{type:"text",value:u.gate_outcome||"",onChange:L=>v("gate_outcome",L.target.value),placeholder:"e.g., complete, failed",style:$e})]})]}),o.jsxs("div",{className:"flex gap-4",children:[u.type==="qa"&&o.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[o.jsx("input",{type:"checkbox",checked:u.requires_qa||!1,onChange:L=>v("requires_qa",L.target.checked)}),"Requires QA"]}),o.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[o.jsx("input",{type:"checkbox",checked:u.non_advancing||!1,onChange:L=>v("non_advancing",L.target.checked)}),"Non-advancing"]})]}),u.type==="task"&&(u.internal_type||"LLM")==="LLM"&&o.jsxs("div",{children:[o.jsx("div",{className:"flex items-center justify-between mb-2",children:o.jsx("label",{style:St,children:"Includes"})}),o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"ROLE_PROMPT"}),o.jsxs("select",{value:C||"",onChange:se,style:{...$e,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Role --"}),i.map(L=>{var K;const W=((K=L.fragment_id)==null?void 0:K.replace("role:",""))||L.id;return o.jsx("option",{value:W,children:L.name||(W==null?void 0:W.replace(/_/g," "))},L.fragment_id||L.id)})]})]}),o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"TASK_PROMPT"}),o.jsxs("select",{value:M||"",onChange:ie,style:{...$e,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Task --"}),a.map(L=>{var K;const W=((K=L.fragment_id)==null?void 0:K.replace("task:",""))||L.id;return o.jsx("option",{value:W,children:L.name||(W==null?void 0:W.replace(/_/g," "))},L.fragment_id||L.id)})]})]}),o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"OUTPUT_SCHEMA"}),o.jsxs("select",{value:P||"",onChange:Z,style:{...$e,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select Schema --"}),s.map(L=>o.jsx("option",{value:L.schema_id,children:L.title||L.schema_id.replace(/_/g," ")},L.schema_id))]})]}),o.jsxs("div",{className:"mb-2",children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"PGC_CONTEXT"}),o.jsxs("select",{value:F||"",onChange:Se,style:{...$e,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select PGC Context --"}),l.map(L=>{var K;const W=((K=L.fragment_id)==null?void 0:K.replace("pgc:",""))||L.id;return o.jsx("option",{value:W,children:L.name||(W==null?void 0:W.replace(/_/g," "))},L.fragment_id||L.id)})]})]}),O.length>0&&o.jsxs("div",{className:"mt-3 pt-2 border-t",style:{borderColor:"var(--border-panel)"},children:[o.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Custom Includes"}),o.jsx("div",{className:"space-y-2",children:O.map(([L,W])=>o.jsxs("div",{className:"flex gap-1",children:[o.jsx("input",{type:"text",value:L,onChange:K=>{const re={...u.includes};delete re[L],re[K.target.value]=W;const Fe={...u,includes:re};f(Fe),t(Fe)},style:{...$e,width:"35%",fontSize:10},placeholder:"KEY"}),o.jsx("input",{type:"text",value:W,onChange:K=>g(L,K.target.value),style:{...$e,flex:1,fontSize:10},placeholder:"path/to/file"}),o.jsx("button",{onClick:()=>_(L),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]},L))})]}),o.jsx("button",{onClick:x,className:"mt-2 text-xs px-2 py-1 rounded hover:opacity-80 w-full",style:{color:"var(--action-primary)",background:"transparent",border:"1px dashed var(--border-panel)"},children:"+ Add Custom Include"})]})]})]})}const fH=["auto","user_choice"],pH=["eq","ne","lt","lte","gt","gte"],Jn={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},is={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function hH({edge:e,nodeIds:t,onChange:n,onDelete:r}){const[s,i]=m.useState(e);m.useEffect(()=>{i(e)},[e]);const a=(u,f)=>{const p={...s,[u]:f};i(p),n(p)},l=()=>{const u=[...s.conditions||[],{type:"retry_count",operator:"lt",value:2}];a("conditions",u)},c=(u,f,p)=>{const h=[...s.conditions||[]];h[u]={...h[u],[f]:p},a("conditions",h)},d=u=>{const f=(s.conditions||[]).filter((p,h)=>h!==u);a("conditions",f)};return s?o.jsxs("div",{className:"w-64 border-l overflow-y-auto flex-shrink-0",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",style:{borderColor:"var(--border-panel)"},children:[o.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Edge Properties"}),o.jsx("button",{onClick:()=>r(s.edge_id),className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete edge",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]}),o.jsxs("div",{className:"p-3 space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:is,children:"Edge ID"}),o.jsx("input",{type:"text",value:s.edge_id||"",onChange:u=>a("edge_id",u.target.value),style:Jn})]}),o.jsxs("div",{children:[o.jsx("label",{style:is,children:"From Node"}),o.jsx("select",{value:s.from_node_id||"",onChange:u=>a("from_node_id",u.target.value),style:Jn,children:t.map(u=>o.jsx("option",{value:u,children:u},u))})]}),o.jsxs("div",{children:[o.jsx("label",{style:is,children:"To Node"}),o.jsxs("select",{value:s.to_node_id||"",onChange:u=>a("to_node_id",u.target.value||null),style:Jn,children:[o.jsx("option",{value:"",children:"(none - non-advancing)"}),t.map(u=>o.jsx("option",{value:u,children:u},u))]})]}),o.jsxs("div",{children:[o.jsx("label",{style:is,children:"Outcome"}),o.jsx("input",{type:"text",value:s.outcome||"",onChange:u=>a("outcome",u.target.value),placeholder:"success, failed, etc.",style:Jn})]}),o.jsxs("div",{children:[o.jsx("label",{style:is,children:"Label"}),o.jsx("input",{type:"text",value:s.label||"",onChange:u=>a("label",u.target.value),placeholder:"Human-readable label",style:Jn})]}),o.jsxs("div",{children:[o.jsx("label",{style:is,children:"Kind"}),o.jsx("select",{value:s.kind||"auto",onChange:u=>a("kind",u.target.value),style:Jn,children:fH.map(u=>o.jsx("option",{value:u,children:u},u))})]}),o.jsxs("label",{className:"flex items-center gap-1.5 text-xs",style:{color:"var(--text-muted)"},children:[o.jsx("input",{type:"checkbox",checked:s.non_advancing||!1,onChange:u=>a("non_advancing",u.target.checked)}),"Non-advancing"]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("label",{style:is,children:"Conditions"}),o.jsx("button",{onClick:l,className:"text-xs px-1.5 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent"},children:"+ Add"})]}),o.jsx("div",{className:"space-y-2",children:(s.conditions||[]).map((u,f)=>o.jsx("div",{className:"p-2 rounded space-y-1",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:o.jsxs("div",{className:"flex gap-1 items-center",children:[o.jsx("input",{type:"text",value:u.type||"",onChange:p=>c(f,"type",p.target.value),placeholder:"retry_count",style:{...Jn,flex:1,fontSize:10}}),o.jsx("select",{value:u.operator||"lt",onChange:p=>c(f,"operator",p.target.value),style:{...Jn,width:"auto",fontSize:10},children:pH.map(p=>o.jsx("option",{value:p,children:p},p))}),o.jsx("input",{type:"text",value:u.value??"",onChange:p=>{const h=isNaN(p.target.value)?p.target.value:Number(p.target.value);c(f,"value",h)},placeholder:"value",style:{...Jn,width:50,fontSize:10}}),o.jsx("button",{onClick:()=>d(f),className:"text-xs px-1",style:{color:"#ef4444"},children:"x"})]})},f))})]})]})]}):null}const mH={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"};function gH({workspaceId:e,artifactId:t,onArtifactSave:n,mechanicalOpTypes:r=[],mechanicalOps:s=[]}){var U,G,H;const[i,a]=m.useState("canvas"),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(""),[h,v]=m.useState(null),{workflowJson:g,loading:_,error:x,saving:y,lastSaveResult:b,updateWorkflow:j}=H3(e,t,{onSave:q=>{n==null||n(t,q)}}),{templates:N}=$3(),{schemas:E}=q3(),{fragmentsByKind:S}=B3(),k=m.useMemo(()=>{var q;return!l||!g?null:((q=g.nodes)==null?void 0:q.find(Q=>Q.node_id===l))||null},[l,g]),w=m.useMemo(()=>{var q;return!d||!g?null:((q=g.edges)==null?void 0:q.find(Q=>Q.edge_id===d))||null},[d,g]),R=m.useMemo(()=>g!=null&&g.nodes?g.nodes.map(q=>q.node_id):[],[g]),T=m.useCallback(q=>{j(q)},[j]),I=m.useCallback(q=>{if(!g)return;const Q=g.nodes.map(Z=>Z.node_id===l?q:Z);let se=g.edges,ie=g.entry_node_ids||[];q.node_id!==l&&(se=g.edges.map(Z=>({...Z,from_node_id:Z.from_node_id===l?q.node_id:Z.from_node_id,to_node_id:Z.to_node_id===l?q.node_id:Z.to_node_id})),ie=ie.map(Z=>Z===l?q.node_id:Z),c(q.node_id)),j({...g,nodes:Q,edges:se,entry_node_ids:ie})},[g,l,j]),D=m.useCallback(q=>{if(!g)return;const Q=g.edges.map(se=>se.edge_id===d?q:se);q.edge_id!==d&&u(q.edge_id),j({...g,edges:Q})},[g,d,j]),C=m.useCallback(q=>{g&&(j({...g,nodes:g.nodes.filter(Q=>Q.node_id!==q),edges:g.edges.filter(Q=>Q.from_node_id!==q&&Q.to_node_id!==q),entry_node_ids:(g.entry_node_ids||[]).filter(Q=>Q!==q)}),c(null))},[g,j]),M=m.useCallback(q=>{g&&(j({...g,edges:g.edges.filter(Q=>Q.edge_id!==q)}),u(null))},[g,j]),P=m.useCallback(q=>{c(q),q&&u(null)},[]),F=m.useCallback(q=>{u(q),q&&c(null)},[]),O=m.useCallback(q=>{q==="json"&&g&&(p(JSON.stringify(g,null,2)),v(null)),a(q)},[g]),A=m.useCallback(q=>{const Q=q.target.value;p(Q);try{const se=JSON.parse(Q);v(null),j(se)}catch(se){v(se.message)}},[j]),z=((U=b==null?void 0:b.tier1_report)==null?void 0:U.results)||[],$=z.filter(q=>q.severity==="error").length,B=z.filter(q=>q.severity==="warning").length;return o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"flex items-center justify-between px-4 py-1.5 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex items-center gap-3",children:[y&&o.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),x&&o.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:x}),!y&&!x&&g&&o.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:[((G=g.nodes)==null?void 0:G.length)||0," nodes, ",((H=g.edges)==null?void 0:H.length)||0," edges"]})]})}),o.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"canvas",label:"Canvas"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(q=>o.jsx("button",{onClick:()=>O(q.id),style:{...mH,color:i===q.id?"var(--text-primary)":"var(--text-muted)",borderBottom:i===q.id?"2px solid var(--action-primary)":"2px solid transparent"},children:q.label},q.id))}),_?o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[i==="canvas"&&o.jsxs(o.Fragment,{children:[o.jsx(Ii,{children:o.jsx(oH,{workflowJson:g,onWorkflowChange:T,selectedNodeId:l,selectedEdgeId:d,onNodeSelect:P,onEdgeSelect:F})}),k&&o.jsx(dH,{node:k,onChange:I,onDelete:C,templates:N,schemas:E,roleFragments:S.role||[],taskFragments:S.task||[],pgcFragments:S.pgc||[],mechanicalOpTypes:r,mechanicalOps:s}),w&&o.jsx(hH,{edge:w,nodeIds:R,onChange:D,onDelete:M})]}),i==="json"&&o.jsxs("div",{className:"flex-1 flex flex-col p-4",children:[o.jsx("textarea",{value:f,onChange:A,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:h?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),h&&o.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",h]})]}),i==="metadata"&&o.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:g?o.jsx(xH,{workflow:g}):o.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]}),z.length>0&&o.jsxs("div",{className:"px-4 py-1.5 border-t flex items-center gap-3 text-xs",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[$>0&&o.jsxs("span",{style:{color:"#ef4444"},children:[$," error",$!==1?"s":""]}),B>0&&o.jsxs("span",{style:{color:"#f59e0b"},children:[B," warning",B!==1?"s":""]}),$===0&&B===0&&o.jsx("span",{style:{color:"#10b981"},children:"Valid"}),o.jsx("span",{style:{color:"var(--text-muted)"},children:z.map(q=>q.message).join(" | ")})]})]})}function xH({workflow:e}){const t={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},n={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},r=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"version",label:"Version"},{key:"description",label:"Description"}],s=e.thread_ownership||{},i=Object.entries(s),a=e.entry_node_ids||[];return o.jsxs("div",{className:"space-y-4 max-w-lg",children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),r.map(l=>o.jsxs("div",{children:[o.jsx("label",{style:n,children:l.label}),o.jsx("div",{style:t,children:e[l.key]||"-"})]},l.key)),o.jsxs("div",{children:[o.jsx("label",{style:n,children:"Entry Node IDs"}),o.jsx("div",{style:t,children:a.length>0?a.join(", "):"-"})]}),i.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Thread Ownership"}),i.map(([l,c])=>o.jsxs("div",{children:[o.jsx("label",{style:n,children:l}),o.jsx("div",{style:t,children:c})]},l))]})]})}function kg({label:e,items:t,selectedId:n,onSelect:r,isGroupActive:s}){const[i,a]=m.useState(!1),l=m.useRef(null);return m.useEffect(()=>{if(!i)return;const c=d=>{l.current&&!l.current.contains(d.target)&&a(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[i]),t.length===0?null:o.jsxs("div",{ref:l,style:{position:"relative"},children:[o.jsxs("button",{onClick:()=>a(!i),className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:s?"var(--text-primary)":"var(--text-muted)",background:s?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:s?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px",cursor:"pointer"},children:[e,o.jsx("span",{style:{fontSize:9,opacity:.6,marginLeft:4},children:""})]}),i&&o.jsx("div",{style:{position:"absolute",top:"100%",left:0,zIndex:50,minWidth:160,background:"var(--bg-panel)",border:"1px solid var(--border-panel)",borderRadius:6,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",paddingTop:4,paddingBottom:4,marginTop:1},children:t.map(c=>o.jsxs("button",{onClick:()=>{r(c.id),a(!1)},className:"w-full text-left px-3 py-1.5 hover:opacity-80 transition-opacity",style:{background:n===c.id?"var(--bg-selected)":"transparent",color:n===c.id?"var(--text-primary)":"var(--text-secondary)",border:"none",cursor:"pointer",fontSize:12,fontWeight:"normal"},children:[c.label,c.viewOnly&&o.jsx("span",{style:{color:"var(--text-muted)",marginLeft:4,fontSize:11},children:"(view)"})]},c.id))})]})}function Ng({label:e,isSelected:t,onClick:n}){return o.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium transition-colors",style:{color:t?"var(--text-primary)":"var(--text-muted)",background:t?"var(--bg-selected, rgba(255,255,255,0.1))":"transparent",borderBottom:t?"2px solid var(--action-primary)":"2px solid transparent",marginBottom:"-1px"},children:e})}function vH({workspaceId:e,docType:t,loading:n=!1,roles:r=[],workflows:s=[],onArtifactSave:i,onCreateDcwWorkflow:a,initialTab:l=null,docTypeSource:c=null,mechanicalOpTypes:d=[],mechanicalOps:u=[]}){var oe,me,fe;const[f,p]=m.useState(l||"task_prompt");m.useEffect(()=>{l&&p(l)},[l]);const[h,v]=m.useState("source"),[g,_]=m.useState(null),[x,y]=m.useState(!1),[b,j]=m.useState(null),[N,E]=m.useState(null),[S,k]=m.useState(!1),[w,R]=m.useState(null),[T,I]=m.useState(null),[D,C]=m.useState(!1),[M,P]=m.useState(null),[F,O]=m.useState(null),[A,z]=m.useState(!1),[$,B]=m.useState(null),U=m.useMemo(()=>{if(!(t!=null&&t.role_prompt_ref))return null;const V=t.role_prompt_ref.split(":");return V.length!==4||V[0]!=="prompt"||V[1]!=="role"?null:{roleId:V[2],version:V[3]}},[t==null?void 0:t.role_prompt_ref]),G=m.useMemo(()=>{if(!(t!=null&&t.template_ref))return null;const V=t.template_ref.split(":");return V.length!==4||V[0]!=="prompt"||V[1]!=="template"?null:{templateId:V[2],version:V[3]}},[t==null?void 0:t.template_ref]),H=m.useMemo(()=>{if(!(t!=null&&t.qa_template_ref))return null;const V=t.qa_template_ref.split(":");return V.length!==4||V[0]!=="prompt"||V[1]!=="template"?null:{templateId:V[2],version:V[3]}},[t==null?void 0:t.qa_template_ref]),q=m.useMemo(()=>{if(!(t!=null&&t.pgc_template_ref))return null;const V=t.pgc_template_ref.split(":");return V.length!==4||V[0]!=="prompt"||V[1]!=="template"?null:{templateId:V[2],version:V[3]}},[t==null?void 0:t.pgc_template_ref]);m.useEffect(()=>{if(!U){_(null);return}y(!0),j(null),_e.getRole(U.roleId,U.version).then(V=>{_(V.content)}).catch(V=>{console.error("Failed to load role:",V),j(V.message)}).finally(()=>{y(!1)})},[U]),m.useEffect(()=>{if(!G){E(null);return}k(!0),R(null),_e.getTemplate(G.templateId,G.version).then(V=>{E(V.content)}).catch(V=>{console.error("Failed to load template:",V),R(V.message)}).finally(()=>{k(!1)})},[G]),m.useEffect(()=>{if(!H){I(null);return}C(!0),P(null),_e.getTemplate(H.templateId,H.version).then(V=>{I(V.content)}).catch(V=>{console.error("Failed to load QA template:",V),P(V.message)}).finally(()=>{C(!1)})},[H]),m.useEffect(()=>{if(!q){O(null);return}z(!0),B(null),_e.getTemplate(q.templateId,q.version).then(V=>{O(V.content)}).catch(V=>{console.error("Failed to load PGC template:",V),B(V.message)}).finally(()=>{z(!1)})},[q]);const Q=m.useMemo(()=>{if(!t||f==="role_prompt")return null;const V=t.version||t.active_version;return`doctype:${t.doc_type_id}:${V}:${f}`},[t,f]),{content:se,loading:ie,error:Z,saving:Se,isDirty:xe,updateContent:be,lastSaveResult:ve}=Ea(e,Q,{onSave:V=>{i==null||i(Q,V)}}),ae=[{id:"package",label:"Package",isPackage:!0},{id:"role_prompt",label:"Role Prompt",viewOnly:!0},{id:"template",label:"Template",viewOnly:!0},{id:"task_prompt",label:"Task Prompt"},{id:"qa_prompt",label:"QA Prompt"},{id:"qa_template",label:"QA Template",viewOnly:!0},{id:"reflection_prompt",label:"Reflection"},{id:"pgc_context",label:"PGC Context"},{id:"pgc_template",label:"PGC Template",viewOnly:!0},{id:"schema",label:"Schema",isJson:!0},{id:"workflow",label:"Workflow",isWorkflow:!0}],Y=m.useMemo(()=>t?ae.filter(V=>V.id==="package"?!0:V.id==="role_prompt"?!!t.role_prompt_ref:V.id==="template"?!!t.template_ref:V.id==="qa_template"?!!t.qa_template_ref:V.id==="pgc_template"?!!t.pgc_template_ref:V.id==="workflow"?!0:t.artifacts?t.artifacts[V.id]!=null:!1):[],[t]),te=c==="task"||c==="schema";m.useEffect(()=>{te||Y.length>0&&!Y.find(V=>V.id===f)&&p(Y[0].id)},[Y,f,te]);const ee=f==="role_prompt"||f==="template"||f==="qa_template"||f==="pgc_template",ke=f==="package",we=f==="schema",Ee=f==="workflow",Ne=!ee&&!ke&&!we&&!Ee,ne=m.useMemo(()=>t!=null&&t.doc_type_id?t.workflow_ref?!0:s.some(V=>V.workflow_id===t.doc_type_id):!1,[t==null?void 0:t.doc_type_id,t==null?void 0:t.workflow_ref,s]),[je,Ve]=m.useState(!1),ct=async()=>{if(!(!(t!=null&&t.doc_type_id)||!a)){Ve(!0);try{await a(t.doc_type_id)}finally{Ve(!1)}}};if(!t&&!n)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Document Type Selected"}),o.jsx("div",{className:"text-sm",children:"Select a document type from the browser to edit its prompts."})]})});if(n)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"Loading..."}),o.jsx("div",{className:"text-sm",children:"Fetching document type details..."})]})});const Be=c==="task"?"Interaction":c==="schema"?"Schema":null,Ie=!te&&(f==="task_prompt"||f==="schema");return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:t.display_name}),o.jsx("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:te?Be:o.jsxs(o.Fragment,{children:["v",t.version||t.active_version,t.authority_level&&`  ${t.authority_level}`]})})]})})}),te&&o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:c==="task"?"Task Prompt":"Schema"})}),!te&&o.jsxs("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[Y.find(V=>V.id==="package")&&o.jsx(Ng,{label:"Package",isSelected:f==="package",onClick:()=>{p("package"),v("source")}}),Y.find(V=>V.id==="workflow")&&o.jsx(Ng,{label:"Workflow",isSelected:f==="workflow",onClick:()=>{p("workflow"),v("source")}}),(()=>{const V=["role_prompt","task_prompt","template"],ge=Y.filter(pe=>V.includes(pe.id)).map(pe=>({id:pe.id,label:pe.id==="role_prompt"?"Role":pe.id==="task_prompt"?"Task":"Template",viewOnly:pe.viewOnly}));return ge.length===0?null:o.jsx(kg,{label:"Generation",items:ge,selectedId:V.includes(f)?f:null,onSelect:pe=>{p(pe),v("source")},isGroupActive:V.includes(f)})})(),(()=>{const V=["qa_prompt","qa_template"],ge=Y.filter(pe=>V.includes(pe.id)).map(pe=>({id:pe.id,label:pe.id==="qa_prompt"?"Prompt":"Template",viewOnly:pe.viewOnly}));return ge.length===0?null:o.jsx(kg,{label:"QA",items:ge,selectedId:V.includes(f)?f:null,onSelect:pe=>{p(pe),v("source")},isGroupActive:V.includes(f)})})(),(()=>{const V=["pgc_context","pgc_template"],ge=Y.filter(pe=>V.includes(pe.id)).map(pe=>({id:pe.id,label:pe.id==="pgc_context"?"Context":"Template",viewOnly:pe.viewOnly}));return ge.length===0?null:o.jsx(kg,{label:"PGC",items:ge,selectedId:V.includes(f)?f:null,onSelect:pe=>{p(pe),v("source")},isGroupActive:V.includes(f)})})(),Y.find(V=>V.id==="schema")&&o.jsx(Ng,{label:"Schema",isSelected:f==="schema",onClick:()=>{p("schema"),v("source")}})]}),!te&&Ne&&!Ie&&o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:()=>v("source"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="source"?"var(--action-primary)":"transparent",color:h==="source"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Source"}),o.jsx("button",{onClick:()=>v("resolved"),className:"px-3 py-1 text-xs font-medium rounded transition-colors",style:{background:h==="resolved"?"var(--action-primary)":"transparent",color:h==="resolved"?"var(--bg-canvas, #000)":"var(--text-muted)"},children:"Resolved"})]}),h==="source"&&((oe=t==null?void 0:t.artifacts)==null?void 0:oe[f])&&o.jsxs("span",{className:"text-xs font-mono truncate ml-4",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts[f]}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts[f]]})]}),ee&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:[o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="role_prompt"?"View Only - Edit roles in the Roles section":"View Only - Shared template"}),f==="role_prompt"&&U&&o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[U.roleId.replace(/_/g," ")," v",U.version]}),f==="template"&&G&&o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[G.templateId.replace(/_/g," ")," v",G.version]}),f==="qa_template"&&H&&o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[H.templateId.replace(/_/g," ")," v",H.version]}),f==="pgc_template"&&q&&o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected)",color:"var(--text-secondary)"},children:[q.templateId.replace(/_/g," ")," v",q.version]})]}),Ie&&o.jsx("div",{className:"flex items-center gap-2 px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:f==="task_prompt"?"View Only  Edit from Building Blocks  Interactions":"View Only  Edit from Building Blocks  Schemas"})}),we&&((me=t==null?void 0:t.artifacts)==null?void 0:me.schema)&&o.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:o.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},title:`combine-config/document_types/${t.doc_type_id}/releases/${t.version||t.active_version}/${t.artifacts.schema}`,children:["combine-config/document_types/",t.doc_type_id,"/releases/",t.version||t.active_version,"/",t.artifacts.schema]})}),o.jsx("div",{className:"flex-1 overflow-hidden flex flex-col",children:Ee?ne?o.jsx(gH,{workspaceId:e,artifactId:t.workflow_ref,onArtifactSave:i,mechanicalOpTypes:d,mechanicalOps:u}):o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8 max-w-md",children:[o.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"No Workflow Defined"}),o.jsx("div",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"This document type doesn't have a workflow definition yet. Create one to define how the document is produced."}),a&&o.jsx("button",{onClick:ct,disabled:je,className:"px-4 py-2 rounded text-sm font-semibold hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",cursor:je?"wait":"pointer",opacity:je?.7:1},children:je?"Creating...":"Create Workflow"})]})}):f==="package"?o.jsx(eH,{workspaceId:e,docType:t,roles:r,onSave:i}):f==="role_prompt"?o.jsx(nr,{content:g||"",onChange:()=>{},loading:x,saving:!1,isDirty:!1,error:b,readOnly:!0,placeholder:"No role prompt configured for this document type"}):f==="template"?o.jsx(nr,{content:N||"",onChange:()=>{},loading:S,saving:!1,isDirty:!1,error:w,readOnly:!0,placeholder:"No template configured for this document type"}):f==="qa_template"?o.jsx(nr,{content:T||"",onChange:()=>{},loading:D,saving:!1,isDirty:!1,error:M,readOnly:!0,placeholder:"No QA template configured for this document type"}):f==="pgc_template"?o.jsx(nr,{content:F||"",onChange:()=>{},loading:A,saving:!1,isDirty:!1,error:$,readOnly:!0,placeholder:"No PGC template configured for this document type"}):h==="source"||we?o.jsx(nr,{content:se,onChange:Ie?()=>{}:be,loading:ie,saving:Ie?!1:Se,isDirty:Ie?!1:xe,error:Z,readOnly:Ie,placeholder:`Enter ${((fe=Y.find(V=>V.id===f))==null?void 0:fe.label)||"prompt"} content...`,isJson:we}):o.jsx(JW,{workspaceId:e,artifactId:Q})}),Ne&&(ve==null?void 0:ve.tier1)&&!ve.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}function yH({workspaceId:e,role:t,onArtifactSave:n}){const r=t?`role:${t.role_id}:${t.active_version}:role_prompt`:null,{content:s,loading:i,error:a,saving:l,isDirty:c,updateContent:d,lastSaveResult:u}=Ea(e,r,{onSave:p=>{n==null||n(r,p)}});if(!t)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Role Selected"}),o.jsx("div",{className:"text-sm",children:"Select a role from the browser to edit its prompt."})]})});const f=t.role_id.replace(/_/g," ").replace(/\b\w/g,p=>p.toUpperCase());return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:f}),o.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:["v",t.active_version,"  Role Prompt"]})]})})}),o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"px-4 py-2 text-sm",style:{color:"var(--text-primary)",background:"var(--bg-canvas)",borderBottom:"2px solid var(--action-primary)"},children:"Role Prompt"})}),o.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:o.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/roles/",t.role_id,"/releases/",t.active_version,"/role.prompt.txt"]})}),o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(nr,{content:s,onChange:d,loading:i,saving:l,isDirty:c,error:a,placeholder:"Enter role prompt content..."})}),(u==null?void 0:u.tier1)&&!u.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const bH=[{value:"",label:"-- Select purpose --"},{value:"document",label:"Document"},{value:"qa",label:"QA"},{value:"pgc",label:"PGC"},{value:"general",label:"General"}],Cg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},Eg={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function _H({workspaceId:e,template:t,onArtifactSave:n}){const[r,s]=m.useState("metadata"),[i,a]=m.useState({name:"",purpose:"",use_case:""}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),f=t?`template:${t.template_id}:${t.active_version}:template`:null,p=t?`template:${t.template_id}:${t.active_version}:meta`:null,{content:h,loading:v,error:g,saving:_,isDirty:x,updateContent:y,lastSaveResult:b}=Ea(e,f,{onSave:w=>{n==null||n(f,w)}});m.useEffect(()=>{t&&(a({name:t.name||"",purpose:t.purpose||"",use_case:t.use_case||""}),c(!1))},[t==null?void 0:t.template_id,t==null?void 0:t.name,t==null?void 0:t.purpose,t==null?void 0:t.use_case]);const j=m.useCallback((w,R)=>{a(T=>({...T,[w]:R})),c(!0)},[]),N=m.useCallback(async()=>{if(!(!e||!p)){u(!0);try{const w=Fy.dump({name:i.name||null,purpose:i.purpose||null,use_case:i.use_case||null},{lineWidth:-1});await _e.writeArtifact(e,p,w),c(!1),n==null||n(p,{success:!0})}catch(w){console.error("Failed to save metadata:",w),alert(`Failed to save metadata: ${w.message}`)}finally{u(!1)}}},[e,p,i,n]),E=m.useCallback(()=>{l&&N()},[l,N]);if(!t)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Template Selected"}),o.jsx("div",{className:"text-sm",children:"Select a template from the browser to edit its content."})]})});const S=i.name||t.template_id.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase()),k=[{id:"metadata",label:"Metadata"},{id:"template",label:"Template"}];return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:S}),o.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[o.jsxs("span",{children:["v",t.active_version]}),o.jsx("span",{children:""}),o.jsx("span",{children:"Shared Template"}),i.purpose&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"var(--action-primary)",color:"#000"},children:i.purpose})]})]})]})})}),o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:k.map(w=>o.jsxs("button",{onClick:()=>s(w.id),className:"px-4 py-2 text-sm transition-colors",style:{color:r===w.id?"var(--text-primary)":"var(--text-muted)",background:r===w.id?"var(--bg-canvas)":"transparent",borderBottom:r===w.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[w.label,w.id==="metadata"&&l&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),w.id==="template"&&x&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},w.id))}),r==="metadata"&&o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o.jsxs("div",{className:"max-w-xl space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{style:Eg,children:"Template Name"}),o.jsx("input",{type:"text",value:i.name,onChange:w=>j("name",w.target.value),onBlur:E,placeholder:"e.g., Document Generator",style:Cg}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this template"})]}),o.jsxs("div",{children:[o.jsx("label",{style:Eg,children:"Template Purpose"}),o.jsx("select",{value:i.purpose,onChange:w=>{j("purpose",w.target.value),setTimeout(()=>N(),0)},style:Cg,children:bH.map(w=>o.jsx("option",{value:w.value,children:w.label},w.value))}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"What type of interaction this template supports"})]}),o.jsxs("div",{children:[o.jsx("label",{style:Eg,children:"Use Case"}),o.jsx("textarea",{value:i.use_case,onChange:w=>j("use_case",w.target.value),onBlur:E,placeholder:"Describe when and how this template should be used...",rows:4,style:{...Cg,resize:"vertical"}}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of when and how this template should be used"})]}),d&&o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."})]})}),r==="template"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex items-center justify-end px-3 py-2 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel-alt, var(--bg-panel))"},children:o.jsxs("span",{className:"text-xs font-mono truncate",style:{color:"var(--text-muted)"},children:["combine-config/prompts/templates/",t.template_id,"/releases/",t.active_version,"/template.txt"]})}),o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(nr,{content:h,onChange:y,loading:v,saving:_,isDirty:x,error:g,placeholder:"Enter template content..."})})]}),(b==null?void 0:b.tier1)&&!b.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const io={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function wH({workspaceId:e,schema:t,onArtifactSave:n}){var x;const[r,s]=m.useState("content"),i=t?`schema:${t.schema_id}:${t.active_version||t.version}:schema`:null,{content:a,loading:l,error:c,saving:d,isDirty:u,updateContent:f,lastSaveResult:p}=Ea(e,i,{onSave:y=>{n==null||n(i,y)}});if(!t)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Schema Selected"}),o.jsx("div",{className:"text-sm",children:"Select a schema from the browser to edit its content."})]})});const h=t.title||((x=t.schema_id)==null?void 0:x.replace(/_/g," "))||"Schema",v=t.active_version||t.version||"1.0.0",g=[{id:"content",label:"Schema"},{id:"info",label:"Info"}],_=!e;return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[h,o.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:"#8b5cf6",color:"#fff"},children:"Schema"})]}),o.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[o.jsxs("span",{children:["v",v]}),_&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:g.map(y=>o.jsxs("button",{onClick:()=>s(y.id),className:"px-4 py-2 text-sm transition-colors",style:{color:r===y.id?"var(--text-primary)":"var(--text-muted)",background:r===y.id?"var(--bg-canvas)":"transparent",borderBottom:r===y.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[y.label,y.id==="content"&&u&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},y.id))}),r==="content"&&o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(nr,{content:a,onChange:f,loading:l,saving:d,isDirty:u,error:c,placeholder:"Enter JSON schema...",readOnly:_,isJson:!0})}),r==="info"&&o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o.jsxs("div",{className:"max-w-xl space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{style:io,children:"Schema ID"}),o.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.schema_id})]}),o.jsxs("div",{children:[o.jsx("label",{style:io,children:"Version"}),o.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:v})]}),o.jsxs("div",{children:[o.jsx("label",{style:io,children:"Title (from JSON)"}),o.jsx("div",{className:"px-3 py-2 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-primary)",fontSize:13},children:t.title||"-"}),o.jsx("div",{className:"text-[10px] mt-1",style:{color:"var(--text-muted)"},children:'Edit in Schema tab via the "title" property'})]}),o.jsxs("div",{children:[o.jsx("label",{style:io,children:"File Path"}),o.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["combine-config/schemas/",t.schema_id,"/releases/",v,"/schema.json"]})]}),o.jsxs("div",{children:[o.jsx("label",{style:io,children:"Artifact ID"}),o.jsxs("div",{className:"px-3 py-2 rounded font-mono text-xs",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:["schema:",t.schema_id,":",v]})]})]})}),(p==null?void 0:p.tier1)&&!p.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const jH={role:"Role",task:"Task",qa:"QA",pgc:"PGC",questions:"Questions",reflection:"Reflection"},SH={role:"var(--dot-purple)",task:"var(--action-primary)",qa:"#10b981",pgc:"#8b5cf6",questions:"#f59e0b",reflection:"#ec4899"},Tg={width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},oo={display:"block",fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4,textTransform:"uppercase",letterSpacing:"0.05em"};function kH({workspaceId:e,fragment:t,onArtifactSave:n}){var z;const[r,s]=m.useState("content"),[i,a]=m.useState({name:"",intent:"",tags:[]}),[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(""),[h,v]=((z=t==null?void 0:t.fragment_id)==null?void 0:z.split(":"))||[null,null],g=t?h==="role"?`fragment:role:${v}:${t.version}:content`:`doctype:${t.source_doc_type}:${t.version}:${h}_prompt`:null,_=t&&h==="role"?`fragment:role:${v}:${t.version}:meta`:null,{content:x,loading:y,error:b,saving:j,isDirty:N,updateContent:E,lastSaveResult:S}=Ea(e,g,{onSave:$=>{n==null||n(g,$)}});m.useEffect(()=>{t&&(a({name:t.name||"",intent:t.intent||"",tags:t.tags||[]}),c(!1))},[t==null?void 0:t.fragment_id,t==null?void 0:t.name,t==null?void 0:t.intent,t==null?void 0:t.tags]);const k=m.useCallback(($,B)=>{a(U=>({...U,[$]:B})),c(!0)},[]),w=m.useCallback(async()=>{if(!(!e||!_)){u(!0);try{const $=Fy.dump({name:i.name||null,intent:i.intent||null,tags:i.tags.length>0?i.tags:null},{lineWidth:-1});await _e.writeArtifact(e,_,$),c(!1),n==null||n(_,{success:!0})}catch($){console.error("Failed to save metadata:",$),alert(`Failed to save metadata: ${$.message}`)}finally{u(!1)}}},[e,_,i,n]),R=m.useCallback(()=>{l&&_&&w()},[l,_,w]),T=m.useCallback(()=>{const $=f.trim().toLowerCase();$&&!i.tags.includes($)&&(k("tags",[...i.tags,$]),p(""))},[f,i.tags,k]),I=m.useCallback($=>{k("tags",i.tags.filter(B=>B!==$))},[i.tags,k]),D=m.useCallback($=>{$.key==="Enter"&&($.preventDefault(),T())},[T]);if(!t)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-2",children:"No Fragment Selected"}),o.jsx("div",{className:"text-sm",children:"Select a prompt fragment from the browser to edit its content."})]})});const C=i.name||t.name||t.fragment_id,M=jH[h]||h,P=SH[h]||"var(--text-muted)",F=[{id:"content",label:"Content"},{id:"metadata",label:"Metadata"}],O=!e,A=_&&!O;return o.jsxs("div",{className:"flex-1 flex flex-col h-full",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsxs("h2",{className:"text-base font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[C,o.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-medium uppercase",style:{background:P,color:"#fff"},children:M})]}),o.jsxs("div",{className:"text-xs mt-0.5 flex items-center gap-2",style:{color:"var(--text-muted)"},children:[o.jsxs("span",{children:["v",t.version]}),t.source_doc_type&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsxs("span",{children:["from ",t.source_doc_type]})]}),O&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px]",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:"View Only"})]})]})]})})}),o.jsx("div",{className:"flex border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:F.map($=>o.jsxs("button",{onClick:()=>s($.id),className:"px-4 py-2 text-sm transition-colors",style:{color:r===$.id?"var(--text-primary)":"var(--text-muted)",background:r===$.id?"var(--bg-canvas)":"transparent",borderBottom:r===$.id?"2px solid var(--action-primary)":"2px solid transparent"},children:[$.label,$.id==="content"&&N&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"}),$.id==="metadata"&&l&&o.jsx("span",{className:"ml-1 text-[10px]",style:{color:"var(--action-primary)"},children:"*"})]},$.id))}),r==="content"&&o.jsx("div",{className:"flex-1 overflow-hidden",children:o.jsx(nr,{content:x,onChange:E,loading:y,saving:j,isDirty:N,error:b,placeholder:"Enter prompt content...",readOnly:O})}),r==="metadata"&&o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o.jsxs("div",{className:"max-w-xl space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{style:oo,children:"Kind"}),o.jsxs("div",{className:"px-3 py-2 rounded flex items-center gap-2",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:P}}),o.jsx("span",{style:{color:"var(--text-primary)",fontSize:13},children:M})]}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Fragment kind determines how it's used in prompt assembly"})]}),o.jsxs("div",{children:[o.jsx("label",{style:oo,children:"Name"}),o.jsx("input",{type:"text",value:i.name,onChange:$=>k("name",$.target.value),onBlur:R,placeholder:"e.g., Technical Architect Role",style:Tg,disabled:!A}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Human-readable name for this fragment"})]}),o.jsxs("div",{children:[o.jsx("label",{style:oo,children:"Intent"}),o.jsx("textarea",{value:i.intent,onChange:$=>k("intent",$.target.value),onBlur:R,placeholder:"Describe the purpose and intent of this prompt fragment...",rows:4,style:{...Tg,resize:"vertical"},disabled:!A}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Description of what this fragment is meant to accomplish"})]}),o.jsxs("div",{children:[o.jsx("label",{style:oo,children:"Tags"}),o.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:i.tags.map($=>o.jsxs("span",{className:"px-2 py-0.5 rounded text-xs flex items-center gap-1",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:[$,A&&o.jsx("button",{onClick:()=>I($),className:"ml-0.5 hover:opacity-70",style:{color:"var(--text-muted)"},children:""})]},$))}),A&&o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",value:f,onChange:$=>p($.target.value),onKeyDown:D,placeholder:"Add tag...",style:{...Tg,flex:1}}),o.jsx("button",{onClick:T,disabled:!f.trim(),className:"px-3 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000",opacity:f.trim()?1:.5,cursor:f.trim()?"pointer":"not-allowed"},children:"Add"})]}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"Free-form tags for classification and filtering"})]}),t.source_doc_type&&o.jsxs("div",{children:[o.jsx("label",{style:oo,children:"Source"}),o.jsxs("div",{className:"px-3 py-2 rounded text-sm",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:["Derived from document type: ",o.jsx("strong",{children:t.source_doc_type})]}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:"This fragment is defined within a DCW package. Edit it from the document type's tab bar."})]}),d&&o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Saving..."}),!A&&!t.source_doc_type&&o.jsx("div",{className:"text-xs p-2 rounded",style:{background:"rgba(251, 191, 36, 0.1)",color:"var(--text-muted)"},children:"Metadata editing requires an active workspace."})]})}),(S==null?void 0:S.tier1)&&!S.tier1.passed&&o.jsx("div",{className:"px-4 py-2 border-t",style:{borderColor:"var(--border-panel)",background:"rgba(239, 68, 68, 0.1)"},children:o.jsx("div",{className:"text-xs",style:{color:"var(--state-error-text)"},children:"Validation issues found - see status panel for details"})})]})}const ao={width:"100%",padding:"6px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)"},lo={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"};function NH({mechanicalOp:e,mechanicalOpTypes:t=[]}){var f,p,h;const[n,r]=m.useState(null),[s,i]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(null);if(m.useEffect(()=>{if(!(e!=null&&e.op_id)){r(null),i(null);return}(async()=>{l(!0),d(null);try{const g=await _e.getMechanicalOp(e.op_id);r(g);const _=t.find(x=>x.type_id===g.type);if(_)i(_);else try{const x=await _e.getMechanicalOpType(g.type);i(x)}catch{}}catch(g){console.error("Failed to load mechanical op details:",g),d(g.message),r(e)}finally{l(!1)}})()},[e==null?void 0:e.op_id,t]),!e)return o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-1",children:"Mechanical Operation Editor"}),o.jsx("div",{className:"text-sm",children:"Select an operation from the Building Blocks tray"})]})});const u=n||e;return o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,background:"var(--dot-purple, #a855f7)",color:"#fff"},children:(s==null?void 0:s.name)||u.type}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:u.name}),o.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",u.active_version||u.version]})]})]})}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[a&&o.jsx("div",{style:{color:"var(--text-muted)"},children:"Loading..."}),c&&o.jsx("div",{className:"mb-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.1)",color:"#ef4444"},children:c}),!a&&o.jsxs("div",{className:"space-y-6 max-w-2xl",children:[o.jsxs("section",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Details"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:lo,children:"Operation ID"}),o.jsx("div",{style:ao,className:"font-mono",children:u.op_id})]}),o.jsxs("div",{children:[o.jsx("label",{style:lo,children:"Name"}),o.jsx("div",{style:ao,children:u.name})]}),u.description&&o.jsxs("div",{children:[o.jsx("label",{style:lo,children:"Description"}),o.jsx("div",{style:{...ao,whiteSpace:"pre-wrap"},children:u.description})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{style:lo,children:"Type"}),o.jsx("div",{style:ao,children:u.type})]}),o.jsxs("div",{children:[o.jsx("label",{style:lo,children:"Version"}),o.jsx("div",{style:ao,children:u.active_version||u.version})]})]})]})]}),s&&o.jsxs("section",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Operation Type"}),o.jsxs("div",{className:"p-3 rounded",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsxs("span",{style:{fontSize:16},children:[s.icon==="git-merge"&&"",s.icon==="scissors"&&"",s.icon==="check-circle"&&"",s.icon==="shuffle"&&"",s.icon==="git-branch"&&""]}),o.jsx("span",{className:"font-semibold",style:{color:"var(--text-primary)"},children:s.name}),o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:s.category})]}),o.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:s.description}),o.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[((f=s.inputs)==null?void 0:f.length)>0&&o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Inputs"}),s.inputs.map((v,g)=>o.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[v.name,": ",v.type]},g))]}),((p=s.outputs)==null?void 0:p.length)>0&&o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-muted)"},children:"Outputs"}),s.outputs.map((v,g)=>o.jsxs("div",{className:"text-xs font-mono",style:{color:"var(--text-secondary)"},children:[v.name,": ",v.type]},g))]})]})]})]}),u.config&&o.jsxs("section",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Configuration"}),o.jsx("pre",{className:"p-3 rounded text-xs font-mono overflow-x-auto",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)",color:"var(--text-secondary)"},children:JSON.stringify(u.config,null,2)})]}),u.metadata&&o.jsxs("section",{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide mb-3",style:{color:"var(--text-muted)"},children:"Metadata"}),o.jsxs("div",{className:"space-y-2",children:[u.metadata.created_date&&o.jsxs("div",{className:"flex justify-between text-xs",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Created"}),o.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.created_date})]}),u.metadata.author&&o.jsxs("div",{className:"flex justify-between text-xs",children:[o.jsx("span",{style:{color:"var(--text-muted)"},children:"Author"}),o.jsx("span",{style:{color:"var(--text-secondary)"},children:u.metadata.author})]}),((h=u.metadata.tags)==null?void 0:h.length)>0&&o.jsxs("div",{children:[o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tags"}),o.jsx("div",{className:"flex gap-1 mt-1",children:u.metadata.tags.map(v=>o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{background:"var(--bg-canvas)",color:"var(--text-muted)"},children:v},v))})]})]})]}),o.jsxs("div",{className:"p-3 rounded text-xs",style:{background:"var(--bg-panel)",color:"var(--text-muted)"},children:[o.jsx("strong",{children:"Note:"})," Mechanical operations are currently read-only in the workbench. Edit the YAML files in ",o.jsx("code",{children:"combine-config/mechanical_ops/"})," to modify."]})]})]})]})}function CH(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const Cu=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Fi(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function $y(e){return"nodeType"in e}function Qt(e){var t,n;return e?Fi(e)?e:$y(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function qy(e){const{Document:t}=Qt(e);return e instanceof t}function Ta(e){return Fi(e)?!1:e instanceof Qt(e).HTMLElement}function V3(e){return e instanceof Qt(e).SVGElement}function $i(e){return e?Fi(e)?e.document:$y(e)?qy(e)?e:Ta(e)||V3(e)?e.ownerDocument:document:document:document}const Kn=Cu?m.useLayoutEffect:m.useEffect;function By(e){const t=m.useRef(e);return Kn(()=>{t.current=e}),m.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function EH(){const e=m.useRef(null),t=m.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=m.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function da(e,t){t===void 0&&(t=[e]);const n=m.useRef(e);return Kn(()=>{n.current!==e&&(n.current=e)},t),n}function Ra(e,t){const n=m.useRef();return m.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function Rc(e){const t=By(e),n=m.useRef(null),r=m.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function Qx(e){const t=m.useRef();return m.useEffect(()=>{t.current=e},[e]),t.current}let Rg={};function Aa(e,t){return m.useMemo(()=>{if(t)return t;const n=Rg[e]==null?0:Rg[e]+1;return Rg[e]=n,e+"-"+n},[e,t])}function U3(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((i,a)=>{const l=Object.entries(a);for(const[c,d]of l){const u=i[c];u!=null&&(i[c]=u+e*d)}return i},{...t})}}const mi=U3(1),fa=U3(-1);function TH(e){return"clientX"in e&&"clientY"in e}function Wy(e){if(!e)return!1;const{KeyboardEvent:t}=Qt(e.target);return t&&e instanceof t}function RH(e){if(!e)return!1;const{TouchEvent:t}=Qt(e.target);return t&&e instanceof t}function Zx(e){if(RH(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return TH(e)?{x:e.clientX,y:e.clientY}:null}const Ei=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Ei.Translate.toString(e),Ei.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),RS="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function AH(e){return e.matches(RS)?e:e.querySelector(RS)}const IH={display:"none"};function PH(e){let{id:t,value:n}=e;return X.createElement("div",{id:t,style:IH},n)}function MH(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return X.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function OH(){const[e,t]=m.useState("");return{announce:m.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const G3=m.createContext(null);function DH(e){const t=m.useContext(G3);m.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function LH(){const[e]=m.useState(()=>new Set),t=m.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[m.useCallback(r=>{let{type:s,event:i}=r;e.forEach(a=>{var l;return(l=a[s])==null?void 0:l.call(a,i)})},[e]),t]}const zH={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},FH={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function $H(e){let{announcements:t=FH,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=zH}=e;const{announce:i,announcement:a}=OH(),l=Aa("DndLiveRegion"),[c,d]=m.useState(!1);if(m.useEffect(()=>{d(!0)},[]),DH(m.useMemo(()=>({onDragStart(f){let{active:p}=f;i(t.onDragStart({active:p}))},onDragMove(f){let{active:p,over:h}=f;t.onDragMove&&i(t.onDragMove({active:p,over:h}))},onDragOver(f){let{active:p,over:h}=f;i(t.onDragOver({active:p,over:h}))},onDragEnd(f){let{active:p,over:h}=f;i(t.onDragEnd({active:p,over:h}))},onDragCancel(f){let{active:p,over:h}=f;i(t.onDragCancel({active:p,over:h}))}}),[i,t])),!c)return null;const u=X.createElement(X.Fragment,null,X.createElement(PH,{id:r,value:s.draggable}),X.createElement(MH,{id:l,announcement:a}));return n?ni.createPortal(u,n):u}var mt;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(mt||(mt={}));function Ac(){}function Ic(e,t){return m.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function K3(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const Pn=Object.freeze({x:0,y:0});function Y3(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function X3(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function qH(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function AS(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function Q3(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function IS(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Z3=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=IS(t,t.left,t.top),i=[];for(const a of r){const{id:l}=a,c=n.get(l);if(c){const d=Y3(IS(c),s);i.push({id:l,data:{droppableContainer:a,value:d}})}}return i.sort(X3)},BH=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=AS(t),i=[];for(const a of r){const{id:l}=a,c=n.get(l);if(c){const d=AS(c),u=s.reduce((p,h,v)=>p+Y3(d[v],h),0),f=Number((u/4).toFixed(4));i.push({id:l,data:{droppableContainer:a,value:f}})}}return i.sort(X3)};function WH(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=s-r,l=i-n;if(r<s&&n<i){const c=t.width*t.height,d=e.width*e.height,u=a*l,f=u/(c+d-u);return Number(f.toFixed(4))}return 0}const HH=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const i of r){const{id:a}=i,l=n.get(a);if(l){const c=WH(l,t);c>0&&s.push({id:a,data:{droppableContainer:i,value:c}})}}return s.sort(qH)};function VH(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function J3(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Pn}function UH(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((a,l)=>({...a,top:a.top+e*l.y,bottom:a.bottom+e*l.y,left:a.left+e*l.x,right:a.right+e*l.x}),{...n})}}const GH=UH(1);function KH(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function YH(e,t,n){const r=KH(t);if(!r)return e;const{scaleX:s,scaleY:i,x:a,y:l}=r,c=e.left-a-(1-s)*parseFloat(n),d=e.top-l-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),u=s?e.width/s:e.width,f=i?e.height/i:e.height;return{width:u,height:f,top:d,right:c+u,bottom:d+f,left:c}}const XH={ignoreTransform:!1};function qi(e,t){t===void 0&&(t=XH);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:d,transformOrigin:u}=Qt(e).getComputedStyle(e);d&&(n=YH(n,d,u))}const{top:r,left:s,width:i,height:a,bottom:l,right:c}=n;return{top:r,left:s,width:i,height:a,bottom:l,right:c}}function PS(e){return qi(e,{ignoreTransform:!0})}function QH(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function ZH(e,t){return t===void 0&&(t=Qt(e).getComputedStyle(e)),t.position==="fixed"}function JH(e,t){t===void 0&&(t=Qt(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=t[s];return typeof i=="string"?n.test(i):!1})}function Eu(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(qy(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!Ta(s)||V3(s)||n.includes(s))return n;const i=Qt(e).getComputedStyle(s);return s!==e&&JH(s,i)&&n.push(s),ZH(s,i)?n:r(s.parentNode)}return e?r(e):n}function eT(e){const[t]=Eu(e,1);return t??null}function Ag(e){return!Cu||!e?null:Fi(e)?e:$y(e)?qy(e)||e===$i(e).scrollingElement?window:Ta(e)?e:null:null}function tT(e){return Fi(e)?e.scrollX:e.scrollLeft}function nT(e){return Fi(e)?e.scrollY:e.scrollTop}function Jx(e){return{x:tT(e),y:nT(e)}}var bt;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(bt||(bt={}));function rT(e){return!Cu||!e?!1:e===document.scrollingElement}function sT(e){const t={x:0,y:0},n=rT(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,l=e.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:a,isRight:l,maxScroll:r,minScroll:t}}const eV={x:.2,y:.2};function tV(e,t,n,r,s){let{top:i,left:a,right:l,bottom:c}=n;r===void 0&&(r=10),s===void 0&&(s=eV);const{isTop:d,isBottom:u,isLeft:f,isRight:p}=sT(e),h={x:0,y:0},v={x:0,y:0},g={height:t.height*s.y,width:t.width*s.x};return!d&&i<=t.top+g.height?(h.y=bt.Backward,v.y=r*Math.abs((t.top+g.height-i)/g.height)):!u&&c>=t.bottom-g.height&&(h.y=bt.Forward,v.y=r*Math.abs((t.bottom-g.height-c)/g.height)),!p&&l>=t.right-g.width?(h.x=bt.Forward,v.x=r*Math.abs((t.right-g.width-l)/g.width)):!f&&a<=t.left+g.width&&(h.x=bt.Backward,v.x=r*Math.abs((t.left+g.width-a)/g.width)),{direction:h,speed:v}}function nV(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function iT(e){return e.reduce((t,n)=>mi(t,Jx(n)),Pn)}function rV(e){return e.reduce((t,n)=>t+tT(n),0)}function sV(e){return e.reduce((t,n)=>t+nT(n),0)}function iV(e,t){if(t===void 0&&(t=qi),!e)return;const{top:n,left:r,bottom:s,right:i}=t(e);eT(e)&&(s<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const oV=[["x",["left","right"],rV],["y",["top","bottom"],sV]];class Hy{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Eu(n),s=iT(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,a,l]of oV)for(const c of a)Object.defineProperty(this,c,{get:()=>{const d=l(r),u=s[i]-d;return this.rect[c]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Io{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function aV(e){const{EventTarget:t}=Qt(e);return e instanceof t?e:$i(e)}function Ig(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var un;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(un||(un={}));function MS(e){e.preventDefault()}function lV(e){e.stopPropagation()}var Me;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Me||(Me={}));const oT={start:[Me.Space,Me.Enter],cancel:[Me.Esc],end:[Me.Space,Me.Enter,Me.Tab]},cV=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Me.Right:return{...n,x:n.x+25};case Me.Left:return{...n,x:n.x-25};case Me.Down:return{...n,y:n.y+25};case Me.Up:return{...n,y:n.y-25}}};class Tu{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Io($i(n)),this.windowListeners=new Io(Qt(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(un.Resize,this.handleCancel),this.windowListeners.add(un.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(un.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&iV(r),n(Pn)}handleKeyDown(t){if(Wy(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:i=oT,coordinateGetter:a=cV,scrollBehavior:l="smooth"}=s,{code:c}=t;if(i.end.includes(c)){this.handleEnd(t);return}if(i.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:d}=r.current,u=d?{x:d.left,y:d.top}:Pn;this.referenceCoordinates||(this.referenceCoordinates=u);const f=a(t,{active:n,context:r.current,currentCoordinates:u});if(f){const p=fa(f,u),h={x:0,y:0},{scrollableAncestors:v}=r.current;for(const g of v){const _=t.code,{isTop:x,isRight:y,isLeft:b,isBottom:j,maxScroll:N,minScroll:E}=sT(g),S=nV(g),k={x:Math.min(_===Me.Right?S.right-S.width/2:S.right,Math.max(_===Me.Right?S.left:S.left+S.width/2,f.x)),y:Math.min(_===Me.Down?S.bottom-S.height/2:S.bottom,Math.max(_===Me.Down?S.top:S.top+S.height/2,f.y))},w=_===Me.Right&&!y||_===Me.Left&&!b,R=_===Me.Down&&!j||_===Me.Up&&!x;if(w&&k.x!==f.x){const T=g.scrollLeft+p.x,I=_===Me.Right&&T<=N.x||_===Me.Left&&T>=E.x;if(I&&!p.y){g.scrollTo({left:T,behavior:l});return}I?h.x=g.scrollLeft-T:h.x=_===Me.Right?g.scrollLeft-N.x:g.scrollLeft-E.x,h.x&&g.scrollBy({left:-h.x,behavior:l});break}else if(R&&k.y!==f.y){const T=g.scrollTop+p.y,I=_===Me.Down&&T<=N.y||_===Me.Up&&T>=E.y;if(I&&!p.x){g.scrollTo({top:T,behavior:l});return}I?h.y=g.scrollTop-T:h.y=_===Me.Down?g.scrollTop-N.y:g.scrollTop-E.y,h.y&&g.scrollBy({top:-h.y,behavior:l});break}}this.handleMove(t,mi(fa(f,this.referenceCoordinates),h))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Tu.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=oT,onActivation:s}=t,{active:i}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const l=i.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function OS(e){return!!(e&&"distance"in e)}function DS(e){return!!(e&&"delay"in e)}class Vy{constructor(t,n,r){var s;r===void 0&&(r=aV(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:a}=i;this.props=t,this.events=n,this.document=$i(a),this.documentListeners=new Io(this.document),this.listeners=new Io(r),this.windowListeners=new Io(Qt(a)),this.initialCoordinates=(s=Zx(i))!=null?s:Pn,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(un.Resize,this.handleCancel),this.windowListeners.add(un.DragStart,MS),this.windowListeners.add(un.VisibilityChange,this.handleCancel),this.windowListeners.add(un.ContextMenu,MS),this.documentListeners.add(un.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(DS(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(OS(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(un.Click,lV,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(un.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:l}}=i;if(!s)return;const c=(n=Zx(t))!=null?n:Pn,d=fa(s,c);if(!r&&l){if(OS(l)){if(l.tolerance!=null&&Ig(d,l.tolerance))return this.handleCancel();if(Ig(d,l.distance))return this.handleStart()}if(DS(l)&&Ig(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}t.cancelable&&t.preventDefault(),a(c)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===Me.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const uV={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Ru extends Vy{constructor(t){const{event:n}=t,r=$i(n.target);super(t,uV,r)}}Ru.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const dV={move:{name:"mousemove"},end:{name:"mouseup"}};var ev;(function(e){e[e.RightClick=2]="RightClick"})(ev||(ev={}));class fV extends Vy{constructor(t){super(t,dV,$i(t.event.target))}}fV.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===ev.RightClick?!1:(r==null||r({event:n}),!0)}}];const Pg={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class pV extends Vy{constructor(t){super(t,Pg)}static setup(){return window.addEventListener(Pg.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Pg.move.name,t)};function t(){}}}pV.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var Po;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Po||(Po={}));var Pc;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Pc||(Pc={}));function hV(e){let{acceleration:t,activator:n=Po.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:a=5,order:l=Pc.TreeOrder,pointerCoordinates:c,scrollableAncestors:d,scrollableAncestorRects:u,delta:f,threshold:p}=e;const h=gV({delta:f,disabled:!i}),[v,g]=EH(),_=m.useRef({x:0,y:0}),x=m.useRef({x:0,y:0}),y=m.useMemo(()=>{switch(n){case Po.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Po.DraggableRect:return s}},[n,s,c]),b=m.useRef(null),j=m.useCallback(()=>{const E=b.current;if(!E)return;const S=_.current.x*x.current.x,k=_.current.y*x.current.y;E.scrollBy(S,k)},[]),N=m.useMemo(()=>l===Pc.TreeOrder?[...d].reverse():d,[l,d]);m.useEffect(()=>{if(!i||!d.length||!y){g();return}for(const E of N){if((r==null?void 0:r(E))===!1)continue;const S=d.indexOf(E),k=u[S];if(!k)continue;const{direction:w,speed:R}=tV(E,k,y,t,p);for(const T of["x","y"])h[T][w[T]]||(R[T]=0,w[T]=0);if(R.x>0||R.y>0){g(),b.current=E,v(j,a),_.current=R,x.current=w;return}}_.current={x:0,y:0},x.current={x:0,y:0},g()},[t,j,r,g,i,a,JSON.stringify(y),JSON.stringify(h),v,d,N,u,JSON.stringify(p)])}const mV={x:{[bt.Backward]:!1,[bt.Forward]:!1},y:{[bt.Backward]:!1,[bt.Forward]:!1}};function gV(e){let{delta:t,disabled:n}=e;const r=Qx(t);return Ra(s=>{if(n||!r||!s)return mV;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[bt.Backward]:s.x[bt.Backward]||i.x===-1,[bt.Forward]:s.x[bt.Forward]||i.x===1},y:{[bt.Backward]:s.y[bt.Backward]||i.y===-1,[bt.Forward]:s.y[bt.Forward]||i.y===1}}},[n,t,r])}function xV(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Ra(s=>{var i;return t==null?null:(i=r??s)!=null?i:null},[r,t])}function vV(e,t){return m.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,i=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...i]},[]),[e,t])}var pa;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(pa||(pa={}));var tv;(function(e){e.Optimized="optimized"})(tv||(tv={}));const LS=new Map;function yV(e,t){let{dragging:n,dependencies:r,config:s}=t;const[i,a]=m.useState(null),{frequency:l,measure:c,strategy:d}=s,u=m.useRef(e),f=_(),p=da(f),h=m.useCallback(function(x){x===void 0&&(x=[]),!p.current&&a(y=>y===null?x:y.concat(x.filter(b=>!y.includes(b))))},[p]),v=m.useRef(null),g=Ra(x=>{if(f&&!n)return LS;if(!x||x===LS||u.current!==e||i!=null){const y=new Map;for(let b of e){if(!b)continue;if(i&&i.length>0&&!i.includes(b.id)&&b.rect.current){y.set(b.id,b.rect.current);continue}const j=b.node.current,N=j?new Hy(c(j),j):null;b.rect.current=N,N&&y.set(b.id,N)}return y}return x},[e,i,n,f,c]);return m.useEffect(()=>{u.current=e},[e]),m.useEffect(()=>{f||h()},[n,f]),m.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),m.useEffect(()=>{f||typeof l!="number"||v.current!==null||(v.current=setTimeout(()=>{h(),v.current=null},l))},[l,f,h,...r]),{droppableRects:g,measureDroppableContainers:h,measuringScheduled:i!=null};function _(){switch(d){case pa.Always:return!1;case pa.BeforeDragging:return n;default:return!n}}}function aT(e,t){return Ra(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function bV(e,t){return aT(e,t)}function _V(e){let{callback:t,disabled:n}=e;const r=By(t),s=m.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function Au(e){let{callback:t,disabled:n}=e;const r=By(t),s=m.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return m.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function wV(e){return new Hy(qi(e),e)}function zS(e,t,n){t===void 0&&(t=wV);const[r,s]=m.useState(null);function i(){s(c=>{if(!e)return null;if(e.isConnected===!1){var d;return(d=c??n)!=null?d:null}const u=t(e);return JSON.stringify(c)===JSON.stringify(u)?c:u})}const a=_V({callback(c){if(e)for(const d of c){const{type:u,target:f}=d;if(u==="childList"&&f instanceof HTMLElement&&f.contains(e)){i();break}}}}),l=Au({callback:i});return Kn(()=>{i(),e?(l==null||l.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(l==null||l.disconnect(),a==null||a.disconnect())},[e]),r}function jV(e){const t=aT(e);return J3(e,t)}const FS=[];function SV(e){const t=m.useRef(e),n=Ra(r=>e?r&&r!==FS&&e&&t.current&&e.parentNode===t.current.parentNode?r:Eu(e):FS,[e]);return m.useEffect(()=>{t.current=e},[e]),n}function kV(e){const[t,n]=m.useState(null),r=m.useRef(e),s=m.useCallback(i=>{const a=Ag(i.target);a&&n(l=>l?(l.set(a,Jx(a)),new Map(l)):null)},[]);return m.useEffect(()=>{const i=r.current;if(e!==i){a(i);const l=e.map(c=>{const d=Ag(c);return d?(d.addEventListener("scroll",s,{passive:!0}),[d,Jx(d)]):null}).filter(c=>c!=null);n(l.length?new Map(l):null),r.current=e}return()=>{a(e),a(i)};function a(l){l.forEach(c=>{const d=Ag(c);d==null||d.removeEventListener("scroll",s)})}},[s,e]),m.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,a)=>mi(i,a),Pn):iT(e):Pn,[e,t])}function $S(e,t){t===void 0&&(t=[]);const n=m.useRef(null);return m.useEffect(()=>{n.current=null},t),m.useEffect(()=>{const r=e!==Pn;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?fa(e,n.current):Pn}function NV(e){m.useEffect(()=>{if(!Cu)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function CV(e,t){return m.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:i}=r;return n[s]=a=>{i(a,t)},n},{}),[e,t])}function lT(e){return m.useMemo(()=>e?QH(e):null,[e])}const qS=[];function EV(e,t){t===void 0&&(t=qi);const[n]=e,r=lT(n?Qt(n):null),[s,i]=m.useState(qS);function a(){i(()=>e.length?e.map(c=>rT(c)?r:new Hy(t(c),c)):qS)}const l=Au({callback:a});return Kn(()=>{l==null||l.disconnect(),a(),e.forEach(c=>l==null?void 0:l.observe(c))},[e]),s}function TV(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Ta(t)?t:e}function RV(e){let{measure:t}=e;const[n,r]=m.useState(null),s=m.useCallback(d=>{for(const{target:u}of d)if(Ta(u)){r(f=>{const p=t(u);return f?{...f,width:p.width,height:p.height}:p});break}},[t]),i=Au({callback:s}),a=m.useCallback(d=>{const u=TV(d);i==null||i.disconnect(),u&&(i==null||i.observe(u)),r(u?t(u):null)},[t,i]),[l,c]=Rc(a);return m.useMemo(()=>({nodeRef:l,rect:n,setRef:c}),[n,l,c])}const AV=[{sensor:Ru,options:{}},{sensor:Tu,options:{}}],IV={current:{}},Ol={draggable:{measure:PS},droppable:{measure:PS,strategy:pa.WhileDragging,frequency:tv.Optimized},dragOverlay:{measure:qi}};class Mo extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const PV={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Mo,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ac},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Ol,measureDroppableContainers:Ac,windowRect:null,measuringScheduled:!1},MV={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ac,draggableNodes:new Map,over:null,measureDroppableContainers:Ac},Iu=m.createContext(MV),cT=m.createContext(PV);function OV(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Mo}}}function DV(e,t){switch(t.type){case mt.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case mt.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case mt.DragEnd:case mt.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case mt.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new Mo(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case mt.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const a=new Mo(e.droppable.containers);return a.set(n,{...i,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case mt.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new Mo(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function LV(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=m.useContext(Iu),i=Qx(r),a=Qx(n==null?void 0:n.id);return m.useEffect(()=>{if(!t&&!r&&i&&a!=null){if(!Wy(i)||document.activeElement===i.target)return;const l=s.get(a);if(!l)return;const{activatorNode:c,node:d}=l;if(!c.current&&!d.current)return;requestAnimationFrame(()=>{for(const u of[c.current,d.current]){if(!u)continue;const f=AH(u);if(f){f.focus();break}}})}},[r,t,s,a,i]),null}function zV(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,i)=>i({transform:s,...r}),n):n}function FV(e){return m.useMemo(()=>({draggable:{...Ol.draggable,...e==null?void 0:e.draggable},droppable:{...Ol.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Ol.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function $V(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const i=m.useRef(!1),{x:a,y:l}=typeof s=="boolean"?{x:s,y:s}:s;Kn(()=>{if(!a&&!l||!t){i.current=!1;return}if(i.current||!r)return;const d=t==null?void 0:t.node.current;if(!d||d.isConnected===!1)return;const u=n(d),f=J3(u,r);if(a||(f.x=0),l||(f.y=0),i.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const p=eT(d);p&&p.scrollBy({top:f.y,left:f.x})}},[t,a,l,r,n])}const uT=m.createContext({...Pn,scaleX:1,scaleY:1});var Er;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Er||(Er={}));const dT=m.memo(function(t){var n,r,s,i;let{id:a,accessibility:l,autoScroll:c=!0,children:d,sensors:u=AV,collisionDetection:f=HH,measuring:p,modifiers:h,...v}=t;const g=m.useReducer(DV,void 0,OV),[_,x]=g,[y,b]=LH(),[j,N]=m.useState(Er.Uninitialized),E=j===Er.Initialized,{draggable:{active:S,nodes:k,translate:w},droppable:{containers:R}}=_,T=S!=null?k.get(S):null,I=m.useRef({initial:null,translated:null}),D=m.useMemo(()=>{var re;return S!=null?{id:S,data:(re=T==null?void 0:T.data)!=null?re:IV,rect:I}:null},[S,T]),C=m.useRef(null),[M,P]=m.useState(null),[F,O]=m.useState(null),A=da(v,Object.values(v)),z=Aa("DndDescribedBy",a),$=m.useMemo(()=>R.getEnabled(),[R]),B=FV(p),{droppableRects:U,measureDroppableContainers:G,measuringScheduled:H}=yV($,{dragging:E,dependencies:[w.x,w.y],config:B.droppable}),q=xV(k,S),Q=m.useMemo(()=>F?Zx(F):null,[F]),se=K(),ie=bV(q,B.draggable.measure);$V({activeNode:S!=null?k.get(S):null,config:se.layoutShiftCompensation,initialRect:ie,measure:B.draggable.measure});const Z=zS(q,B.draggable.measure,ie),Se=zS(q?q.parentElement:null),xe=m.useRef({activatorEvent:null,active:null,activeNode:q,collisionRect:null,collisions:null,droppableRects:U,draggableNodes:k,draggingNode:null,draggingNodeRect:null,droppableContainers:R,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),be=R.getNodeFor((n=xe.current.over)==null?void 0:n.id),ve=RV({measure:B.dragOverlay.measure}),ae=(r=ve.nodeRef.current)!=null?r:q,Y=E?(s=ve.rect)!=null?s:Z:null,te=!!(ve.nodeRef.current&&ve.rect),ee=jV(te?null:Z),ke=lT(ae?Qt(ae):null),we=SV(E?be??q:null),Ee=EV(we),Ne=zV(h,{transform:{x:w.x-ee.x,y:w.y-ee.y,scaleX:1,scaleY:1},activatorEvent:F,active:D,activeNodeRect:Z,containerNodeRect:Se,draggingNodeRect:Y,over:xe.current.over,overlayNodeRect:ve.rect,scrollableAncestors:we,scrollableAncestorRects:Ee,windowRect:ke}),ne=Q?mi(Q,w):null,je=kV(we),Ve=$S(je),ct=$S(je,[Z]),Be=mi(Ne,Ve),Ie=Y?GH(Y,Ne):null,oe=D&&Ie?f({active:D,collisionRect:Ie,droppableRects:U,droppableContainers:$,pointerCoordinates:ne}):null,me=Q3(oe,"id"),[fe,V]=m.useState(null),ge=te?Ne:mi(Ne,ct),pe=VH(ge,(i=fe==null?void 0:fe.rect)!=null?i:null,Z),ze=m.useRef(null),We=m.useCallback((re,Fe)=>{let{sensor:pt,options:ln}=Fe;if(C.current==null)return;const Tt=k.get(C.current);if(!Tt)return;const jt=re.nativeEvent,qt=new pt({active:C.current,activeNode:Tt,event:jt,options:ln,context:xe,onAbort(at){if(!k.get(at))return;const{onDragAbort:de}=A.current,Ye={id:at};de==null||de(Ye),y({type:"onDragAbort",event:Ye})},onPending(at,ue,de,Ye){if(!k.get(at))return;const{onDragPending:ns}=A.current,zn={id:at,constraint:ue,initialCoordinates:de,offset:Ye};ns==null||ns(zn),y({type:"onDragPending",event:zn})},onStart(at){const ue=C.current;if(ue==null)return;const de=k.get(ue);if(!de)return;const{onDragStart:Ye}=A.current,wn={activatorEvent:jt,active:{id:ue,data:de.data,rect:I}};ni.unstable_batchedUpdates(()=>{Ye==null||Ye(wn),N(Er.Initializing),x({type:mt.DragStart,initialCoordinates:at,active:ue}),y({type:"onDragStart",event:wn}),P(ze.current),O(jt)})},onMove(at){x({type:mt.DragMove,coordinates:at})},onEnd:Ln(mt.DragEnd),onCancel:Ln(mt.DragCancel)});ze.current=qt;function Ln(at){return async function(){const{active:de,collisions:Ye,over:wn,scrollAdjustedTranslate:ns}=xe.current;let zn=null;if(de&&ns){const{cancelDrop:rs}=A.current;zn={activatorEvent:jt,active:de,collisions:Ye,delta:ns,over:wn},at===mt.DragEnd&&typeof rs=="function"&&await Promise.resolve(rs(zn))&&(at=mt.DragCancel)}C.current=null,ni.unstable_batchedUpdates(()=>{x({type:at}),N(Er.Uninitialized),V(null),P(null),O(null),ze.current=null;const rs=at===mt.DragEnd?"onDragEnd":"onDragCancel";if(zn){const Bi=A.current[rs];Bi==null||Bi(zn),y({type:rs,event:zn})}})}}},[k]),st=m.useCallback((re,Fe)=>(pt,ln)=>{const Tt=pt.nativeEvent,jt=k.get(ln);if(C.current!==null||!jt||Tt.dndKit||Tt.defaultPrevented)return;const qt={active:jt};re(pt,Fe.options,qt)===!0&&(Tt.dndKit={capturedBy:Fe.sensor},C.current=ln,We(pt,Fe))},[k,We]),Ue=vV(u,st);NV(u),Kn(()=>{Z&&j===Er.Initializing&&N(Er.Initialized)},[Z,j]),m.useEffect(()=>{const{onDragMove:re}=A.current,{active:Fe,activatorEvent:pt,collisions:ln,over:Tt}=xe.current;if(!Fe||!pt)return;const jt={active:Fe,activatorEvent:pt,collisions:ln,delta:{x:Be.x,y:Be.y},over:Tt};ni.unstable_batchedUpdates(()=>{re==null||re(jt),y({type:"onDragMove",event:jt})})},[Be.x,Be.y]),m.useEffect(()=>{const{active:re,activatorEvent:Fe,collisions:pt,droppableContainers:ln,scrollAdjustedTranslate:Tt}=xe.current;if(!re||C.current==null||!Fe||!Tt)return;const{onDragOver:jt}=A.current,qt=ln.get(me),Ln=qt&&qt.rect.current?{id:qt.id,rect:qt.rect.current,data:qt.data,disabled:qt.disabled}:null,at={active:re,activatorEvent:Fe,collisions:pt,delta:{x:Tt.x,y:Tt.y},over:Ln};ni.unstable_batchedUpdates(()=>{V(Ln),jt==null||jt(at),y({type:"onDragOver",event:at})})},[me]),Kn(()=>{xe.current={activatorEvent:F,active:D,activeNode:q,collisionRect:Ie,collisions:oe,droppableRects:U,draggableNodes:k,draggingNode:ae,draggingNodeRect:Y,droppableContainers:R,over:fe,scrollableAncestors:we,scrollAdjustedTranslate:Be},I.current={initial:Y,translated:Ie}},[D,q,oe,Ie,k,ae,Y,U,R,fe,we,Be]),hV({...se,delta:w,draggingRect:Ie,pointerCoordinates:ne,scrollableAncestors:we,scrollableAncestorRects:Ee});const L=m.useMemo(()=>({active:D,activeNode:q,activeNodeRect:Z,activatorEvent:F,collisions:oe,containerNodeRect:Se,dragOverlay:ve,draggableNodes:k,droppableContainers:R,droppableRects:U,over:fe,measureDroppableContainers:G,scrollableAncestors:we,scrollableAncestorRects:Ee,measuringConfiguration:B,measuringScheduled:H,windowRect:ke}),[D,q,Z,F,oe,Se,ve,k,R,U,fe,G,we,Ee,B,H,ke]),W=m.useMemo(()=>({activatorEvent:F,activators:Ue,active:D,activeNodeRect:Z,ariaDescribedById:{draggable:z},dispatch:x,draggableNodes:k,over:fe,measureDroppableContainers:G}),[F,Ue,D,Z,x,z,k,fe,G]);return X.createElement(G3.Provider,{value:b},X.createElement(Iu.Provider,{value:W},X.createElement(cT.Provider,{value:L},X.createElement(uT.Provider,{value:pe},d)),X.createElement(LV,{disabled:(l==null?void 0:l.restoreFocus)===!1})),X.createElement($H,{...l,hiddenTextDescribedById:z}));function K(){const re=(M==null?void 0:M.autoScrollEnabled)===!1,Fe=typeof c=="object"?c.enabled===!1:c===!1,pt=E&&!re&&!Fe;return typeof c=="object"?{...c,enabled:pt}:{enabled:pt}}}),qV=m.createContext(null),BS="button",BV="Draggable";function WV(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const i=Aa(BV),{activators:a,activatorEvent:l,active:c,activeNodeRect:d,ariaDescribedById:u,draggableNodes:f,over:p}=m.useContext(Iu),{role:h=BS,roleDescription:v="draggable",tabIndex:g=0}=s??{},_=(c==null?void 0:c.id)===t,x=m.useContext(_?uT:qV),[y,b]=Rc(),[j,N]=Rc(),E=CV(a,t),S=da(n);Kn(()=>(f.set(t,{id:t,key:i,node:y,activatorNode:j,data:S}),()=>{const w=f.get(t);w&&w.key===i&&f.delete(t)}),[f,t]);const k=m.useMemo(()=>({role:h,tabIndex:g,"aria-disabled":r,"aria-pressed":_&&h===BS?!0:void 0,"aria-roledescription":v,"aria-describedby":u.draggable}),[r,h,g,_,v,u.draggable]);return{active:c,activatorEvent:l,activeNodeRect:d,attributes:k,isDragging:_,listeners:r?void 0:E,node:y,over:p,setNodeRef:b,setActivatorNodeRef:N,transform:x}}function HV(){return m.useContext(cT)}const VV="Droppable",UV={timeout:25};function GV(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const i=Aa(VV),{active:a,dispatch:l,over:c,measureDroppableContainers:d}=m.useContext(Iu),u=m.useRef({disabled:n}),f=m.useRef(!1),p=m.useRef(null),h=m.useRef(null),{disabled:v,updateMeasurementsFor:g,timeout:_}={...UV,...s},x=da(g??r),y=m.useCallback(()=>{if(!f.current){f.current=!0;return}h.current!=null&&clearTimeout(h.current),h.current=setTimeout(()=>{d(Array.isArray(x.current)?x.current:[x.current]),h.current=null},_)},[_]),b=Au({callback:y,disabled:v||!a}),j=m.useCallback((k,w)=>{b&&(w&&(b.unobserve(w),f.current=!1),k&&b.observe(k))},[b]),[N,E]=Rc(j),S=da(t);return m.useEffect(()=>{!b||!N.current||(b.disconnect(),f.current=!1,b.observe(N.current))},[N,b]),m.useEffect(()=>(l({type:mt.RegisterDroppable,element:{id:r,key:i,disabled:n,node:N,rect:p,data:S}}),()=>l({type:mt.UnregisterDroppable,key:i,id:r})),[r]),m.useEffect(()=>{n!==u.current.disabled&&(l({type:mt.SetDroppableDisabled,id:r,key:i,disabled:n}),u.current.disabled=n)},[r,i,n,l]),{active:a,rect:p,isOver:(c==null?void 0:c.id)===r,node:N,over:c,setNodeRef:E}}function Pu(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function KV(e,t){return e.reduce((n,r,s)=>{const i=t.get(r);return i&&(n[s]=i),n},Array(e.length))}function xl(e){return e!==null&&e>=0}function YV(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function XV(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const fT=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const i=Pu(t,r,n),a=t[s],l=i[s];return!l||!a?null:{x:l.left-a.left,y:l.top-a.top,scaleX:l.width/a.width,scaleY:l.height/a.height}},vl={scaleX:1,scaleY:1},pT=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:i,overIndex:a}=e;const l=(t=i[n])!=null?t:r;if(!l)return null;if(s===n){const d=i[a];return d?{x:0,y:n<a?d.top+d.height-(l.top+l.height):d.top-l.top,...vl}:null}const c=QV(i,s,n);return s>n&&s<=a?{x:0,y:-l.height-c,...vl}:s<n&&s>=a?{x:0,y:l.height+c,...vl}:{x:0,y:0,...vl}};function QV(e,t,n){const r=e[t],s=e[t-1],i=e[t+1];return r?n<t?s?r.top-(s.top+s.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const hT="Sortable",mT=X.createContext({activeIndex:-1,containerId:hT,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:fT,disabled:{draggable:!1,droppable:!1}});function gT(e){let{children:t,id:n,items:r,strategy:s=fT,disabled:i=!1}=e;const{active:a,dragOverlay:l,droppableRects:c,over:d,measureDroppableContainers:u}=HV(),f=Aa(hT,n),p=l.rect!==null,h=m.useMemo(()=>r.map(E=>typeof E=="object"&&"id"in E?E.id:E),[r]),v=a!=null,g=a?h.indexOf(a.id):-1,_=d?h.indexOf(d.id):-1,x=m.useRef(h),y=!YV(h,x.current),b=_!==-1&&g===-1||y,j=XV(i);Kn(()=>{y&&v&&u(h)},[y,h,v,u]),m.useEffect(()=>{x.current=h},[h]);const N=m.useMemo(()=>({activeIndex:g,containerId:f,disabled:j,disableTransforms:b,items:h,overIndex:_,useDragOverlay:p,sortedRects:KV(h,c),strategy:s}),[g,f,j.draggable,j.droppable,b,h,_,c,p,s]);return X.createElement(mT.Provider,{value:N},t)}const ZV=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return Pu(n,r,s).indexOf(t)},JV=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:i,newIndex:a,previousItems:l,previousContainerId:c,transition:d}=e;return!d||!r||l!==i&&s===a?!1:n?!0:a!==s&&t===c},eU={duration:200,easing:"ease"},xT="transform",tU=Ei.Transition.toString({property:xT,duration:0,easing:"linear"}),nU={roleDescription:"sortable"};function rU(e){let{disabled:t,index:n,node:r,rect:s}=e;const[i,a]=m.useState(null),l=m.useRef(n);return Kn(()=>{if(!t&&n!==l.current&&r.current){const c=s.current;if(c){const d=qi(r.current,{ignoreTransform:!0}),u={x:c.left-d.left,y:c.top-d.top,scaleX:c.width/d.width,scaleY:c.height/d.height};(u.x||u.y)&&a(u)}}n!==l.current&&(l.current=n)},[t,n,r,s]),m.useEffect(()=>{i&&a(null)},[i]),i}function vT(e){let{animateLayoutChanges:t=JV,attributes:n,disabled:r,data:s,getNewIndex:i=ZV,id:a,strategy:l,resizeObserverConfig:c,transition:d=eU}=e;const{items:u,containerId:f,activeIndex:p,disabled:h,disableTransforms:v,sortedRects:g,overIndex:_,useDragOverlay:x,strategy:y}=m.useContext(mT),b=sU(r,h),j=u.indexOf(a),N=m.useMemo(()=>({sortable:{containerId:f,index:j,items:u},...s}),[f,s,j,u]),E=m.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:S,node:k,isOver:w,setNodeRef:R}=GV({id:a,data:N,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...c}}),{active:T,activatorEvent:I,activeNodeRect:D,attributes:C,setNodeRef:M,listeners:P,isDragging:F,over:O,setActivatorNodeRef:A,transform:z}=WV({id:a,data:N,attributes:{...nU,...n},disabled:b.draggable}),$=CH(R,M),B=!!T,U=B&&!v&&xl(p)&&xl(_),G=!x&&F,H=G&&U?z:null,Q=U?H??(l??y)({rects:g,activeNodeRect:D,activeIndex:p,overIndex:_,index:j}):null,se=xl(p)&&xl(_)?i({id:a,items:u,activeIndex:p,overIndex:_}):j,ie=T==null?void 0:T.id,Z=m.useRef({activeId:ie,items:u,newIndex:se,containerId:f}),Se=u!==Z.current.items,xe=t({active:T,containerId:f,isDragging:F,isSorting:B,id:a,index:j,items:u,newIndex:Z.current.newIndex,previousItems:Z.current.items,previousContainerId:Z.current.containerId,transition:d,wasDragging:Z.current.activeId!=null}),be=rU({disabled:!xe,index:j,node:k,rect:S});return m.useEffect(()=>{B&&Z.current.newIndex!==se&&(Z.current.newIndex=se),f!==Z.current.containerId&&(Z.current.containerId=f),u!==Z.current.items&&(Z.current.items=u)},[B,se,f,u]),m.useEffect(()=>{if(ie===Z.current.activeId)return;if(ie!=null&&Z.current.activeId==null){Z.current.activeId=ie;return}const ae=setTimeout(()=>{Z.current.activeId=ie},50);return()=>clearTimeout(ae)},[ie]),{active:T,activeIndex:p,attributes:C,data:N,rect:S,index:j,newIndex:se,items:u,isOver:w,isSorting:B,isDragging:F,listeners:P,node:k,overIndex:_,over:O,setNodeRef:$,setActivatorNodeRef:A,setDroppableNodeRef:R,setDraggableNodeRef:M,transform:be??Q,transition:ve()};function ve(){if(be||Se&&Z.current.newIndex===j)return tU;if(!(G&&!Wy(I)||!d)&&(B||xe))return Ei.Transition.toString({...d,property:xT})}}function sU(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function Mc(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const iU=[Me.Down,Me.Right,Me.Up,Me.Left],yT=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:s,droppableContainers:i,over:a,scrollableAncestors:l}}=t;if(iU.includes(e.code)){if(e.preventDefault(),!n||!r)return;const c=[];i.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const p=s.get(f.id);if(p)switch(e.code){case Me.Down:r.top<p.top&&c.push(f);break;case Me.Up:r.top>p.top&&c.push(f);break;case Me.Left:r.left>p.left&&c.push(f);break;case Me.Right:r.left<p.left&&c.push(f);break}});const d=BH({collisionRect:r,droppableRects:s,droppableContainers:c});let u=Q3(d,"id");if(u===(a==null?void 0:a.id)&&d.length>1&&(u=d[1].id),u!=null){const f=i.get(n.id),p=i.get(u),h=p?s.get(p.id):null,v=p==null?void 0:p.node.current;if(v&&h&&f&&p){const _=Eu(v).some((E,S)=>l[S]!==E),x=bT(f,p),y=oU(f,p),b=_||!x?{x:0,y:0}:{x:y?r.width-h.width:0,y:y?r.height-h.height:0},j={x:h.left,y:h.top};return b.x&&b.y?j:fa(j,b)}}}};function bT(e,t){return!Mc(e)||!Mc(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function oU(e,t){return!Mc(e)||!Mc(t)||!bT(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const aU={padding:"6px 14px",fontSize:12,fontWeight:600,border:"none",cursor:"pointer",transition:"opacity 0.15s",background:"transparent"},$n={width:"100%",padding:"5px 8px",borderRadius:4,fontSize:12,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none"},cn={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},_T={step_id:"new_step",produces:"",scope:"",inputs:[]},lU={step_id:"new_iteration",iterate_over:{doc_type:"",collection_field:"",entity_type:""},scope:"",steps:[]};function cU({workspaceId:e,workflow:t,documentTypes:n=[],onArtifactSave:r,onDelete:s,onNavigateToWorkflow:i}){const[a,l]=m.useState("steps"),[c,d]=m.useState(""),[u,f]=m.useState(null),p=m.useMemo(()=>t?`workflow:${t.workflow_id}:${t.active_version}:definition`:null,[t]),{workflowJson:h,loading:v,error:g,saving:_,updateWorkflow:x}=H3(e,p,{onSave:w=>{r==null||r(p,w)}}),y=m.useCallback(w=>{w==="json"&&h&&(d(JSON.stringify(h,null,2)),f(null)),l(w)},[h]),b=m.useCallback(w=>{const R=w.target.value;d(R);try{const T=JSON.parse(R);f(null),x(T)}catch(T){f(T.message)}},[x]),j=m.useCallback((w,R)=>{if(!h)return;const T=[...h.steps];T[w]=R,x({...h,steps:T})},[h,x]),N=m.useCallback(w=>{if(!h)return;const R=h.steps.filter((T,I)=>I!==w);x({...h,steps:R})},[h,x]),E=m.useCallback(w=>{var T,I;if(!h)return;const R=w==="iteration"?{...lU,step_id:`new_iteration_${(((T=h.steps)==null?void 0:T.length)||0)+1}`}:{..._T,step_id:`new_step_${(((I=h.steps)==null?void 0:I.length)||0)+1}`};x({...h,steps:[...h.steps||[],R]})},[h,x]),S=m.useCallback((w,R)=>{if(!h)return;const T=Pu(h.steps,w,R);x({...h,steps:T})},[h,x]),k=m.useCallback(()=>{!s||!t||window.confirm(`Delete workflow "${t.workflow_id}"? This cannot be undone until you discard workspace changes.`)&&s(t.workflow_id)},[s,t]);return t?o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",style:{background:"var(--bg-canvas)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:(h==null?void 0:h.name)||t.workflow_id.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase())}),((h==null?void 0:h.pow_class)||t.pow_class)&&o.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-semibold uppercase",style:{fontSize:9,letterSpacing:"0.05em",background:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:((h==null?void 0:h.pow_class)||t.pow_class)==="reference"?"#000":"var(--text-primary)"},children:(h==null?void 0:h.pow_class)||t.pow_class})]}),o.jsxs("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:["v",t.active_version,(h==null?void 0:h.description)&&`  ${h.description}`]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[_&&o.jsx("span",{className:"text-xs",style:{color:"var(--action-primary)"},children:"Saving..."}),g&&o.jsx("span",{className:"text-xs",style:{color:"#ef4444"},children:g}),s&&o.jsx("button",{onClick:k,className:"p-1 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444"},title:"Delete workflow",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]})}),o.jsx("div",{className:"flex items-center border-b px-2",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[{id:"steps",label:"Steps"},{id:"json",label:"JSON"},{id:"metadata",label:"Metadata"}].map(w=>o.jsx("button",{onClick:()=>y(w.id),style:{...aU,color:a===w.id?"var(--text-primary)":"var(--text-muted)",borderBottom:a===w.id?"2px solid var(--action-primary)":"2px solid transparent"},children:w.label},w.id))}),v?o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading workflow..."})}):o.jsxs("div",{className:"flex-1 overflow-hidden",children:[a==="steps"&&o.jsxs("div",{className:"h-full overflow-y-auto p-4",children:[o.jsx(uU,{steps:(h==null?void 0:h.steps)||[],documentTypes:n,onStepChange:j,onStepDelete:N,onReorder:S}),o.jsxs("div",{className:"flex gap-2 mt-3",children:[o.jsx("button",{onClick:()=>E("production"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600},children:"+ Production Step"}),o.jsx("button",{onClick:()=>E("iteration"),className:"text-xs px-3 py-1.5 rounded hover:opacity-80",style:{background:"transparent",color:"var(--action-primary)",border:"1px solid var(--action-primary)",fontWeight:600},children:"+ Iteration Step"})]})]}),a==="json"&&o.jsxs("div",{className:"h-full flex flex-col p-4",children:[o.jsx("textarea",{value:c,onChange:b,className:"flex-1 font-mono text-xs p-3 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:u?"1px solid #ef4444":"1px solid var(--border-panel)",color:"var(--text-primary)",resize:"none",outline:"none"},spellCheck:!1}),u&&o.jsxs("div",{className:"mt-2 text-xs",style:{color:"#ef4444"},children:["JSON Error: ",u]})]}),a==="metadata"&&o.jsx("div",{className:"h-full overflow-y-auto p-4",children:h?o.jsx(hU,{workflow:h,onUpdateWorkflow:x,onNavigateToWorkflow:i}):o.jsx("div",{style:{color:"var(--text-muted)"},children:"No workflow loaded"})})]})]}):o.jsx("div",{className:"flex-1 flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",style:{color:"var(--text-muted)"},children:[o.jsx("div",{className:"text-lg mb-1",children:"Workflow Editor"}),o.jsx("div",{className:"text-sm",children:"Select a workflow from the sidebar to begin editing"})]})})}function uU({steps:e,documentTypes:t=[],onStepChange:n,onStepDelete:r,onReorder:s}){const i=K3(Ic(Ru,{activationConstraint:{distance:5}}),Ic(Tu,{coordinateGetter:yT})),a=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&s(f,p)},[e,s]);return e.length===0?o.jsx("div",{className:"text-sm py-4",style:{color:"var(--text-muted)"},children:"No steps defined. Add a step to get started."}):o.jsx(dT,{sensors:i,collisionDetection:Z3,onDragEnd:l,children:o.jsx(gT,{items:a,strategy:pT,children:e.map((c,d)=>o.jsx(dU,{step:c,index:d,documentTypes:t,onChange:n,onDelete:r},c.step_id))})})}function dU({step:e,index:t,documentTypes:n=[],onChange:r,onDelete:s}){const{attributes:i,listeners:a,setNodeRef:l,transform:c,transition:d,isDragging:u}=vT({id:e.step_id}),f={transform:Ei.Transform.toString(c),transition:d,opacity:u?.5:1};return o.jsx("div",{ref:l,style:f,children:o.jsx(wT,{step:e,index:t,documentTypes:n,onChange:r,onDelete:s,dragHandleProps:{...i,...a}})})}function wT({step:e,index:t,documentTypes:n=[],onChange:r,onDelete:s,dragHandleProps:i,depth:a=0}){var E,S,k;const[l,c]=m.useState(e),[d,u]=m.useState(!0);m.useEffect(()=>{c(e)},[e]);const f=!!l.iterate_over,p=(w,R)=>{const T={...l,[w]:R};c(T),r(t,T)},h=(w,R)=>{const T={...l.iterate_over,[w]:R},I={...l,iterate_over:T};c(I),r(t,I)},v=()=>{const w=[...l.inputs||[],{doc_type:"",scope:""}],R={...l,inputs:w};c(R),r(t,R)},g=(w,R,T)=>{const I=[...l.inputs||[]];I[w]={...I[w],[R]:T};const D={...l,inputs:I};c(D),r(t,D)},_=w=>{const R=(l.inputs||[]).filter((I,D)=>D!==w),T={...l,inputs:R};c(T),r(t,T)},x=m.useCallback((w,R)=>{const T=[...l.steps||[]];T[w]=R;const I={...l,steps:T};c(I),r(t,I)},[l,t,r]),y=m.useCallback(w=>{const R=(l.steps||[]).filter((I,D)=>D!==w),T={...l,steps:R};c(T),r(t,T)},[l,t,r]),b=m.useCallback(()=>{var T;const w=[...l.steps||[],{..._T,step_id:`nested_step_${(((T=l.steps)==null?void 0:T.length)||0)+1}`}],R={...l,steps:w};c(R),r(t,R)},[l,t,r]),j=m.useCallback((w,R)=>{const T=Pu(l.steps||[],w,R),I={...l,steps:T};c(I),r(t,I)},[l,t,r]),N={background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",borderRadius:6,marginBottom:8,marginLeft:a*20,borderLeft:f?"3px solid var(--action-primary)":"3px solid var(--border-panel)"};return o.jsxs("div",{style:N,children:[o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",style:{borderBottom:d?"1px solid var(--border-panel)":"none",background:"var(--bg-panel)",borderRadius:d?"6px 6px 0 0":6},children:[i&&o.jsx("span",{...i,style:{cursor:"grab",color:"var(--text-muted)",lineHeight:1},title:"Drag to reorder",children:o.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor",children:[o.jsx("circle",{cx:"5",cy:"3",r:"1.5"}),o.jsx("circle",{cx:"11",cy:"3",r:"1.5"}),o.jsx("circle",{cx:"5",cy:"8",r:"1.5"}),o.jsx("circle",{cx:"11",cy:"8",r:"1.5"}),o.jsx("circle",{cx:"5",cy:"13",r:"1.5"}),o.jsx("circle",{cx:"11",cy:"13",r:"1.5"})]})}),o.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded",style:{background:f?"var(--action-primary)":"var(--bg-canvas)",color:f?"#000":"var(--action-primary)",border:"1px solid var(--border-panel)",fontSize:10,fontWeight:700},children:f?"ITER":"STEP"}),o.jsx("span",{className:"text-xs font-mono",style:{color:"var(--text-primary)",fontWeight:600},children:l.step_id}),o.jsx("span",{style:{flex:1}}),o.jsx("button",{onClick:()=>u(!d),className:"p-0.5 rounded hover:opacity-80",style:{color:"var(--text-muted)",background:"transparent",border:"none",cursor:"pointer"},title:d?"Collapse":"Expand",children:o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:d?o.jsx("path",{d:"M18 15l-6-6-6 6"}):o.jsx("path",{d:"M6 9l6 6 6-6"})})}),o.jsx("button",{onClick:()=>s(t),className:"p-0.5 rounded hover:bg-red-500/20 transition-colors",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer"},title:"Delete step",children:o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),d&&o.jsxs("div",{className:"p-3 space-y-2",children:[o.jsxs("div",{children:[o.jsx("label",{style:cn,children:"Step ID"}),o.jsx("input",{type:"text",value:l.step_id||"",onChange:w=>p("step_id",w.target.value),style:$n})]}),f?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{style:cn,children:"Doc Type"}),o.jsxs("select",{value:((E=l.iterate_over)==null?void 0:E.doc_type)||"",onChange:w=>h("doc_type",w.target.value),style:$n,children:[o.jsx("option",{value:"",children:"-- Select --"}),n.map(w=>o.jsx("option",{value:w.doc_type_id,children:w.doc_type_id},w.doc_type_id))]})]}),o.jsxs("div",{children:[o.jsx("label",{style:cn,children:"Collection Field"}),o.jsx("input",{type:"text",value:((S=l.iterate_over)==null?void 0:S.collection_field)||"",onChange:w=>h("collection_field",w.target.value),style:$n})]}),o.jsxs("div",{children:[o.jsx("label",{style:cn,children:"Entity Type"}),o.jsx("input",{type:"text",value:((k=l.iterate_over)==null?void 0:k.entity_type)||"",onChange:w=>h("entity_type",w.target.value),style:$n})]})]}),o.jsxs("div",{children:[o.jsx("label",{style:cn,children:"Scope"}),o.jsx("input",{type:"text",value:l.scope||"",onChange:w=>p("scope",w.target.value),style:$n})]}),o.jsxs("div",{className:"mt-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("label",{style:cn,children:"Nested Steps"}),o.jsx("button",{onClick:b,className:"text-xs px-2 py-0.5 rounded hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),o.jsx(fU,{steps:l.steps||[],documentTypes:n,onStepChange:x,onStepDelete:y,onReorder:j})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{style:cn,children:"Produces"}),o.jsxs("select",{value:l.produces||"",onChange:w=>p("produces",w.target.value),style:$n,children:[o.jsx("option",{value:"",children:"-- Select document type --"}),n.map(w=>o.jsx("option",{value:w.doc_type_id,children:w.doc_type_id},w.doc_type_id))]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{style:cn,children:"Scope"}),o.jsx("input",{type:"text",value:l.scope||"",onChange:w=>p("scope",w.target.value),placeholder:"project",style:$n})]}),o.jsxs("div",{children:[o.jsx("label",{style:cn,children:"Creates Entities"}),o.jsx("input",{type:"text",value:l.creates_entities||"",onChange:w=>p("creates_entities",w.target.value||void 0),placeholder:"e.g., epic",style:$n})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("label",{style:cn,children:"Inputs"}),o.jsx("button",{onClick:v,className:"text-xs hover:opacity-80",style:{color:"var(--action-primary)",background:"transparent",border:"none",cursor:"pointer",fontWeight:600},children:"+ Add"})]}),(l.inputs||[]).length===0?o.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No inputs"}):o.jsx("div",{className:"space-y-1",children:(l.inputs||[]).map((w,R)=>o.jsxs("div",{className:"flex gap-1 items-end",children:[o.jsxs("div",{style:{flex:1},children:[R===0&&o.jsx("label",{style:{...cn,fontSize:9},children:"Doc/Entity Type"}),o.jsxs("select",{value:w.doc_type||w.entity_type||"",onChange:T=>{const I=T.target.value;w.entity_type!==void 0?g(R,"entity_type",I):g(R,"doc_type",I)},style:{...$n,fontSize:11},children:[o.jsx("option",{value:"",children:"-- Select --"}),n.map(T=>o.jsx("option",{value:T.doc_type_id,children:T.doc_type_id},T.doc_type_id))]})]}),o.jsxs("div",{style:{width:"30%"},children:[R===0&&o.jsx("label",{style:{...cn,fontSize:9},children:"Scope"}),o.jsx("input",{type:"text",value:w.scope||"",onChange:T=>g(R,"scope",T.target.value),placeholder:"scope",style:{...$n,fontSize:11}})]}),o.jsxs("label",{className:"flex items-center gap-1 text-xs pb-0.5",style:{color:"var(--text-muted)",whiteSpace:"nowrap"},children:[o.jsx("input",{type:"checkbox",checked:w.context||!1,onChange:T=>g(R,"context",T.target.checked||void 0)}),"ctx"]}),o.jsx("button",{onClick:()=>_(R),className:"pb-0.5",style:{color:"#ef4444",background:"transparent",border:"none",cursor:"pointer",fontSize:12,fontWeight:700},children:"x"})]},R))})]})]})]})]})}function fU({steps:e,documentTypes:t=[],onStepChange:n,onStepDelete:r,onReorder:s}){const i=K3(Ic(Ru,{activationConstraint:{distance:5}}),Ic(Tu,{coordinateGetter:yT})),a=m.useMemo(()=>e.map(c=>c.step_id),[e]),l=m.useCallback(c=>{const{active:d,over:u}=c;if(!u||d.id===u.id)return;const f=e.findIndex(h=>h.step_id===d.id),p=e.findIndex(h=>h.step_id===u.id);f!==-1&&p!==-1&&s(f,p)},[e,s]);return e.length===0?o.jsx("div",{className:"text-xs py-1",style:{color:"var(--text-muted)"},children:"No nested steps"}):o.jsx(dT,{sensors:i,collisionDetection:Z3,onDragEnd:l,children:o.jsx(gT,{items:a,strategy:pT,children:e.map((c,d)=>o.jsx(pU,{step:c,index:d,documentTypes:t,onChange:n,onDelete:r},c.step_id))})})}function pU({step:e,index:t,documentTypes:n=[],onChange:r,onDelete:s}){const{attributes:i,listeners:a,setNodeRef:l,transform:c,transition:d,isDragging:u}=vT({id:e.step_id}),f={transform:Ei.Transform.toString(c),transition:d,opacity:u?.5:1};return o.jsx("div",{ref:l,style:f,children:o.jsx(wT,{step:e,index:t,documentTypes:n,onChange:r,onDelete:s,dragHandleProps:{...i,...a},depth:1})})}function hU({workflow:e,onUpdateWorkflow:t,onNavigateToWorkflow:n}){const[r,s]=m.useState(""),i={fontSize:12,color:"var(--text-primary)",padding:"6px 8px",borderRadius:4,background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",width:"100%"},a={display:"block",fontSize:10,fontWeight:600,color:"var(--text-muted)",marginBottom:2,textTransform:"uppercase",letterSpacing:"0.05em"},l=[{key:"workflow_id",label:"Workflow ID"},{key:"name",label:"Name"},{key:"schema_version",label:"Schema Version"},{key:"revision",label:"Revision"},{key:"effective_date",label:"Effective Date"},{key:"description",label:"Description"}],c=e.scopes||{},d=Object.entries(c),u=e.document_types||{},f=Object.entries(u),p=e.pow_class||"reference",h=e.derived_from,v=e.source_version,g=e.tags||[],_=()=>{const b=r.trim().toLowerCase().replace(/\s+/g,"_");!b||g.includes(b)||(t==null||t({...e,tags:[...g,b]}),s(""))},x=b=>{t==null||t({...e,tags:g.filter(j=>j!==b)})},y=()=>{h!=null&&h.workflow_id&&n&&n(h.workflow_id)};return o.jsxs("div",{className:"space-y-4 max-w-lg",children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Classification"}),o.jsxs("div",{children:[o.jsx("label",{style:a,children:"POW Class"}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx("span",{className:"text-xs px-2 py-1 rounded font-semibold uppercase",style:{fontSize:10,letterSpacing:"0.05em",background:p==="reference"?"var(--action-primary)":"var(--bg-selected, #334155)",color:p==="reference"?"#000":"var(--text-primary)"},children:p})})]}),h&&o.jsxs("div",{children:[o.jsx("label",{style:a,children:"Derived From"}),o.jsx("div",{style:i,children:n?o.jsxs("button",{onClick:y,className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--action-primary)",textDecoration:"underline",fontSize:12},children:[h.workflow_id," v",h.version]}):o.jsxs("span",{children:[h.workflow_id," v",h.version]})})]}),v&&o.jsxs("div",{children:[o.jsx("label",{style:a,children:"Source Version"}),o.jsx("div",{style:i,children:v})]}),o.jsxs("div",{children:[o.jsx("label",{style:a,children:"Tags"}),o.jsxs("div",{className:"flex flex-wrap gap-1 mb-1.5",children:[g.length===0&&o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No tags"}),g.map(b=>o.jsxs("span",{className:"inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded",style:{background:"var(--bg-selected, #334155)",color:"var(--text-primary)",fontSize:11},children:[b,t&&o.jsx("button",{onClick:()=>x(b),className:"hover:opacity-80",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"var(--text-muted)",fontSize:11,lineHeight:1},title:`Remove tag "${b}"`,children:"x"})]},b))]}),t&&o.jsxs("div",{className:"flex gap-1",children:[o.jsx("input",{type:"text",value:r,onChange:b=>s(b.target.value),onKeyDown:b=>{b.key==="Enter"&&(b.preventDefault(),_())},placeholder:"Add tag...",className:"text-xs px-2 py-1 rounded",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",outline:"none",flex:1}}),o.jsx("button",{onClick:_,disabled:!r.trim(),className:"text-xs px-2 py-1 rounded hover:opacity-80",style:{background:"var(--action-primary)",color:"#000",fontWeight:600,border:"none",cursor:r.trim()?"pointer":"default",opacity:r.trim()?1:.5},children:"Add"})]})]}),o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Workflow Metadata"}),l.map(b=>o.jsxs("div",{children:[o.jsx("label",{style:a,children:b.label}),o.jsx("div",{style:i,children:e[b.key]||"-"})]},b.key)),d.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Scopes"}),d.map(([b,j])=>o.jsxs("div",{children:[o.jsx("label",{style:a,children:b}),o.jsxs("div",{style:i,children:["parent: ",j.parent||"none"]})]},b))]}),f.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide pt-2",style:{color:"var(--text-muted)"},children:"Document Types"}),f.map(([b,j])=>o.jsxs("div",{children:[o.jsx("label",{style:a,children:b}),o.jsxs("div",{style:i,children:[j.name,j.scope&&` (${j.scope})`,j.acceptance_required&&" [acceptance required]"]})]},b))]})]})}function WS({results:e,compact:t=!1}){if(!e||e.length===0)return null;const n=e.filter(s=>s.status==="fail"),r=e.filter(s=>s.status==="pass");return t?o.jsx("div",{className:"flex items-center gap-2",children:n.length>0?o.jsxs("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-error-bg)",color:"var(--state-error-text)"},children:[n.length," error",n.length!==1?"s":""]}):o.jsx("span",{className:"text-xs px-2 py-0.5 rounded",style:{background:"var(--state-success-bg)",color:"var(--state-success-text)"},children:"Valid"})}):o.jsxs("div",{className:"space-y-2",children:[n.map((s,i)=>o.jsxs("div",{className:"text-xs p-2 rounded border",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"var(--state-error-bg)",color:"var(--text-primary)"},children:[o.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[o.jsx("span",{className:"text-red-400",children:"FAIL"}),o.jsx("span",{className:"font-mono",children:s.rule_id})]}),s.message&&o.jsx("div",{className:"mt-1 opacity-80",children:s.message}),s.artifact_id&&o.jsx("div",{className:"mt-1 font-mono text-xs opacity-60",children:s.artifact_id})]},i)),r.length>0&&n.length>0&&o.jsxs("div",{className:"text-xs p-2 rounded",style:{background:"rgba(34, 197, 94, 0.1)",color:"var(--text-muted)"},children:[r.length," rule",r.length!==1?"s":""," passed"]})]})}function mU(e,t){const n=(e||"").split(`
`),r=(t||"").split(`
`),s=[];let i=0,a=0;for(;i<n.length||a<r.length;)if(i>=n.length)s.push({type:"added",line:r[a],lineNum:a+1}),a++;else if(a>=r.length)s.push({type:"removed",line:n[i],lineNum:i+1}),i++;else if(n[i]===r[a])s.push({type:"same",line:n[i],oldLineNum:i+1,newLineNum:a+1}),i++,a++;else{let l=r.slice(a,a+5).indexOf(n[i]),c=n.slice(i,i+5).indexOf(r[a]);if(l!==-1&&(c===-1||l<=c)){for(let d=0;d<l;d++)s.push({type:"added",line:r[a+d],lineNum:a+d+1});a+=l}else if(c!==-1){for(let d=0;d<c;d++)s.push({type:"removed",line:n[i+d],lineNum:i+d+1});i+=c}else s.push({type:"removed",line:n[i],lineNum:i+1}),s.push({type:"added",line:r[a],lineNum:a+1}),i++,a++}return s}function gU({diff:e}){const[t,n]=m.useState(!0),r=mU(e.old_content,e.new_content),s={M:{bg:"rgba(245, 158, 11, 0.2)",color:"#f59e0b"},A:{bg:"rgba(34, 197, 94, 0.2)",color:"#22c55e"},D:{bg:"rgba(239, 68, 68, 0.2)",color:"#ef4444"}};return o.jsxs("div",{className:"border rounded mb-3",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between px-3 py-2 cursor-pointer",style:{background:"var(--bg-panel)"},onClick:()=>n(!t),children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:s[e.status]||s.M,children:e.status}),o.jsx("span",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},children:e.file_path})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("span",{className:"text-xs",style:{color:"var(--action-success)"},children:["+",e.additions]}),o.jsxs("span",{className:"text-xs",style:{color:"var(--state-error-text)"},children:["-",e.deletions]}),o.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:t?"":"+"})]})]}),t&&o.jsx("div",{className:"overflow-x-auto",style:{background:"var(--bg-canvas)"},children:o.jsx("pre",{className:"text-xs font-mono m-0 p-0",children:r.map((i,a)=>o.jsxs("div",{className:"flex",style:{background:i.type==="added"?"rgba(34, 197, 94, 0.1)":i.type==="removed"?"rgba(239, 68, 68, 0.1)":"transparent",borderLeft:i.type==="added"?"3px solid #22c55e":i.type==="removed"?"3px solid #ef4444":"3px solid transparent"},children:[o.jsx("span",{className:"select-none px-2 text-right",style:{color:"var(--text-muted)",minWidth:"40px",background:"rgba(0,0,0,0.1)"},children:i.type==="same"?i.oldLineNum:i.lineNum||""}),o.jsx("span",{className:"select-none px-1",style:{color:i.type==="added"?"#22c55e":i.type==="removed"?"#ef4444":"var(--text-muted)",minWidth:"16px"},children:i.type==="added"?"+":i.type==="removed"?"-":" "}),o.jsx("span",{className:"flex-1 px-2 whitespace-pre",style:{color:"var(--text-primary)"},children:i.line})]},a))})})]})}function xU({workspaceId:e,artifactId:t=null,onClose:n}){const[r,s]=m.useState([]),[i,a]=m.useState(!0),[l,c]=m.useState(null);m.useEffect(()=>{e&&(a(!0),c(null),_e.getDiff(e,t).then(u=>{s(u.diffs||[])}).catch(u=>{c(u.message)}).finally(()=>{a(!1)}))},[e,t]);const d=u=>{u.key==="Escape"&&(n==null||n())};return o.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:u=>u.target===u.currentTarget&&(n==null?void 0:n()),onKeyDown:d,tabIndex:0,children:o.jsxs("div",{className:"w-full max-w-4xl max-h-[80vh] flex flex-col rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:t?"Artifact Changes":"All Changes"}),o.jsx("button",{onClick:n,className:"p-1 rounded hover:opacity-80",style:{color:"var(--text-muted)"},children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i?o.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"Loading diff..."}):l?o.jsxs("div",{className:"text-center py-8",style:{color:"var(--state-error-text)"},children:["Error: ",l]}):r.length===0?o.jsx("div",{className:"text-center py-8",style:{color:"var(--text-muted)"},children:"No changes to display"}):r.map((u,f)=>o.jsx(gU,{diff:u},u.artifact_id||f))}),o.jsx("div",{className:"flex justify-end px-4 py-3 border-t",style:{borderColor:"var(--border-panel)"},children:o.jsx("button",{onClick:n,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Close"})})]})})}function vU(e){const t=e.split(":");if(t.length!==4)return{display:e,scope:"unknown"};const[n,r,s,i]=t,a=r.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=i.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:n,name:r,version:s,kind:i,displayName:a,kindLabel:l,display:`${a} - ${l}`}}function yU(e){const t={doctype:{label:"Document Types",items:[]},role:{label:"Roles",items:[]},template:{label:"Templates",items:[]}};return e.forEach(n=>{const r=vU(n);t[r.scope]&&t[r.scope].items.push(r)}),Object.entries(t).filter(([n,r])=>r.items.length>0).map(([n,r])=>({scope:n,...r}))}function bU({workspaceId:e,onCommit:t,onCancel:n,loading:r=!1,modifiedArtifacts:s=[],modifiedFiles:i=[]}){const[a,l]=m.useState(""),[c,d]=m.useState(!1),u=yU(s),f=s.length,p=v=>{v.preventDefault(),a.trim()&&!r&&t(a.trim())},h=v=>{v.key==="Escape"&&!r&&n()};return o.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{background:"rgba(0, 0, 0, 0.7)"},onClick:v=>v.target===v.currentTarget&&!r&&n(),onKeyDown:h,children:[o.jsxs("div",{className:"w-full max-w-lg p-6 rounded-lg shadow-xl",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Commit Changes"}),f>0&&o.jsxs("div",{className:"mb-4 p-3 rounded",style:{background:"var(--bg-canvas)",border:"1px solid var(--border-panel)"},children:[o.jsxs("div",{className:"text-xs font-medium mb-2",style:{color:"var(--text-muted)"},children:[f," ",f===1?"change":"changes"," to be committed"]}),o.jsx("div",{className:"space-y-3 max-h-40 overflow-y-auto",children:u.map(v=>o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:v.label}),o.jsx("div",{className:"space-y-1",children:v.items.map((g,_)=>o.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded",style:{background:"var(--state-warning-bg, rgba(245, 158, 11, 0.2))",color:"var(--state-warning-text, #f59e0b)"},children:"M"}),o.jsx("span",{style:{color:"var(--text-primary)"},children:g.displayName}),o.jsx("span",{style:{color:"var(--text-muted)"},children:g.kindLabel}),o.jsxs("span",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:["v",g.version]})]},_))})]},v.scope))}),o.jsx("button",{type:"button",onClick:()=>d(!0),className:"mt-3 text-xs hover:underline",style:{color:"var(--action-primary)"},children:"View detailed changes..."})]}),o.jsxs("form",{onSubmit:p,children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm mb-2",style:{color:"var(--text-muted)"},children:"Commit Message"}),o.jsx("textarea",{value:a,onChange:v=>l(v.target.value),placeholder:"Describe your changes...",className:"w-full p-3 rounded text-sm resize-none",style:{background:"var(--bg-input, var(--bg-canvas))",border:"1px solid var(--border-panel)",color:"var(--text-primary)",minHeight:"80px"},autoFocus:!0,disabled:r}),o.jsx("div",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:'Keep it concise - describe the "why" not the "what"'})]}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx("button",{type:"button",onClick:n,disabled:r,className:"px-4 py-2 rounded text-sm",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)"},children:"Cancel"}),o.jsx("button",{type:"submit",disabled:!a.trim()||r,className:"px-4 py-2 rounded text-sm font-medium",style:{background:a.trim()&&!r?"var(--action-success)":"var(--border-panel)",color:a.trim()&&!r?"#000":"var(--text-muted)",cursor:a.trim()&&!r?"pointer":"not-allowed"},children:r?"Committing...":"Commit"})]})]})]}),c&&e&&o.jsx(xU,{workspaceId:e,onClose:()=>d(!1)})]})}function _U(e){const t=e.split(":");if(t.length!==4)return{display:e};const[n,r,s,i]=t,a=r.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),l=i.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase());return{scope:n,name:r,displayName:a,kind:i,kindLabel:l,version:s,display:`${a} - ${l}`}}function wU({workspaceId:e,state:t,loading:n,onCommit:r,onDiscard:s,onClose:i,onRefresh:a}){var w,R;const[l,c]=m.useState(!1),[d,u]=m.useState(!1),[f,p]=m.useState(!1),[h,v]=m.useState(null),g=(t==null?void 0:t.is_dirty)??!1,_=(t==null?void 0:t.modified_artifacts)??[],x=((w=t==null?void 0:t.tier1)==null?void 0:w.passed)??!0,y=((R=t==null?void 0:t.tier1)==null?void 0:R.results)??[],b=(t==null?void 0:t.branch)??"",j=t!=null&&t.expires_at?new Date(t.expires_at):null,N=async T=>{u(!0),v(null);try{const I=await _e.commit(e,T);c(!1),r==null||r(I),a==null||a()}catch(I){v(I.message)}finally{u(!1)}},E=async()=>{if(confirm("Discard all uncommitted changes? This cannot be undone.")){p(!0);try{await _e.discard(e),s==null||s(),a==null||a()}catch(T){console.error("Discard failed:",T),alert("Failed to discard changes: "+T.message)}finally{p(!1)}}},S=async()=>{if(g){alert("Cannot close workspace with uncommitted changes. Commit or discard first.");return}if(confirm("Close this workspace? You can open a new one later."))try{await _e.closeWorkspace(e),i==null||i()}catch(T){console.error("Close failed:",T),alert("Failed to close workspace: "+T.message)}},k=T=>{if(!T)return null;const D=T-new Date;if(D<=0)return"Expired";const C=Math.floor(D/(1e3*60*60)),M=Math.floor(D%(1e3*60*60)/(1e3*60));return C>0?`${C}h ${M}m remaining`:`${M}m remaining`};return o.jsxs("div",{className:"w-80 flex flex-col border-l h-full",style:{borderColor:"var(--border-panel)",background:"var(--bg-panel)"},children:[o.jsx("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:o.jsx("h2",{className:"text-sm font-semibold uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Workspace Status"})}),n?o.jsx("div",{className:"p-4 text-sm",style:{color:"var(--text-muted)"},children:"Loading..."}):o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[o.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsx("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Branch"}),o.jsx("div",{className:"text-sm font-mono truncate",style:{color:"var(--text-primary)"},title:b,children:b||"-"}),j&&o.jsx("div",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:k(j)})]}),o.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Status"}),o.jsx("div",{className:"text-xs px-2 py-0.5 rounded",style:{background:g?"var(--state-warning-bg, rgba(245, 158, 11, 0.2))":"var(--state-success-bg)",color:g?"var(--state-warning-text, #f59e0b)":"var(--state-success-text)"},children:g?"Modified":"Clean"})]}),_.length>0&&o.jsxs("div",{className:"mt-2",children:[o.jsxs("div",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:["Changed (",_.length,")"]}),o.jsx("div",{className:"space-y-1",children:_.map(T=>{const I=_U(T);return o.jsxs("div",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},title:T,children:[o.jsx("span",{style:{color:"var(--text-primary)"},children:I.displayName||T}),I.kindLabel&&o.jsxs("span",{style:{color:"var(--text-muted)"},children:[" ","- ",I.kindLabel]})]},T)})})]})]}),o.jsxs("div",{className:"px-4 py-3 border-b",style:{borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Tier 1 Validation"}),o.jsx(WS,{results:y,compact:!0})]}),y.length>0&&!x&&o.jsx("div",{className:"mt-3",children:o.jsx(WS,{results:y})})]})]}),o.jsxs("div",{className:"px-4 py-3 border-t space-y-2",style:{borderColor:"var(--border-panel)"},children:[o.jsx("button",{onClick:()=>c(!0),disabled:!g||!x||n,className:"w-full px-4 py-2 rounded text-sm font-medium transition-opacity",style:{background:g&&x?"var(--action-success)":"var(--border-panel)",color:g&&x?"#000":"var(--text-muted)",cursor:g&&x&&!n?"pointer":"not-allowed",opacity:n?.5:1},children:"Commit Changes"}),!x&&g&&o.jsx("div",{className:"text-xs text-center",style:{color:"var(--state-error-text)"},children:"Fix validation errors to commit"}),g&&o.jsx("button",{onClick:E,disabled:f||n,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:f||n?.5:1},children:f?"Discarding...":"Discard Changes"}),!g&&o.jsx("button",{onClick:S,disabled:n,className:"w-full px-4 py-2 rounded text-sm transition-opacity",style:{background:"transparent",border:"1px solid var(--border-panel)",color:"var(--text-muted)",opacity:n?.5:1},children:"Close Workspace"})]}),l&&o.jsx(bU,{workspaceId:e,onCommit:N,onCancel:()=>{c(!1),v(null)},loading:d,modifiedArtifacts:_,modifiedFiles:(t==null?void 0:t.modified_files)??[]}),h&&o.jsx("div",{className:"absolute bottom-4 left-4 right-4 p-3 rounded text-sm",style:{background:"rgba(239, 68, 68, 0.9)",color:"#fff"},children:h})]})}function jU(){const{isAdmin:e,loading:t}=zi(),[n,r]=m.useState(null),[s,i]=m.useState(null),[a,l]=m.useState(!1),[c,d]=m.useState(null),[u,f]=m.useState(null),[p,h]=m.useState(null),[v,g]=m.useState(null),[_,x]=m.useState(null),[y,b]=m.useState(null),[j,N]=m.useState(null),[E,S]=m.useState(!1),{workspaceId:k,loading:w,error:R,reinitialize:T}=o9(),{state:I,loading:D,refresh:C}=a9(k),{documentTypes:M,loading:P,refresh:F}=l9(),{roles:O,loading:A,refresh:z}=c9(),{templates:$,loading:B,refresh:U}=$3(),{workflows:G,loading:H,refresh:q}=YW(),{fragments:Q,loading:se,kindOptions:ie,refresh:Z}=B3(),{schemas:Se,loading:xe,refresh:be}=q3(),[ve,ae]=m.useState([]),[Y,te]=m.useState([]),[ee,ke]=m.useState(!1),[we,Ee]=m.useState(null),Ne=m.useCallback(async()=>{ke(!0);try{const[ue,de]=await Promise.all([_e.getMechanicalOpTypes(),_e.getMechanicalOps()]);ae(ue.types||[]),te(de.operations||[])}catch(ue){console.error("Failed to load mechanical ops:",ue)}finally{ke(!1)}},[]);m.useEffect(()=>{Ne()},[Ne]);const ne=m.useCallback(async(ue,de=null,Ye="docworkflow")=>{if(r(ue),d(null),f(null),h(null),i(null),g(null),x(null),Ee(null),b(de),N(Ye),!!ue){l(!0);try{const wn=await _e.getDocumentType(ue.doc_type_id);i(wn)}catch(wn){console.error("Failed to load doc type details:",wn),i(ue)}finally{l(!1)}}},[]),je=m.useCallback(ue=>{ne(ue,"task_prompt","task")},[ne]),Ve=m.useCallback(ue=>{ne(ue,"schema","schema")},[ne]),ct=m.useCallback(ue=>{d(ue),r(null),i(null),f(null),h(null),g(null),x(null),Ee(null)},[]),Be=m.useCallback(ue=>{f(ue),r(null),i(null),d(null),h(null),g(null),x(null),Ee(null)},[]),Ie=m.useCallback(ue=>{h(ue),r(null),i(null),d(null),f(null),g(null),x(null),Ee(null)},[]),oe=m.useCallback(ue=>{g(ue),r(null),i(null),d(null),f(null),h(null),x(null),Ee(null)},[]),me=m.useCallback(ue=>{x(ue),r(null),i(null),d(null),f(null),h(null),g(null),Ee(null)},[]),fe=m.useCallback(ue=>{Ee(ue),r(null),i(null),d(null),f(null),h(null),g(null),x(null)},[]),V=m.useCallback(ue=>{const de=G.find(Ye=>Ye.workflow_id===ue);de&&Ie(de)},[G,Ie]),ge=m.useCallback((ue,de)=>{C()},[C]),pe=m.useCallback(ue=>{console.log("Committed:",ue.commit_hash)},[]),ze=m.useCallback(()=>{r(null),i(null),d(null),f(null),h(null),g(null),x(null),Ee(null)},[]),We=m.useCallback(async ue=>{if(k)try{const de=await _e.createOrchestrationWorkflow(k,ue);await q(),C(),h({workflow_id:de.workflow_id,active_version:de.version,name:ue.name||de.workflow_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase())}),r(null),i(null),d(null),f(null)}catch(de){console.error("Failed to create workflow:",de),alert(`Failed to create workflow: ${de.message}`)}},[k,q,C]),st=m.useCallback(async ue=>{if(k)try{await _e.deleteOrchestrationWorkflow(k,ue),await q(),C(),h(null)}catch(de){console.error("Failed to delete workflow:",de),alert(`Failed to delete workflow: ${de.message}`)}},[k,q,C]),Ue=m.useCallback(async ue=>{if(k)try{const de=await _e.createDocumentType(k,ue);await F(),C(),ne({doc_type_id:de.doc_type_id,display_name:ue.display_name||de.doc_type_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase()),active_version:de.version})}catch(de){console.error("Failed to create document type:",de),alert(`Failed to create document type: ${de.message}`)}},[k,F,C,ne]);m.useCallback(async ue=>{if(k)try{await _e.deleteDocumentType(k,ue),await F(),C(),r(null),i(null)}catch(de){console.error("Failed to delete document type:",de),alert(`Failed to delete document type: ${de.message}`)}},[k,F,C]);const L=m.useCallback(async ue=>{if(k)try{await _e.createDcwWorkflow(k,{doc_type_id:ue}),await q(),C()}catch(de){console.error("Failed to create DCW workflow:",de),alert(`Failed to create workflow: ${de.message}`)}},[k,q,C]),W=m.useCallback(async ue=>{if(k)try{const de=await _e.createRolePrompt(k,ue);await Z(),await z(),C(),oe({fragment_id:`role:${de.role_id}`,kind:"role",version:de.version,name:ue.name||de.role_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase())})}catch(de){console.error("Failed to create role prompt:",de),alert(`Failed to create role prompt: ${de.message}`)}},[k,Z,z,C,oe]),K=m.useCallback(async ue=>{if(k)try{const de=await _e.createTemplate(k,ue);await U(),C(),Be({template_id:de.template_id,active_version:de.version,name:ue.name||de.template_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase())})}catch(de){console.error("Failed to create template:",de),alert(`Failed to create template: ${de.message}`)}},[k,U,C,Be]),re=m.useCallback(async ue=>{if(k)try{const de=await _e.createStandaloneSchema(k,ue);await be(),C(),me({schema_id:de.schema_id,active_version:de.version,title:ue.title||de.schema_id.replace(/_/g," ").replace(/\b\w/g,Ye=>Ye.toUpperCase())})}catch(de){console.error("Failed to create schema:",de),alert(`Failed to create schema: ${de.message}`)}},[k,be,C,me]),Fe=m.useCallback(()=>{T(),r(null),i(null),d(null),f(null),h(null),g(null),x(null),Ee(null)},[T]),pt=m.useCallback(async()=>{try{await _e.invalidateCache(),await Promise.all([F(),z(),U(),q(),Z(),be(),Ne(),C()])}catch(ue){console.error("Failed to reload config:",ue),alert(`Failed to reload config: ${ue.message}`)}},[F,z,U,q,Z,be,Ne,C]);if(t)return o.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:o.jsx("span",{style:{color:"var(--text-muted)"},children:"Loading..."})});if(!e)return o.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8 rounded-lg",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Access Denied"}),o.jsx("div",{style:{color:"var(--text-muted)"},children:"Admin access required for the Workbench."})]})});if(w)return o.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-lg mb-2",style:{color:"var(--text-primary)"},children:"Initializing Workspace"}),o.jsx("div",{style:{color:"var(--text-muted)"},children:"Setting up your editing environment..."})]})});if(R)return o.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-8 rounded-lg max-w-md",style:{background:"var(--bg-panel)",border:"1px solid var(--border-panel)"},children:[o.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"var(--state-error-text)"},children:"Workspace Error"}),o.jsx("div",{className:"mb-4",style:{color:"var(--text-muted)"},children:R}),o.jsx("button",{onClick:T,className:"px-4 py-2 rounded text-sm",style:{background:"var(--action-primary)",color:"#000"},children:"Retry"})]})});const ln=c&&!n&&!u&&!p&&!v&&!_&&!we,Tt=u&&!n&&!c&&!p&&!v&&!_&&!we,jt=p&&!n&&!c&&!u&&!v&&!_&&!we,qt=v&&!n&&!c&&!u&&!p&&!_&&!we,Ln=_&&!n&&!c&&!u&&!p&&!v&&!we,at=we&&!n&&!c&&!u&&!p&&!v&&!_;return o.jsxs("div",{className:"flex flex-col h-screen overflow-hidden",style:{background:"var(--bg-canvas)"},children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-2",style:{background:"var(--bg-group-header)",borderBottom:"1px solid var(--border-panel)",flexShrink:0},children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:"/logo-dark.png",alt:"The Combine",className:"h-6 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>{window.location.href="/"},title:"Return to Home"}),o.jsx("span",{className:"font-bold uppercase tracking-widest",style:{color:"var(--text-primary)",fontSize:11},children:"Admin Workbench"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:pt,className:"flex items-center gap-1 px-2 py-1 rounded hover:opacity-80 transition-opacity",style:{background:"var(--bg-panel)",color:"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:11},title:"Reload config from disk (invalidate cache)",children:[o.jsx("span",{style:{fontSize:12},children:""}),o.jsx("span",{children:"Reload"})]}),o.jsxs("button",{onClick:()=>S(!E),className:"flex items-center gap-2 px-3 py-1.5 rounded hover:opacity-80 transition-opacity",style:{background:E?"var(--action-primary)":"var(--bg-panel)",color:E?"#000":"var(--text-secondary)",border:"1px solid var(--border-panel)",cursor:"pointer",fontSize:12,fontWeight:500},title:"Building Blocks",children:[o.jsx("span",{style:{fontSize:14},children:""}),o.jsx("span",{children:"Building Blocks"})]})]})]}),o.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[o.jsx(XW,{documentTypes:M,roles:O,templates:$,workflows:G,promptFragments:Q,promptFragmentKindOptions:ie,schemas:Se,loading:P,rolesLoading:A,templatesLoading:B,workflowsLoading:H,promptFragmentsLoading:se,schemasLoading:xe,selectedDocType:n,docTypeSource:j,selectedRole:c,selectedTemplate:u,selectedWorkflow:p,selectedFragment:v,selectedSchema:_,onSelectDocType:ne,onSelectRole:ct,onSelectTemplate:Be,onSelectWorkflow:Ie,onSelectFragment:oe,onSelectStandaloneSchema:me,onCreateWorkflow:We,onCreateDocType:Ue,onCreateFragment:W,onCreateTemplate:K,onCreateSchema:re,onSelectTask:je,onSelectSchema:Ve,workspaceState:I}),ln?o.jsx(yH,{workspaceId:k,role:c,onArtifactSave:ge}):Tt?o.jsx(_H,{workspaceId:k,template:u,onArtifactSave:ge}):qt?o.jsx(kH,{workspaceId:k,fragment:v,onArtifactSave:ge}):jt?o.jsx(cU,{workspaceId:k,workflow:p,documentTypes:M,onArtifactSave:ge,onDelete:st,onNavigateToWorkflow:V}):Ln?o.jsx(wH,{workspaceId:k,schema:_,onArtifactSave:ge}):at?o.jsx(NH,{mechanicalOp:we,mechanicalOpTypes:ve}):o.jsx(vH,{workspaceId:k,docType:s,loading:a,roles:O,workflows:G,onArtifactSave:ge,onCreateDcwWorkflow:L,initialTab:y,docTypeSource:j,mechanicalOpTypes:ve,mechanicalOps:Y}),o.jsx(wU,{workspaceId:k,state:I,loading:D,onCommit:pe,onDiscard:ze,onClose:Fe,onRefresh:C})]}),o.jsx(ZW,{isOpen:E,onClose:()=>S(!1),promptFragments:Q,promptFragmentKindOptions:ie,templates:$,schemas:Se,documentTypes:M,promptFragmentsLoading:se,templatesLoading:B,schemasLoading:xe,selectedFragment:v,selectedTemplate:u,selectedSchema:_,selectedMechanicalOp:we,onSelectFragment:oe,onSelectTemplate:Be,onSelectSchema:Ve,onSelectStandaloneSchema:me,onCreateFragment:W,onCreateTemplate:K,onCreateSchema:re,mechanicalOpTypes:ve,mechanicalOps:Y,mechanicalOpsLoading:ee,onSelectMechanicalOp:fe})]})}function SU({user:e,onClick:t}){return o.jsx("div",{className:"p-3 border-t",style:{borderColor:"var(--border-panel)"},children:o.jsxs("button",{onClick:t,className:"flex items-center gap-3 w-full p-2 rounded-lg hover:bg-white/10 transition-colors",style:{color:"var(--text-primary)"},children:[e!=null&&e.avatar_url?o.jsx("img",{src:e.avatar_url,alt:e.name,className:"w-8 h-8 rounded-full"}):o.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"var(--bg-canvas)"},children:o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),o.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}),o.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[o.jsx("div",{className:"text-sm font-medium truncate",children:(e==null?void 0:e.name)||"User"}),o.jsx("div",{className:"text-xs truncate",style:{color:"var(--text-muted)"},children:(e==null?void 0:e.email)||""})]})]})})}function kU(){var T,I,D,C,M;const{user:e}=zi(),[t,n]=m.useState(!1),{projects:r,loading:s,error:i,refresh:a}=n9({includeArchived:t}),[l,c]=m.useState(null),[d,u]=m.useState(null),[f,p]=m.useState(!1),[h,v]=m.useState(!1),{theme:g,setTheme:_}=X4(),x=Object.keys(r),y=l&&r[l]?l:x[0]||null;m.useEffect(()=>{if(y&&r[y]){const P=r[y];document.title=`${P.projectId} - The Combine`}else document.title="The Combine"},[y,r]);const b=P=>{c(P),u(null)},j=()=>{p(!0)},N=async P=>{await a(),P&&P.id&&(c(P.id),u("concierge_intake")),p(!1)},E=()=>{p(!1)},S=async(P,F)=>{try{await Ke.updateProject(P,F),await a()}catch(O){throw console.error("Failed to update project:",O),O}},k=async P=>{try{if(await Ke.archiveProject(P),!t){const F=Object.values(r).sort((z,$)=>{const B=(z.name||"").localeCompare($.name||"");return B!==0?B:(z.projectId||"").localeCompare($.projectId||"")}),O=F.findIndex(z=>z.id===P),A=F[O+1]||F[O-1]||null;c((A==null?void 0:A.id)||null)}await a()}catch(F){throw console.error("Failed to archive project:",F),F}},w=async P=>{try{await Ke.unarchiveProject(P),await a()}catch(F){throw console.error("Failed to unarchive project:",F),F}},R=async P=>{try{await Ke.deleteProject(P);const F=Object.values(r).sort((z,$)=>{const B=(z.name||"").localeCompare($.name||"");return B!==0?B:(z.projectId||"").localeCompare($.projectId||"")}),O=F.findIndex(z=>z.id===P),A=F[O+1]||F[O-1]||null;c((A==null?void 0:A.id)||null),await a()}catch(F){throw console.error("Failed to delete project:",F),F}};return s?o.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",children:[o.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),o.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading projects..."})]})}):i?o.jsx("div",{className:`flex h-screen items-center justify-center theme-${g}`,style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center p-6 rounded-lg",style:{background:"var(--bg-panel)"},children:[o.jsxs("p",{className:"text-red-500 mb-4",children:["Failed to load projects: ",i]}),o.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-emerald-500 text-white rounded hover:bg-emerald-600",children:"Retry"})]})}):o.jsxs("div",{className:`flex flex-col h-screen theme-${g}`,children:[o.jsxs("header",{className:"h-12 flex items-center justify-between px-4 border-b flex-shrink-0",style:{background:"var(--bg-panel)",borderColor:"var(--border-panel)"},children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("img",{src:"/logo-256.png",alt:"The Combine",className:"h-7 w-7"}),o.jsx("span",{className:"text-sm font-bold tracking-wide",style:{color:"var(--text-primary)"},children:"THE COMBINE"})]}),o.jsx("button",{className:"p-2 rounded hover:bg-white/10 transition-colors",style:{color:"var(--text-muted)"},title:"Help",children:o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"12",cy:"12",r:"10"}),o.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),o.jsx("path",{d:"M12 17h.01"})]})})]}),o.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[o.jsx(g8,{projects:r,selectedId:y,onSelectProject:b,onNewProject:j,showArchived:t,onToggleShowArchived:()=>n(P=>!P),userSection:o.jsx(SU,{user:e,onClick:()=>v(!0)})}),o.jsx("div",{className:"flex-1",children:y?o.jsx(Ii,{children:o.jsx(f9,{projectId:y,projectCode:(T=r[y])==null?void 0:T.projectId,projectName:(I=r[y])==null?void 0:I.name,isArchived:(D=r[y])==null?void 0:D.isArchived,savedLayout:(M=(C=r[y])==null?void 0:C.metadata)==null?void 0:M.floor_layout,autoExpandNodeId:d,theme:g,onThemeChange:_,onProjectUpdate:S,onProjectArchive:k,onProjectUnarchive:w,onProjectDelete:R})},y):o.jsx("div",{className:"flex items-center justify-center h-full",style:{background:"var(--bg-canvas)"},children:o.jsx("div",{className:"text-center",children:o.jsx("p",{style:{color:"var(--text-muted)"},children:"No projects yet. Create one to get started."})})})}),f&&o.jsx(DW,{onClose:E,onComplete:N}),h&&o.jsx(LW,{onClose:()=>v(!1)})]})]})}function NU(){const{isAuthenticated:e,loading:t}=zi(),{theme:n}=X4(),[r,s]=m.useState(window.location.pathname);return m.useEffect(()=>{const i=()=>s(window.location.pathname);return window.addEventListener("popstate",i),()=>window.removeEventListener("popstate",i)},[]),t?o.jsx("div",{className:`flex h-screen items-center justify-center theme-${n}`,style:{background:"var(--bg-canvas)"},children:o.jsxs("div",{className:"text-center",children:[o.jsx("img",{src:"/logo-light.png",alt:"The Combine",className:"h-16 mx-auto mb-4 animate-pulse"}),o.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading..."})]})}):e?r==="/admin/workbench"?o.jsx("div",{className:`h-screen theme-${n}`,children:o.jsx(jU,{})}):o.jsx(kU,{}):r==="/learn"?o.jsx(KW,{}):o.jsx(HW,{})}function CU(){return o.jsx(i9,{children:o.jsx(NU,{})})}Mg.createRoot(document.getElementById("root")).render(o.jsx(X.StrictMode,{children:o.jsx(CU,{})}));
//# sourceMappingURL=index-nJCYyU9H.js.map
