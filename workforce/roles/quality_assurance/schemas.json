{
  "qa_test_plan": {
    "description": "Structured test plan created by the QA role.",
    "type": "object",
    "properties": {
      "summary": {
        "type": "string",
        "description": "Short overview of what functionality is being tested."
      },
      "test_cases": {
        "type": "array",
        "description": "List of detailed test cases.",
        "items": {
          "type": "object",
          "properties": {
            "name": { "type": "string" },
            "preconditions": { "type": "string" },
            "steps": { "type": "array", "items": { "type": "string" } },
            "expected_result": { "type": "string" }
          },
          "required": ["name", "steps", "expected_result"]
        }
      },
      "edge_cases": {
        "type": "array",
        "description": "List of additional risk-driven scenarios to execute.",
        "items": { "type": "string" }
      },
      "regression_notes": {
        "type": "string",
        "description": "Explanation of which existing areas may be impacted and need retesting."
      },
      "defects": {
        "type": "array",
        "description": "List of defects discovered during testing.",
        "items": {
          "type": "object",
          "properties": {
            "title": { "type": "string" },
            "steps_to_reproduce": { "type": "array", "items": { "type": "string" } },
            "expected": { "type": "string" },
            "actual": { "type": "string" },
            "severity": { "type": "string", "enum": ["low", "medium", "high", "critical"] }
          },
          "required": ["title", "steps_to_reproduce", "expected", "actual"]
        }
      },
      "open_questions": {
        "type": "array",
        "description": "Questions about missing or unclear requirements.",
        "items": { "type": "string" }
      },
      "verdict": {
        "type": "string",
        "description": "The QA decision regarding readiness of the implementation.",
        "enum": ["READY", "BLOCKED", "DEFECTS_FOUND", "PARTIALLY_VERIFIED"]
      }
    },
    "required": ["summary", "verdict"]
  }
}
